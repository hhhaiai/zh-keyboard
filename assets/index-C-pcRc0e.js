var Ow=Object.defineProperty;var Fw=(e,t,n)=>t in e?Ow(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Qs=(e,t,n)=>Fw(e,typeof t!="symbol"?t+"":t,n);function Rw(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in e)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(e,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pw=1e-7,Mw=1e-4;class Vw{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class Jp{refCount(t){return _n("refCount")}incRef(t){return _n("incRef")}timerAvailable(){return!0}time(t){return _n("time")}read(t){return _n("read")}readSync(t){return _n("readSync")}readToGPU(t,n){return _n("readToGPU")}numDataIds(){return _n("numDataIds")}disposeData(t,n){return _n("disposeData")}write(t,n,s){return _n("write")}move(t,n,s,r,a){return _n("move")}createTensorFromGPUData(t,n,s){return _n("createTensorFromGPUData")}memory(){return _n("memory")}floatPrecision(){return _n("floatPrecision")}epsilon(){return this.floatPrecision()===32?Pw:Mw}dispose(){return _n("dispose")}}function _n(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jl(e,t,n){return Math.max(e,Math.min(t,n))}function Za(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function A(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Mn(e,t,n=""){A(Un(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function Pa(e){A(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Nt(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Lw(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function Un(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ko(e){return e%1===0}function Ii(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function zw(e,t){let n=1,s=-1;for(let a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(e[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(e[a]<0)throw Error(`Shapes can not be < 0. Found ${e[a]} at dim ${a}`);if(s===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const r=e.slice();return r[s]=t/n,r}function Ue(e,t){const n=t.length;return e=e==null?t.map((s,r)=>r):[].concat(e),A(e.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),A(e.every(s=>ko(s)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(s=>s<0?n+s:s)}function Bw(e,t){const n=[],s=[],r=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||r?null:Ue(t,e).sort();let o=0;for(let i=0;i<e.length;++i){if(a!=null){if(a[o]===i&&e[i]!==1)throw new Error(`Can't squeeze axis ${i} since its dim '${e[i]}' is not 1`);(a[o]==null||a[o]>i)&&e[i]===1&&(n.push(e[i]),s.push(i)),a[o]<=i&&o++}e[i]!==1&&(n.push(e[i]),s.push(i))}return{newShape:n,keptDims:s}}function pn(e,t){return ze(e,t)}function ze(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function Ww(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function jw(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function Hw(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function Hc(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function qw(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function gu(e){return typeof e=="string"||e instanceof String}function Kw(e){return typeof e=="boolean"}function Uw(e){return typeof e=="number"}function Lo(e){return Array.isArray(e)?Lo(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":Uw(e)?"float32":gu(e)?"string":Kw(e)?"bool":"float32"}function qc(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Kt(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let s=t-3;s>=0;--s)n[s]=n[s+1]*e[s+1];return n}function Qp(e,t,n,s=!1){const r=new Array;if(t.length===1){const a=t[0]*(s?2:1);for(let o=0;o<a;o++)r[o]=n[e+o]}else{const a=t[0],o=t.slice(1),i=o.reduce((u,c)=>u*c)*(s?2:1);for(let u=0;u<a;u++)r[u]=Qp(e+u*i,o,n,s)}return r}function Hn(e,t,n=!1){if(e.length===0)return t[0];const s=e.reduce((r,a)=>r*a)*(n?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return Qp(0,e,t,n)}function Gw(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function Hl(e,t){const n=tn(e,t);for(let s=0;s<n.length;s++)n[s]=1;return n}function tn(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function tm(e,t){const n=e.reduce((s,r)=>s*r,1);if(t==null||t==="float32")return Hn(e,new Float32Array(n));if(t==="int32")return Hn(e,new Int32Array(n));if(t==="bool")return Hn(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function Vn(e){e.forEach(t=>{A(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function fs(e,t,n){if(t===0)return 0;if(t===1)return e[0];let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=n[r]*e[r];return s}function Ma(e,t,n){if(t===0)return[];if(t===1)return[e];const s=new Array(t);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(e/n[r]),e-=s[r]*n[r];return s[s.length-1]=e,s}function zr(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sd="tfjsflags";class Yw{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Xw,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(ie().getBool("IS_TEST")||ie().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,s){if(this.flagRegistry[t]={evaluationFn:n,setHook:s},this.urlFlags[t]!=null){const r=this.urlFlags[t];ie().getBool("IS_TEST")||ie().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${r}.`),this.set(t,r)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(zr(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);Sd in t&&t[Sd].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=Jw(r,a)})}}function Xw(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(Zw(t,s[0],s[1]),s.join("="))),t}function Zw(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Jw(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function ie(){return em}let em=null;function Qw(e){em=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Nc;function nm(){if(Nc==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");Nc=e}return Nc}function tv(){const e=nm();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function ql(e,t){const n=tv();if(n.has(e))return n.get(e);{const s=t();return n.set(e,s),n.get(e)}}const sm="Abs",Kl="Acos",Ul="Acosh",yu="Add",rm="AddN",am="All",om="Any",im="ArgMax",um="ArgMin",Gl="Asin",Yl="Asinh",Xl="Atan",Zl="Atanh",Jl="Atan2",cm="AvgPool",ev="AvgPoolGrad",lm="AvgPool3D",nv="AvgPool3DGrad",fm="BatchMatMul",hm="BatchToSpaceND",dm="Bincount",Ql="BitwiseAnd",pm="BroadcastArgs",tf="Cast",ef="Ceil",nf="ClipByValue",mm="Complex",gm="ComplexAbs",ym="Concat",bm="Conv2D",wm="Conv2DBackpropFilter",vm="Conv2DBackpropInput",km="Conv3D",sv="Conv3DBackpropFilterV2",xm="Conv3DBackpropInputV2",sf="Cos",rf="Cosh",Sm="Cumprod",Nm="Cumsum",Im="CropAndResize",_m="DenseBincount",Tm="DepthToSpace",Em="DepthwiseConv2dNative",$m="DepthwiseConv2dNativeBackpropFilter",Cm="DepthwiseConv2dNativeBackpropInput",Am="Diag",Dm="Dilation2D",Nd="Dilation2DBackpropInput",Id="Dilation2DBackpropFilter",rv="Draw",af="RealDiv",Om="Einsum",of="Elu",av="EluGrad",uf="Erf",cf="Equal",lf="Exp",Fm="ExpandDims",ff="Expm1",Rm="FFT",Pm="Fill",Mm="FlipLeftRight",hf="Floor",df="FloorDiv",Vm="FusedBatchNorm",Lm="GatherV2",zm="GatherNd",pf="Greater",mf="GreaterEqual",gf="Identity",Bm="IFFT",Wm="Imag",yf="IsFinite",bf="IsInf",wf="IsNan",jm="LeakyRelu",vf="Less",kf="LessEqual",Hm="LinSpace",xf="Log",Sf="Log1p",Nf="LogicalAnd",If="LogicalNot",_f="LogicalOr",qm="LRN",ov="LRNGrad",Km="Max",Tf="Maximum",Um="MaxPool",iv="MaxPoolGrad",Gm="MaxPool3D",uv="MaxPool3DGrad",Ym="MaxPoolWithArgmax",Xm="Mean",Zm="Min",Ef="Minimum",Jm="MirrorPad",$f="Mod",Qm="Multinomial",Cf="Multiply",tg="Neg",Af="NotEqual",eg="NonMaxSuppressionV3",ng="NonMaxSuppressionV4",sg="NonMaxSuppressionV5",rg="OnesLike",ag="OneHot",og="Pack",ig="PadV2",Df="Pow",ug="Prelu",cg="Prod",lg="RaggedGather",fg="RaggedRange",hg="RaggedTensorToTensor",dg="Range",pg="Real",Of="Reciprocal",Ff="Relu",mg="Reshape",gg="ResizeNearestNeighbor",cv="ResizeNearestNeighborGrad",yg="ResizeBilinear",lv="ResizeBilinearGrad",Rf="Relu6",bg="Reverse",Pf="Round",Mf="Rsqrt",wg="ScatterNd",vg="TensorScatterUpdate",kg="SearchSorted",xg="Select",Vf="Selu",Sg="Slice",Lf="Sin",zf="Sinh",Bf="Sign",Wf="Sigmoid",jf="Softplus",Hf="Sqrt",Ng="Sum",Ig="SpaceToBatchND",_g="SplitV",Tg="Softmax",Eg="SparseFillEmptyRows",$g="SparseReshape",Cg="SparseSegmentMean",Ag="SparseSegmentSum",Dg="SparseToDense",qf="SquaredDifference",fv="Square",Kf="StaticRegexReplace",Og="StridedSlice",Fg="StringNGrams",Rg="StringSplit",Pg="StringToHashBucketFast",Uf="Sub",Gf="Tan",Yf="Tanh",Xf="Tile",Mg="TopK",Vg="Transform",_i="Transpose",Lg="Unique",zg="Unpack",Bg="UnsortedSegmentSum",Wg="ZerosLike",Zf="Step",_d="FromPixels",jg="RotateWithOffset",Kc="_FusedMatMul",Uc="FusedConv2D",Gc="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ar(...e){ie().getBool("IS_TEST")||ie().getBool("PROD")||console.warn(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wi=ql("kernelRegistry",()=>new Map),hv=ql("gradRegistry",()=>new Map);function Yc(e,t){const n=Hg(e,t);return Wi.get(n)}function Td(e){return hv.get(e)}function Ed(e){const t=Wi.entries(),n=[];for(;;){const{done:s,value:r}=t.next();if(s)break;const[a,o]=r,[i]=a.split("_");i===e&&n.push(o)}return n}function dv(e){const{kernelName:t,backendName:n}=e,s=Hg(t,n);Wi.has(s)&&Ar(`The kernel '${t}' for backend '${n}' is already registered`),Wi.set(s,e)}function Hg(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qg(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}function pv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function mv(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var r=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return e[s]}})}),n}var Ic,$d;function gv(){if($d)return Ic;$d=1,Ic=t;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(M,E,K){this.low=M|0,this.high=E|0,this.unsigned=!!K}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function n(M){return(M&&M.__isLong__)===!0}t.isLong=n;var s={},r={};function a(M,E){var K,X,rt;return E?(M>>>=0,(rt=0<=M&&M<256)&&(X=r[M],X)?X:(K=i(M,(M|0)<0?-1:0,!0),rt&&(r[M]=K),K)):(M|=0,(rt=-128<=M&&M<128)&&(X=s[M],X)?X:(K=i(M,M<0?-1:0,!1),rt&&(s[M]=K),K))}t.fromInt=a;function o(M,E){if(isNaN(M))return E?I:k;if(E){if(M<0)return I;if(M>=g)return P}else{if(M<=-w)return L;if(M+1>=w)return D}return M<0?o(-M,E).neg():i(M%m|0,M/m|0,E)}t.fromNumber=o;function i(M,E,K){return new t(M,E,K)}t.fromBits=i;var u=Math.pow;function c(M,E,K){if(M.length===0)throw Error("empty string");if(M==="NaN"||M==="Infinity"||M==="+Infinity"||M==="-Infinity")return k;if(typeof E=="number"?(K=E,E=!1):E=!!E,K=K||10,K<2||36<K)throw RangeError("radix");var X;if((X=M.indexOf("-"))>0)throw Error("interior hyphen");if(X===0)return c(M.substring(1),E,K).neg();for(var rt=o(u(K,8)),nt=k,st=0;st<M.length;st+=8){var it=Math.min(8,M.length-st),tt=parseInt(M.substring(st,st+it),K);if(it<8){var ut=o(u(K,it));nt=nt.mul(ut).add(o(tt))}else nt=nt.mul(rt),nt=nt.add(o(tt))}return nt.unsigned=E,nt}t.fromString=c;function l(M,E){return typeof M=="number"?o(M,E):typeof M=="string"?c(M,E):i(M.low,M.high,typeof E=="boolean"?E:M.unsigned)}t.fromValue=l;var f=65536,d=1<<24,m=f*f,g=m*m,w=g/2,b=a(d),k=a(0);t.ZERO=k;var I=a(0,!0);t.UZERO=I;var T=a(1);t.ONE=T;var N=a(1,!0);t.UONE=N;var $=a(-1);t.NEG_ONE=$;var D=i(-1,2147483647,!1);t.MAX_VALUE=D;var P=i(-1,-1,!0);t.MAX_UNSIGNED_VALUE=P;var L=i(0,-2147483648,!1);t.MIN_VALUE=L;var R=t.prototype;return R.toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},R.toString=function(E){if(E=E||10,E<2||36<E)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(L)){var K=o(E),X=this.div(K),rt=X.mul(K).sub(this);return X.toString(E)+rt.toInt().toString(E)}else return"-"+this.neg().toString(E);for(var nt=o(u(E,6),this.unsigned),st=this,it="";;){var tt=st.div(nt),ut=st.sub(tt.mul(nt)).toInt()>>>0,ht=ut.toString(E);if(st=tt,st.isZero())return ht+it;for(;ht.length<6;)ht="0"+ht;it=""+ht+it}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){if(this.isNegative())return this.eq(L)?64:this.neg().getNumBitsAbs();for(var E=this.high!=0?this.high:this.low,K=31;K>0&&(E&1<<K)==0;K--);return this.high!=0?K+33:K+1},R.isZero=function(){return this.high===0&&this.low===0},R.eqz=R.isZero,R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||this.high>=0},R.isOdd=function(){return(this.low&1)===1},R.isEven=function(){return(this.low&1)===0},R.equals=function(E){return n(E)||(E=l(E)),this.unsigned!==E.unsigned&&this.high>>>31===1&&E.high>>>31===1?!1:this.high===E.high&&this.low===E.low},R.eq=R.equals,R.notEquals=function(E){return!this.eq(E)},R.neq=R.notEquals,R.ne=R.notEquals,R.lessThan=function(E){return this.comp(E)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(E){return this.comp(E)<=0},R.lte=R.lessThanOrEqual,R.le=R.lessThanOrEqual,R.greaterThan=function(E){return this.comp(E)>0},R.gt=R.greaterThan,R.greaterThanOrEqual=function(E){return this.comp(E)>=0},R.gte=R.greaterThanOrEqual,R.ge=R.greaterThanOrEqual,R.compare=function(E){if(n(E)||(E=l(E)),this.eq(E))return 0;var K=this.isNegative(),X=E.isNegative();return K&&!X?-1:!K&&X?1:this.unsigned?E.high>>>0>this.high>>>0||E.high===this.high&&E.low>>>0>this.low>>>0?-1:1:this.sub(E).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(L)?L:this.not().add(T)},R.neg=R.negate,R.add=function(E){n(E)||(E=l(E));var K=this.high>>>16,X=this.high&65535,rt=this.low>>>16,nt=this.low&65535,st=E.high>>>16,it=E.high&65535,tt=E.low>>>16,ut=E.low&65535,ht=0,mt=0,vt=0,bt=0;return bt+=nt+ut,vt+=bt>>>16,bt&=65535,vt+=rt+tt,mt+=vt>>>16,vt&=65535,mt+=X+it,ht+=mt>>>16,mt&=65535,ht+=K+st,ht&=65535,i(vt<<16|bt,ht<<16|mt,this.unsigned)},R.subtract=function(E){return n(E)||(E=l(E)),this.add(E.neg())},R.sub=R.subtract,R.multiply=function(E){if(this.isZero())return k;if(n(E)||(E=l(E)),e){var K=e.mul(this.low,this.high,E.low,E.high);return i(K,e.get_high(),this.unsigned)}if(E.isZero())return k;if(this.eq(L))return E.isOdd()?L:k;if(E.eq(L))return this.isOdd()?L:k;if(this.isNegative())return E.isNegative()?this.neg().mul(E.neg()):this.neg().mul(E).neg();if(E.isNegative())return this.mul(E.neg()).neg();if(this.lt(b)&&E.lt(b))return o(this.toNumber()*E.toNumber(),this.unsigned);var X=this.high>>>16,rt=this.high&65535,nt=this.low>>>16,st=this.low&65535,it=E.high>>>16,tt=E.high&65535,ut=E.low>>>16,ht=E.low&65535,mt=0,vt=0,bt=0,$t=0;return $t+=st*ht,bt+=$t>>>16,$t&=65535,bt+=nt*ht,vt+=bt>>>16,bt&=65535,bt+=st*ut,vt+=bt>>>16,bt&=65535,vt+=rt*ht,mt+=vt>>>16,vt&=65535,vt+=nt*ut,mt+=vt>>>16,vt&=65535,vt+=st*tt,mt+=vt>>>16,vt&=65535,mt+=X*ht+rt*ut+nt*tt+st*it,mt&=65535,i(bt<<16|$t,mt<<16|vt,this.unsigned)},R.mul=R.multiply,R.divide=function(E){if(n(E)||(E=l(E)),E.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&E.low===-1&&E.high===-1)return this;var K=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,E.low,E.high);return i(K,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?I:k;var X,rt,nt;if(this.unsigned){if(E.unsigned||(E=E.toUnsigned()),E.gt(this))return I;if(E.gt(this.shru(1)))return N;nt=I}else{if(this.eq(L)){if(E.eq(T)||E.eq($))return L;if(E.eq(L))return T;var st=this.shr(1);return X=st.div(E).shl(1),X.eq(k)?E.isNegative()?T:$:(rt=this.sub(E.mul(X)),nt=X.add(rt.div(E)),nt)}else if(E.eq(L))return this.unsigned?I:k;if(this.isNegative())return E.isNegative()?this.neg().div(E.neg()):this.neg().div(E).neg();if(E.isNegative())return this.div(E.neg()).neg();nt=k}for(rt=this;rt.gte(E);){X=Math.max(1,Math.floor(rt.toNumber()/E.toNumber()));for(var it=Math.ceil(Math.log(X)/Math.LN2),tt=it<=48?1:u(2,it-48),ut=o(X),ht=ut.mul(E);ht.isNegative()||ht.gt(rt);)X-=tt,ut=o(X,this.unsigned),ht=ut.mul(E);ut.isZero()&&(ut=T),nt=nt.add(ut),rt=rt.sub(ht)}return nt},R.div=R.divide,R.modulo=function(E){if(n(E)||(E=l(E)),e){var K=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,E.low,E.high);return i(K,e.get_high(),this.unsigned)}return this.sub(this.div(E).mul(E))},R.mod=R.modulo,R.rem=R.modulo,R.not=function(){return i(~this.low,~this.high,this.unsigned)},R.and=function(E){return n(E)||(E=l(E)),i(this.low&E.low,this.high&E.high,this.unsigned)},R.or=function(E){return n(E)||(E=l(E)),i(this.low|E.low,this.high|E.high,this.unsigned)},R.xor=function(E){return n(E)||(E=l(E)),i(this.low^E.low,this.high^E.high,this.unsigned)},R.shiftLeft=function(E){return n(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?i(this.low<<E,this.high<<E|this.low>>>32-E,this.unsigned):i(0,this.low<<E-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(E){return n(E)&&(E=E.toInt()),(E&=63)===0?this:E<32?i(this.low>>>E|this.high<<32-E,this.high>>E,this.unsigned):i(this.high>>E-32,this.high>=0?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(E){if(n(E)&&(E=E.toInt()),E&=63,E===0)return this;var K=this.high;if(E<32){var X=this.low;return i(X>>>E|K<<32-E,K>>>E,this.unsigned)}else return E===32?i(K,0,this.unsigned):i(K>>>E-32,0,this.unsigned)},R.shru=R.shiftRightUnsigned,R.shr_u=R.shiftRightUnsigned,R.toSigned=function(){return this.unsigned?i(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:i(this.low,this.high,!0)},R.toBytes=function(E){return E?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var E=this.high,K=this.low;return[K&255,K>>>8&255,K>>>16&255,K>>>24,E&255,E>>>8&255,E>>>16&255,E>>>24]},R.toBytesBE=function(){var E=this.high,K=this.low;return[E>>>24,E>>>16&255,E>>>8&255,E&255,K>>>24,K>>>16&255,K>>>8&255,K&255]},t.fromBytes=function(E,K,X){return X?t.fromBytesLE(E,K):t.fromBytesBE(E,K)},t.fromBytesLE=function(E,K){return new t(E[0]|E[1]<<8|E[2]<<16|E[3]<<24,E[4]|E[5]<<8|E[6]<<16|E[7]<<24,K)},t.fromBytesBE=function(E,K){return new t(E[4]<<24|E[5]<<16|E[6]<<8|E[7],E[0]<<24|E[1]<<16|E[2]<<8|E[3],K)},Ic}var Kg=gv();const Ug=pv(Kg),yv=Rw({__proto__:null,default:Ug},[Kg]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dr=Ug||yv;function bu(e){return Dr.fromString(e,!0,16)}const Gg=bu("c3a5c85c97cb3127"),$r=bu("b492b66fbe98f273"),un=bu("9ae16a3b2f90404f");function Xc(e){return e.xor(e.shru(47))}function Yg(e,t,n){const s=e.slice(t,t+n);return Dr.fromBytes(Array.from(s),!0,!0)}function we(e,t){return Yg(e,t,8)}function Cd(e,t){return Yg(e,t,4)}function Ke(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function ar(e,t,n=bu("9ddfea08eb382d69")){let s=e.xor(t).mul(n);s=s.xor(s.shru(47));let r=t.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function bv(e,t,n,s,r,a){r=r.add(e),a=Ke(a.add(r).add(s),21);const o=r;return r=r.add(t),r=r.add(n),a=a.add(Ke(r,44)),[r.add(s),a.add(o)]}function bi(e,t,n,s){return bv(we(e,t),we(e,t+8),we(e,t+16),we(e,t+24),n,s)}function wv(e,t=e.length){if(t>=8){const n=un.add(t*2),s=we(e,0).add(un),r=we(e,t-8),a=Ke(r,37).mul(n).add(s),o=Ke(s,25).add(r).mul(n);return ar(a,o,n)}if(t>=4){const n=un.add(t*2),s=Cd(e,0);return ar(s.shl(3).add(t),Cd(e,t-4),n)}if(t>0){const n=e[0],s=e[t>>1],r=e[t-1],a=n+(s<<8),o=t+(r<<2);return Xc(un.mul(a).xor(Gg.mul(o))).mul(un)}return un}function vv(e,t=e.length){const n=un.add(t*2),s=we(e,0).mul($r),r=we(e,8),a=we(e,t-8).mul(n),o=we(e,t-16).mul(un);return ar(Ke(s.add(r),43).add(Ke(a,30)).add(o),s.add(Ke(r.add(un),18)).add(a),n)}function kv(e,t=e.length){const n=un.add(t*2),s=we(e,0).mul(un),r=we(e,8),a=we(e,t-8).mul(n),o=we(e,t-16).mul(un),i=Ke(s.add(r),43).add(Ke(a,30)).add(o),u=ar(i,s.add(Ke(r.add(un),18)).add(a),n),c=we(e,16).mul(n),l=we(e,24),f=i.add(we(e,t-32)).mul(n),d=u.add(we(e,t-24)).mul(n);return ar(Ke(c.add(l),43).add(Ke(f,30)).add(d),c.add(Ke(l.add(s),18)).add(f),n)}function xv(e,t=e.length){const n=Dr.fromNumber(81,!0);if(t<=32)return t<=16?wv(e,t):vv(e,t);if(t<=64)return kv(e,t);let s=n,r=n.mul($r).add(113),a=Xc(r.mul(un).add(113)).mul(un),o=[Dr.UZERO,Dr.UZERO],i=[Dr.UZERO,Dr.UZERO];s=s.mul(un).add(we(e,0));let u=0;const c=(t-1>>6)*64,l=c+(t-1&63)-63;do s=Ke(s.add(r).add(o[0]).add(we(e,u+8)),37).mul($r),r=Ke(r.add(o[1]).add(we(e,u+48)),42).mul($r),s=s.xor(i[1]),r=r.add(o[0]).add(we(e,u+40)),a=Ke(a.add(i[0]),33).mul($r),o=bi(e,u,o[1].mul($r),s.add(i[0])),i=bi(e,u+32,a.add(i[1]),r.add(we(e,u+16))),[a,s]=[s,a],u+=64;while(u!==c);const f=$r.add(a.and(255).shl(1));return u=l,i[0]=i[0].add(t-1&63),o[0]=o[0].add(i[0]),i[0]=i[0].add(o[0]),s=Ke(s.add(r).add(o[0]).add(we(e,u+8)),37).mul(f),r=Ke(r.add(o[1]).add(we(e,u+48)),42).mul(f),s=s.xor(i[1].mul(9)),r=r.add(o[0].mul(9).add(we(e,u+40))),a=Ke(a.add(i[0]),33).mul(f),o=bi(e,u,o[1].mul(f),s.add(i[0])),i=bi(e,u+32,a.add(i[1]),r.add(we(e,u+16))),[a,s]=[s,a],ar(ar(o[0],i[0],f).add(Xc(r).mul(Gg)).add(a),ar(o[1],i[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jf(e,t){return t==="string"?Mr(e):Xr([e],t)}function Sv(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Xr(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=So(e)),ie().getBool("DEBUG")&&Ww(e,t),Sv(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let s=0;s<n.length;++s)Math.round(e[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${t}`)}function Na(){return ie().platform.now()}function Mr(e,t="utf-8"){return t=t||"utf-8",ie().platform.encode(e,t)}function xo(e,t="utf-8"){return t=t||"utf-8",ie().platform.decode(e,t)}function Gn(e){return ie().platform.isTypedArray!=null?ie().platform.isTypedArray(e):qg(e)}function So(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||zr(e)||e==null||Gn(e)&&n)t.push(e);else if(Array.isArray(e)||Gn(e))for(let s=0;s<e.length;++s)So(e[s],t,n);else{let s=-1;for(const r of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)So(e[r],t,n)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nv{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new _v)}profileKernel(t,n,s){let r;const a=()=>{r=s()};let o;const i=Na();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:Na()-i})}if(ie().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const l=r[c];l.data().then(f=>{Iv(f,l.dtype,t)})}return{kernelName:t,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:s,timeMs:r,inputs:a,extraInfo:o}=t;s.forEach(i=>{Promise.all([i.data(),r,o]).then(u=>{this.logger.logKernelProfile(n,i,u[0],u[1],a,u[2])})})}}function Iv(e,t,n){if(t!=="float32")return!1;for(let s=0;s<e.length;s++){const r=e[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class _v{logKernelProfile(t,n,s,r,a,o){const i=typeof r=="number"?Ii(`${r}ms`,9):r.error,u=Ii(t,25),c=n.rank,l=n.size,f=Ii(n.shape.toString(),14);let d="";for(const m in a){const g=a[m];if(g!=null){const w=g.shape||n.shape,b=w.length;d+=`${m}: ${b}D ${b>0?w:""} `}}console.log(`%c${u}	%c${i}	%c${c}D ${f}	%c${l}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tv(e,t,n){const s={},r={};for(let u=0;u<t.length;u++)s[t[u].id]=!0;for(let u=0;u<e.length;u++){const c=e[u],l=c.inputs;for(const f in l){const d=l[f];let m=!1;for(let g=0;g<t.length;g++)if(s[d.id]){c.outputs.forEach(w=>s[w.id]=!0),m=!0,r[c.id]=!0;break}if(m)break}}const a={};a[n.id]=!0;const o={};for(let u=e.length-1;u>=0;u--){const c=e[u],l=c.inputs;for(let f=0;f<c.outputs.length;f++)if(a[c.outputs[f].id]){for(const d in l)a[l[d].id]=!0,o[c.id]=!0;break}}const i=[];for(let u=0;u<e.length;u++){const c=e[u];if(r[c.id]&&o[c.id]){const l={};for(const d in c.inputs){const m=c.inputs[d];s[m.id]&&(l[d]=m)}const f=Object.assign({},c);f.inputs=l,f.outputs=c.outputs,i.push(f)}}return i}function Ev(e,t,n,s){for(let r=t.length-1;r>=0;r--){const a=t[r],o=[];if(a.outputs.forEach(u=>{const c=e[u.id];c!=null?o.push(c):o.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const i=a.gradient(o);for(const u in a.inputs){if(!(u in i))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(i)}.`);const c=n(()=>i[u]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${c.dtype}'`);const l=a.inputs[u];if(!Un(c.shape,l.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${u}' has shape '${c.shape}', which does not match the shape of the input '${l.shape}'`);if(e[l.id]==null)e[l.id]=c;else{const f=e[l.id];e[l.id]=s(f,c),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ad=20,Ja=3,_c=7;function $v(e,t,n,s){const r=Kt(t),a=Cv(e,t,n,r),o=t.length,i=Ti(e,t,n,r,a),u=["Tensor"];return s&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${o}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(i.map(c=>"    "+c).join(`
`)),u.join(`
`)}function Cv(e,t,n,s){const r=Nt(t),a=s[s.length-1],o=new Array(a).fill(0),i=t.length,u=n==="complex64"?ro(e):e;if(i>1)for(let c=0;c<r/a;c++){const l=c*a;for(let f=0;f<a;f++)o[f]=Math.max(o[f],so(u[l+f],0,n).length)}return o}function so(e,t,n){let s;return Array.isArray(e)?s=`${parseFloat(e[0].toFixed(_c))} + ${parseFloat(e[1].toFixed(_c))}j`:gu(e)?s=`'${e}'`:n==="bool"?s=Xg(e):s=parseFloat(e.toFixed(_c)).toString(),Ii(s,t)}function Xg(e){return e===0?"false":"true"}function Ti(e,t,n,s,r,a=!0){const o=n==="complex64"?2:1,i=t[0],u=t.length;if(u===0){if(n==="complex64"){const w=ro(e);return[so(w[0],0,n)]}return n==="bool"?[Xg(e[0])]:[e[0].toString()]}if(u===1){if(i>Ad){const b=Ja*o;let k=Array.from(e.slice(0,b)),I=Array.from(e.slice((i-Ja)*o,i*o));return n==="complex64"&&(k=ro(k),I=ro(I)),["["+k.map((T,N)=>so(T,r[N],n)).join(", ")+", ..., "+I.map((T,N)=>so(T,r[i-Ja+N],n)).join(", ")+"]"]}return["["+(n==="complex64"?ro(e):Array.from(e)).map((b,k)=>so(b,r[k],n)).join(", ")+"]"]}const c=t.slice(1),l=s.slice(1),f=s[0]*o,d=[];if(i>Ad){for(let w=0;w<Ja;w++){const b=w*f,k=b+f;d.push(...Ti(e.slice(b,k),c,n,l,r,!1))}d.push("...");for(let w=i-Ja;w<i;w++){const b=w*f,k=b+f;d.push(...Ti(e.slice(b,k),c,n,l,r,w===i-1))}}else for(let w=0;w<i;w++){const b=w*f,k=b+f;d.push(...Ti(e.slice(b,k),c,n,l,r,w===i-1))}const m=u===2?",":"";d[0]="["+(i>0?d[0]+m:"");for(let w=1;w<d.length-1;w++)d[w]=" "+d[w]+m;let g=`,
`;for(let w=2;w<u;w++)g+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(a?"":g),d}function ro(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class je{constructor(t,n,s){if(this.dtype=n,this.shape=t.slice(),this.size=Nt(t),s!=null){const r=s.length;A(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||ze(n,this.size),this.strides=Kt(t)}set(t,...n){n.length===0&&(n=[0]),A(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const r of t){if(r<0||r>=this.shape[n]){const a=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=this.strides[r]*t[r];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let s=0;s<t.length-1;++s)n+=this.strides[s]*t[s];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(t/this.strides[s]),t-=n[s]*this.strides[s];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return Yn().makeTensor(this.values,this.shape,this.dtype)}}let Yn=null,la=null;function Av(e){Yn=e}function Dv(e){la=e}class cn{constructor(t,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Nt(t),this.strides=Kt(t),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return la.buffer(this.shape,this.dtype,t)}bufferSync(){return la.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Hn(this.shape,t,this.dtype==="complex64")}arraySync(){return Hn(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=Yn().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(s=>xo(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Yn().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Yn().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>xo(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Yn().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Yn().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return la.print(this,t)}clone(){return this.throwIfDisposed(),la.clone(this)}toString(t=!1){const n=this.dataSync();return $v(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),la.cast(this,t)}variable(t=!0,n,s){return this.throwIfDisposed(),Yn().makeVariable(this,t,n,s)}}Object.defineProperty(cn,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function Zg(){return ql("Tensor",()=>cn)}Zg();class ji extends cn{constructor(t,n,s,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=n,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Un(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Yn().disposeTensor(this),this.dataId=t.dataId,Yn().incRef(this,null)}dispose(){Yn().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(ji,Symbol.hasInstance,{value:e=>e instanceof cn&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Dd;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(Dd||(Dd={}));var Zc;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(Zc||(Zc={}));var Jc;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(Jc||(Jc={}));var Qc;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(Qc||(Qc={}));var tl;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(tl||(tl={}));const Ov={float32:Qc,int32:Zc,bool:Jc,complex64:tl};function Va(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return Ov[e][t]}function Jg(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function Qg(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oe(e,t){if(e.dtype===t.dtype)return[e,t];const n=Va(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Fv(e,t){A(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function ty(e){const t=[];return ey(e,t,new Set),t}function ey(e,t,n){if(e==null)return;if(e instanceof cn){t.push(e);return}if(!Rv(e))return;const s=e;for(const r in s){const a=s[r];n.has(a)||(n.add(a),ey(a,t,n))}}function Rv(e){return Array.isArray(e)||typeof e=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tc(e){return e.kernelName!=null}class Od{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Ia{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Od}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,s=1){return t in this.registryFactory?(Ar(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(t);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Nv(this.backendInstance),!0}setupRegisteredKernels(){Ed(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Ed(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof Jp)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[t]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ar(`Initialization of backend ${t} failed`),Ar(o.stack||o.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return Ar(`Initialization of backend ${t} failed`),Ar(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const s=this.state.tensorInfo.get(n),r=s.backend,a=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=t,t.move(n,a,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let s=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,n,s){t();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Ia.nextTensorId++}nextVariableId(){return Ia.nextVariableId++}clone(t){const n=j.runKernel(gf,{x:t}),s={x:t},r=o=>({x:()=>{const i="float32",u={x:o},c={dtype:i};return j.runKernel(tf,u,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,a,{}),n}runKernel(t,n,s){if(this.backendName==null&&this.backend,!(Yc(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,s){const r=this.backend.numDataIds();let a=0;s.forEach(u=>{a+=u.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-n-a-o;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${t}'`)}runKernelFunc(t){let n,s=[];const r=this.isTapeOn(),a=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let i;this.backendName==null&&this.backend;let u;const c=Tc(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Tc(t)){const{kernelName:g,inputs:w,attrs:b}=t;this.backendName==null&&this.backend;const k=Yc(g,this.backendName);A(k!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),i=()=>{const I=this.backend.numDataIds();u=k.kernelFunc({inputs:w,attrs:b,backend:this.backend});const T=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,I,T);const N=T.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(r){const $=this.getTensorsForGradient(g,w,N);s=this.saveTensorsForBackwardMode($)}return N}}else{const{forwardFunc:g}=t,w=b=>{r&&(s=b.map(k=>this.keep(this.clone(k))))};i=()=>{const b=this.backend.numDataIds();u=this.tidy(()=>g(this.backend,w));const k=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,b,k),k}}const{inputs:l,attrs:f}=t,d=Tc(t)?null:t.backwardsFunc;let m;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=i():(m=this.profiler.profileKernel(c,l,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),n=m.outputs)}),r&&this.addTapeNode(c,l,n,d,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map(g=>l[g]!=null?l[g].shape:null),outputShapes:n.map(g=>g.shape),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(u)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,n,s){const r=Td(t);if(r!=null){const a=r.inputsToSave||[],o=r.outputsToSave||[];let i;r.saveAllInputs?(A(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(n).map(c=>n[c])):i=a.map(c=>n[c]);const u=s.filter((c,l)=>o[l]);return i.concat(u)}return[]}makeTensor(t,n,s,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=t;s==="string"&&gu(t[0])&&(a=t.map(u=>Mr(u)));const o=r.write(a,n,s),i=new cn(n,s,o,this.nextTensorId());if(this.trackTensor(i,r),s==="string"){const u=this.state.tensorInfo.get(o),c=qw(a);this.state.numBytes+=c-u.bytes,u.bytes=c}return i}makeTensorFromDataId(t,n,s,r){s=s||"float32";const a={dataId:t,shape:n,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(t,n){const{dataId:s,shape:r,dtype:a}=t,o=new cn(r,a,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(t,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.cast(r));const a=new ji(t,n,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*Hc(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof ji||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*Hc(t.dtype);this.state.numBytes-=s}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,s,r,a,o){const i={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:s,saved:a},u=Td(t);u!=null&&(r=u.gradFunc),r!=null&&(i.gradient=c=>(c=c.map((l,f)=>{if(l==null){const d=s[f],m=tn(d.size,d.dtype);return this.makeTensor(m,d.shape,d.dtype)}return l}),r(c.length>1?c:c[0],a,o))),this.state.activeTape.push(i)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=ty(t),s=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const o=this.state.activeScope.track[a];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(t,n,s,r=!1){if(A(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));A(a instanceof cn,()=>"The result y returned by f() must be a tensor.");const o=Tv(this.state.activeTape,n,a);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const i={};i[a.id]=s??Pv(a.shape),Ev(i,o,c=>this.tidy(c),Mv);const u=n.map(c=>i[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const l of c.saved)l.dispose()}),this.state.activeTape=null),{value:a,grads:u}})}customGrad(t){return A(qc(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{A(n.every(i=>i instanceof cn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((i,u)=>{r[u]=i});const a=(i,u)=>(s=t(...n,u),A(s.value instanceof cn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),A(qc(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(i,u)=>{const c=s.gradFunc(i,u),l=Array.isArray(c)?c:[c];A(l.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),A(l.every(d=>d instanceof cn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return l.forEach((d,m)=>{f[m]=()=>d}),f};return this.runKernelFunc({forwardFunc:a,backwardsFunc:o,inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=Na(),s=await this.backend.time(t);return s.wallMs=Na()-n,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Od;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ia.nextTensorId=0;Ia.nextVariableId=0;function Pv(e){const t=Hl(Nt(e),"float32");return j.makeTensor(t,e,"float32")}function ny(){const e=nm();if(e._tfengine==null){const t=new Yw(e);e._tfengine=new Ia(t)}return Qw(e._tfengine.ENV),Av(()=>e._tfengine),e._tfengine}const j=ny();function Mv(e,t){const n={a:e,b:t};return j.runKernel(yu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vv(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nn=ie();Nn.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Nn.registerFlag("IS_BROWSER",()=>Vv());Nn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Nn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Nn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Nn.registerFlag("PROD",()=>!1);Nn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Nn.getBool("DEBUG"));Nn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Nn.registerFlag("IS_TEST",()=>!1);Nn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Nn.getBool("DEBUG"));Nn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Nn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Nn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mr(e,t){let n=e;if(Gn(e))return t==="string"?[]:[e.length];if(Jg(e)){const r=e.channels||"RGBA";return[e.height,e.width*r.length]}else if(Qg(e))return[e.buffer.size/(t==null?4:Hc(t))];if(!Array.isArray(e))return[];const s=[];for(;Array.isArray(n)||Gn(n)&&t!=="string";)s.push(n.length),n=n[0];return Array.isArray(e)&&ie().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&sy(e,s,[]),s}function sy(e,t,n){if(n=n||[],!Array.isArray(e)&&!Gn(e)){A(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}A(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),A(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const s=t.slice(1);for(let r=0;r<e.length;++r)sy(e[r],s,n.concat(r))}function Fd(e,t,n,s){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${e} tensor, but got ${t} tensor`)}}function C(e,t,n,s="numeric"){if(e instanceof Zg())return Fd(s,e.dtype,t,n),e;let r=Lo(e);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),Fd(s,r,t,n),e==null||!Gn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const u=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${u}'`)}const a=mr(e,r);!Gn(e)&&!Array.isArray(e)&&(e=[e]);const i=r!=="string"?Xr(e,r):So(e,[],!0);return j.makeTensor(i,a,r)}function Hi(e,t,n,s="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((a,o)=>C(a,`${t}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ry="__op";function z(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const s=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+ry;const r=(...a)=>{j.startScope(n);try{const o=s(...a);return zr(o)&&console.error("Cannot return a Promise inside of tidy."),j.endScope(o),o}catch(o){throw j.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lv(e,t){const n=C(e,"real","complex"),s=C(t,"imag","complex");Mn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return j.runKernel(mm,r)}const lr=z({complex_:Lv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gr(e,t,n,s){if(s==null)s=Lo(e);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(Qg(e)||Jg(e)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return j.backend.createTensorFromGPUData(e,t||n,s)}if(!Gn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Vn(t);const r=Nt(t),a=Nt(n);A(r===a,()=>`Based on the provided shape, [${t}], the tensor should have ${r} values but has ${a}`);for(let o=0;o<n.length;++o){const i=n[o],u=o===n.length-1?i!==Nt(t.slice(o)):!0;A(n[o]===t[o]||!u,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Gn(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=s!=="string"?Xr(e,s):So(e,[],!0),j.makeTensor(e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(e,t,n){const s=mr(e,n);return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Br={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Jn{static join(t){return new Jn(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(s=>Gn(s)?s.buffer:s),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let s=0;s<t.length;s++){const r=t[s];s!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=n+r.byteLength;this.shards.push({buffer:r,start:n,end:a}),n=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const s=this.findShardForByte(t);if(s===-1)throw new Error(`Could not find start shard for byte ${t}`);const r=n-t,a=new ArrayBuffer(r),o=new Uint8Array(a);let i=0;for(let u=s;u<this.shards.length;u++){const c=this.shards[u],f=t+i-c.start,d=i,g=Math.min(n,c.end)-c.start,w=new Uint8Array(c.buffer,f,g-f);if(o.set(w,d),i+=w.length,n<c.end)break}return a}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(r){return t<r.start?-1:t>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=zv(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function zv(e,t){let n=0,s=e.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,a=t(e[r]);if(a===0)return r;a<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rd(){return j}function de(e,t){return j.tidy(e,t)}function Sn(e){ty(e).forEach(n=>n.dispose())}function ls(e){return j.keep(e)}function Pd(e){return j.setBackend(e)}function Bv(){return j.ready()}function Wv(){return j.backendName}function jv(e,t,n=1){return j.registerBackend(e,t,n)}function Hv(){return j.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fr=4;async function qv(e,t){const n=[],s=[],r=Array.isArray(e)?e.map(o=>o.name):Object.keys(e);for(let o=0;o<r.length;++o){const i=r[o],u=Array.isArray(e)?e[o].tensor:e[i];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${i}': ${u.dtype}`);const c={name:i,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const l=new Promise(async f=>{const d=await u.bytes(),m=d.reduce((b,k)=>b+k.length,0)+fr*d.length,g=new Uint8Array(m);let w=0;for(let b=0;b<d.length;b++){const k=d[b],I=new Uint8Array(new Uint32Array([k.length]).buffer);g.set(I,w),w+=fr,g.set(k,w),w+=k.length}f(g)});s.push(l)}else s.push(u.data());t!=null&&(c.group=t),n.push(c)}const a=await Promise.all(s);return{data:Gv(a),specs:n}}function ay(e,t){const n=new Jn(e),s={};let r=0;for(const a of t){const o=Kv(a,(i,u)=>n.slice(r+i,r+u));s[a.name]=oy(a,n.slice(r,r+o)),r+=o}return s}function Kv(e,t){const n=Nt(e.shape);let s;if("quantization"in e){const r=e.quantization;s=Br[r.dtype]}else if(e.dtype==="string"){let r=0;for(let a=0;a<n;a++)r+=fr+new Uint32Array(t(r,r+fr))[0];return r}else s=Br[e.dtype];return n*s}async function Uv(e,t){const n=Nt(e.shape);let s;if("quantization"in e){const r=e.quantization;s=Br[r.dtype]}else if(e.dtype==="string"){let r=0;for(let a=0;a<n;a++)r+=fr+new Uint32Array(await t(r,r+fr))[0];return r}else s=Br[e.dtype];return n*s}function oy(e,t){const n=e.name,s=e.dtype,r=e.shape,a=Nt(r);let o,i=0;if("quantization"in e){const u=e.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${e.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${e.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Br[u.dtype],l=u.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(s==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){o=new Float32Array(l.length);for(let f=0;f<l.length;f++){const d=l[f];o[f]=d*u.scale+u.min}}else if(u.dtype==="float16")o=e1()(l);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(s==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);o=new Int32Array(l.length);for(let f=0;f<l.length;f++){const d=l[f];o[f]=Math.round(d*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);i+=a*c}else if(s==="string"){const u=Nt(e.shape);o=[];for(let c=0;c<u;c++){const l=new Uint32Array(t.slice(i,i+fr))[0];i+=fr;const f=new Uint8Array(t.slice(i,i+l));o.push(f),i+=l}}else{const u=Br[s];if(s==="float32")o=new Float32Array(t);else if(s==="int32")o=new Int32Array(t);else if(s==="bool")o=new Uint8Array(t);else if(s==="complex64"){o=new Float32Array(t);const c=new Float32Array(o.length/2),l=new Float32Array(o.length/2);for(let g=0;g<c.length;g++)c[g]=o[g*2],l[g]=o[g*2+1];const f=hs(c,r,"float32"),d=hs(l,r,"float32"),m=lr(f,d);return f.dispose(),d.dispose(),m}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);i+=a*u}return hs(o,r,s)}async function Md(e,t,n){let s=new Uint8Array(t);for(;s.byteLength<n;){const{done:r,value:a}=await e.read();if(r&&a==null){const i=n-s.byteLength;throw new Error(`Reader is done but ${i} bytes are still expected`)}const o=new Uint8Array(s.length+a.byteLength);o.set(s,0),o.set(new Uint8Array(a),s.length),s=o}return s.buffer}async function iy(e,t){const n={},s=e.getReader();let r=new ArrayBuffer(0);for(const a of t){const o=await Uv(a,async(c,l)=>(r=await Md(s,r,l),r.slice(c,l)));r=await Md(s,r,o);const i=r.slice(0,o);r=r.slice(o);const u=oy(a,i);if(n[a.name]=u,Wv()==="webgpu"){const c=Hv();"uploadToGPU"in c&&Nt(u.shape)>=ie().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(u.dataId)}}return n}function Gv(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(a=>{if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(t);let r=0;return n.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const Qf=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Vd(e){return Qf?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function Yv(e){if(Qf)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let s=0,r=t.length;s<r;s++)n+=String.fromCharCode(t[s]);return btoa(n)}function Xv(e){if(Qf){const s=Buffer.from(e,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<t.length;++s)n.set([t.charCodeAt(s)],s);return n.buffer}function Zv(e){return Jn.join(e)}function Ld(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const n=e.split("/");return n[n.length-1]}function uy(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function cy(e,t,n){const s={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(s.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=t,s.weightData=n}return e.signature!=null&&(s.signature=e.signature),e.userDefinedMetadata!=null&&(s.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(s.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(s.initializerSignature=e.initializerSignature),s}async function th(e,t){let n,s;return e.weightsManifest!=null&&([n,s]=await t(e.weightsManifest)),cy(e,n,s)}function zo(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:Vd(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:Vd(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new Jn(e.weightData).byteLength}}function el(e){const t=[];for(const n of e)t.push(...n.weights);return t}function Jv(){const e=n=>{let s=n<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function Qv(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function t1(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function e1(){const e=Jv(),t=Qv(),n=t1();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let o=0;o<s.length;o++){const i=s[o],u=e[n[i>>10]+(i&1023)]+t[i>>10];a[o]=u}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ae{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Ae.instance==null&&(Ae.instance=new Ae),Ae.instance}static registerSaveRouter(t){Ae.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Ae.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Ae.getHandlers(t,"save")}static getLoadHandlers(t,n){return Ae.getHandlers(t,"load",n)}static getHandlers(t,n,s){const r=[];return(n==="load"?Ae.getInstance().loadRouters:Ae.getInstance().saveRouters).forEach(o=>{const i=o(t,s);i!==null&&r.push(i)}),r}}const n1=e=>Ae.registerSaveRouter(e),s1=e=>Ae.registerLoadRouter(e),r1=e=>Ae.getSaveHandlers(e),a1=(e,t)=>Ae.getLoadHandlers(e,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nl="tensorflowjs",sl=1,Rr="models_store",rr="model_info_store";function ly(){if(!ie().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function rl(e){const t=e.result;t.createObjectStore(Rr,{keyPath:"modelPath"}),t.createObjectStore(rr,{keyPath:"modelPath"})}class Wr{constructor(t){if(this.indexedDB=ly(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((s,r)=>{const a=this.indexedDB.open(nl,sl);a.onupgradeneeded=()=>rl(a),a.onsuccess=()=>{const o=a.result;if(n==null){const i=o.transaction(Rr,"readonly"),c=i.objectStore(Rr).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=l=>(o.close(),r(c.error)),i.oncomplete=()=>o.close()}else{n.weightData=Jn.join(n.weightData);const i=zo(n),u=o.transaction(rr,"readwrite");let c=u.objectStore(rr),l;try{l=c.put({modelPath:this.modelPath,modelArtifactsInfo:i})}catch(d){return r(d)}let f;l.onsuccess=()=>{f=o.transaction(Rr,"readwrite");const d=f.objectStore(Rr);let m;try{m=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:i})}catch(g){return r(g)}m.onsuccess=()=>s({modelArtifactsInfo:i}),m.onerror=g=>{c=u.objectStore(rr);const w=c.delete(this.modelPath);w.onsuccess=()=>(o.close(),r(m.error)),w.onerror=b=>(o.close(),r(m.error))}},l.onerror=d=>(o.close(),r(l.error)),u.oncomplete=()=>{f==null?o.close():f.oncomplete=()=>o.close()}}},a.onerror=o=>r(a.error)})}}Wr.URL_SCHEME="indexeddb://";const fy=e=>ie().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Wr.URL_SCHEME)?o1(e.slice(Wr.URL_SCHEME.length)):null;Ae.registerSaveRouter(fy);Ae.registerLoadRouter(fy);function o1(e){return new Wr(e)}function i1(e){return e.startsWith(Wr.URL_SCHEME)?e.slice(Wr.URL_SCHEME.length):e}class u1{constructor(){this.indexedDB=ly()}async listModels(){return new Promise((t,n)=>{const s=this.indexedDB.open(nl,sl);s.onupgradeneeded=()=>rl(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(rr,"readonly"),i=a.objectStore(rr).getAll();i.onsuccess=()=>{const u={};for(const c of i.result)u[c.modelPath]=c.modelArtifactsInfo;t(u)},i.onerror=u=>(r.close(),n(i.error)),a.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(t){return t=i1(t),new Promise((n,s)=>{const r=this.indexedDB.open(nl,sl);r.onupgradeneeded=()=>rl(r),r.onsuccess=()=>{const a=r.result,o=a.transaction(rr,"readwrite"),i=o.objectStore(rr),u=i.get(t);let c;u.onsuccess=()=>{if(u.result==null)return a.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const l=i.delete(t),f=()=>{c=a.transaction(Rr,"readwrite");const m=c.objectStore(Rr).delete(t);m.onsuccess=()=>n(u.result.modelArtifactsInfo),m.onerror=g=>s(u.error)};l.onsuccess=f,l.onerror=d=>(f(),a.close(),s(u.error))}},u.onerror=l=>(a.close(),s(u.error)),o.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cs="/",fa="tensorflowjs_models",hy="info",c1="model_topology",l1="weight_specs",f1="weight_data",h1="model_metadata";function dy(e){return{info:[fa,e,hy].join(Cs),topology:[fa,e,c1].join(Cs),weightSpecs:[fa,e,l1].join(Cs),weightData:[fa,e,f1].join(Cs),modelMetadata:[fa,e,h1].join(Cs)}}function py(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function d1(e){const t=e.split(Cs);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Cs)}function p1(e){return e.startsWith(jr.URL_SCHEME)?e.slice(jr.URL_SCHEME.length):e}class jr{constructor(t){if(!ie().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=dy(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),r=zo(t),a=Jn.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,Yv(a));const o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw py(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const i=JSON.parse(a);n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,i.signature!=null&&(n.signature=i.signature),i.userDefinedMetadata!=null&&(n.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(n.modelInitializer=i.modelInitializer),i.initializerSignature!=null&&(n.initializerSignature=i.initializerSignature),i.trainingConfig!=null&&(n.trainingConfig=i.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Xv(o),n}}jr.URL_SCHEME="localstorage://";const my=e=>ie().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(jr.URL_SCHEME)?m1(e.slice(jr.URL_SCHEME.length)):null;Ae.registerSaveRouter(my);Ae.registerLoadRouter(my);function m1(e){return new jr(e)}class g1{constructor(){A(ie().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),A(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=fa+Cs,s=Cs+hy;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(n)&&a.endsWith(s)){const o=d1(a);t[o]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){t=p1(t);const n=dy(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(n.info));return py(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ma="://";class on{constructor(){this.managers={}}static getInstance(){return on.instance==null&&(on.instance=new on),on.instance}static registerManager(t,n){A(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(ma)&&(t=t.slice(0,t.indexOf(ma))),A(t.length>0,()=>"scheme must not be an empty string.");const s=on.getInstance();A(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=n}static getManager(t){const n=on.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(on.getInstance().managers)}}function Ei(e){if(e.indexOf(ma)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${on.getSchemes().join(",")}`);return{scheme:e.split(ma)[0],path:e.split(ma)[1]}}async function gy(e,t,n=!1){A(e!==t,()=>`Old path and new path are the same: '${e}'`);const s=Ae.getLoadHandlers(e);A(s.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),A(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${e}.`);const r=s[0],a=Ae.getSaveHandlers(t);A(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),A(a.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${t}.`);const o=a[0],i=Ei(e).scheme,u=Ei(e).path,c=i===Ei(e).scheme,l=await r.load();n&&c&&await on.getManager(i).removeModel(u);const f=await o.save(l);return n&&!c&&await on.getManager(i).removeModel(u),f.modelArtifactsInfo}async function y1(){const e=on.getSchemes(),t={};for(const n of e){const s=await on.getManager(n).listModels();for(const r in s){const a=n+ma+r;t[a]=s[r]}}return t}async function b1(e){const t=Ei(e);return on.getManager(t.scheme).removeModel(t.path)}async function w1(e,t){return gy(e,t,!1)}async function v1(e,t){return gy(e,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k1{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!ie().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return qg(t)}}if(ie().get("IS_BROWSER")){ie().setPlatform("browser",new k1);try{on.registerManager(jr.URL_SCHEME,new g1)}catch{}try{on.registerManager(Wr.URL_SCHEME,new u1)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x1={importFetch:()=>require("node-fetch")};let Ec;class S1{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return ie().global.fetch!=null?ie().global.fetch(t,n):(Ec==null&&(Ec=x1.importFetch()),Ec(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}ie().get("IS_NODE")&&!ie().get("IS_BROWSER")&&ie().setPlatform("node",new S1);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ce(e,t="float32",n){return t=t||"float32",Vn(e),new je(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N1(e,t){const n=C(e,"x","cast");if(!jw(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:t};return j.runKernel(tf,s,r)}const Pe=z({cast_:N1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1(e){const n={x:C(e,"x","clone","string_or_numeric")};return j.runKernel(gf,n)}const or=z({clone_:I1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ny();const _1={buffer:ce,cast:Pe,clone:or,print:yy};Dv(_1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1(e,t){let n=C(e,"a","add"),s=C(t,"b","add");[n,s]=Oe(n,s);const r={a:n,b:s};return j.runKernel(yu,r)}const Zt=z({add_:T1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1(e,t){let n=C(e,"a","floorDiv"),s=C(t,"b","floorDiv");[n,s]=Oe(n,s);const r={a:n,b:s};return j.runKernel(df,r)}const by=z({floorDiv_:E1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1(e,t){let n=C(e,"a","div"),s=C(t,"b","div");if([n,s]=Oe(n,s),n.dtype==="int32"&&s.dtype==="int32")return by(n,s);const r={a:n,b:s},a={};return j.runKernel(af,r,a)}const xe=z({div_:$1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1(e,t){let n=C(e,"a","mul"),s=C(t,"b","mul");[n,s]=Oe(n,s);const r={a:n,b:s};return j.runKernel(Cf,r)}const Pt=z({mul_:C1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1(e){const t=C(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return j.runKernel(gm,n)}else{const n={x:t};return j.runKernel(sm,n)}}const Fn=z({abs_:A1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1(e){const n={x:C(e,"x","acos")};return j.runKernel(Kl,n)}const O1=z({acos_:D1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1(e){const n={x:C(e,"x","acosh")};return j.runKernel(Ul,n)}const R1=z({acosh_:F1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1(e){A(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),A(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((r,a)=>C(r,`tensors${a}`,"addN")),n=t[0];t.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(r=>{if(!Un(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=t;return j.runKernel(rm,s)}const M1=z({addN_:P1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1(e,t=null,n=!1){const r={x:C(e,"x","all","bool")},a={axis:t,keepDims:n};return j.runKernel(am,r,a)}const L1=z({all_:V1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1(e,t=null,n=!1){const r={x:C(e,"x","any","bool")},a={axis:t,keepDims:n};return j.runKernel(om,r,a)}const B1=z({any_:z1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1(e,t=0){const s={x:C(e,"x","argMax")},r={axis:t};return j.runKernel(im,s,r)}const j1=z({argMax_:W1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1(e,t=0){const s={x:C(e,"x","argMin")},r={axis:t};return j.runKernel(um,s,r)}const q1=z({argMin_:H1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1(e){const n={x:C(e,"x","asin")};return j.runKernel(Gl,n)}const U1=z({asin_:K1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1(e){const n={x:C(e,"x","asinh")};return j.runKernel(Yl,n)}const Y1=z({asinh_:G1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1(e){const n={x:C(e,"x","atan")};return j.runKernel(Xl,n)}const Z1=z({atan_:X1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J1(e,t){let n=C(e,"a","atan2"),s=C(t,"b","atan2");[n,s]=Oe(n,s);const r={a:n,b:s};return j.runKernel(Jl,r)}const Q1=z({atan2_:J1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tk(e){const n={x:C(e,"x","atanh")};return j.runKernel(Zl,n)}const ek=z({atanh_:tk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eh(e,t,n,s,r="NHWC",a){const o=e[3],i=[...t,o],u=ku(r);return vs(e,i,n,a,s,null,null,u)}function La(e,t,n,s,r,a,o="channelsLast"){const[i,u]=No(t);let c;if(o==="channelsLast")c=[i,u,e[3],e[3]];else if(o==="channelsFirst")c=[i,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return vs(e,c,n,s,r,a,!1,o)}function wu(e,t,n,s,r,a,o="NDHWC"){const[i,u,c]=al(t);let l,f;if(o==="NDHWC")f="channelsLast",l=[i,u,c,e[4],e[4]];else if(o==="NCDHW")f="channelsFirst",l=[i,u,c,e[1],e[1]];else throw new Error(`Unknown dataFormat ${o}`);return vu(e,l,n,s,r,!1,f,a)}function vs(e,t,n,s,r,a,o=!1,i="channelsLast"){let[u,c,l,f]=[-1,-1,-1,-1];if(i==="channelsLast")[u,c,l,f]=e;else if(i==="channelsFirst")[u,f,c,l]=e;else throw new Error(`Unknown dataFormat ${i}`);const[d,m,,g]=t,[w,b]=No(n),[k,I]=No(s),T=ga(d,k),N=ga(m,I),{padInfo:$,outHeight:D,outWidth:P}=rk(r,c,l,w,b,T,N,a,i),L=o?g*f:g;let R;return i==="channelsFirst"?R=[u,L,D,P]:i==="channelsLast"&&(R=[u,D,P,L]),{batchSize:u,dataFormat:i,inHeight:c,inWidth:l,inChannels:f,outHeight:D,outWidth:P,outChannels:L,padInfo:$,strideHeight:w,strideWidth:b,filterHeight:d,filterWidth:m,effectiveFilterHeight:T,effectiveFilterWidth:N,dilationHeight:k,dilationWidth:I,inShape:e,outShape:R,filterShape:t}}function vu(e,t,n,s,r,a=!1,o="channelsLast",i){let[u,c,l,f,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[u,c,l,f,d]=e;else if(o==="channelsFirst")[u,d,c,l,f]=e;else throw new Error(`Unknown dataFormat ${o}`);const[m,g,w,,b]=t,[k,I,T]=al(n),[N,$,D]=al(s),P=ga(m,N),L=ga(g,$),R=ga(w,D),{padInfo:M,outDepth:E,outHeight:K,outWidth:X}=ak(r,c,l,f,k,I,T,P,L,R,i),rt=a?b*d:b;let nt;return o==="channelsFirst"?nt=[u,rt,E,K,X]:o==="channelsLast"&&(nt=[u,E,K,X,rt]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:f,inChannels:d,outDepth:E,outHeight:K,outWidth:X,outChannels:rt,padInfo:M,strideDepth:k,strideHeight:I,strideWidth:T,filterDepth:m,filterHeight:g,filterWidth:w,effectiveFilterDepth:P,effectiveFilterHeight:L,effectiveFilterWidth:R,dilationDepth:N,dilationHeight:$,dilationWidth:D,inShape:e,outShape:nt,filterShape:t}}function nk(e,t,n,s,r){s==null&&(s=wy(e,t,n));const a=e[0],o=e[1],i=Io((a-t+2*s)/n+1,r),u=Io((o-t+2*s)/n+1,r);return[i,u]}function sk(e,t,n,s,r,a){r==null&&(r=wy(e,t[0],s[0]));const o=[0,0,0,n];for(let i=0;i<3;i++)e[i]+2*r>=t[i]&&(o[i]=Io((e[i]-t[i]+2*r)/s[i]+1,a));return o}function wy(e,t,n,s=1){const r=ga(t,s);return Math.floor((e[0]*(n-1)-n+r)/2)}function No(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function al(e){return typeof e=="number"?[e,e,e]:e}function ga(e,t){return t<=1?e:e+(e-1)*(t-1)}function rk(e,t,n,s,r,a,o,i,u){let c,l,f;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const m=nk([t,n],a,s,e,i);l=m[0],f=m[1]}else if(e==="same"){l=Math.ceil(t/s),f=Math.ceil(n/r);const d=Math.max(0,(l-1)*s+a-t),m=Math.max(0,(f-1)*r+o-n),g=Math.floor(d/2),w=d-g,b=Math.floor(m/2),k=m-b;c={top:g,bottom:w,left:b,right:k,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-a+1)/s),f=Math.ceil((n-o+1)/r);else if(typeof e=="object"){const d=u==="channelsLast"?e[1][0]:e[2][0],m=u==="channelsLast"?e[1][1]:e[2][1],g=u==="channelsLast"?e[2][0]:e[3][0],w=u==="channelsLast"?e[2][1]:e[3][1];c={top:d,bottom:m,left:g,right:w,type:d===0&&m===0&&g===0&&w===0?"VALID":"EXPLICIT"},l=Io((t-a+d+m)/s+1,i),f=Io((n-o+g+w)/r+1,i)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:l,outWidth:f}}function ak(e,t,n,s,r,a,o,i,u,c,l){let f,d,m,g;if(e==="valid"&&(e=0),typeof e=="number"){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const b=sk([t,n,s,1],[i,u,c],1,[r,a,o],e,l);d=b[0],m=b[1],g=b[2]}else if(e==="same"){d=Math.ceil(t/r),m=Math.ceil(n/a),g=Math.ceil(s/o);const w=(d-1)*r+i-t,b=(m-1)*a+u-n,k=(g-1)*o+c-s,I=Math.floor(w/2),T=w-I,N=Math.floor(b/2),$=b-N,D=Math.floor(k/2),P=k-D;f={top:N,bottom:$,left:D,right:P,front:I,back:T,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:f,outDepth:d,outHeight:m,outWidth:g}}function Io(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function qi(e){const[t,n,s]=No(e);return t===1&&n===1&&s===1}function Qn(e,t){return qi(e)||qi(t)}function _a(e){return No(e).every(t=>t>0)}function ku(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function ts(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")A(ko(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(s=>{s.forEach(r=>{A(ko(r),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ok(e,t){const s={x:C(e,"x","reshape","string_or_numeric")},r={shape:t};return j.runKernel(mg,s,r)}const pt=z({reshape_:ok});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ik(e,t,n,s,r){const a=C(e,"x","avgPool","float32"),o=1;A(Qn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let i=a,u=!1;a.rank===3&&(u=!0,i=pt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(i.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`),ts("avgPool",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r};let f=j.runKernel(cm,c,l);return f=Pe(f,a.dtype),u?pt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const vy=z({avgPool_:ik});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uk(e,t,n,s,r,a="NDHWC"){const o=C(e,"x","avgPool3d","float32");let i=o,u=!1;o.rank===4&&(u=!0,i=pt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),A(i.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`),A(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),A(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),ts("avgPool3d",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:a};let f=j.runKernel(lm,c,l);return f=Pe(f,i.dtype),u?pt(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const ck=z({avgPool3d_:uk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lk(e,t=0){A(e.length>=1,()=>"Pass at least one tensor to concat");const n=Hi(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return or(n[0]);const s=n,r={axis:t};return j.runKernel(ym,s,r)}const hn=z({concat_:lk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fk(e,t,n=!1,s=!1){let r=C(e,"a","matMul"),a=C(t,"b","matMul");[r,a]=Oe(r,a);const o={a:r,b:a},i={transposeA:n,transposeB:s};return j.runKernel(fm,o,i)}const be=z({matMul_:fk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hk(e){const n={x:C(e,"x","sigmoid","float32")};return j.runKernel(Wf,n)}const ya=z({sigmoid_:hk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dk(e,t,n){const s=C(e,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:t,size:n};return j.runKernel(Sg,r,a)}const ve=z({slice_:dk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pk(e){const n={x:C(e,"x","tanh","float32")};return j.runKernel(Yf,n)}const ol=z({tanh_:pk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mk(e,t,n,s,r,a){const o=C(e,"forgetBias","basicLSTMCell"),i=C(t,"lstmKernel","basicLSTMCell"),u=C(n,"lstmBias","basicLSTMCell"),c=C(s,"data","basicLSTMCell"),l=C(r,"c","basicLSTMCell"),f=C(a,"h","basicLSTMCell"),d=hn([c,f],1),m=be(d,i),g=Zt(m,u),w=g.shape[0],b=g.shape[1]/4,k=[w,b],I=ve(g,[0,0],k),T=ve(g,[0,b],k),N=ve(g,[0,b*2],k),$=ve(g,[0,b*3],k),D=Zt(Pt(ya(I),ol(T)),Pt(l,ya(Zt(o,N)))),P=Pt(ol(D),ya($));return[D,P]}const gk=z({basicLSTMCell_:mk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yk(e,t,n){const s=C(e,"x","batchToSpaceND"),r=t.reduce((i,u)=>i*u);A(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),A(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),A(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${r}`);const a={x:s},o={blockShape:t,crops:n};return j.runKernel(hm,a,o)}const ky=z({batchToSpaceND_:yk});function bk(e){let t;return e.rank===0||e.rank===1?t=pt(e,[1,1,1,e.size]):e.rank===2?t=pt(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=pt(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wk(e,t,n,s,r,a){a==null&&(a=.001);const o=C(e,"x","batchNorm"),i=C(t,"mean","batchNorm"),u=C(n,"variance","batchNorm");let c;r!=null&&(c=C(r,"scale","batchNorm"));let l;s!=null&&(l=C(s,"offset","batchNorm")),A(i.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(l==null||i.rank===l.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(c==null||i.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:bk(o),scale:c,offset:l,mean:i,variance:u},m={varianceEpsilon:a},g=j.runKernel(Vm,d,m);return pt(g,o.shape)}const xu=z({batchNorm_:wk});function vk(e,t,n,s,r,a){const o=C(e,"x","batchNorm"),i=C(t,"mean","batchNorm"),u=C(n,"variance","batchNorm");let c;r!=null&&(c=C(r,"scale","batchNorm"));let l;return s!=null&&(l=C(s,"offset","batchNorm")),A(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),A(i.rank===2||i.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`),A(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&A(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${l.rank}.`),xu(o,i,u,l,c,a)}const kk=z({batchNorm2d_:vk});function xk(e,t,n,s,r,a){const o=C(e,"x","batchNorm"),i=C(t,"mean","batchNorm"),u=C(n,"variance","batchNorm");let c;r!=null&&(c=C(r,"scale","batchNorm"));let l;return s!=null&&(l=C(s,"offset","batchNorm")),A(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),A(i.rank===3||i.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`),A(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&A(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${l.rank}.`),xu(o,i,u,l,c,a)}const Sk=z({batchNorm3d_:xk});function Nk(e,t,n,s,r,a){const o=C(e,"x","batchNorm"),i=C(t,"mean","batchNorm"),u=C(n,"variance","batchNorm");let c;r!=null&&(c=C(r,"scale","batchNorm"));let l;return s!=null&&(l=C(s,"offset","batchNorm")),A(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),A(i.rank===4||i.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`),A(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&A(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&A(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${l.rank}.`),xu(o,i,u,l,c,a)}const Ik=z({batchNorm4d_:Nk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _k(e,t,n){const s=C(e,"x","bincount"),r=C(t,"weights","bincount");A(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},o={size:n};return j.runKernel(dm,a,o)}const xy=z({bincount_:_k});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tk(e,t){const n=C(e,"x","bitwiseAnd"),s=C(t,"y","bitwiseAnd");if(!Un(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return j.runKernel(Ql,r)}const Ek=z({bitwiseAnd_:Tk});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $k(e,t){const n=C(e,"s0","broadcastArgs","int32"),s=C(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return j.runKernel(pm,r)}const Ck=z({broadcastArgs_:$k});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ak(e,t){let n=C(e,"broadcastTo","x");const s=n.shape;if(Vn(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const c=n.shape.slice();for(;c.length<t.length;)c.unshift(1);n=pt(n,c)}const r=n.shape,a=Array.from(t);for(let c=t.length-1;c>=0;c--)if(r[c]===t[c])a[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(a.map((c,l)=>c>1?l:-1).filter(c=>c>=0).length===0)return or(n);const i={x:n},u={reps:a};return j.runKernel(Xf,i,u)}const uo=z({broadcastTo_:Ak});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dk(e){const n={x:C(e,"x","ceil","float32")};return j.runKernel(ef,n)}const Ok=z({ceil_:Dk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bo(e,t,n){Vn(e),n=n||Lo(t);const s={shape:e,value:t,dtype:n};return j.runKernel(Pm,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fk(e,t,n){const s=C(e,"x","clipByValue");if(A(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return Bo(s.shape,t,s.dtype);const r={x:s},a={clipValueMin:t,clipValueMax:n};return j.runKernel(nf,r,a)}const Rk=z({clipByValue_:Fk});function Pk(e){return hn(e,0)}const Mk=z({concat1d_:Pk});function Vk(e,t){return hn(e,t)}const Lk=z({concat2d_:Vk});function zk(e,t){return hn(e,t)}const Bk=z({concat3d_:zk});function Wk(e,t){return hn(e,t)}const jk=z({concat4d_:Wk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hk(e,t,n,s,r="NHWC",a=[1,1],o){const i=C(e,"x","conv2d","float32"),u=C(t,"filter","conv2d","float32");let c=i,l=!1;i.rank===3&&(l=!0,c=pt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),A(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),A(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),ts("conv2d",s,o);const f=r==="NHWC"?c.shape[3]:c.shape[1];A(f===u.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${u.shape[2]}.`),A(Qn(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),A(_a(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),A(_a(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:u},m={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o},g=j.runKernel(bm,d,m);return l?pt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Su=z({conv2d_:Hk});function qk(e,t,n,s,r="NWC",a=1,o){const i=C(e,"x","conv1d"),u=C(t,"filter","conv1d");let c=i,l=!1;i.rank===2&&(l=!0,c=pt(i,[1,i.shape[0],i.shape[1]])),A(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),A(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),ts("conv1d",s,o),A(c.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${u.shape[1]}.`),A(Qn(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),A(_a(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),A(_a(n),()=>"Error in conv1D: Stride should be larger than 0."),A(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const f=pt(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=pt(c,[c.shape[0],1,c.shape[1],c.shape[2]]),b=Su(d,f,[1,n],s,"NHWC",[1,a],o);return l?pt(b,[b.shape[2],b.shape[3]]):pt(b,[b.shape[0],b.shape[2],b.shape[3]])}const Kk=z({conv1d_:qk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uk(e,t,n,s,r,a="NHWC",o){A(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let i=e,u=t,c=!1;t.rank===3&&(c=!0,u=pt(t,[1,t.shape[0],t.shape[1],t.shape[2]]),i=[1,e[0],e[1],e[2]]),A(i.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`),A(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),A(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const l=a==="NHWC"?i[3]:i[1],f=a==="NHWC"?u.shape[3]:u.shape[1];A(l===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[2]}.`),A(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),ts("conv2dDerInput",r,o);const d={dy:u,filter:n},m={strides:s,pad:r,dataFormat:a,dimRoundingMode:o,inputShape:i},g=j.runKernel(vm,d,m);return c?pt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Sy=z({conv2DBackpropInput_:Uk});function Gk(e,t,n,s,r,a){const o=C(e,"x","conv2dTranspose"),i=C(t,"filter","conv2dTranspose");return Sy(n,o,i,s,r,"NHWC",a)}const Yk=z({conv2dTranspose_:Gk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xk(e,t,n,s,r="NDHWC",a=[1,1,1]){const o=C(e,"x","conv3d"),i=C(t,"filter","conv3d");let u=o,c=!1;o.rank===4&&(c=!0,u=pt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),A(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),A(i.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`),A(u.shape[4]===i.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${i.shape[3]}.`),A(Qn(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),A(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),A(_a(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),A(_a(n),()=>"Error in conv3D: Strides should be larger than 0.");const l={x:u,filter:i},f={strides:n,pad:s,dataFormat:r,dilations:a},d=j.runKernel(km,l,f);return c?pt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Zk=z({conv3d_:Xk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jk(e,t,n,s,r){A(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,o=t,i=!1;t.rank===4&&(i=!0,o=pt(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,e[0],e[1],e[2],e[3]]);const u=a[4],c=o.shape[4];A(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),A(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),A(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),A(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),A(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const l={dy:o,filter:n},f={pad:r,strides:s,inputShape:a},d=j.runKernel(xm,l,f);return i?pt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Qk=z({conv3DBackpropInput_:Jk});function tx(e,t,n,s,r){const a=C(e,"x","conv3dTranspose"),o=C(t,"filter","conv3dTranspose");return Qk(n,a,o,s,r)}const ex=z({conv3dTranspose_:tx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(e){const n={x:C(e,"x","cos","float32")};return j.runKernel(sf,n)}const sx=z({cos_:nx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rx(e){const n={x:C(e,"x","cosh","float32")};return j.runKernel(rf,n)}const ax=z({cosh_:rx});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ox(e,t=0,n=!1,s=!1){const a={x:C(e,"x","cumprod")},o={axis:t,exclusive:n,reverse:s};return j.runKernel(Sm,a,o)}const ix=z({cumprod_:ox});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ux(e,t=0,n=!1,s=!1){const a={x:C(e,"x","cumsum")},o={axis:t,exclusive:n,reverse:s};return j.runKernel(Nm,a,o)}const cx=z({cumsum_:ux});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(e,t,n,s=!1){const r=C(e,"x","denseBincount"),a=C(t,"weights","denseBincount");A(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),A(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),A(n>=0,()=>`size must be non-negative, but got ${n}.`),A(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const o={x:r,weights:a},i={size:n,binaryOutput:s};return j.runKernel(_m,o,i)}const fx=z({denseBincount_:lx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hx(e,t,n="NHWC"){const s=C(e,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],a=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];A(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),A(r*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${t}  for depthToSpace with input shape
    ${s.shape}`),A(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${s.shape}`),A(o%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${s.shape}`);const i={x:s},u={blockSize:t,dataFormat:n};return j.runKernel(Tm,i,u)}const dx=z({depthToSpace_:hx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function px(e,t,n,s,r="NHWC",a=[1,1],o){const i=C(e,"x","depthwiseConv2d","float32"),u=C(t,"filter","depthwiseConv2d","float32");let c=i,l=!1;i.rank===3&&(l=!0,c=pt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),A(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),A(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const f=r==="NHWC"?c.shape[3]:c.shape[1];A(f===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${u.shape[2]}.`),ts("depthwiseConv2d",s,o);const d={x:c,filter:u},m={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o},g=j.runKernel(Em,d,m);return l?pt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const nh=z({depthwiseConv2d_:px});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mx(e){const n={x:C(e,"x","diag")};return j.runKernel(Am,n)}const gx=z({diag_:mx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yx(e,t,n,s,r=[1,1],a="NHWC"){const o=C(e,"x","dilation2d"),i=C(t,"filter","dilation2d");A(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),A(i.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`),A(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let u=o,c=!1;o.rank===3&&(u=pt(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),A(u.shape[3]===i.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${i.shape[2]}`);const l={x:u,filter:i},f={strides:n,pad:s,dilations:r},d=j.runKernel(Dm,l,f);return c?pt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const bx=z({dilation2d_:yx});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ki(e,t){const n=e.length,s=[];for(let r=0;r<n;r++){const a=n-1-r,o=e[a]||1;(t[t.length-1-r]||1)>1&&o===1&&s.unshift(a)}return s}function wx(e,t){const n=[];for(let s=0;s<t.length;s++){const r=e[e.length-s-1],a=t.length-s-1,o=t[a];(r==null||r===1&&o>1)&&n.unshift(a)}return n}function Fe(e,t){const n=Math.max(e.length,t.length),s=new Array(n);for(let r=0;r<n;r++){let a=e[e.length-r-1];a==null&&(a=1);let o=t[t.length-r-1];if(o==null&&(o=1),a===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=a;else if(a!==o){const i=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(i)}else s[n-r-1]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vx(e,t){let n=C(e,"a","equal","string_or_numeric"),s=C(t,"b","equal","string_or_numeric");[n,s]=Oe(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(cf,r)}const Ny=z({equal_:vx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kx(e,t,n){const s=C(t,"a","where"),r=C(n,"b","where"),a=C(e,"condition","where","bool"),o=Fe(Fe(a.shape,s.shape),r.shape),i=uo(a,o),u=uo(s,o),c=uo(r,o),l={condition:i,t:u,e:c};return j.runKernel(xg,l)}const ir=z({where_:kx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xx(e){const n={x:C(e,"x","zerosLike")};return j.runKernel(Wg,n)}const Pn=z({zerosLike_:xx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sx(e,t){let n=C(e,"a","div"),s=C(t,"b","div");[n,s]=Oe(n,s);const r=xe(n,s),a=Pn(r),o=Ny(s,a);return ir(o,a,r)}const Nx=z({divNoNan_:Sx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ix(e,t){const n=C(e,"t1","dot"),s=C(t,"t2","dot");A((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],a=s.rank===1?s.size:s.shape[0];if(A(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),n.rank===1&&s.rank===1){const o=pt(n,[1,-1]),i=pt(s,[-1,1]),u=be(o,i);return pt(u,[])}else if(n.rank===1&&s.rank===2){const o=pt(n,[1,-1]),i=pt(s,[s.shape[0],s.shape[1]]),u=be(o,i);return pt(u,[u.size])}else if(n.rank===2&&s.rank===1){const o=pt(s,[-1,1]),i=be(n,o);return pt(i,[i.size])}else{const o=pt(s,[s.shape[0],s.shape[1]]);return be(n,o)}}const _x=z({dot_:Ix});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tx(e,...t){const n=t.map((r,a)=>C(r,`tensors${a}`,"einsum")),s={equation:e};return j.runKernel(Om,n,s)}const ha=z({einsum_:Tx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ex(e){const n={x:C(e,"x","elu","float32")};return j.runKernel(of,n)}const Iy=z({elu_:Ex});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $x(e,t){const n=C(e,"x","ensureShape","string_or_numeric");if(!Lw(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}const Cx=z({ensureShape_:$x});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ax(e){let t=C(e,"x","erf");A(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=Pe(t,"float32"));const n={x:t};return j.runKernel(uf,n)}const Dx=z({erf_:Ax});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _y(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Ox(e,t,n){const s=e.length+t.length,r=[];let a=0,o=0;for(let i=0;i<s;i++)n.indexOf(i)===-1?r.push(e[a++]):r.push(t[o++]);return r}function Bs(e,t){const n=[],s=e.length;for(let a=0;a<s;a++)t.indexOf(a)===-1&&n.push(e[a]);const r=t.map(a=>e[a]);return[n,r]}function es(e,t){const n=t.map(s=>1);return Ox(e,n,t)}function Zr(e,t,n){A(_y(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function ks(e,t){if(_y(e,t))return null;const n=[];for(let s=0;s<t;++s)e.indexOf(s)===-1&&n.push(s);return e.forEach(s=>n.push(s)),n}function Ty(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function xs(e,t){const n=[];for(let s=t-e;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fx(e,t=null,n=!1){const r={x:C(e,"x","max")},a={reductionIndices:t,keepDims:n};return j.runKernel(Km,r,a)}const ba=z({max_:Fx});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rx(e,t=null,n=!1){const r={x:C(e,"x","min")},a={axis:t,keepDims:n};return j.runKernel(Zm,r,a)}const il=z({min_:Rx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Px(e,t){let n=C(e,"base","pow"),s=C(t,"exp","pow");[n,s]=Oe(n,s);const r={a:n,b:s};return j.runKernel(Df,r)}const _o=z({pow_:Px});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fe(e,t){if((Gn(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Gn(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return gr(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mx(e){const n={x:C(e,"x","sqrt","float32")};return j.runKernel(Hf,n)}const Rs=z({sqrt_:Mx});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(e){const t=C(e,"x","square"),n={};return j.runKernel("Square",{x:t},n)}const Xn=z({square_:Vx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lx(e,t=null,n=!1){let s=C(e,"x","sum");s.dtype==="bool"&&(s=Pe(s,"int32"));const r={x:s},a={axis:t,keepDims:n};return j.runKernel(Ng,r,a)}const Te=z({sum_:Lx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zx(e,t="euclidean",n=null,s=!1){e=C(e,"x","norm");const r=Ey(e,t,n);let a=r.shape;if(s){const o=Ue(n,e.shape);a=es(r.shape,o)}return pt(r,a)}function Ey(e,t,n=null){if(e.rank===0)return Fn(e);if(e.rank!==1&&n===null)return Ey(pt(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Te(Fn(e),n);if(t===1/0)return ba(Fn(e),n);if(t===-1/0)return il(Fn(e),n);if(t==="euclidean"||t===2)return Rs(Te(_o(Fn(e),fe(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return ba(Te(Fn(e),n[0]),n[1]-1);if(t===1/0)return ba(Te(Fn(e),n[1]),n[0]);if(t===-1/0)return il(Te(Fn(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Rs(Te(Xn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Nu=z({norm_:zx});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bx(e,t=null,n=!1){return Nu(e,"euclidean",t,n)}const Wx=z({euclideanNorm_:Bx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jx(e){const n={x:C(e,"x","exp")};return j.runKernel(lf,n)}const Hr=z({exp_:jx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hx(e,t=0){const n=C(e,"x","expandDims","string_or_numeric");A(t<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:t};return j.runKernel(Fm,s,r)}const Ts=z({expandDims_:Hx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qx(e){const n={x:C(e,"x","expm1")};return j.runKernel(ff,n)}const Kx=z({expm1_:qx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ux(e,t){const n=C(e,"x","tile","string_or_numeric");A(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const s={x:n},r={reps:t};return j.runKernel(Xf,s,r)}const co=z({tile_:Ux});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gx(e,t,n,s="float32"){t==null&&(t=e);const r=ce([e,t],s),a=e<=t?e:t;for(let i=0;i<a;++i)r.set(1,i,i);const o=pt(r.toTensor(),[e,t]);if(n==null)return o;if(n.length===1)return co(Ts(o,0),[n[0],1,1]);if(n.length===2)return co(Ts(Ts(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return co(Ts(Ts(Ts(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const $y=z({eye_:Gx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yx(e){const n={x:C(e,"x","floor","float32")};return j.runKernel(hf,n)}const Cy=z({floor_:Yx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xx(e,t,n=0,s=0){const r=C(e,"x","gather"),a=C(t,"indices","gather","int32"),o={x:r,indices:a},i={axis:n,batchDims:s};return j.runKernel(Lm,o,i)}const Ay=z({gather_:Xx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zx(e,t){let n=C(e,"a","greater","string_or_numeric"),s=C(t,"b","greater","string_or_numeric");[n,s]=Oe(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(pf,r)}const Iu=z({greater_:Zx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jx(e,t){let n=C(e,"a","greaterEqual","string_or_numeric"),s=C(t,"b","greaterEqual","string_or_numeric");[n,s]=Oe(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(mf,r)}const Dy=z({greaterEqual_:Jx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qx(e){const n={input:C(e,"input","imag")};return j.runKernel(Wm,n)}const _u=z({imag_:Qx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tS(e){const n={x:C(e,"x","isFinite")};return j.runKernel(yf,n)}const eS=z({isFinite_:tS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nS(e){const n={x:C(e,"x","isInf")};return j.runKernel(bf,n)}const sS=z({isInf_:nS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rS(e){const n={x:C(e,"x","isNaN")};return j.runKernel(wf,n)}const aS=z({isNaN_:rS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oS(e,t=.2){const s={x:C(e,"x","leakyRelu")},r={alpha:t};return j.runKernel(jm,s,r)}const Oy=z({leakyRelu_:oS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iS(e,t){let n=C(e,"a","less","string_or_numeric"),s=C(t,"b","less","string_or_numeric");[n,s]=Oe(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(vf,r)}const ul=z({less_:iS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uS(e,t){let n=C(e,"a","lessEqual","string_or_numeric"),s=C(t,"b","lessEqual","string_or_numeric");[n,s]=Oe(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(kf,r)}const sh=z({lessEqual_:uS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cS(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:e,stop:t,num:n};return j.runKernel(Hm,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lS(e,t=5,n=1,s=1,r=.5){const a=C(e,"x","localResponseNormalization");A(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),A(ko(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=a,i=!1;a.rank===3&&(i=!0,o=pt(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const u={x:o},c={depthRadius:t,bias:n,alpha:s,beta:r},l=j.runKernel(qm,u,c);return i?pt(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const fS=z({localResponseNormalization_:lS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hS(e){const n={x:C(e,"x","log","float32")};return j.runKernel(xf,n)}const To=z({log_:hS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dS(e){const n={x:C(e,"x","log1p")};return j.runKernel(Sf,n)}const Fy=z({log1p_:dS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pS(e,t){A(qc(e),()=>"The f passed in variableGrads(f) must be a function"),A(t==null||Array.isArray(t)&&t.every(c=>c instanceof ji),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const c in j.registeredVariables)t.push(j.registeredVariables[c])}const s=n?t.filter(c=>!c.trainable):null,r=t.length;t=t.filter(c=>c.trainable),A(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:o,grads:i}=j.gradients(e,t,null,a);A(i.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),A(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const u={};return t.forEach((c,l)=>{i[l]!=null&&(u[c.name]=i[l])}),s!=null&&s.forEach(c=>u[c.name]=null),{value:o,grads:u}}function Ps(e){return j.customGrad(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mS(e){const n={x:C(e,"x","neg")};return j.runKernel(tg,n)}const ds=z({neg_:mS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gS(e){const n={x:C(e,"x","softplus")};return j.runKernel(jf,n)}const Ry=z({softplus_:gS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yS(e){const t=C(e,"x","logSigmoid");return Ps(s=>({value:ds(Ry(ds(s))),gradFunc:o=>Pt(o,ya(ds(s)))}))(t)}const bS=z({logSigmoid_:yS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wS(e,t){let n=C(e,"a","sub"),s=C(t,"b","sub");[n,s]=Oe(n,s);const r={a:n,b:s};return j.runKernel(Uf,r)}const oe=z({sub_:wS});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vS(e,t=-1){const n=C(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Ps((r,a)=>{const i=ba(r,t,!0),u=oe(r,i),c=oe(Pe(u,"float32"),To(Te(Hr(u),t,!0)));return a([c]),{value:c,gradFunc:(f,d)=>{const[m]=d,g=!0,w=Hr(m);return oe(f,Pt(Te(f,t,g),w))}}})(n)}const kS=z({logSoftmax_:vS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xS(e,t=null,n=!1){const s=C(e,"x","logSumExp"),r=Ue(t,s.shape),a=ba(s,r,!0),o=oe(s,a),i=Hr(o),u=Te(i,r),c=To(u),l=Zt(pt(a,c.shape),c);if(n){const f=es(l.shape,r);return pt(l,f)}return l}const Py=z({logSumExp_:xS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SS(e,t){const n=C(e,"a","logicalAnd","bool"),s=C(t,"b","logicalAnd","bool");Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(Nf,r)}const Ui=z({logicalAnd_:SS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NS(e){const n={x:C(e,"x","logicalNot","bool")};return j.runKernel(If,n)}const My=z({logicalNot_:NS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IS(e,t){const n=C(e,"a","logicalOr","bool"),s=C(t,"b","logicalOr","bool");Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(_f,r)}const Vy=z({logicalOr_:IS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _S(e,t){const n=C(e,"a","logicalXor","bool"),s=C(t,"b","logicalXor","bool");return Fe(n.shape,s.shape),Ui(Vy(e,t),My(Ui(e,t)))}const TS=z({logicalXor_:_S});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wi=2147483648;function ES(e,t,n="left"){const s=C(e,"sortedSequence","searchSorted"),r=C(t,"values","searchSorted"),a=s.shape[s.shape.length-1],o=r.shape[r.shape.length-1],i=pt(s,[-1,a]),u=pt(r,[-1,o]);if(i.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(i.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Nt(u.shape)>=wi)throw new Error(`values tensor size must less than ${wi}`);if(i.shape[1]>=wi)throw new Error(`trailing dim_size must less than ${wi} for int32 output type, was ${i.shape[1]}`);const c={sortedSequence:i,values:u},l={side:n};return j.runKernel(kg,c,l)}const rh=z({searchSorted_:ES});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $S(e,t){return rh(e,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CS(e,t,n,s,r){const a=C(e,"x","maxPool"),o=1;let i=a,u=!1;a.rank===3&&(u=!0,i=pt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A(i.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`),A(Qn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),ts("maxPool",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r},f=j.runKernel(Um,c,l);return u?pt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Ly=z({maxPool_:CS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AS(e,t=[1,1,1],n,s,r,a="NDHWC"){const o=C(e,"x","maxPool3d");let i=o,u=!1;o.rank===4&&(u=!0,i=pt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),A(i.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`),A(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),ts("maxPool3d",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:a},f=j.runKernel(Gm,c,l);return u?pt(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const DS=z({maxPool3d_:AS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OS(e,t,n,s,r=!1){const o={x:C(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:n,pad:s,includeBatchInIndex:r},u=j.runKernel(Ym,o,i);return{result:u[0],indexes:u[1]}}const FS=z({maxPoolWithArgmax_:OS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RS(e,t){let n=C(e,"a","maximum"),s=C(t,"b","maximum");[n,s]=Oe(n,s),n.dtype==="bool"&&(n=Pe(n,"int32"),s=Pe(s,"int32")),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(Tf,r)}const zy=z({maximum_:RS});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PS(e,t=null,n=!1){const r={x:C(e,"x","mean")},a={axis:t,keepDims:n};return j.runKernel(Xm,r,a)}const Gi=z({mean_:PS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ta(e,t="float32"){if(Vn(e),t==="complex64"){const s=Ta(e,"float32"),r=Ta(e,"float32");return lr(s,r)}const n=tn(Nt(e),t);return j.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pr(e,t="float32"){if(Vn(e),t==="complex64"){const s=Pr(e,"float32"),r=Ta(e,"float32");return lr(s,r)}const n=Hl(Nt(e),t);return j.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MS(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let s=C(e,"x","meshgrid",e instanceof cn?e.dtype:"float32");if(t===void 0)return[s];let r=C(t,"y","meshgrid",t instanceof cn?t.dtype:"float32");const a=Nt(s.shape),o=Nt(r.shape);return n==="xy"?(s=pt(s,[1,-1]),r=pt(r,[-1,1]),[be(Pr([o,1],s.dtype),s),be(r,Pr([1,a],r.dtype))]):(s=pt(s,[-1,1]),r=pt(r,[1,-1]),[be(s,Pr([1,o],s.dtype)),be(Pr([a,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VS(e,t){let n=C(e,"a","minimum"),s=C(t,"b","minimum");[n,s]=Oe(n,s),n.dtype==="bool"&&(n=Pe(n,"int32"),s=Pe(s,"int32")),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(Ef,r)}const Yi=z({minimum_:VS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LS(e,t,n){A(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=C(e,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");A(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const r=n==="reflect"?1:0;for(let i=0;i<s.rank;i++)A(t[i].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),A(t[i][0]>=0&&t[i][0]<=s.shape[i]-r&&t[i][1]>=0&&t[i][1]<=s.shape[i]-r,()=>`Padding in dimension ${i} cannot be greater than or equal to ${s.shape[i]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:t,mode:n},o={x:s};return j.runKernel(Jm,o,a)}const zS=z({mirrorPad_:LS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BS(e,t){let n=C(e,"a","mod"),s=C(t,"b","mod");[n,s]=Oe(n,s);const r={a:n,b:s};return j.runKernel($f,r)}const WS=z({mod_:BS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jS(e,t=null,n=!1){e=C(e,"x","moments");const s=Ue(t,e.shape),r=Gi(e,s,n);let a=r.shape;n||(a=es(r.shape,s));const o=Xn(oe(Pe(e,"float32"),pt(r,a))),i=Gi(o,s,n);return{mean:r,variance:i}}const HS=z({moments_:jS});function qS(e,t,n,s){const r=C(t,"data","multiRNNCell"),a=Hi(n,"c","multiRNNCell"),o=Hi(s,"h","multiRNNCell");let i=r;const u=[];for(let f=0;f<e.length;f++){const d=e[f](i,a[f],o[f]);u.push(d[0]),u.push(d[1]),i=d[1]}const c=[],l=[];for(let f=0;f<u.length;f+=2)c.push(u[f]),l.push(u[f+1]);return[c,l]}const KS=z({multiRNNCell_:qS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function US(e,t,n,s=!1){const r=C(e,"logits","multinomial"),a=r.size,o=r.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const u={logits:o===1?pt(r,[1,-1]):r},c={numSamples:t,seed:n,normalized:s},l=j.runKernel(Qm,u,c);return o===1?pt(l,[l.size]):l}const GS=z({multinomial_:US});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YS(e,t){let n=C(e,"a","notEqual","string_or_numeric"),s=C(t,"b","notEqual","string_or_numeric");[n,s]=Oe(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return j.runKernel(Af,r)}const By=z({notEqual_:YS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XS(e,t,n=1,s=0,r="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:C(e,"indices","oneHot","int32")},i={dtype:r,depth:t,onValue:n,offValue:s};return j.runKernel(ag,o,i)}const ZS=z({oneHot_:XS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JS(e){const n={x:C(e,"x","onesLike")};return j.runKernel(rg,n)}const QS=z({onesLike_:JS});function tN(e,t){const n=C(e,"v1","outerProduct"),s=C(t,"v2","outerProduct");A(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=pt(n,[-1,1]),a=pt(s,[1,-1]);return be(r,a)}const eN=z({outerProduct_:tN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nN(e,t,n=0){const s=C(e,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:t,constantValue:n},a={x:s};return j.runKernel(ig,a,r)}const Wo=z({pad_:nN});function sN(e,t,n=0){return A(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),Wo(e,[t],n)}const rN=z({pad1d_:sN});function aN(e,t,n=0){return A(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Wo(e,t,n)}const oN=z({pad2d_:aN});function iN(e,t,n=0){return A(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Wo(e,t,n)}const uN=z({pad3d_:iN});function cN(e,t,n=0){return A(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Wo(e,t,n)}const lN=z({pad4d_:cN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fN(e,t,n){const s=C(e,"x","spaceToBatchND");A(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),A(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),A(s.shape.reduce((o,i,u)=>u>0&&u<=t.length?o&&(i+n[u-1][0]+n[u-1][1])%t[u-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const r={x:s},a={blockShape:t,paddings:n};return j.runKernel(Ig,r,a)}const Wy=z({spaceToBatchND_:fN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hN(e,t,n,s,r,a,o){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const i=C(e,"x","maxPool");let u=i,c=!1;i.rank===3&&(c=!0,u=pt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),A(Qn(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const l=La(u.shape,t,a,r,s),f=[l.dilationHeight,l.dilationWidth];let d;s==="same"?d=pN([l.filterHeight,l.filterWidth],f):d=[[0,0],[0,0]];const m=f[0]===1&&f[1]===1,[g,w]=dN([l.inHeight,l.inWidth],f,d),b=m?s:"valid",k=m?u:Wy(u,f,g),T=(n==="avg"?()=>vy(k,t,a,b,o):()=>Ly(k,t,a,b,o))(),N=m?T:ky(T,f,w);return c?pt(N,[N.shape[1],N.shape[2],N.shape[3]]):N}function dN(e,t,n){const s=n.map(l=>l[0]),r=n.map(l=>l[1]),a=e.concat(s,r),o=t.map((l,f)=>(l-a[f]%l)%l),i=r.map((l,f)=>l+o[f]),u=t.map((l,f)=>[s[f],i[f]]),c=t.map((l,f)=>[0,o[f]]);return[u,c]}function pN(e,t){const s=e.map((o,i)=>o+(o-1)*(t[i]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),a=s.map((o,i)=>o-r[i]);return s.map((o,i)=>[r[i],a[i]])}const mN=z({pool_:hN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gN(e,t){const n=C(e,"x","prelu"),s=C(t,"alpha","prelu"),r={x:n,alpha:s};return j.runKernel(ug,r)}const jy=z({prelu_:gN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yN(e,t=null,n=!1){let s=C(e,"x","prod");s.dtype==="bool"&&(s=Pe(s,"int32"));const r={x:s},a={axis:t,keepDims:n};return j.runKernel(cg,r,a)}const bN=z({prod_:yN});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wN(e,t,n,s){const r=e.map((l,f)=>C(l,`tensors${f}`,"raggedGather","int32")),a=C(t,"paramsDenseValues","raggedGather"),o=C(n,"indices","raggedGather","int32"),i={paramsNestedSplits:r,paramsDenseValues:a,indices:o},u={outputRaggedRank:s},c=j.runKernel(lg,i,u);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const vN=z({raggedGather_:wN});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kN(e,t,n){const s=C(e,"starts","raggedRange"),r=C(t,"limits","raggedRange",s.dtype),a=C(n,"deltas","raggedRange",s.dtype),o={starts:s,limits:r,deltas:a},i=j.runKernel(fg,o);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}const xN=z({raggedRange_:kN});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SN(e,t,n,s,r){const a=C(e,"shape","raggedTensorToTensor","int32"),o=C(t,"values","raggedTensorToTensor"),i=C(n,"defaultValue","raggedTensorToTensor",o.dtype),u=s.map((f,d)=>C(f,`tensors${d}`,"raggedTensorToTensor","int32")),c={shape:a,values:o,defaultValue:i,rowPartitionTensors:u},l={rowPartitionTypes:r};return j.runKernel(hg,c,l)}const NN=z({raggedTensorToTensor_:SN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IN(e,t,n){Vn(e);const s=Nt(e);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let a=0;a<s;a++)r[a]=t();return j.makeTensor(r,e,n)}const _N=z({rand_:IN});var $i={exports:{}},TN=$i.exports,zd;function EN(){return zd||(zd=1,(function(e){(function(t,n,s){function r(u){var c=this,l=i();c.next=function(){var f=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=f-(c.c=f|0)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(u),c.s0<0&&(c.s0+=1),c.s1-=l(u),c.s1<0&&(c.s1+=1),c.s2-=l(u),c.s2<0&&(c.s2+=1),l=null}function a(u,c){return c.c=u.c,c.s0=u.s0,c.s1=u.s1,c.s2=u.s2,c}function o(u,c){var l=new r(u),f=c&&c.state,d=l.next;return d.int32=function(){return l.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,f&&(typeof f=="object"&&a(f,l),d.state=function(){return a(l,{})}),d}function i(){var u=4022871197,c=function(l){l=String(l);for(var f=0;f<l.length;f++){u+=l.charCodeAt(f);var d=.02519603282416938*u;u=d>>>0,d-=u,d*=u,u=d>>>0,d-=u,u+=d*4294967296}return(u>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(TN,e)})($i)),$i.exports}var Ci={exports:{}},$N=Ci.exports,Bd;function CN(){return Bd||(Bd=1,(function(e){(function(t,n,s){function r(i){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},i===(i|0)?u.x=i:c+=i;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,u.next()}function a(i,u){return u.x=i.x,u.y=i.y,u.z=i.z,u.w=i.w,u}function o(i,u){var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(typeof l=="object"&&a(l,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xor128=o})($N,e)})(Ci)),Ci.exports}var Ai={exports:{}},AN=Ai.exports,Wd;function DN(){return Wd||(Wd=1,(function(e){(function(t,n,s){function r(i){var u=this,c="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(f^f<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,i===(i|0)?u.x=i:c+=i;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(i,u){return u.x=i.x,u.y=i.y,u.z=i.z,u.w=i.w,u.v=i.v,u.d=i.d,u}function o(i,u){var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(typeof l=="object"&&a(l,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xorwow=o})(AN,e)})(Ai)),Ai.exports}var Di={exports:{}},ON=Di.exports,jd;function FN(){return jd||(jd=1,(function(e){(function(t,n,s){function r(i){var u=this;u.next=function(){var l=u.x,f=u.i,d,m;return d=l[f],d^=d>>>7,m=d^d<<24,d=l[f+1&7],m^=d^d>>>10,d=l[f+3&7],m^=d^d>>>3,d=l[f+4&7],m^=d^d<<7,d=l[f+7&7],d=d^d<<13,m^=d^d<<9,l[f]=m,u.i=f+1&7,m};function c(l,f){var d,m=[];if(f===(f|0))m[0]=f;else for(f=""+f,d=0;d<f.length;++d)m[d&7]=m[d&7]<<15^f.charCodeAt(d)+m[d+1&7]<<13;for(;m.length<8;)m.push(0);for(d=0;d<8&&m[d]===0;++d);for(d==8?m[7]=-1:m[d],l.x=m,l.i=0,d=256;d>0;--d)l.next()}c(u,i)}function a(i,u){return u.x=i.x.slice(),u.i=i.i,u}function o(i,u){i==null&&(i=+new Date);var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(l.x&&a(l,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xorshift7=o})(ON,e)})(Di)),Di.exports}var Oi={exports:{}},RN=Oi.exports,Hd;function PN(){return Hd||(Hd=1,(function(e){(function(t,n,s){function r(i){var u=this;u.next=function(){var l=u.w,f=u.X,d=u.i,m,g;return u.w=l=l+1640531527|0,g=f[d+34&127],m=f[d=d+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,g=f[d]=g^m,u.i=d,g+(l^l>>>16)|0};function c(l,f){var d,m,g,w,b,k=[],I=128;for(f===(f|0)?(m=f,f=null):(f=f+"\0",m=0,I=Math.max(I,f.length)),g=0,w=-32;w<I;++w)f&&(m^=f.charCodeAt((w+32)%f.length)),w===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,w>=0&&(b=b+1640531527|0,d=k[w&127]^=m+b,g=d==0?g+1:0);for(g>=128&&(k[(f&&f.length||0)&127]=-1),g=127,w=512;w>0;--w)m=k[g+34&127],d=k[g=g+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,k[g]=m^d;l.w=b,l.X=k,l.i=g}c(u,i)}function a(i,u){return u.i=i.i,u.w=i.w,u.X=i.X.slice(),u}function o(i,u){i==null&&(i=+new Date);var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(l.X&&a(l,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xor4096=o})(RN,e)})(Oi)),Oi.exports}var Fi={exports:{}},MN=Fi.exports,qd;function VN(){return qd||(qd=1,(function(e){(function(t,n,s){function r(i){var u=this,c="";u.next=function(){var f=u.b,d=u.c,m=u.d,g=u.a;return f=f<<25^f>>>7^d,d=d-m|0,m=m<<24^m>>>8^g,g=g-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-m|0,u.d=m<<16^d>>>16^g,u.a=g-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,i===Math.floor(i)?(u.a=i/4294967296|0,u.b=i|0):c+=i;for(var l=0;l<c.length+20;l++)u.b^=c.charCodeAt(l)|0,u.next()}function a(i,u){return u.a=i.a,u.b=i.b,u.c=i.c,u.d=i.d,u}function o(i,u){var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(typeof l=="object"&&a(l,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.tychei=o})(MN,e)})(Fi)),Fi.exports}var Ri={exports:{}};const LN={},zN=Object.freeze(Object.defineProperty({__proto__:null,default:LN},Symbol.toStringTag,{value:"Module"})),BN=mv(zN);var WN=Ri.exports,Kd;function jN(){return Kd||(Kd=1,(function(e){(function(t,n,s){var r=256,a=6,o=52,i="random",u=s.pow(r,a),c=s.pow(2,o),l=c*2,f=r-1,d;function m(N,$,D){var P=[];$=$==!0?{entropy:!0}:$||{};var L=k(b($.entropy?[N,T(n)]:N??I(),3),P),R=new g(P),M=function(){for(var E=R.g(a),K=u,X=0;E<c;)E=(E+X)*r,K*=r,X=R.g(1);for(;E>=l;)E/=2,K/=2,X>>>=1;return(E+X)/K};return M.int32=function(){return R.g(4)|0},M.quick=function(){return R.g(4)/4294967296},M.double=M,k(T(R.S),n),($.pass||D||function(E,K,X,rt){return rt&&(rt.S&&w(rt,R),E.state=function(){return w(R,{})}),X?(s[i]=E,K):E})(M,L,"global"in $?$.global:this==s,$.state)}function g(N){var $,D=N.length,P=this,L=0,R=P.i=P.j=0,M=P.S=[];for(D||(N=[D++]);L<r;)M[L]=L++;for(L=0;L<r;L++)M[L]=M[R=f&R+N[L%D]+($=M[L])],M[R]=$;(P.g=function(E){for(var K,X=0,rt=P.i,nt=P.j,st=P.S;E--;)K=st[rt=f&rt+1],X=X*r+st[f&(st[rt]=st[nt=f&nt+K])+(st[nt]=K)];return P.i=rt,P.j=nt,X})(r)}function w(N,$){return $.i=N.i,$.j=N.j,$.S=N.S.slice(),$}function b(N,$){var D=[],P=typeof N,L;if($&&P=="object")for(L in N)try{D.push(b(N[L],$-1))}catch{}return D.length?D:P=="string"?N:N+"\0"}function k(N,$){for(var D=N+"",P,L=0;L<D.length;)$[f&L]=f&(P^=$[f&L]*19)+D.charCodeAt(L++);return T($)}function I(){try{var N;return d&&(N=d.randomBytes)?N=N(r):(N=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(N)),T(N)}catch{var $=t.navigator,D=$&&$.plugins;return[+new Date,t,D,t.screen,T(n)]}}function T(N){return String.fromCharCode.apply(0,N)}if(k(s.random(),n),e.exports){e.exports=m;try{d=BN}catch{}}else s["seed"+i]=m})(typeof self<"u"?self:WN,[],Math)})(Ri)),Ri.exports}var $c,Ud;function HN(){if(Ud)return $c;Ud=1;var e=EN(),t=CN(),n=DN(),s=FN(),r=PN(),a=VN(),o=jN();return o.alea=e,o.xor128=t,o.xorwow=n,o.xorshift7=s,o.xor4096=r,o.tychei=a,$c=o,$c}var Tu=HN();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ah{constructor(t,n,s,r,a){this.mean=t,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=a||Math.random();this.random=Tu.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let t,n,s=!1;for(;!s;){let r,a,o;do r=2*this.random()-1,a=2*this.random()-1,o=r*r+a*a;while(o>=1||o===0);const i=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*r*i,n=this.mean+this.stdDev*a*i,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class qN{constructor(t,n,s,r){this.alpha=t,this.beta=1/n,this.dtype=s;const a=r||Math.random();this.randu=Tu.alea(a.toString()),this.randn=new ah(0,1,s,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,s,r,a,o;for(;;){do r=this.randn.nextValue(),o=1+this.c*r;while(o<=0);if(o*=o*o,t=r*r,n=1-.331*t*t,s=.5*t+this.d*(1-o+Math.log(o)),a=this.randu(),a<n||Math.log(a)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class KN{constructor(t=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=Tu.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UN(e,t,n=1,s="float32",r){if(Vn(e),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const a=new qN(t,n,s,r),o=ce(e,s);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const GN=z({randomGamma_:UN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YN(e,t=0,n=1,s,r){if(Vn(e),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new ah(t,n,s,!1,r),o=ce(e,s);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const Hy=z({randomNormal_:YN});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XN(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return Hy(e,0,1,t,n)}const ZN=z({randomStandardNormal_:XN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JN(e,t=0,n=1,s="float32",r){Vn(e);const a=ce(e,s),o=new KN(t,n,null,r);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const oh=z({randomUniform_:JN});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QN(e,t,n,s){return oh(e,t,n,"int32",s)}const tI=z({randomUniformInt_:QN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eo(e,t,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:e,stop:t,step:n,dtype:s};return j.runKernel(dg,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eI(e){const n={input:C(e,"input","real")};return j.runKernel(pg,n)}const $o=z({real_:eI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nI(e){const n={x:C(e,"x","reciprocal")};return j.runKernel(Of,n)}const sI=z({reciprocal_:nI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rI(e){const n={x:C(e,"x","relu")};return j.runKernel(Ff,n)}const Eu=z({relu_:rI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aI(e){const n={x:C(e,"x","relu6")};return j.runKernel(Rf,n)}const qy=z({relu6_:aI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oI(e,t){const s={x:C(e,"x","reverse")},r={dims:t};return j.runKernel(bg,s,r)}const qr=z({reverse_:oI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iI(e){const t=C(e,"x","reverse");return A(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),qr(t,0)}const uI=z({reverse1d_:iI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cI(e,t){const n=C(e,"x","reverse");return A(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),qr(n,t)}const lI=z({reverse2d_:cI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fI(e,t){const n=C(e,"x","reverse");return A(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),qr(n,t)}const hI=z({reverse3d_:fI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dI(e,t){const n=C(e,"x","reverse");return A(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),qr(n,t)}const pI=z({reverse4d_:dI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mI(e){const n={x:C(e,"x","round")};return j.runKernel(Pf,n)}const Ky=z({round_:mI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gI(e){const n={x:C(e,"x","rsqrt","float32")};return j.runKernel(Mf,n)}const yI=z({rsqrt_:gI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bI(e){const n={x:C(e,"x","selu")};return j.runKernel(Vf,n)}const wI=z({selu_:bI});function vI(e,t,n,s,r,a=[1,1],o="NHWC"){const i=C(e,"x","separableConv2d"),u=C(t,"depthwiseFilter","separableConv2d"),c=C(n,"pointwiseFilter","separableConv2d");let l=i,f=!1;if(i.rank===3&&(f=!0,l=pt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A(l.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${l.rank}.`),A(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),A(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),A(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),A(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=u.shape[2],m=u.shape[3];A(c.shape[2]===d*m,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*m}, but got ${c.shape[2]}.`);const g=nh(l,u,s,r,o,a),b=Su(g,c,1,"valid",o);return f?pt(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const kI=z({separableConv2d_:vI});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function xI(e,t){const n=C(e,"x","setdiff1d"),s=C(t,"y","setdiff1d");A(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),A(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),A(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),a=await s.data(),o=new Set(a);let i=0;for(let l=0;l<r.length;l++)o.has(r[l])||i++;const u=new je([i],n.dtype),c=new je([i],"int32");for(let l=0,f=0;l<r.length;l++)o.has(r[l])||(u.values[f]=r[l],c.values[f]=l,f++);return[u.toTensor(),c.toTensor()]}const SI=xI;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NI(e){const n={x:C(e,"x","sign")};return j.runKernel(Bf,n)}const II=z({sign_:NI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _I(e){const n={x:C(e,"x","sin","float32")};return j.runKernel(Lf,n)}const TI=z({sin_:_I});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EI(e){const n={x:C(e,"x","sinh")};return j.runKernel(zf,n)}const $I=z({sinh_:EI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CI(e,t,n){const s=C(e,"x","slice1d");return A(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),ve(s,[t],[n])}const AI=z({slice1d_:CI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DI(e,t,n){const s=C(e,"x","slice2d");return A(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),ve(s,t,n)}const OI=z({slice2d_:DI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FI(e,t,n){const s=C(e,"x","slice3d");return A(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),ve(s,t,n)}const RI=z({slice3d_:FI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PI(e,t,n){const s=C(e,"x","slice4d");return A(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),ve(s,t,n)}const MI=z({slice4d_:PI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VI(e,t=-1){const n=C(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const s={logits:n},r={dim:t};return j.runKernel(Tg,s,r)}const LI=z({softmax_:VI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zI(e){A(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return j.runKernel(Rm,t)}const ih=z({fft_:zI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BI(e){A(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return j.runKernel(Bm,t)}const Xi=z({ifft_:BI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(e){const t=e.shape[e.shape.length-1],n=e.size/t;let s;if(t<=2){const r=pt(e,[n,t]);s=Xi(r)}else{const r=[n,2*(t-1)],a=pt($o(e),[n,t]),o=pt(_u(e),[n,t]),i=qr(ve(a,[0,1],[n,t-2]),1),u=Pt(qr(ve(o,[0,1],[n,t-2]),1),fe(-1)),c=hn([a,i],1),l=hn([o,u],1),f=pt(lr(c,l),[r[0],r[1]]);s=Xi(f)}if(s=$o(s),e.rank===3&&e.shape[0]!==0){const r=s,a=e.shape[0];s=pt(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const Uy=z({irfft_:WI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jI(e,t,n=0){const r={x:C(e,"x","split")},a={numOrSizeSplits:t,axis:n};return j.runKernel(_g,r,a)}const Co=z({split_:jI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HI(e,t){A(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const s=e.size/n;let r;if(t!=null&&t<n){const g=e.shape.map(b=>0),w=e.shape.map(b=>b);w[e.shape.length-1]=t,r=ve(e,g,w),n=t}else if(t!=null&&t>n){const g=e.shape.map(w=>w);g[e.shape.length-1]=t-n,r=hn([e,Ta(g)],e.shape.length-1),n=t}else r=e;const a=Pn(r),o=pt(lr(r,a),[s,n]),i=ih(o),u=Math.floor(n/2)+1,c=$o(i),l=_u(i),f=Co(c,[u,n-u],c.shape.length-1),d=Co(l,[u,n-u],l.shape.length-1),m=r.shape.slice();return m[r.shape.length-1]=u,pt(lr(f[0],d[0]),m)}const uh=z({rfft_:HI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qI(e,t){let n=C(e,"a","squaredDifference"),s=C(t,"b","squaredDifference");[n,s]=Oe(n,s),Fe(n.shape,s.shape);const r={a:n,b:s},a={};return j.runKernel(qf,r,a)}const Gy=z({squaredDifference_:qI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KI(e,t){const n=C(e,"x","squeeze","string_or_numeric");return pt(n,Bw(n.shape,t).newShape)}const ch=z({squeeze_:KI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UI(e,t=0){const n=Hi(e,"tensors","stack","string_or_numeric");A(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&A(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:t};return j.runKernel(og,s,r)}const Ms=z({stack_:UI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GI(e,t=0){const s={x:C(e,"x","step")},r={alpha:t};return j.runKernel(Zf,s,r)}const Yy=z({step_:GI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YI(e,t,n,s,r=0,a=0,o=0,i=0,u=0){const l={x:C(e,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:s,beginMask:r,endMask:a,ellipsisMask:o,newAxisMask:i,shrinkAxisMask:u};return j.runKernel(Og,l,f)}const XI=z({stridedSlice_:YI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZI(e){const n={x:C(e,"x","tan","float32")};return j.runKernel(Gf,n)}const JI=z({tan_:ZI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wn(e,t){Pa(e);const n=mr(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return gr(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lo(e,t,n){if(Pa(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=mr(e,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xy(e,t,n){if(Pa(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=mr(e,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QI(e,t,n){if(Pa(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=mr(e,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t_(e,t,n){if(Pa(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=mr(e,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e_(e,t,n){if(Pa(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=mr(e,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||s,gr(e,t,s,n)}function n_(e,t,n){const s=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(a+` update.rank < ${r}. `);if(e.length<s+(n.rank-r))throw new Error(a+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+e.length-s)throw new Error(a+` update.rank != ${r+e.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==e[o+s])throw new Error(a+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${e[o+r]})`)}function Zy(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}n_(n,t,e)}function lh(e,t,n){const s=t.shape.length,r=s>1?t.shape[s-1]:1,a=n.length;let o=1;for(let f=r;f<a;++f)o*=n[f];const i=r<1?1:r,u=Nt(t.shape)/i,c=[...Kt(n.slice(0,r)),1],l=Nt(n);return{sliceRank:r,numUpdates:u,sliceSize:o,strides:c,outputSize:l}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_(e,t,n){const s=C(e,"tensor","tensorScatterupdate"),r=C(t,"indices","tensorScatterupdate","int32"),a=C(n,"updates","tensorScatterupdate");if(Zy(a,r,s.shape),s.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${a.dtype}.`);const o={tensor:s,indices:r,updates:a},i={};return j.runKernel(vg,o,i)}const r_=z({tensorScatterUpdate_:s_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_(e,t=1,n=!0){const s=C(e,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${t}`);const a={x:s},o={k:t,sorted:n},[i,u]=j.runKernel(Mg,a,o);return{values:i,indices:u}}const o_=z({topk_:a_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_(e,t=0,n=1,s,r){if(Vn(e),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new ah(t,n,s,!0,r),o=ce(e,s);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const u_=z({truncatedNormal_:i_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_(e,t=0){const n=C(e,"x","unique","string_or_numeric");A(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:t},[a,o]=j.runKernel(Lg,s,r);return{values:a,indices:o}}const l_=z({unique_:c_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_(e,t,n){const s=C(e,"x","unsortedSegmentSum"),r=C(t,"segmentIds","unsortedSegmentSum","int32");A(ko(n),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},o={numSegments:n};return j.runKernel(Bg,a,o)}const h_=z({unsortedSegmentSum_:f_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_(e,t=0){const n=C(e,"x","unstack","string_or_numeric");A(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:t};return j.runKernel(zg,s,r)}const Jr=z({unstack_:d_});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_(e,t){return rh(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_(e,t=!0,n,s){return j.makeVariable(e,t,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jy(e,t){const n=[];for(let a=0;a<t.length;a++)t[a]&&n.push(a);const s=ce(e,"int32"),r=ce([n.length,e.length],"int32");for(let a=0;a<n.length;a++){const o=s.indexToLoc(n[a]),i=a*e.length;r.values.set(o,i)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function g_(e){const t=C(e,"condition","whereAsync","bool"),n=await t.data(),s=Jy(t.shape,n);return e!==t&&t.dispose(),s}const Qy=g_;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function y_(e,t,n){const s=C(e,"tensor","boolMask"),r=C(t,"mask","boolMask","bool"),a=n??0,o=r.rank,i=s.shape;A(o>0,()=>"mask cannot be scalar"),Mn(i.slice(a,a+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let w=a;w<a+o;w++)u*=i[w];const c=i.slice(0,a).concat([u],i.slice(a+o)),l=pt(s,c),f=pt(r,[-1]),d=await Qy(f),m=ch(d,[1]),g=Ay(l,m,a);return e!==s&&s.dispose(),t!==r&&r.dispose(),m.dispose(),l.dispose(),f.dispose(),d.dispose(),g}const b_=y_;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_(e,t,n){const s=C(e,"x","transpose");if(t==null&&(t=s.shape.map((o,i)=>i).reverse()),A(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(o=>{A(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:t};return s.dtype==="complex64"?de(()=>{let o=$o(s),i=_u(s);return o=j.runKernel(_i,{x:o},a),i=j.runKernel(_i,{x:i},a),n&&(i=ds(i)),lr(o,i)}):j.runKernel(_i,r,a)}const cl=z({transpose_:w_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v_(e,t,n,s,r=!0){const a=C(e,"v","movingAverage"),o=C(t,"x","movingAverage"),i=C(n,"decay","movingAverage");Fv(a,o),A(Un(a.shape,o.shape),()=>"Shape mismatch in v and x");const u=fe(1),c=oe(u,i);let l=Pt(oe(o,a),c);if(r){A(s!=null,()=>"When using zeroDebias: true, step is required.");const f=C(s,"step","movingAverage");l=xe(l,oe(u,_o(i,f)))}return Zt(a,l)}const k_=z({movingAverage_:v_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_(e,t,n){Vn(n);const s=C(e,"indices","scatterND","int32"),r=C(t,"updates","scatterND");Zy(r,s,n);const a={indices:s,updates:r},o={shape:n};return j.runKernel(wg,a,o)}const S_=z({scatterND_:x_});function N_(e,t,n,s){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const r=e.rank>0?e.shape[0]:1,a=e.rank>1?e.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const o=t.size;if(!(t.rank===0||t.rank===1&&o===r))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${r}]`);if(t.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_(e,t,n,s=0){Vn(n);const r=C(e,"sparseIndices","sparseToDense","int32"),a=C(t,"sparseValues","sparseToDense","string_or_numeric"),o=C(s,"defaultValue","sparseToDense",a.dtype);N_(r,a,n,o);const i={sparseIndices:r,sparseValues:a,defaultValue:o},u={outputShape:n};return j.runKernel(Dg,i,u)}const __=z({sparseToDense_:I_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T_(e,t){const n=C(t,"indices","gatherND","int32"),r={params:C(e,"x","gatherND","string_or_numeric"),indices:n};return j.runKernel(zm,r)}const E_=z({gatherND_:T_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_(e,t){if(t==null)return e.shape.slice();if(Un(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let s=0;s<e.shape.length;s++)t[s]==null&&e.shape[s]!=null?n.push(e.shape[s]):n.push(t[s]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_(e,t,n,s){const r=C(e,"x","dropout");if(A(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),A(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof cn?r.clone():r;const a=$_(r,n),o=1-t,i=xe(Cy(Zt(oh(a,0,1,"float32",s),o)),o);return Pt(r,i)}const A_=z({dropout_:C_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tb(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function fh(e,t,n){const s=1-e%2,r=new Float32Array(e);for(let a=0;a<e;++a){const o=2*Math.PI*a/(e+s-1);r[a]=t-n*Math.cos(o)}return Wn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function D_(e,t,n=1){const s=C(e,"predictions","inTopK"),r=C(t,"targets","inTopK");A(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),A(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Mn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=s.shape[s.shape.length-1];A(n>0&&n<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`);const o=await s.data(),i=await r.data(),[u,c]=[o.length/a,a],l=pn("bool",u);for(let f=0;f<u;f++){const d=f*c,m=o.subarray(d,d+c),g=[];for(let w=0;w<m.length;w++)g.push({value:m[w],index:w});g.sort((w,b)=>b.value-w.value),l[f]=0;for(let w=0;w<n;w++)if(g[w].index===i[f]){l[f]=1;break}}return e!==s&&s.dispose(),t!==r&&r.dispose(),hs(l,r.shape,"bool")}const O_=D_;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_(e,t,n,s,r,a="NHWC",o){let i=e;e.rank===3&&(i=pt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=pt(t,[1,t.shape[0],t.shape[1],t.shape[2]])),A(i.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`),A(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),A(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=a==="NHWC"?i.shape[3]:i.shape[1],l=a==="NHWC"?u.shape[3]:u.shape[1];A(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),A(l===n[3],()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${n[3]}).`),ts("conv2dDerFilter",r,o);const f={x:i,dy:u},d={strides:s,pad:r,dataFormat:a,dimRoundingMode:o,filterShape:n};return j.runKernel(wm,f,d)}const R_=z({conv2DBackpropFilter_:F_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hh(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return Pt(e,Yy(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function dh(e,t){let n=t;const s=wx(e.shape,t.shape);return s.length>0&&(n=Te(n,s)),pt(n,e.shape)}function ph(e,t,n,s){if(t==="linear")return e;if(t==="relu")return Eu(e);if(t==="elu")return Iy(e);if(t==="relu6")return qy(e);if(t==="prelu")return jy(e,n);if(t==="leakyrelu")return Oy(e,s);if(t==="sigmoid")return ya(e);throw new Error(`Unknown fused activation ${t}.`)}const mh=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_({x:e,filter:t,strides:n,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(u=u||"linear",mh(j.state.gradientDepth,u)===!1){A(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let D=Su(e,t,n,s,r,a,o);return i!=null&&(D=Zt(D,i)),ph(D,u,c,l)}const f=C(e,"x","conv2d","float32"),d=C(t,"filter","conv2d","float32");let m=f,g=!1;f.rank===3&&(g=!0,m=pt(f,[1,f.shape[0],f.shape[1],f.shape[2]])),A(m.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${m.rank}.`),A(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),ts("fused conv2d",s,o);const w=r==="NHWC"?m.shape[3]:m.shape[1];A(d.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${d.shape[2]}.`),A(Qn(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const b=vs(m.shape,d.shape,n,a,s,o);let k;i!=null&&(k=C(i,"bias","fused conv2d"),[k]=Oe(k,f),r==="NHWC"?Fe(b.outShape,k.shape):(A(k.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${k.shape.length}.`),A(k.shape.length===0||k.shape[0]===b.outChannels||k.shape[0]===1,()=>`Error in fused conv2d: bias shape (${k.shape}) is not compatible with the number of output channels (${b.outChannels})`)));let I;if(c!=null){const D=c.shape;if(A(D.length<=1||D.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${D.length}.`),D.length===1)A(D[0]===1||D[0]===b.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${D}) is not compatible with the number of output channels (${b.outChannels}).`);else if(D.length===3)try{Fe(D,b.outShape)}catch{const L=`Error in fused conv2d: PReLU activation weights (${D}) is not compatible with the output shape of the conv2d (${b.outShape}).`;throw Error(L)}I=C(c,"prelu weights","fused conv2d")}const T=(D,P)=>{A(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[L,R,M,E]=P,K=hh(D,M,u);A(qi(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const X=Sy(R.shape,K,L,n,s),rt=R_(R,K,L.shape,n,s),nt=[X,rt];if(E!=null){const st=dh(E,K);nt.push(st)}return nt},N={x:m,filter:d,bias:k,preluActivationWeights:I},$={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o,activation:u,leakyreluAlpha:l};return i==null?Ps((P,L,R)=>{let M=j.runKernel(Uc,N,$);return R([L,P,M]),g&&(M=pt(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:T}})(m,d):Ps((P,L,R,M)=>{let E=j.runKernel(Uc,N,$);return M([L,P,E,R]),g&&(E=pt(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:T}})(m,d,k)}const M_=z({fusedConv2d_:P_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_(e,t,n,s,r,a=[1,1],o){let i=e;e.rank===3&&(i=pt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=pt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:i,dy:u},l={strides:s,pad:r,dimRoundingMode:o,dilations:a,filterShape:n};return j.runKernel($m,c,l)}const L_=z({depthwiseConv2dNativeBackpropFilter_:V_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_(e,t,n,s,r,a=[1,1],o){let i=t,u=!1;t.rank===3&&(u=!0,i=pt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:i,filter:n},l={strides:s,pad:r,dimRoundingMode:o,dilations:a,inputShape:e},f=j.runKernel(Cm,c,l);return u?pt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const B_=z({depthwiseConv2dNativeBackpropInput_:z_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W_({x:e,filter:t,strides:n,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(mh(j.state.gradientDepth,u)===!1){let $=nh(e,t,n,s,r,a,o);return i!=null&&($=Zt($,i)),ph($,u,c,l)}const f=C(e,"x","depthwiseConv2d","float32"),d=C(t,"filter","depthwiseConv2d","float32");let m=f,g=!1;f.rank===3&&(g=!0,m=pt(f,[1,f.shape[0],f.shape[1],f.shape[2]])),A(m.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`),A(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),A(m.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${m.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),a==null&&(a=[1,1]),A(Qn(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),ts("fused depthwiseConv2d",s,o);const w=vs(m.shape,d.shape,n,a,s,o,!0);let b;i!=null&&(b=C(i,"bias","fused conv2d"),[b]=Oe(b,f),Fe(w.outShape,b.shape));let k;c!=null&&(k=C(c,"prelu weights","fused depthwiseConv2d"));const I=($,D)=>{A(qi(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[P,L,R,M]=D,E=hh($,R,u),K=B_(L.shape,E,P,n,s,a,o),X=L_(L,E,P.shape,n,s,a,o);if(M!=null){const rt=dh(b,E);return[K,X,rt]}return[K,X]},T={x:m,filter:d,bias:b,preluActivationWeights:k},N={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o,activation:u,leakyreluAlpha:l};return i==null?Ps((D,P,L)=>{let R=j.runKernel(Gc,T,N);return L([P,D,R]),g&&(R=pt(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:I}})(m,d):Ps((D,P,L,R)=>{let M=j.runKernel(Gc,T,N);return R([P,D,M,L]),g&&(M=pt(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:I}})(m,d,b)}const j_=z({fusedDepthwiseConv2d_:W_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_({a:e,b:t,transposeA:n=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:i=.2}){if(mh(j.state.gradientDepth,a)===!1){let E=be(e,t,n,s);return r!=null&&(E=Zt(E,r)),ph(E,a,o,i)}let u=C(e,"a","fused matMul"),c=C(t,"b","fused matMul");[u,c]=Oe(u,c);const l=n?u.shape[u.rank-2]:u.shape[u.rank-1],f=s?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],m=s?c.shape[c.rank-2]:c.shape[c.rank-1],g=u.shape.slice(0,-2),w=c.shape.slice(0,-2),b=Nt(g),k=Nt(w);A(l===f,()=>`Error in fused matMul: inner shapes (${l}) and (${f}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const T=Fe(u.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,m]),N=n?pt(u,[b,l,d]):pt(u,[b,d,l]),$=s?pt(c,[k,m,f]):pt(c,[k,f,m]);let D;r!=null&&(D=C(r,"bias","fused matMul"),[D]=Oe(D,u),Fe(T,D.shape));let P;o!=null&&(P=C(o,"prelu weights","fused matMul"));const L=(E,K)=>{const[X,rt,nt,st]=K,it=hh(pt(E,nt.shape),nt,a);let tt,ut;if(!n&&!s?(tt=be(it,rt,!1,!0),ut=be(X,it,!0,!1)):!n&&s?(tt=be(it,rt,!1,!1),ut=be(it,X,!0,!1)):n&&!s?(tt=be(rt,it,!1,!0),ut=be(X,it,!1,!1)):(tt=be(rt,it,!0,!0),ut=be(it,X,!0,!0)),r!=null){const ht=dh(st,it);return[tt,ut,ht]}else return[tt,ut]},R={a:N,b:$,bias:D,preluActivationWeights:P},M={transposeA:n,transposeB:s,activation:a,leakyreluAlpha:i};return r==null?Ps((K,X,rt)=>{const nt=j.runKernel(Kc,R,M);return rt([K,X,nt]),{value:pt(nt,T),gradFunc:L}})(N,$):Ps((K,X,rt,nt)=>{const st=j.runKernel(Kc,R,M);return nt([K,X,st,rt]),{value:pt(st,T),gradFunc:L}})(N,$,D)}const q_=z({fusedMatMul_:H_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_=Object.freeze(Object.defineProperty({__proto__:null,conv2d:M_,depthwiseConv2d:j_,matMul:q_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_(e){return fh(e,.54,.46)}const G_=z({hammingWindow_:U_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_(e){return fh(e,.5,.5)}const eb=z({hannWindow_:Y_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_(e,t,n,s=!1,r=0){let a=0;const o=[];for(;a+t<=e.size;)o.push(ve(e,a,t)),a+=n;if(s)for(;a<e.size;){const i=a+t-e.size,u=hn([ve(e,a,t-i),Bo([i],r)]);o.push(u),a+=n}return o.length===0?lo([],[0,t]):pt(hn(o),[o.length,t])}const nb=z({frame_:X_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_(e,t,n,s,r=eb){s==null&&(s=tb(t));const a=nb(e,t,n),o=Pt(a,r(t));return uh(o,s)}const J_=z({stft_:Z_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_(e,t,n,s,r="bilinear",a=0){const o=C(e,"image","cropAndResize"),i=C(t,"boxes","cropAndResize","float32"),u=C(n,"boxInd","cropAndResize","int32"),c=i.shape[0];A(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),A(i.rank===2&&i.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${i.shape}.`),A(u.rank===1&&u.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${i.shape}.`),A(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),A(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),A(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const l={image:o,boxes:i,boxInd:u},f={method:r,extrapolationValue:a,cropSize:s};return j.runKernel(Im,l,f)}const tT=z({cropAndResize_:Q_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eT(e){const t=C(e,"image","flipLeftRight","float32");A(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return j.runKernel(Mm,n,{})}const nT=z({flipLeftRight_:eT});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sT(e){const t=C(e,"image","grayscaleToRGB"),n=t.rank-1,s=t.shape[n];A(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),A(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(t.rank);return r.fill(1,0,n),r[n]=3,co(t,r)}const rT=z({grayscaleToRGB_:sT});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aT(e){const t=C(e,"image","RGBToGrayscale"),n=t.rank-1,s=t.shape[n];A(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),A(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=t.dtype,a=Pe(t,"float32"),o=Wn([.2989,.587,.114]);let i;switch(t.rank){case 2:i=ha("ij,j->i",a,o);break;case 3:i=ha("ijk,k->ij",a,o);break;case 4:i=ha("ijkl,l->ijk",a,o);break;case 5:i=ha("ijklm,m->ijkl",a,o);break;case 6:i=ha("ijklmn,n->ijklm",a,o);break;default:throw new Error("Not a valid tensor rank.")}return i=Ts(i,-1),Pe(i,r)}const oT=z({rgbToGrayscale_:aT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iT(e,t,n=0,s=.5){const r=C(e,"image","rotateWithOffset","float32");A(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},o={radians:t,fillValue:n,center:s};return j.runKernel(jg,a,o)}const uT=z({rotateWithOffset_:iT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function za(e,t,n,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const o=e.shape[0];return n=Math.min(n,o),A(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),A(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),A(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),A(t.rank===1,()=>"scores must be a 1D tensor"),A(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),A(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=C(e,"boxes","nonMaxSuppression","float32"),o=C(t,"scores","nonMaxSuppression","float32"),i=za(a,o,n,s,r);n=i.maxOutputSize,s=i.iouThreshold,r=i.scoreThreshold;const u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return j.runKernel(eg,{boxes:a,scores:o},u)}const lT=z({nonMaxSuppression_:cT});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(e,t,n){const s=hT(e,t,n),r=s<0?-(s+1):s;e.splice(r,0,t)}function hT(e,t,n){return pT(e,t,n||dT)}function dT(e,t){return e>t?1:e<t?-1:0}function pT(e,t,n){let s=0,r=e.length,a=0,o=!1;for(;s<r;){a=s+(r-s>>>1);const i=n(t,e[a]);i>0?s=a+1:(r=a,o=!i)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sb(e,t,n,s,r){return gh(e,t,n,s,r,0)}function rb(e,t,n,s,r,a){return gh(e,t,n,s,r,0,!1,a,!0)}function ab(e,t,n,s,r,a){return gh(e,t,n,s,r,a,!0)}function gh(e,t,n,s,r,a,o=!1,i=!1,u=!1){const c=[];for(let b=0;b<t.length;b++)t[b]>r&&c.push({score:t[b],boxIndex:b,suppressBeginIndex:0});c.sort(Gd);const l=a>0?-.5/a:0,f=[],d=[];for(;f.length<n&&c.length>0;){const b=c.pop(),{score:k,boxIndex:I,suppressBeginIndex:T}=b;if(k<r)break;let N=!1;for(let $=f.length-1;$>=T;--$){const D=mT(e,I,f[$]);if(D>=s){N=!0;break}if(b.score=b.score*gT(s,l,D),b.score<=r)break}b.suppressBeginIndex=f.length,N||(b.score===k?(f.push(I),d.push(b.score)):b.score>r&&fT(c,b,Gd))}const m=f.length,g=n-m;i&&g>0&&(f.push(...new Array(g).fill(0)),d.push(...new Array(g).fill(0)));const w={selectedIndices:f};return o&&(w.selectedScores=d),u&&(w.validOutputs=m),w}function mT(e,t,n){const s=e.subarray(t*4,t*4+4),r=e.subarray(n*4,n*4+4),a=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),i=Math.max(s[0],s[2]),u=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),l=Math.min(r[1],r[3]),f=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),m=(i-a)*(u-o),g=(f-c)*(d-l);if(m<=0||g<=0)return 0;const w=Math.max(a,c),b=Math.max(o,l),k=Math.min(i,f),I=Math.min(u,d),T=Math.max(k-w,0)*Math.max(I-b,0);return T/(m+g-T)}function gT(e,t,n){const s=Math.exp(t*n*n);return n<=e?s:0}function Gd(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=C(e,"boxes","nonMaxSuppressionAsync"),o=C(t,"scores","nonMaxSuppressionAsync"),i=za(a,o,n,s,r);n=i.maxOutputSize,s=i.iouThreshold,r=i.scoreThreshold;const u=await Promise.all([a.data(),o.data()]),c=u[0],l=u[1],{selectedIndices:f}=sb(c,l,n,s,r);return a!==e&&a.dispose(),o!==t&&o.dispose(),Wn(f,"int32")}const bT=yT;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const o=C(e,"boxes","nonMaxSuppression"),i=C(t,"scores","nonMaxSuppression"),u=za(o,i,n,s,r,a);n=u.maxOutputSize,s=u.iouThreshold,r=u.scoreThreshold,a=u.softNmsSigma;const c={boxes:o,scores:i},l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},f=j.runKernel(sg,c,l);return{selectedIndices:f[0],selectedScores:f[1]}}const vT=z({nonMaxSuppressionWithScore_:wT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function kT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const o=C(e,"boxes","nonMaxSuppressionAsync"),i=C(t,"scores","nonMaxSuppressionAsync"),u=za(o,i,n,s,r,a);n=u.maxOutputSize,s=u.iouThreshold,r=u.scoreThreshold,a=u.softNmsSigma;const c=await Promise.all([o.data(),i.data()]),l=c[0],f=c[1],{selectedIndices:d,selectedScores:m}=ab(l,f,n,s,r,a);return o!==e&&o.dispose(),i!==t&&i.dispose(),{selectedIndices:Wn(d,"int32"),selectedScores:Wn(m)}}const xT=kT;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const o=C(e,"boxes","nonMaxSuppression"),i=C(t,"scores","nonMaxSuppression"),u=za(o,i,n,s,r,null),c=u.maxOutputSize,l=u.iouThreshold,f=u.scoreThreshold,d={boxes:o,scores:i},m={maxOutputSize:c,iouThreshold:l,scoreThreshold:f,padToMaxOutputSize:a},g=j.runKernel(ng,d,m);return{selectedIndices:g[0],validOutputs:g[1]}}const NT=z({nonMaxSuppressionPadded_:ST});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function IT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const o=C(e,"boxes","nonMaxSuppressionAsync"),i=C(t,"scores","nonMaxSuppressionAsync"),u=za(o,i,n,s,r,null),c=u.maxOutputSize,l=u.iouThreshold,f=u.scoreThreshold,[d,m]=await Promise.all([o.data(),i.data()]),{selectedIndices:g,validOutputs:w}=rb(d,m,c,l,f,a);return o!==e&&o.dispose(),i!==t&&i.dispose(),{selectedIndices:Wn(g,"int32"),validOutputs:fe(w,"int32")}}const _T=IT;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TT(e,t,n=!1,s=!1){const r=C(e,"images","resizeBilinear");A(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),A(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),A(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,o=!1;r.rank===3&&(o=!0,a=pt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const i={images:a},u={alignCorners:n,halfPixelCenters:s,size:t},c=j.runKernel(yg,i,u);return o?pt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const ET=z({resizeBilinear_:TT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $T(e,t,n=!1,s=!1){const r=C(e,"images","resizeNearestNeighbor");A(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),A(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),A(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),A(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,o=!1;r.rank===3&&(o=!0,a=pt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const i={images:a},u={alignCorners:n,halfPixelCenters:s,size:t},c=j.runKernel(gg,i,u);return o?pt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const CT=z({resizeNearestNeighbor_:$T});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AT(e,t="binary",n=!1,s=.5){const r=C(e,"image","threshold"),a=.2989,o=.587,i=.114,u=r.shape[0]*r.shape[1];let c=Pt(Wn([s]),255),l,f,d,m;if(A(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),A(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),A(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),A(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),r.shape[2]===3){[l,f,d]=Co(r,[1,1,1],-1);const b=Pt(l,a),k=Pt(f,o),I=Pt(d,i);m=Zt(Zt(b,k),I)}else m=e;if(t==="otsu"){const b=xy(Pe(Ky(m),"int32"),hs([]),256);c=DT(b,u)}const g=n?sh(m,c):Iu(m,c);return Pe(Pt(g,255),"int32")}function DT(e,t){let n=Wn([-1]),s=Wn([0]),r=Wn([0]),a,o,i,u,c,l;for(let f=0;f<e.size-1;f++){a=ve(e,0,f+1),o=ve(e,f+1),c=xe(Te(a),t),l=xe(Te(o),t);const d=Te(Pt(a,Eo(0,a.size)));i=xe(d,Te(a));const m=Bo(o.shape,a.size),g=Zt(Eo(0,o.size),m),w=Pt(o,g);u=xe(Te(w),Te(o));const b=oe(i,u),k=oe(i,u),I=Pt(c,l);r=Pt(Pt(I,b),k);const T=Iu(r,s);s=ir(T,r,s),n=ir(T,Wn([f]),n)}return n}const OT=z({threshold_:AT});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FT(e,t,n="nearest",s="constant",r=0,a){const o=C(e,"image","transform","float32"),i=C(t,"transforms","transform","float32");A(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),A(i.rank===2&&(i.shape[0]===o.shape[0]||i.shape[0]===1)&&i.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),A(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const u={image:o,transforms:i},c={interpolation:n,fillMode:s,fillValue:r,outputShape:a};return j.runKernel(Vg,u,c)}const RT=z({transform_:FT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PT(e,t,n){const s=C(e,"a","bandPart");A(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,o]=s.shape.slice(-2);let i,u;typeof t=="number"?(A(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),A(t<=a,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`),i=C(t<0?a:t,"numLower","bandPart")):(A(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),i=ir(ul(t,0),a,Yi(t,a))),typeof n=="number"?(A(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),A(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),u=C(n<0?o:n,"numUpper","bandPart")):(A(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=ir(ul(n,0),o,Yi(n,o)));const c=pt(Eo(0,a,1,"int32"),[-1,1]),l=Eo(0,o,1,"int32"),f=oe(c,l),d=Ui(sh(f,i),Dy(f,ds(u))),m=Ta([a,o],s.dtype);return pt(Ms(Jr(pt(s,[-1,a,o])).map(g=>ir(d,g,m))),r)}const MT=z({bandPart_:PT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VT(e){let t;if(Array.isArray(e)){t=!1,A(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=e[0].shape[0];for(let a=1;a<e.length;++a)A(e[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[a].shape[0]} vs. ${r})`)}else t=!0,e=Co(e,e.shape[0],0).map(r=>ch(r,[0]));A(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],s=e;for(let r=0;r<e.length;++r)n.push(j.tidy(()=>{let a=s[r];if(r>0)for(let o=0;o<r;++o){const i=Pt(Te(Pt(n[o],a)),n[o]);a=oe(a,i)}return xe(a,Nu(a,"euclidean"))}));return t?Ms(n,0):n}const LT=z({gramSchmidt_:VT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zT(e,t=!1){if(A(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return Yd(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((u,c)=>u*c),s=Jr(pt(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],a=[];s.forEach(u=>{const[c,l]=Yd(u,t);r.push(c),a.push(l)});const o=pt(Ms(r,0),e.shape),i=pt(Ms(a,0),e.shape);return[o,i]}}function Yd(e,t=!1){return j.tidy(()=>{A(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],s=e.shape[1];let r=$y(n),a=or(e);const o=lo([[1]],[1,1]);let i=or(o);const u=n>=s?s:n;for(let c=0;c<u;++c){const l=a,f=i,d=r;[i,a,r]=j.tidy(()=>{const m=ve(a,[c,c],[n-c,1]),g=Nu(m),w=ve(a,[c,c],[1,1]),b=ir(Iu(w,0),lo([[-1]]),lo([[1]])),k=oe(w,Pt(b,g)),I=xe(m,k);I.shape[0]===1?i=or(o):i=hn([o,ve(I,[1,0],[I.shape[0]-1,I.shape[1]])],0);const T=ds(xe(be(b,k),g)),N=ve(a,[c,0],[n-c,s]),$=Pt(T,i),D=cl(i);if(c===0)a=oe(N,be($,be(D,N)));else{const R=oe(N,be($,be(D,N)));a=hn([ve(a,[0,0],[c,s]),R],0)}const P=cl($),L=ve(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=oe(L,be(be(L,i),P));else{const R=oe(L,be(be(L,i),P));r=hn([ve(r,[0,0],[n,c]),R],1)}return[i,a,r]}),Sn([l,f,d])}return!t&&n>s&&(r=ve(r,[0,0],[n,s]),a=ve(a,[0,0],[s,s])),[r,a]})}const BT=z({qr_:zT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var vn;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(vn||(vn={}));function WT(e,t,n=vn.SUM_BY_NONZERO_WEIGHTS){const s=C(e,"losses","computeWeightedLoss");let r=null;t!=null&&(r=C(t,"weights","computeWeightedLoss"));const a=r==null?s:Pt(s,r);if(n===vn.NONE)return a;if(n===vn.SUM)return Te(a);if(n===vn.MEAN){if(r==null)return Gi(a);{const o=s.size/r.size,i=xe(Te(a),Te(r));return o>1?xe(i,fe(o)):i}}if(n===vn.SUM_BY_NONZERO_WEIGHTS){if(r==null)return xe(Te(a),fe(s.size));{const o=Pt(r,Pr(s.shape)),i=Pe(Te(By(o,fe(0))),"float32");return xe(Te(a),i)}}throw Error(`Unknown reduction: ${n}`)}const Ws=z({computeWeightedLoss_:WT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jT(e,t,n,s=vn.SUM_BY_NONZERO_WEIGHTS){const r=C(e,"labels","absoluteDifference"),a=C(t,"predictions","absoluteDifference");let o=null;n!=null&&(o=C(n,"weights","absoluteDifference")),Mn(r.shape,a.shape,"Error in absoluteDifference: ");const i=Fn(oe(r,a));return Ws(i,o,s)}const HT=z({absoluteDifference_:jT});function qT(e,t,n,s,r=vn.SUM_BY_NONZERO_WEIGHTS){const a=C(e,"labels","cosineDistance"),o=C(t,"predictions","cosineDistance");let i=null;s!=null&&(i=C(s,"weights","cosineDistance")),Mn(a.shape,o.shape,"Error in cosineDistance: ");const u=fe(1),c=oe(u,Te(Pt(a,o),n,!0));return Ws(c,i,r)}const KT=z({cosineDistance_:qT});function UT(e,t,n,s=vn.SUM_BY_NONZERO_WEIGHTS){let r=C(e,"labels","hingeLoss");const a=C(t,"predictions","hingeLoss");let o=null;n!=null&&(o=C(n,"weights","hingeLoss")),Mn(r.shape,a.shape,"Error in hingeLoss: ");const i=fe(1);r=oe(Pt(fe(2),r),i);const u=Eu(oe(i,Pt(r,a)));return Ws(u,o,s)}const GT=z({hingeLoss_:UT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YT(e,t,n,s=1,r=vn.SUM_BY_NONZERO_WEIGHTS){const a=C(e,"labels","huberLoss"),o=C(t,"predictions","huberLoss");let i=null;n!=null&&(i=C(n,"weights","huberLoss")),Mn(a.shape,o.shape,"Error in huberLoss: ");const u=fe(s),c=Fn(oe(o,a)),l=Yi(c,u),f=oe(c,l),d=Zt(Pt(fe(.5),Xn(l)),Pt(u,f));return Ws(d,i,r)}const XT=z({huberLoss_:YT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZT(e,t,n,s=1e-7,r=vn.SUM_BY_NONZERO_WEIGHTS){const a=C(e,"labels","logLoss"),o=C(t,"predictions","logLoss");let i=null;n!=null&&(i=C(n,"weights","logLoss")),Mn(a.shape,o.shape,"Error in logLoss: ");const u=fe(1),c=fe(s),l=ds(Pt(a,To(Zt(o,c)))),f=Pt(oe(u,a),To(Zt(oe(u,o),c))),d=oe(l,f);return Ws(d,i,r)}const JT=z({logLoss_:ZT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QT(e,t,n,s=vn.SUM_BY_NONZERO_WEIGHTS){const r=C(e,"labels","meanSquaredError"),a=C(t,"predictions","meanSquaredError");let o=null;n!=null&&(o=C(n,"weights","meanSquaredError")),Mn(r.shape,a.shape,"Error in meanSquaredError: ");const i=Gy(r,a);return Ws(i,o,s)}const tE=z({meanSquaredError_:QT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eE(e,t){const n=C(e,"labels","sigmoidCrossEntropyWithLogits"),s=C(t,"logits","sigmoidCrossEntropyWithLogits");Mn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Eu(s),a=Pt(s,n),o=Fy(Hr(ds(Fn(s))));return Zt(oe(r,a),o)}function nE(e,t,n,s=0,r=vn.SUM_BY_NONZERO_WEIGHTS){let a=C(e,"multiClassLabels","sigmoidCrossEntropy");const o=C(t,"logits","sigmoidCrossEntropy");let i=null;if(n!=null&&(i=C(n,"weights","sigmoidCrossEntropy")),Mn(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=fe(s),l=fe(1),f=fe(.5);a=Zt(Pt(a,oe(l,c)),Pt(f,c))}const u=eE(a,o);return Ws(u,i,r)}const sE=z({sigmoidCrossEntropy_:nE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rE(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Ps((r,a,o)=>{const u=Py(a,[n],!0),c=oe(Pe(a,"float32"),u);o([r,c]);const l=ds(Pt(c,r));return{value:Te(l,[n]),gradFunc:(m,g)=>{const[w,b]=g,k=es(m.shape,[n]);return[Pt(pt(m,k),oe(Pe(w,"float32"),Hr(b))),Pt(pt(m,k),oe(Hr(b),Pe(w,"float32")))]}}})(e,t)}function aE(e,t,n,s=0,r=vn.SUM_BY_NONZERO_WEIGHTS){let a=C(e,"onehotLabels","softmaxCrossEntropy");const o=C(t,"logits","softmaxCrossEntropy");let i=null;if(n!=null&&(i=C(n,"weights","softmaxCrossEntropy")),Mn(a.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const c=fe(s),l=fe(1),f=fe(a.shape[1]);a=Zt(Pt(a,oe(l,c)),xe(c,f))}const u=rE(a,o);return Ws(u,i,r)}const oE=z({softmaxCrossEntropy_:aE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iE(e,t,n,s){const r=C(e,"indices","sparseFillEmptyRows","int32"),a=C(t,"values","sparseFillEmptyRows"),o=C(n,"denseShape","sparseFillEmptyRows","int32"),i=C(s,"defaultValue","sparseFillEmptyRows",a.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(i.rank!==0)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const u={indices:r,values:a,denseShape:o,defaultValue:i},c=j.runKernel(Eg,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const uE=z({sparseFillEmptyRows_:iE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cE(e,t,n){const s=C(e,"inputIndices","sparseReshape","int32"),r=C(t,"inputShape","sparseReshape","int32"),a=C(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const o={inputIndices:s,inputShape:r,newShape:a},i=j.runKernel($g,o);return{outputIndices:i[0],outputShape:i[1]}}const lE=z({sparseReshape_:cE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fE(e,t,n){const s=C(e,"data","sparseSegmentMean"),r=C(t,"indices","sparseSegmentMean","int32"),a=C(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const o={data:s,indices:r,segmentIds:a};return j.runKernel(Cg,o)}const hE=z({sparseSegmentMean_:fE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dE(e,t,n){const s=C(e,"data","sparseSegmentSum"),r=C(t,"indices","sparseSegmentSum","int32"),a=C(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const o={data:s,indices:r,segmentIds:a};return j.runKernel(Ag,o)}const pE=z({sparseSegmentSum_:dE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mE(e,t,n,s,r,a,o,i){const u=C(e,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const c=C(t,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:s,leftPad:r,rightPad:a,padWidth:o,preserveShortSequences:i},f={data:u,dataSplits:c},d=j.runKernel(Fg,f,l);return{nGrams:d[0],nGramsSplits:d[1]}}const gE=z({stringNGrams_:mE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yE(e,t,n=!0){const s=C(e,"input","stringSplit","string"),r=C(t,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const a={skipEmpty:n},o={input:s,delimiter:r},i=j.runKernel(Rg,o,a);return{indices:i[0],values:i[1],shape:i[2]}}const bE=z({stringSplit_:yE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wE(e,t){const n=C(e,"input","stringToHashBucketFast","string"),s={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return j.runKernel(Pg,r,s)}const vE=z({stringToHashBucketFast_:wE});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kE(e,t,n,s=!0){const r=C(e,"input","staticRegexReplace","string"),a={pattern:t,rewrite:n,replaceGlobal:s};return j.runKernel(Kf,{x:r},a)}const xE=z({staticRegexReplace_:kE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SE={fft:ih,ifft:Xi,rfft:uh,irfft:Uy},NE={hammingWindow:G_,hannWindow:eb,frame:nb,stft:J_},IE={flipLeftRight:nT,grayscaleToRGB:rT,resizeNearestNeighbor:CT,resizeBilinear:ET,rgbToGrayscale:oT,rotateWithOffset:uT,cropAndResize:tT,nonMaxSuppression:lT,nonMaxSuppressionAsync:bT,nonMaxSuppressionWithScore:vT,nonMaxSuppressionWithScoreAsync:xT,nonMaxSuppressionPadded:NT,nonMaxSuppressionPaddedAsync:_T,threshold:OT,transform:RT},_E={bandPart:MT,gramSchmidt:LT,qr:BT},TE={absoluteDifference:HT,computeWeightedLoss:Ws,cosineDistance:KT,hingeLoss:GT,huberLoss:XT,logLoss:JT,meanSquaredError:tE,sigmoidCrossEntropy:sE,softmaxCrossEntropy:oE},EE={sparseFillEmptyRows:uE,sparseReshape:lE,sparseSegmentMean:hE,sparseSegmentSum:pE},$E={stringNGrams:gE,stringSplit:bE,stringToHashBucketFast:vE,staticRegexReplace:xE};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CE=new Map,AE=new Map;class DE{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Or{constructor(){this.classNameMap={}}static getMap(){return Or.instance==null&&(Or.instance=new Or),Or.instance}static register(t){Or.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function OE(e,t,n){A(e.className!=null,()=>"Class being registered does not have the static className property defined."),A(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),A(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const s=n,r=t+">"+s;return Or.register(e),CE.set(r,e),AE.set(e,r),e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qr extends DE{minimize(t,n=!1,s){const{value:r,grads:a}=this.computeGradients(t,s);if(s!=null){const o=s.map(i=>({name:i.name,tensor:a[i.name]}));this.applyGradients(o)}else this.applyGradients(a);return Sn(a),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return pS(t,n)}dispose(){this.iterations_!=null&&Sn(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:fe(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Qr,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FE extends Qr{static get className(){return"Adadelta"}constructor(t,n,s=null){super(),this.learningRate=t,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=j.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=j.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:de(()=>Pn(a).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:de(()=>Pn(a).variable(o))});const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const u=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;de(()=>{const l=Zt(Pt(u,this.rho),Pt(Xn(i),1-this.rho)),f=Pt(xe(Rs(Zt(c,this.epsilon)),Rs(Zt(u,this.epsilon))),i),d=Zt(Pt(c,this.rho),Pt(Xn(f),1-this.rho));u.assign(l),c.assign(d);const m=Zt(Pt(f,-this.learningRate),a);a.assign(m)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Sn(this.accumulatedGrads.map(t=>t.variable)),Sn(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RE extends Qr{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=j.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:de(()=>Bo(a.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[r].tensor:t[s];if(o==null)return;const i=this.accumulatedGrads[r].variable;de(()=>{const u=Zt(i,Xn(o));i.assign(u);const c=Zt(Pt(xe(o,Rs(Zt(u,j.backend.epsilon()))),-this.learningRate),a);a.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Sn(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PE extends Qr{static get className(){return"Adam"}constructor(t,n,s,r=null){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],de(()=>{this.accBeta1=fe(n).variable(),this.accBeta2=fe(s).variable()}),r==null&&(this.epsilon=j.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);de(()=>{const s=oe(1,this.accBeta1),r=oe(1,this.accBeta2);n.forEach((a,o)=>{const i=j.registeredVariables[a],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:de(()=>Pn(i).variable(u))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${a}/v`,variable:de(()=>Pn(i).variable(u))});const c=Array.isArray(t)?t[o].tensor:t[a];if(c==null)return;const l=this.accumulatedFirstMoment[o].variable,f=this.accumulatedSecondMoment[o].variable,d=Zt(Pt(l,this.beta1),Pt(c,1-this.beta1)),m=Zt(Pt(f,this.beta2),Pt(Xn(c),1-this.beta2)),g=xe(d,s),w=xe(m,r);l.assign(d),f.assign(m);const b=Zt(Pt(xe(g,Zt(Rs(w),this.epsilon)),-this.learningRate),i);i.assign(b)}),this.accBeta1.assign(Pt(this.accBeta1,this.beta1)),this.accBeta2.assign(Pt(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Sn(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&Sn(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),de(()=>{this.accBeta1.assign(_o(this.beta1,this.iterations_+1)),this.accBeta2.assign(_o(this.beta2,this.iterations_+1))});const n=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ME extends Qr{static get className(){return"Adamax"}constructor(t,n,s,r=null,a=0){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],de(()=>{this.iteration=fe(0).variable(),this.accBeta1=fe(n).variable()}),r==null&&(this.epsilon=j.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);de(()=>{const s=oe(1,this.accBeta1),r=xe(-this.learningRate,Zt(Pt(this.iteration,this.decay),1));n.forEach((a,o)=>{const i=j.registeredVariables[a],u=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:Pn(i).variable(u)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${a}/v`,variable:Pn(i).variable(u)});const c=Array.isArray(t)?t[o].tensor:t[a];if(c==null)return;const l=this.accumulatedFirstMoment[o].variable,f=this.accumulatedWeightedInfNorm[o].variable,d=Zt(Pt(l,this.beta1),Pt(c,1-this.beta1)),m=Pt(f,this.beta2),g=Fn(c),w=zy(m,g);l.assign(d),f.assign(w);const b=Zt(Pt(xe(r,s),xe(d,Zt(w,this.epsilon))),i);i.assign(b)}),this.iteration.assign(Zt(this.iteration,1)),this.accBeta1.assign(Pt(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Sn(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&Sn(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ob extends Qr{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const o=j.registeredVariables[s];de(()=>{const i=Zt(Pt(this.c,a),o);o.assign(i)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=ls(fe(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VE extends ob{static get className(){return"Momentum"}constructor(t,n,s=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=fe(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=j.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:de(()=>Pn(a).variable(!1))});const o=this.accumulations[r].variable,i=Array.isArray(t)?t[r].tensor:t[s];i!=null&&de(()=>{let u;const c=Zt(Pt(this.m,o),i);this.useNesterov?u=Zt(Pt(this.c,Zt(i,Pt(c,this.m))),a):u=Zt(Pt(this.c,c),a),o.assign(c),a.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Sn(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LE extends Qr{static get className(){return"RMSProp"}constructor(t,n=.9,s=0,r=null,a=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=j.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=j.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:de(()=>Pn(a).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:de(()=>Pn(a).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:de(()=>Pn(a).variable(o))});const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const u=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;de(()=>{const l=Zt(Pt(u,this.decay),Pt(Xn(i),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[r].variable,d=Zt(Pt(f,this.decay),Pt(i,1-this.decay)),m=xe(Pt(i,this.learningRate),Rs(oe(l,Zt(Xn(d),this.epsilon)))),g=Zt(Pt(c,this.momentum),m);u.assign(l),f.assign(d),c.assign(g);const w=oe(a,g);a.assign(w)}else{const f=Zt(Pt(u,this.decay),Pt(Xn(i),1-this.decay)),d=Zt(Pt(c,this.momentum),xe(Pt(i,this.learningRate),Rs(Zt(f,this.epsilon))));u.assign(f),c.assign(d);const m=oe(a,d);a.assign(m)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Sn(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Sn(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&Sn(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zE=[FE,RE,PE,ME,VE,LE,ob];function BE(){for(const e of zE)OE(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WE="model",jE=".json",HE=".weights.bin";function Xd(e){return new Promise(t=>setTimeout(t)).then(e)}class Kr{constructor(t){if(!ie().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Kr.URL_SCHEME)&&(t=t.slice(Kr.URL_SCHEME.length)),(t==null||t.length===0)&&(t=WE),this.modelJsonFileName=t+jE,this.weightDataFileName=t+HE}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Jn.join(t.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a=uy(t,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=o,await Xd(()=>i.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=s,await Xd(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:zo(t)}}}}Kr.URL_SCHEME="downloads://";class qE{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,n)=>{const s=new FileReader;s.onload=r=>{const a=JSON.parse(r.target.result),o=a.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:o});return}const u=th(a,c=>this.loadWeights(c));t(u)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(t){const n=[],s=[];for(const o of t)n.push(...o.weights),s.push(...o.paths);const r=this.checkManifestAndWeightFiles(t),a=s.map(o=>this.loadWeightsFile(o,r[o]));return Promise.all(a).then(o=>[n,o])}loadWeightsFile(t,n){return new Promise((s,r)=>{const a=new FileReader;a.onload=o=>{const i=o.target.result;s(i)},a.onerror=o=>r(`Failed to weights data from file of path '${t}'.`),a.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){const n=[],s=this.weightsFiles.map(a=>Ld(a.name)),r={};for(const a of t)a.paths.forEach(o=>{const i=Ld(o);if(n.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(n.push(i),s.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);r[o]=this.weightsFiles[s.indexOf(i)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const KE=e=>ie().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Kr.URL_SCHEME)?UE(e.slice(Kr.URL_SCHEME.length)):null;Ae.registerSaveRouter(KE);function UE(e="model"){return new Kr(e)}function GE(e){return new qE(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zd(e,t,n,s){o(e),n=n??0,s=s??1,i(n,s);let r=0;const a=u=>(u.then(c=>{const l=n+ ++r/e.length*(s-n);return t(l),c}),u);function o(u){A(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function i(u,c){A(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),A(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),A(c>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${c}`)}return Promise.all(e.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ib(e,t){t==null&&(t={});const n=t.fetchFunc==null?ie().platform.fetch:t.fetchFunc,s=e.map(f=>n(f,t.requestInit,{isBinary:!0})),i=(t.onProgress==null?await Promise.all(s):await Zd(s,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?await Promise.all(i):await Zd(i,t.onProgress,.5,1)}function YE(e,t){var n;const s=t.fetchFunc==null?ie().platform.fetch:t.fetchFunc;let r=0,a;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:async o=>{for(var i;r<e.length;){a||(a=(await s(e[r],t.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:c}=await a.read();if(u){r++,a=void 0,(i=t.onProgress)===null||i===void 0||i.call(t,r/e.length);continue}o.enqueue(c);return}o.close()}})}async function XE(e,t="",n,s){return ub(o=>ib(o,{requestInit:s}))(e,t,n)}function ub(e){return async(t,n="",s)=>{const r=t.map(()=>!1),a={},o=s!=null?s.map(()=>!1):[],i=[];if(t.forEach((m,g)=>{let w=0;m.weights.forEach(b=>{const k="quantization"in b?b.quantization.dtype:b.dtype,I=Br[k]*Nt(b.shape),T=()=>{r[g]=!0,a[g]==null&&(a[g]=[]),a[g].push({manifestEntry:b,groupOffset:w,sizeBytes:I})};s!=null?s.forEach((N,$)=>{N===b.name&&(T(),o[$]=!0)}):T(),i.push(b.name),w+=I})}),!o.every(m=>m)){const m=s.filter((g,w)=>!o[w]);throw new Error(`Could not find weights in manifest with names: ${m.join(", ")}. 
Manifest JSON has weights with names: ${i.join(", ")}.`)}const u=r.reduce((m,g,w)=>(g&&m.push(w),m),[]),c=[];u.forEach(m=>{t[m].paths.forEach(g=>{const w=n+(n.endsWith("/")?"":"/")+g;c.push(w)})});const l=await e(c),f={};let d=0;return u.forEach(m=>{const g=t[m].paths.length,w=new Jn(l.slice(d,d+g));a[m].forEach(k=>{const I=w.slice(k.groupOffset,k.groupOffset+k.sizeBytes),T=ay(I,[k.manifestEntry]);for(const N in T)f[N]=T[N]}),d+=g}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZE="application/octet-stream",JE="application/json";class yh{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(A(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ie().platform.fetch,A(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&A(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=uy(t,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:JE}),"model.json"),t.weightData!=null){const o=Jn.join(t.weightData);n.body.append("model.weights.bin",new Blob([o],{type:ZE}),"model.weights.bin")}const a=await this.fetch(this.path,n);if(a.ok)return{modelArtifactsInfo:zo(t),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return th(t,n=>this.loadWeights(n))}async loadStream(){const t=await this.loadModelJSON(),n=await this.getWeightUrls(t.weightsManifest),s=el(t.weightsManifest),r=()=>YE(n,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=QE(n),a=this.weightPathPrefix||s,o=[],i=[];for(const u of t)for(const c of u.paths)this.weightUrlConverter!=null?i.push(this.weightUrlConverter(c)):o.push(a+c+r);return this.weightUrlConverter&&o.push(...await Promise.all(i)),o}async loadWeights(t){const n=await this.getWeightUrls(t),s=el(t),r=await ib(n,this.loadOptions);return[s,r]}}yh.URL_SCHEME_REGEX=/^https?:\/\//;function QE(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),s=e.substring(0,t),r=n>t?e.substring(n):"";return[s+"/",r]}function ll(e){return e.match(yh.URL_SCHEME_REGEX)!=null}const cb=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(s=>ll(s)):n=ll(e),n)return bh(e,t)}return null};Ae.registerSaveRouter(cb);Ae.registerLoadRouter(cb);function bh(e,t){return new yh(e,t)}function t2(e,t){return bh(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cc{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class lb{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class e2{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}function n2(e,t,n,s){const r=arguments;return new e2(fb(...r))}function fb(e,t,n,s){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new Cc(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Cc({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Cc({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:s}))}function s2(e){return new lb(e)}function r2(e){return new lb(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hb=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Jn,browserFiles:GE,browserHTTPRequest:t2,concatenateArrayBuffers:Zv,copyModel:w1,decodeWeights:ay,decodeWeightsStream:iy,encodeWeights:qv,fromMemory:n2,fromMemorySync:fb,getLoadHandlers:a1,getModelArtifactsForJSON:th,getModelArtifactsForJSONSync:cy,getModelArtifactsInfoForJSON:zo,getSaveHandlers:r1,getWeightSpecs:el,http:bh,isHTTPScheme:ll,listModels:y1,loadWeights:XE,moveModel:v1,registerLoadRouter:s1,registerSaveRouter:n1,removeModel:b1,weightsLoaderFactory:ub,withSaveHandler:s2,withSaveHandlerSync:r2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _r;function a2(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,a=!1,o=!1,i=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)a=!0;else if(e.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)i=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(Yc(_d,j.backendName)!=null){const g={pixels:e},w={numChannels:t};return j.runKernel(_d,g,w)}const[c,l]=r?[e.videoWidth,e.videoHeight]:[e.width,e.height];let f;if(o)f=e.getContext("2d").getImageData(0,0,c,l).data;else if(s||n)f=e.data;else if(a||r||i){if(_r==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")_r=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else _r=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});_r.canvas.width=c,_r.canvas.height=l,_r.drawImage(e,0,0,c,l),f=_r.getImageData(0,0,c,l).data}let d;if(t===4)d=new Int32Array(f);else{const g=c*l;d=new Int32Array(g*t);for(let w=0;w<g;w++)for(let b=0;b<t;++b)d[w*t+b]=f[w*4+b]}return Xy(d,[l,c,t],"int32")}const o2=z({fromPixels_:a2});function i2(e,t){const n=e.shape.length,s=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${n}`);if(Nt(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const r=t.shape,a=r[r.length-1];let o=1;for(let f=0;f<r.length-1;++f)o*=r[f];const i=e.shape,u=r.slice();u.pop();let c=1;for(let f=a;f<n;++f)c*=i[f],u.push(i[f]);const l=[...Kt(e.shape).map(f=>f/c),1].slice(0,a);return[u,o,c,l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fl=-2,u2=-1;function c2(e,t,n){const s=e.shape.length;A(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),A(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)A(t[r]+n[r]<=e.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${t[r]+n[r]}) would overflow input.shape[${r}] (${e.shape[r]})`)}function l2(e,t,n){const s=[];for(let r=0;r<e.length;r++)s[r]=Math.ceil((t[r]-e[r])/n[r]);return s}function f2(e,t,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function h2(e,t){let n=e.length>0?e[e.length-1]:1;for(let s=0;s<e.length-1;s++)n+=e[s]*t[s];return n}function d2(e,t,n){let s;const r=e.shape.length;typeof t=="number"?s=[t,...new Array(r-1).fill(0)]:t.length<r?s=t.concat(new Array(r-t.length).fill(0)):s=t.slice(),s.forEach(o=>{A(o!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(r).fill(-1):typeof n=="number"?a=[n,...new Array(r-1).fill(-1)]:n.length<r?a=n.concat(new Array(r-n.length).fill(-1)):a=n,a=a.map((o,i)=>o>=0?o:(A(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${i}.`),e.shape[i]-s[i])),[s,a]}function p2(e,t,n,s,r,a,o,i,u){let c;if(s==null?(c=new Array(t.length),c.fill(1)):c=s,o!=null&&(o&o-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let l=!1;const f={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:a,ellipsisMask:o,newAxisMask:i,shrinkAxisMask:u};for(let T=0;T<f.dims;T++)l&&(1<<T&i)!==0&&f.numAddAxisAfterEllipsis++,1<<T&o&&(l=!0);l||(f.ellipsisMask|=1<<f.dims,f.dims++);const d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};m2(f,d);let m=!0,g=!0,w=!0;const b=[],k=[];for(let T=0;T<e.length;++T){if(d.strides[T]===0)throw Error(`strides[${T}] must be non-zero`);const N=!!(d.shrinkAxisMask&1<<T),$=e[T];if($===-1){b.push(N?1:-1);continue}const D=[d.beginMask&1<<T,d.endMask&1<<T],P=[d.strides[T]>0?0:-1,d.strides[T]>0?$:$-1];if(N&&d.strides[T]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&d.strides[T]===1;const L=!!(d.beginMask&1<<T&&d.endMask&1<<T);if(d.beginValid&&d.endValid){if(N){const K=d.begin[T]<0?$+d.begin[T]:d.begin[T];if(d.begin[T]=K,d.end[T]=d.begin[T]+1,K<0||K>=$)throw Error(`slice index ${d.begin[T]} of dimension ${T} out of bounds.`)}else d.begin[T]=Jd(d.begin[T],0,d.strides[T],$,D,P),d.end[T]=Jd(d.end[T],1,d.strides[T],$,D,P);const E=d.strides[T]===1&&d.begin[T]===0&&d.end[T]===$;m=m&&E,g=g&&(T===0&&d.strides[T]===1||E)}else m=m&&d.strides[T]===1&&L,g=g&&(T===0&&d.strides[T]===1||L);let R,M=!1;if(d.beginValid&&d.endValid?(R=d.end[T]-d.begin[T],M=!0):N?(R=1,M=!0):L&&$>=0&&(d.strides[T]<0?R=-$:R=$,M=!0),M){let E;R===0||R<0!=d.strides[T]<0?E=0:E=Math.trunc(R/d.strides[T])+(R%d.strides[T]!==0?1:0),b.push(E)}else b.push(-1)}for(let T=0;T<d.finalShapeGatherIndices.length;++T){const N=d.finalShapeGatherIndices[T];N>=0?k.push(b[N]):N===fl&&k.push(1)}return{finalShapeSparse:k.filter((T,N)=>d.finalShapeGatherIndices[N]!==fl),finalShape:k,isIdentity:m,sliceDim0:g,isSimpleSlice:w,begin:d.begin,end:d.end,strides:d.strides}}function m2(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<e.dims;s++)if(1<<s&e.ellipsisMask){const r=Math.min(t.dims-(e.dims-s)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<r;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&e.newAxisMask)t.finalShapeGatherIndices.push(fl),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[s]),e.end!=null&&(t.end[n]=e.end[s]),t.strides[n]=e.strides[s],e.beginMask&1<<s&&(t.beginMask|=1<<n),e.endMask&1<<s&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(u2),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[n]=s,n++}}function Jd(e,t,n,s,r,a){if(r[t])return n>0?a[t]:a[t+1&1];{const o=e<0?s+e:e;return o<a[0]?a[0]:o>a[1]?a[1]:o}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2(e,t){const n=e[0].length;e.forEach((r,a)=>{A(r.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),A(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=e[0];e.forEach((r,a)=>{for(let o=0;o<n;o++)A(o===t||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function Ac(e,t){const n=e[0].slice();for(let s=1;s<e.length;s++)n[t]+=e[s][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var us;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(us||(us={}));function y2(e,t,n){let s=new Array;if(n==null&&t==null)return s;if(t==null)for(;s.length<e+n.length;)s.push(-1);else s=t.slice();if(n==null)return s;if(e+n.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const a=n[r],o=s[s.length-n.length+r],i=s[o];if(a>=0)if(i>=0){if(i!==a)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${r+e}] = ${a} but shape[${r+e}] = ${i}`)}else s[o]=a}return s}function b2(e){const t={FIRST_DIM_SIZE:us.FIRST_DIM_SIZE,VALUE_ROWIDS:us.VALUE_ROWIDS,ROW_LENGTHS:us.ROW_LENGTHS,ROW_SPLITS:us.ROW_SPLITS,ROW_LIMITS:us.ROW_LIMITS,ROW_STARTS:us.ROW_STARTS},n=[];for(const s of e)if(s in t)n.push(t[s]);else break;return n}function w2(e){return e.length===0?0:e[0]===us.FIRST_DIM_SIZE?e.length-1:e.length}function v2(e,t){if(e==null||t==null)return;const n=e.length,s=t.length;if(n>=s)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const a=e[r],o=t[r+1];if(a>=0&&o>=0&&a!==1&&a!==o)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${r-e.length}] = ${a} but ragged tensor input.flatValues.shape[${r-e.length}] = ${o}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(e,t,n){const s=n*(typeof e=="number"?e:e[0]),r=t*(typeof e=="number"?e:e[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function db(e,t,n,s=!0){let r=[];if(s)r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const a=t.length;for(let o=0;o<a;++o)r=r.concat([e[o+1]/t[o],t[o]]);r=r.concat(e.slice(a+1))}return r}function pb(e,t,n=!0){const s=[];if(n){s.push(t);for(let r=t+1;r<e;++r)r<=2*t?(s.push(r),s.push(r-(t+1))):s.push(r)}else{const r=[],a=[];for(let o=1;o<e;++o)o>=t*2+1||o%2===1?a.push(o):r.push(o);s.push(...r),s.push(0),s.push(...a)}return s}function mb(e,t,n,s=!0){const r=[];s?r.push(e[0]/n):r.push(e[0]*n);for(let a=1;a<e.length;++a)a<=t.length?s?r.push(t[a-1]*e[a]):r.push(e[a]/t[a-1]):r.push(e[a]);return r}function x2(e,t){const n=[0];for(let s=0;s<t;++s)n.push(e[s][0]);return n}function S2(e,t,n){const s=e.slice(0,1);for(let r=0;r<n;++r)s.push(e[r+1]-t[r][0]-t[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N2=1.7580993408473768,I2=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _2=.3275911,T2=.254829592,E2=-.284496736,$2=1.421413741,C2=-1.453152027,A2=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ea(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let s=0;s<n.length;s+=2)n[s]=e[s/2],n[s+1]=t[s/2];return n}function D2(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let s=0;s<e.length;s+=2)t[s/2]=e[s],n[s/2]=e[s+1];return{real:t,imag:n}}function O2(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=0;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function F2(e){const t=Math.floor(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=2;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function gb(e,t){const n=e[t*2],s=e[t*2+1];return{real:n,imag:s}}function R2(e,t,n,s){e[s*2]=t,e[s*2+1]=n}function P2(e,t){const n=new Float32Array(e/2),s=new Float32Array(e/2);for(let r=0;r<Math.ceil(e/2);r++){const a=(t?2:-2)*Math.PI*(r/e);n[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:n,imag:s}}function M2(e,t,n){const s=(n?2:-2)*Math.PI*(e/t),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dc="->",V2=/->/g,Qd=",",tp="...";function L2(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(V2,"").length)/Dc.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Dc}").`);const[s,r]=e.split(Dc);A(s.indexOf(tp)===-1,()=>`The ellipsis notation ("${tp}") is not supported yet.`);const a=s.split(Qd),o=a.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let d=0;d<r.length;++d){const m=r[d];if(!a.some(g=>g.indexOf(m)!==-1))throw new Error(`Output subscripts contain the label ${m} not present in the input subscripts.`);i.indexOf(m)===-1&&i.push(m)}for(let d=0;d<s.length;++d){const m=s[d];i.indexOf(m)===-1&&m!==Qd&&i.push(m)}const u=new Array(a.length);for(let d=0;d<o;++d){if(new Set(a[d].split("")).size!==a[d].length)throw new Error(`Found duplicate axes in input component ${a[d]}. Support for duplicate axes in input is not implemented yet.`);u[d]=[];for(let m=0;m<a[d].length;++m)u[d].push(i.indexOf(a[d][m]))}const c=i.length,l=r.length,f=[];for(let d=l;d<c;++d)f.push(d);return{allDims:i,summedDims:f,idDims:u}}function z2(e,t){let n=new Array(e);n.fill(-1);for(let r=0;r<t.length;++r)n[t[r]]=r;const s=[];for(let r=0;r<e;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function B2(e,t,n){const s=new Array(e);for(let r=0;r<n.length;++r){const a=n[r].shape;for(let o=0;o<t[r].length;++o)s[t[r][o]]===void 0?s[t[r][o]]=a[o]:A(s[t[r][o]]===a[o],()=>`Expected dimension ${s[t[r][o]]} at axis ${o} of input shaped ${JSON.stringify(a)}, but got dimension ${a[o]}`)}}function W2(e,t){const n=e,s=[];let r=0;e.length===0&&n.push(-1),r=e.length+1;for(let o=0;o<r;++o)s.push([]);const a=[];for(let o=0;o<n.length;++o){const i=n[o],u=H2(t,i);for(const c of u)a.indexOf(c)===-1&&(s[o].push(c),a.push(c))}return{path:n,steps:s}}function j2(e){return e.every((t,n)=>t===n)}function H2(e,t){const n=[];for(let s=0;s<e.length;++s)(e[s].length===0||e[s].indexOf(t)!==-1||t===-1)&&n.push(s);return n}function q2(e,t,n=0){let s=[];if(typeof t=="number")A(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(e.shape[n]/t);else{const r=t.reduce((o,i)=>(i===-1&&(o+=1),o),0);A(r<=1,()=>"There should be only one negative value in split array.");const a=t.indexOf(-1);if(a!==-1){const o=t.reduce((i,u)=>u>0?i+u:i);t[a]=e.shape[n]-o}A(e.shape[n]===t.reduce((o,i)=>o+i),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function U2(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function G2(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function X2(e,t){return`size ${e} must be non-negative, not ${t}`}function Z2(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function J2(e,t){const n=Nt(e),s=Nt(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${e} outputShape= ${t}`}function Q2(e,t){const n=Nt(e),s=Nt(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ep(){return"segment ids must be >= 0"}function t$(){return"segment ids are not increasing"}function e$(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function n$(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$(e,t,n,s){const r=t.shape.length,a=e.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let f=0;f<s;++f)if(e.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${e.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const o=e.shape[n],i=[];let u=1,c=1,l=1;for(let f=0;f<s;++f)i.push(e.shape[f]),u*=e.shape[f];for(let f=s;f<n;f++)i.push(e.shape[f]),c*=e.shape[f];for(let f=s;f<r;f++)i.push(t.shape[f]);for(let f=n+1;f<a;f++)i.push(e.shape[f]),l*=e.shape[f];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:o,outputShape:i}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ao(e){try{return e.map(t=>xo(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function r$(e){return e.map(t=>Mr(t))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */BE();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a$=ie();a$.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Tn;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(Tn||(Tn={}));var np;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(np||(np={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$={};function yb(e){return o$[e]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v(e,t,n,s,r){const a=t.inputParams[e];if(a&&a.inputIndexStart!==void 0){const i=a.inputIndexStart,u=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?i+1:a.inputIndexEnd,c=i<0?t.inputNames.length+i:i;if(a.type==="tensor")return Xe(t.inputNames[c],n,s,r);if(a.type==="tensors"){const d=t.inputs.slice(i,u);return t.inputNames.slice(i,u).filter((g,w)=>{var b;return((b=d[w])===null||b===void 0?void 0:b.op)!=="NoOp"}).map(g=>Xe(g,n,s,r))}const l=Xe(t.inputNames[c],n,s,r),f=l.dataSync();return a.type==="number"?f[0]:Hn(l.shape,f)}const o=t.attrParams[e];return o&&o.value}function Xe(e,t,n,s){const[r,a]=En(e,n);if(s!=null){const i=s.getHashTableHandleByName(r);if(i!=null)return i}const o=n.currentContextIds.find(i=>!!t[Zi(r,i)]);return o!==void 0?t[Zi(r,o)][a]:void 0}function sp(e,t,n){return t[Zi(e,n.currentContextId)]}function Es(e,t){const[n,s,r]=En(e,t);return[Zi(n,t&&t.currentContextId),s,r]}function Zi(e,t){return t?`${e}-${t}`:e}function En(e,t){if(e==="")return["",0,void 0];const n=t!=null&&t.parseNodeNameCache!=null;if(n){const a=t.parseNodeNameCache.get(e);if(a!=null)return a}const s=e.split(":");let r;if(s.length===1)r=[e,0,void 0];else{const a=s[0],o=s.length===3?s[1]:void 0,i=Number(s[s.length-1]);r=[a,i,o]}return n&&t.parseNodeNameCache.set(e,r),r}function Pi(e,t,n){let s=v("pad",e,t,n);if(s==="explicit"){s=v("explicitPaddings",e,t,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)r[a][0]=s[a*2],r[a][1]=s[a*2+1];return r}return s}function $s(e){return e.kept?e:or(e)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],u$=Object.freeze(Object.defineProperty({__proto__:null,json:i$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c$=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],l$=Object.freeze(Object.defineProperty({__proto__:null,json:c$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],h$=Object.freeze(Object.defineProperty({__proto__:null,json:f$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],p$=Object.freeze(Object.defineProperty({__proto__:null,json:d$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m$=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],g$=Object.freeze(Object.defineProperty({__proto__:null,json:m$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y$=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],b$=Object.freeze(Object.defineProperty({__proto__:null,json:y$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],v$=Object.freeze(Object.defineProperty({__proto__:null,json:w$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],x$=Object.freeze(Object.defineProperty({__proto__:null,json:k$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],N$=Object.freeze(Object.defineProperty({__proto__:null,json:S$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],_$=Object.freeze(Object.defineProperty({__proto__:null,json:I$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],E$=Object.freeze(Object.defineProperty({__proto__:null,json:T$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $$=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],C$=Object.freeze(Object.defineProperty({__proto__:null,json:$$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],D$=Object.freeze(Object.defineProperty({__proto__:null,json:A$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],F$=Object.freeze(Object.defineProperty({__proto__:null,json:O$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R$=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],P$=Object.freeze(Object.defineProperty({__proto__:null,json:R$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M$=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],V$=Object.freeze(Object.defineProperty({__proto__:null,json:M$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L$=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],z$=Object.freeze(Object.defineProperty({__proto__:null,json:L$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B$=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],W$=Object.freeze(Object.defineProperty({__proto__:null,json:B$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j$=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],H$=Object.freeze(Object.defineProperty({__proto__:null,json:j$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rp{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[u$,l$,h$,p$,g$,b$,v$,x$,N$,_$,E$,C$,D$,F$,P$,V$,z$,W$,H$],n=[].concat(...t.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(t,n={}){const s=t.node,r=[],a=[],o=[],i=s.reduce((w,b)=>(w[b.name]=this.mapNode(b),b.op.startsWith("Placeholder")?r.push(w[b.name]):b.op==="Const"?a.push(w[b.name]):(b.input==null||b.input.length===0)&&o.push(w[b.name]),w),{});let u=[];const c=[];let l={},f={};n!=null&&(l=this.mapSignatureEntries(n.inputs),f=this.mapSignatureEntries(n.outputs));const d=Object.keys(i);d.forEach(w=>{const b=i[w];b.inputNames.forEach((k,I)=>{const[T,,N]=Es(k),$=i[T];if($.outputs!=null){const D=$.outputs.indexOf(N);if(D!==-1){const P=`${T}:${D}`;b.inputNames[I]=P}}b.inputs.push($),$.children.push(b)})}),Object.keys(f).length===0?d.forEach(w=>{const b=i[w];b.children.length===0&&c.push(b)}):Object.keys(f).forEach(w=>{const[b]=Es(w),k=i[b];k!=null&&(k.signatureKey=f[w],c.push(k))}),Object.keys(l).length>0?Object.keys(l).forEach(w=>{const[b]=Es(w),k=i[b];k&&(k.signatureKey=l[w],u.push(k))}):u=r;let m={};t.library!=null&&t.library.function!=null&&(m=t.library.function.reduce((w,b)=>(w[b.signature.name]=this.mapFunction(b),w),{}));const g={nodes:i,inputs:u,outputs:c,weights:a,placeholders:r,signature:n,functions:m};return o.length>0&&(g.initNodes=o),g}mapSignatureEntries(t){return Object.keys(t||{}).reduce((n,s)=>(n[t[s].name]=s,n),{})}mapNode(t){const n=yb(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const s={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,a)=>{const o=a.type;let i;switch(a.type){case"string":i=hl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=hl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":i=wl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=wl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":i=pl(t.attr,a.tfName,a.defaultValue||0),i===void 0&&a.tfDeprecatedName&&(i=pl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":i=bl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=bl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":i=dl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=dl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":i=kl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=kl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":i=yl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=yl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":i=vl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=vl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":i=ml(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=ml(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":i=gl(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=gl(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":i=ap(t.attr,a.tfName,a.defaultValue),i===void 0&&a.tfDeprecatedName&&(i=ap(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${t.op}`)}return r[a.name]={value:i,type:o},r},{})),s}mapFunction(t){const n=t.nodeDef,s=[],r=[];let a={};n!=null&&(a=n.reduce((f,d)=>(f[d.name]=this.mapNode(d),d.op==="Const"&&r.push(f[d.name]),f),{}));const o=[],i=[];t.signature.inputArg.forEach(f=>{const[d]=Es(f.name),m={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:wh(f.type),type:"dtype"}},children:[]};m.signatureKey=f.name,o.push(m),a[d]=m}),Object.keys(a).forEach(f=>{const d=a[f];d.inputNames.forEach((m,g)=>{const[w,,b]=Es(m),k=a[w];if(k.outputs!=null){const I=k.outputs.indexOf(b);if(I!==-1){const T=`${w}:${I}`;d.inputNames[g]=T}}d.inputs.push(k),k.children.push(d)})});const c=t.ret;t.signature.outputArg.forEach(f=>{const[d,m]=Es(c[f.name]),g=a[d];g!=null&&(g.defaultOutput=m,i.push(g))});const l=this.mapArgsToSignature(t);return{nodes:a,inputs:o,outputs:i,weights:r,placeholders:s,signature:l}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:t.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,t.ret),n),{})}}mapArgToTensorInfo(t,n){let s=t.name;return n!=null&&(s=n[s]),{name:s,dtype:t.type}}}function q$(e){const t=ie().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function bb(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):q$(e);return t?n:n.toLowerCase()}function hl(e,t,n,s=!1){const r=e[t];return r!=null?bb(r.s,s):n}function dl(e,t,n){const s=e[t];return s?s.b:n}function pl(e,t,n){const s=e[t]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function wh(e){switch(typeof e=="string"&&(e=Tn[e]),e){case Tn.DT_FLOAT:case Tn.DT_HALF:return"float32";case Tn.DT_INT32:case Tn.DT_INT64:case Tn.DT_INT8:case Tn.DT_UINT8:return"int32";case Tn.DT_BOOL:return"bool";case Tn.DT_DOUBLE:return"float32";case Tn.DT_STRING:return"string";case Tn.DT_COMPLEX64:case Tn.DT_COMPLEX128:return"complex64";default:return null}}function ap(e,t,n){const s=e[t];return s&&s.func?s.func.name:n}function ml(e,t,n){const s=e[t];return s&&s.type?wh(s.type):n}function gl(e,t,n){const s=e[t];return s&&s.list&&s.list.type?s.list.type.map(r=>wh(r)):n}function wb(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function yl(e,t,n){const s=e[t];return s&&s.shape?wb(s.shape):n}function bl(e,t,n){const s=e[t];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function wl(e,t,n,s=!1){const r=e[t];return r&&r.list&&r.list.s?r.list.s.map(a=>bb(a,s)):n}function vl(e,t,n){const s=e[t];return s&&s.list&&s.list.shape?s.list.shape.map(r=>wb(r)):n}function kl(e,t,n){const s=e[t];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K${constructor(t,n,s){this.node=t,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(r=>this.getInput(r)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(t){return Xe(t,this.tensorMap,this.context)}getAttr(t,n){const s=this.node.rawAttrs[t];if(s.tensor!=null)return Xe(t,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return pl(this.node.rawAttrs,t,n);if(s.s!=null)return hl(this.node.rawAttrs,t,n);if(s.b!=null)return dl(this.node.rawAttrs,t,n);if(s.shape!=null)return yl(this.node.rawAttrs,t,n);if(s.type!=null)return ml(this.node.rawAttrs,t,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return bl(this.node.rawAttrs,t,n);if(s.list.s!=null)return wl(this.node.rawAttrs,t,n);if(s.list.shape!=null)return vl(this.node.rawAttrs,t,n);if(s.list.b!=null)return kl(this.node.rawAttrs,t,n);if(s.list.type!=null)return gl(this.node.rawAttrs,t,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:ry,abs:Fn,acos:O1,acosh:R1,add:Zt,addN:M1,all:L1,any:B1,argMax:j1,argMin:q1,asin:U1,asinh:Y1,atan:Z1,atan2:Q1,atanh:ek,avgPool:vy,avgPool3d:ck,basicLSTMCell:gk,batchNorm:xu,batchNorm2d:kk,batchNorm3d:Sk,batchNorm4d:Ik,batchToSpaceND:ky,bincount:xy,bitwiseAnd:Ek,booleanMaskAsync:b_,broadcastArgs:Ck,broadcastTo:uo,buffer:ce,cast:Pe,ceil:Ok,clipByValue:Rk,clone:or,complex:lr,concat:hn,concat1d:Mk,concat2d:Lk,concat3d:Bk,concat4d:jk,conv1d:Kk,conv2d:Su,conv2dTranspose:Yk,conv3d:Zk,conv3dTranspose:ex,cos:sx,cosh:ax,cosineWindow:fh,cumprod:ix,cumsum:cx,denseBincount:fx,depthToSpace:dx,depthwiseConv2d:nh,diag:gx,dilation2d:bx,div:xe,divNoNan:Nx,dot:_x,dropout:A_,einsum:ha,elu:Iy,enclosingPowerOfTwo:tb,ensureShape:Cx,equal:Ny,erf:Dx,euclideanNorm:Wx,exp:Hr,expandDims:Ts,expm1:Kx,eye:$y,fft:ih,fill:Bo,floor:Cy,floorDiv:by,fused:K_,gather:Ay,gatherND:E_,greater:Iu,greaterEqual:Dy,ifft:Xi,imag:_u,image:IE,inTopKAsync:O_,irfft:Uy,isFinite:eS,isInf:sS,isNaN:aS,leakyRelu:Oy,less:ul,lessEqual:sh,linalg:_E,linspace:cS,localResponseNormalization:fS,log:To,log1p:Fy,logSigmoid:bS,logSoftmax:kS,logSumExp:Py,logicalAnd:Ui,logicalNot:My,logicalOr:Vy,logicalXor:TS,losses:TE,lowerBound:$S,matMul:be,max:ba,maxPool:Ly,maxPool3d:DS,maxPoolWithArgmax:FS,maximum:zy,mean:Gi,meshgrid:MS,min:il,minimum:Yi,mirrorPad:zS,mod:WS,moments:HS,movingAverage:k_,mul:Pt,multiRNNCell:KS,multinomial:GS,neg:ds,norm:Nu,notEqual:By,oneHot:ZS,ones:Pr,onesLike:QS,op:z,outerProduct:eN,pad:Wo,pad1d:rN,pad2d:oN,pad3d:uN,pad4d:lN,pool:mN,pow:_o,prelu:jy,print:yy,prod:bN,raggedGather:vN,raggedRange:xN,raggedTensorToTensor:NN,rand:_N,randomGamma:GN,randomNormal:Hy,randomStandardNormal:ZN,randomUniform:oh,randomUniformInt:tI,range:Eo,real:$o,reciprocal:sI,relu:Eu,relu6:qy,reshape:pt,reverse:qr,reverse1d:uI,reverse2d:lI,reverse3d:hI,reverse4d:pI,rfft:uh,round:Ky,rsqrt:yI,scalar:fe,scatterND:S_,searchSorted:rh,selu:wI,separableConv2d:kI,setdiff1dAsync:SI,sigmoid:ya,sign:II,signal:NE,sin:TI,sinh:$I,slice:ve,slice1d:AI,slice2d:OI,slice3d:RI,slice4d:MI,softmax:LI,softplus:Ry,spaceToBatchND:Wy,sparse:EE,sparseToDense:__,spectral:SE,split:Co,sqrt:Rs,square:Xn,squaredDifference:Gy,squeeze:ch,stack:Ms,step:Yy,stridedSlice:XI,string:$E,sub:oe,sum:Te,tan:JI,tanh:ol,tensor:hs,tensor1d:Wn,tensor2d:lo,tensor3d:Xy,tensor4d:QI,tensor5d:t_,tensor6d:e_,tensorScatterUpdate:r_,tile:co,topk:o_,transpose:cl,truncatedNormal:u_,unique:l_,unsortedSegmentSum:h_,unstack:Jr,upperBound:p_,variable:m_,where:ir,whereAsync:Qy,zeros:Ta,zerosLike:Pn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U$=(e,t,n,s=Ze)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(v("a",e,t,n),v("b",e,t,n))];case"AddN":return[s.addN(v("tensors",e,t,n))];case"FloorMod":case"Mod":return[s.mod(v("a",e,t,n),v("b",e,t,n))];case"Mul":return[s.mul(v("a",e,t,n),v("b",e,t,n))];case"RealDiv":case"Div":return[s.div(v("a",e,t,n),v("b",e,t,n))];case"DivNoNan":return[s.divNoNan(v("a",e,t,n),v("b",e,t,n))];case"FloorDiv":return[s.floorDiv(v("a",e,t,n),v("b",e,t,n))];case"Sub":return[s.sub(v("a",e,t,n),v("b",e,t,n))];case"Minimum":return[s.minimum(v("a",e,t,n),v("b",e,t,n))];case"Maximum":return[s.maximum(v("a",e,t,n),v("b",e,t,n))];case"Pow":return[s.pow(v("a",e,t,n),v("b",e,t,n))];case"SquaredDifference":return[s.squaredDifference(v("a",e,t,n),v("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$=(e,t,n,s=Ze)=>{switch(e.op){case"Abs":case"ComplexAbs":return[s.abs(v("x",e,t,n))];case"Acos":return[s.acos(v("x",e,t,n))];case"Acosh":return[s.acosh(v("x",e,t,n))];case"Asin":return[s.asin(v("x",e,t,n))];case"Asinh":return[s.asinh(v("x",e,t,n))];case"Atan":return[s.atan(v("x",e,t,n))];case"Atan2":return[s.atan2(v("x",e,t,n),v("y",e,t,n))];case"Atanh":return[s.atanh(v("x",e,t,n))];case"Ceil":return[s.ceil(v("x",e,t,n))];case"Complex":return[s.complex(v("real",e,t,n),v("imag",e,t,n))];case"Cos":return[s.cos(v("x",e,t,n))];case"Cosh":return[s.cosh(v("x",e,t,n))];case"Elu":return[s.elu(v("x",e,t,n))];case"Erf":return[s.erf(v("x",e,t,n))];case"Exp":return[s.exp(v("x",e,t,n))];case"Expm1":return[s.expm1(v("x",e,t,n))];case"Floor":return[s.floor(v("x",e,t,n))];case"Log":return[s.log(v("x",e,t,n))];case"Log1p":return[s.log1p(v("x",e,t,n))];case"Imag":return[s.imag(v("x",e,t,n))];case"Neg":return[s.neg(v("x",e,t,n))];case"Reciprocal":return[s.reciprocal(v("x",e,t,n))];case"Real":return[s.real(v("x",e,t,n))];case"Relu":return[s.relu(v("x",e,t,n))];case"Round":return[s.round(v("x",e,t,n))];case"Selu":return[s.selu(v("x",e,t,n))];case"Sigmoid":return[s.sigmoid(v("x",e,t,n))];case"Sin":return[s.sin(v("x",e,t,n))];case"Sign":return[s.sign(v("x",e,t,n))];case"Sinh":return[s.sinh(v("x",e,t,n))];case"Softplus":return[s.softplus(v("x",e,t,n))];case"Sqrt":return[s.sqrt(v("x",e,t,n))];case"Square":return[s.square(v("x",e,t,n))];case"Tanh":return[s.tanh(v("x",e,t,n))];case"Tan":return[s.tan(v("x",e,t,n))];case"ClipByValue":return[s.clipByValue(v("x",e,t,n),v("clipValueMin",e,t,n),v("clipValueMax",e,t,n))];case"Relu6":return[s.relu6(v("x",e,t,n))];case"Rsqrt":return[s.rsqrt(Xe(e.inputNames[0],t,n))];case"LeakyRelu":return[s.leakyRelu(v("x",e,t,n),v("alpha",e,t,n))];case"Prelu":return[s.prelu(v("x",e,t,n),v("alpha",e,t,n))];case"IsNan":return[s.isNaN(Xe(e.inputNames[0],t,n))];case"IsInf":return[s.isInf(Xe(e.inputNames[0],t,n))];case"IsFinite":return[s.isFinite(Xe(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){A(e.length===t.length,()=>n+` Shapes ${e} and ${t} must match`);for(let s=0;s<e.length;s++){const r=e[s],a=t[s];A(r<0||a<0||r===a,()=>n+` Shapes ${e} and ${t} must match`)}}}function op(e){return!(typeof e=="number"||e.some(t=>t<0))}function Qa(e,t,n){let s=xl(e,n);const r=!op(s);if(r&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&t.forEach(a=>{s=xl(a.shape,s)}),!op(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function xl(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let s=0;s<e.length;++s){const r=e[s],a=t[s];if(r>=0&&a>=0&&r!==a)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[s]=r>=0?r:a}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y${constructor(t,n,s,r,a,o,i){this.name=t,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=fe(0),ls(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const n=this.tensors[t];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(t){return t.map(n=>this.read(n))}write(t,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Bn(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);s.tensor=n,ls(n),s.written=!0,this.tensors[t]=s}writeMany(t,n){if(t.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${n.length}.`);t.forEach((s,r)=>this.write(s,n[r]))}gather(t,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(t)t=t.slice(0,this.size());else{t=[];for(let r=0;r<this.size();r++)t.push(r)}if(t.length===0)return hs([],[0].concat(this.elementShape));const s=this.readMany(t);return Bn(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Ms(s,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return hs([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return Bn(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),hn(s,0)}scatter(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const s=Math.max(...t);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(t,Jr(n,0))}split(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=t.map(u=>(s+=u,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:n.size/s,o=[];de(()=>{n=pt(n,[1,s,a]);for(let u=0;u<t.length;++u){const l=[0,u===0?0:r[u-1],0],f=[1,t[u],a];o[u]=pt(ve(n,l,f),this.elementShape)}return o});const i=[];for(let u=0;u<t.length;u++)i[u]=u;this.writeMany(i,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ur{get id(){return this.idTensor.id}constructor(t,n,s,r=-1){this.tensors=t,this.elementShape=n,this.elementDtype=s,t!=null&&t.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);Bn(n,a.shape,"TensorList shape mismatch: "),ls(a)}),this.idTensor=fe(0),this.maxNumElements=r,ls(this.idTensor)}copy(){return new Ur([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Bn(t,this.elementShape,"TensorList shape mismatch: ");const r=Qa(this.elementShape,this.tensors,t);return de(()=>{const a=this.tensors.map(o=>pt(o,r));return Ms(a,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Qa(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,Bn(r.shape,t,"TensorList shape mismatch: "),pt(r,s)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(Bn(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");ls(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const n=new Ur([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let s=0;s<Math.min(this.tensors.length,t);++s)n.tensors[s]=this.tensors[s];return n}getItem(t,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);Bn(this.tensors[t].shape,n,"TensorList shape mismatch: ");const r=Qa(this.elementShape,this.tensors,n);return pt(this.tensors[t],r)}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);Bn(this.elementShape,n.shape,"TensorList shape mismatch: "),ls(n),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=n}gather(t,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Bn(this.elementShape,s,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=Qa(this.elementShape,this.tensors,s);return t.length===0?hs([],[0].concat(r)):de(()=>{const a=t.map(o=>pt(this.tensors[o],r));return Ms(a,0)})}concat(t,n){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);Bn(this.elementShape,n,"TensorList shape mismatch: ");const s=Qa(this.elementShape,this.tensors,n);return this.size()===0?hs([],[0].concat(s)):de(()=>{const r=this.tensors.map(a=>pt(a,s));return hn(r,0)})}}function X$(e,t,n){const s=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);const r=e.shape.slice(1);Bn(r,t,"TensorList shape mismatch: ");const a=Jr(e);return new Ur(a,t,s)}function Z$(e,t,n,s){return new Ur([],e,t,s)}function J$(e,t,n,s){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const r=Math.max(...t);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const a=new Ur([],n,e.dtype,s),o=Jr(e,0);return t.forEach((i,u)=>{a.setItem(i,o[u])}),a}function Q$(e,t,n){let s=0;const r=t.map(l=>(s+=l,s));if(s!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${e.shape}`);const a=e.shape.slice(1),o=xl(a,n),i=s===0?0:e.size/s,u=de(()=>{const l=[];e=pt(e,[1,s,i]);for(let f=0;f<t.length;++f){const m=[0,f===0?0:r[f-1],0],g=[1,t[f],i];l[f]=pt(ve(e,m,g),o)}return e.dispose(),l}),c=new Ur([],n,e.dtype,t.length);for(let l=0;l<u.length;l++)c.setItem(l,u[l]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tC=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const s=v("thenBranch",e,t,n),r=v("elseBranch",e,t,n),a=v("cond",e,t,n),o=v("args",e,t,n);return(await a.data())[0]?n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=v("body",e,t,n),r=v("cond",e,t,n),a=v("args",e,t,n),o=await n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),i=a.map(l=>l.id);let u=await o[0].data();o.forEach(l=>{!l.kept&&i.indexOf(l.id)===-1&&l.dispose()});let c=a;for(;u[0];){const l=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const f=c.map(m=>m.id);l.forEach(m=>{!m.kept&&i.indexOf(m.id)===-1&&f.indexOf(m.id)===-1&&m.dispose()});const d=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);u=await d[0].data(),d.forEach(m=>{!m.kept&&i.indexOf(m.id)===-1&&f.indexOf(m.id)===-1&&m.dispose()})}return c}case"LoopCond":{const s=v("pred",e,t,n);return[$s(s)]}case"Switch":{const s=v("pred",e,t,n);let r=v("data",e,t,n);return r.kept||(r=$s(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=e.inputNames.find(r=>Xe(r,t,n)!==void 0);if(s){const r=Xe(s,t,n);return[$s(r)]}return}case"Enter":{const s=v("frameName",e,t,n),r=v("tensor",e,t,n);return n.enterFrame(s),[$s(r)]}case"Exit":{const s=v("tensor",e,t,n);return n.exitFrame(),[$s(s)]}case"NextIteration":{const s=v("tensor",e,t,n);return n.nextIteration(),[$s(s)]}case"TensorArrayV3":{const s=v("size",e,t,n),r=v("dtype",e,t,n),a=v("elementShape",e,t,n),o=v("dynamicSize",e,t,n),i=v("clearAfterRead",e,t,n),u=v("identicalElementShapes",e,t,n),c=v("name",e,t,n),l=new Y$(c,r,s,a,u,o,i);return n.addTensorArray(l),[l.idTensor,fe(1)]}case"TensorArrayWriteV3":{const s=v("tensorArrayId",e,t,n),r=v("index",e,t,n),a=v("tensor",e,t,n),o=n.getTensorArray(s.id);return o.write(r,a),[o.idTensor]}case"TensorArrayReadV3":{const s=v("tensorArrayId",e,t,n),r=v("index",e,t,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=v("tensorArrayId",e,t,n),r=v("indices",e,t,n),a=v("dtype",e,t,n);return[n.getTensorArray(s.id).gather(r,a)]}case"TensorArrayScatterV3":{const s=v("tensorArrayId",e,t,n),r=v("indices",e,t,n),a=v("tensor",e,t,n),o=n.getTensorArray(s.id);return o.scatter(r,a),[o.idTensor]}case"TensorArrayConcatV3":{const s=v("tensorArrayId",e,t,n),r=n.getTensorArray(s.id),a=v("dtype",e,t,n);return[r.concat(a)]}case"TensorArraySplitV3":{const s=v("tensorArrayId",e,t,n),r=v("tensor",e,t,n),a=v("lengths",e,t,n),o=n.getTensorArray(s.id);return o.split(a,r),[o.idTensor]}case"TensorArraySizeV3":{const s=v("tensorArrayId",e,t,n),r=n.getTensorArray(s.id);return[fe(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=v("tensorArrayId",e,t,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=v("tensorListId",e,t,n),r=v("index",e,t,n),a=v("tensor",e,t,n),o=n.getTensorList(s.id);return o.setItem(r,a),[o.idTensor]}case"TensorListGetItem":{const s=v("tensorListId",e,t,n),r=v("index",e,t,n),a=v("elementShape",e,t,n),o=v("elementDType",e,t,n);return[n.getTensorList(s.id).getItem(r,a,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=v("indices",e,t,n),r=v("tensor",e,t,n),a=v("elementShape",e,t,n),o=v("numElements",e,t,n),i=J$(r,s,a,o);return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=v("elementShape",e,t,n),r=v("elementDType",e,t,n);let a;e.op==="TensorListReserve"?a="numElements":a="maxNumElements";const o=v(a,e,t,n),i=e.op==="TensorListReserve"?-1:o,u=Z$(s,r,o,i);return n.addTensorList(u),[u.idTensor]}case"TensorListGather":{const s=v("tensorListId",e,t,n),r=v("indices",e,t,n),a=v("elementShape",e,t,n),o=v("elementDType",e,t,n);return[n.getTensorList(s.id).gather(r,o,a)]}case"TensorListStack":{const s=v("tensorListId",e,t,n),r=v("elementShape",e,t,n),a=v("elementDType",e,t,n),o=v("numElements",e,t,n);return[n.getTensorList(s.id).stack(r,a,o)]}case"TensorListFromTensor":{const s=v("tensor",e,t,n),r=v("elementShape",e,t,n),a=v("elementDType",e,t,n),o=X$(s,r,a);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=v("tensorListId",e,t,n),r=n.getTensorList(s.id),a=v("dtype",e,t,n),o=v("elementShape",e,t,n);return[r.concat(a,o)]}case"TensorListPushBack":{const s=v("tensorListId",e,t,n),r=v("tensor",e,t,n),a=n.getTensorList(s.id);return a.pushBack(r),[a.idTensor]}case"TensorListPopBack":{const s=v("tensorListId",e,t,n),r=v("elementShape",e,t,n),a=v("elementDType",e,t,n);return[n.getTensorList(s.id).popBack(r,a)]}case"TensorListSplit":{const s=v("tensor",e,t,n),r=v("elementShape",e,t,n),a=v("lengths",e,t,n),o=Q$(s,a,r);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=v("tensorListId",e,t,n),r=n.getTensorList(s.id);return[fe(r.size(),"int32")]}case"TensorListResize":{const s=v("tensorListId",e,t,n),r=v("size",e,t,n),o=n.getTensorList(s.id).resize(r);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ip(e,t,n){const[s,r]=v("fusedOps",e,t,n),a=s==="biasadd",o=!a,i=r==="prelu",u=s==="fusedbatchnorm",c=v("numArgs",e,t,n);if(a){if(i&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&a&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const l=v("strides",e,t,n),f=Pi(e,t,n),d=v("dataFormat",e,t,n).toUpperCase(),m=v("dilations",e,t,n);let[g,w]=v("args",e,t,n);o&&(w=g,g=void 0);const b=v("leakyreluAlpha",e,t,n);return{stride:l,pad:f,dataFormat:d,dilations:m,biasArg:g,preluArg:w,activationFunc:r,leakyreluAlpha:b}}const eC=(e,t,n,s=Ze)=>{switch(e.op){case"Conv1D":{const r=v("stride",e,t,n),a=v("pad",e,t,n),o=v("dataFormat",e,t,n).toUpperCase(),i=v("dilation",e,t,n);return[s.conv1d(v("x",e,t,n),v("filter",e,t,n),r,a,o,i)]}case"Conv2D":{const r=v("strides",e,t,n),a=Pi(e,t,n),o=v("dataFormat",e,t,n).toUpperCase(),i=v("dilations",e,t,n);return[s.conv2d(v("x",e,t,n),v("filter",e,t,n),[r[1],r[2]],a,o,[i[1],i[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:o,dilations:i,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:f}=ip(e,t,n);return[s.fused.conv2d({x:v("x",e,t,n),filter:v("filter",e,t,n),strides:[r[1],r[2]],pad:a,dataFormat:o,dilations:[i[1],i[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:o,dilations:i,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:f}=ip(e,t,n);return[s.fused.depthwiseConv2d({x:v("x",e,t,n),filter:v("filter",e,t,n),strides:[r[1],r[2]],pad:a,dataFormat:o,dilations:[i[1],i[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=v("outputShape",e,t,n),a=v("strides",e,t,n),o=Pi(e,t,n);return[s.conv2dTranspose(v("x",e,t,n),v("filter",e,t,n),r,[a[1],a[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=v("strides",e,t,n),a=Pi(e,t,n),o=v("dilations",e,t,n),i=v("dataFormat",e,t,n).toUpperCase();return[s.depthwiseConv2d(v("input",e,t,n),v("filter",e,t,n),[r[1],r[2]],a,i,[o[1],o[2]])]}case"Conv3D":{const r=v("strides",e,t,n),a=v("pad",e,t,n),o=v("dataFormat",e,t,n).toUpperCase(),i=v("dilations",e,t,n);return[s.conv3d(v("x",e,t,n),v("filter",e,t,n),[r[1],r[2],r[3]],a,o,[i[1],i[2],i[3]])]}case"AvgPool":{const r=v("strides",e,t,n),a=v("pad",e,t,n),o=v("kernelSize",e,t,n);return[s.avgPool(v("x",e,t,n),[o[1],o[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=v("strides",e,t,n),a=v("pad",e,t,n),o=v("kernelSize",e,t,n);return[s.maxPool(v("x",e,t,n),[o[1],o[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=v("strides",e,t,n),a=v("pad",e,t,n),o=v("kernelSize",e,t,n),i=v("includeBatchInIndex",e,t,n),{result:u,indexes:c}=s.maxPoolWithArgmax(v("x",e,t,n),[o[1],o[2]],[r[1],r[2]],a,i);return[u,c]}case"AvgPool3D":{const r=v("strides",e,t,n),a=v("pad",e,t,n),o=v("kernelSize",e,t,n);return[s.avgPool3d(v("x",e,t,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=v("strides",e,t,n),a=v("pad",e,t,n),o=v("kernelSize",e,t,n);return[s.maxPool3d(v("x",e,t,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=v("strides",e,t,n),a=v("pad",e,t,n),o=v("dilations",e,t,n),i=r[1],u=r[2],c=o[1],l=o[2];return[s.dilation2d(v("x",e,t,n),v("filter",e,t,n),[i,u],a,[c,l],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nC=(e,t,n,s=Ze)=>{switch(e.op){case"Fill":{const r=v("shape",e,t,n),a=v("dtype",e,t,n),o=v("value",e,t,n);return[s.fill(r,o,a)]}case"LinSpace":{const r=v("start",e,t,n),a=v("stop",e,t,n),o=v("num",e,t,n);return[s.linspace(r,a,o)]}case"Multinomial":{const r=v("logits",e,t,n),a=v("numSamples",e,t,n),o=v("seed",e,t,n);return[s.multinomial(r,a,o)]}case"OneHot":{const r=v("indices",e,t,n),a=v("depth",e,t,n),o=v("onValue",e,t,n),i=v("offValue",e,t,n),u=v("dtype",e,t,n);return[s.oneHot(r,a,o,i,u)]}case"Ones":return[s.ones(v("shape",e,t,n),v("dtype",e,t,n))];case"OnesLike":return[s.onesLike(v("x",e,t,n))];case"RandomStandardNormal":return[s.randomStandardNormal(v("shape",e,t,n),v("dtype",e,t,n),v("seed",e,t,n))];case"RandomUniform":return[s.randomUniform(v("shape",e,t,n),v("minval",e,t,n),v("maxval",e,t,n),v("dtype",e,t,n))];case"RandomUniformInt":return[s.randomUniformInt(v("shape",e,t,n),v("minval",e,t,n),v("maxval",e,t,n),v("seed",e,t,n))];case"Range":{const r=v("start",e,t,n),a=v("stop",e,t,n),o=v("step",e,t,n);return[s.range(r,a,o,v("dtype",e,t,n))]}case"TruncatedNormal":{const r=v("shape",e,t,n),a=v("mean",e,t,n),o=v("stdDev",e,t,n),i=v("seed",e,t,n);return[s.truncatedNormal(r,a,o,v("dtype",e,t,n),i)]}case"Zeros":return[s.zeros(v("shape",e,t,n),v("dtype",e,t,n))];case"ZerosLike":return[s.zerosLike(v("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oc(e,t,n){const s=v("boxes",e,t,n),r=v("scores",e,t,n),a=v("maxOutputSize",e,t,n),o=v("iouThreshold",e,t,n),i=v("scoreThreshold",e,t,n),u=v("softNmsSigma",e,t,n);return{boxes:s,scores:r,maxOutputSize:a,iouThreshold:o,scoreThreshold:i,softNmsSigma:u}}const sC=async(e,t,n,s,r=Ze)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:o,maxOutputSize:i,iouThreshold:u,scoreThreshold:c,softNmsSigma:l}=Oc(e,t,n),f=await r.image.nonMaxSuppressionWithScoreAsync(a,o,i,u,c,l);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:o,maxOutputSize:i,iouThreshold:u,scoreThreshold:c}=Oc(e,t,n),l=v("padToMaxOutputSize",e,t,n),f=await r.image.nonMaxSuppressionPaddedAsync(a,o,i,u,c,l);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:o,maxOutputSize:i,iouThreshold:u,scoreThreshold:c}=Oc(e,t,n);return[await r.image.nonMaxSuppressionAsync(a,o,i,u,c)]}case"Where":{const a=r.cast(v("condition",e,t,n),"bool"),o=[await r.whereAsync(a)];return a.dispose(),o}case"ListDiff":return r.setdiff1dAsync(v("x",e,t,n),v("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rC=(e,t,n,s=Ze)=>{switch(e.op){case"LowerBound":{const r=v("sortedSequence",e,t,n),a=v("values",e,t,n);return[s.lowerBound(r,a)]}case"TopKV2":{const r=v("x",e,t,n),a=v("k",e,t,n),o=v("sorted",e,t,n),i=s.topk(r,a,o);return[i.values,i.indices]}case"UpperBound":{const r=v("sortedSequence",e,t,n),a=v("values",e,t,n);return[s.upperBound(r,a)]}case"Unique":{const r=v("x",e,t,n),a=s.unique(r);return[a.values,a.indices]}case"UniqueV2":{const r=v("x",e,t,n),a=v("axis",e,t,n),o=s.unique(r,a);return[o.values,o.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aC=(e,t,n,s=Ze)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const r=v("default",e,t,n);return[Xe(e.name,t,n)||r];case"Placeholder":return[Xe(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const l=v("x",e,t,n);return[$s(l)]}case"IdentityN":return v("x",e,t,n).map(l=>$s(l));case"Snapshot":const a=v("x",e,t,n);return[$s(a)];case"Shape":return[s.tensor1d(v("x",e,t,n).shape,"int32")];case"ShapeN":return v("x",e,t,n).map(l=>s.tensor1d(l.shape));case"Size":return[s.scalar(v("x",e,t,n).size,"int32")];case"Rank":return[s.scalar(v("x",e,t,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=v("x",e,t,n),i=v("data",e,t,n),u=v("message",e,t,n),c=v("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let l=0;l<i.length;l++)console.log(Array.prototype.slice.call(i[l].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oC{get id(){return this.handle.id}constructor(t,n){this.keyDType=t,this.valueDType=n,this.handle=fe(0),this.tensorMap=new Map,ls(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return fe(this.size(),"int32")}async import(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),de(()=>{const r=Jr(n),a=s.length,o=r.length;A(a===o,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${o} elements.`);for(let i=0;i<a;i++){const u=s[i],c=r[i];ls(c),this.tensorMap.set(u,c)}return this.handle})}async find(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return de(()=>{const r=[];for(let a=0;a<s.length;a++){const o=s[a],i=this.findWithDefault(o,n);r.push(i)}return Ms(r)})}findWithDefault(t,n){const s=this.tensorMap.get(t);return s??n}checkKeyAndValueTensor(t,n){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iC=async(e,t,n,s)=>{switch(e.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(e.name);if(r!=null)return[r];{const a=v("keyDType",e,t,n),o=v("valueDType",e,t,n),i=new oC(a,o);return s.addHashTable(e.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=v("tableHandle",e,t,n,s),a=v("keys",e,t,n),o=v("values",e,t,n);return[await s.getHashTableById(r.id).import(a,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=v("tableHandle",e,t,n,s),a=v("keys",e,t,n),o=v("defaultValue",e,t,n);return[await s.getHashTableById(r.id).find(a,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=v("tableHandle",e,t,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uC=(e,t,n,s=Ze)=>{switch(e.op){case"ResizeBilinear":{const r=v("images",e,t,n),a=v("size",e,t,n),o=v("alignCorners",e,t,n),i=v("halfPixelCenters",e,t,n);return[s.image.resizeBilinear(r,[a[0],a[1]],o,i)]}case"ResizeNearestNeighbor":{const r=v("images",e,t,n),a=v("size",e,t,n),o=v("alignCorners",e,t,n),i=v("halfPixelCenters",e,t,n);return[s.image.resizeNearestNeighbor(r,[a[0],a[1]],o,i)]}case"CropAndResize":{const r=v("image",e,t,n),a=v("boxes",e,t,n),o=v("boxInd",e,t,n),i=v("cropSize",e,t,n),u=v("method",e,t,n),c=v("extrapolationValue",e,t,n);return[s.image.cropAndResize(r,a,o,i,u,c)]}case"ImageProjectiveTransformV3":{const r=v("images",e,t,n),a=v("transforms",e,t,n),o=v("outputShape",e,t,n),i=v("fillValue",e,t,n),u=v("interpolation",e,t,n),c=v("fillMode",e,t,n);return[s.image.transform(r,a,u.toLowerCase(),c.toLowerCase(),i,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cC=(e,t,n,s=Ze)=>{switch(e.op){case"Equal":return[s.equal(v("a",e,t,n),v("b",e,t,n))];case"NotEqual":return[s.notEqual(v("a",e,t,n),v("b",e,t,n))];case"Greater":return[s.greater(v("a",e,t,n),v("b",e,t,n))];case"GreaterEqual":return[s.greaterEqual(v("a",e,t,n),v("b",e,t,n))];case"Less":return[s.less(v("a",e,t,n),v("b",e,t,n))];case"LessEqual":return[s.lessEqual(v("a",e,t,n),v("b",e,t,n))];case"LogicalAnd":return[s.logicalAnd(v("a",e,t,n),v("b",e,t,n))];case"LogicalNot":return[s.logicalNot(v("a",e,t,n))];case"LogicalOr":return[s.logicalOr(v("a",e,t,n),v("b",e,t,n))];case"Select":case"SelectV2":return[s.where(v("condition",e,t,n),v("a",e,t,n),v("b",e,t,n))];case"BitwiseAnd":return[s.bitwiseAnd(v("a",e,t,n),v("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lC=(e,t,n,s=Ze)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(v("a",e,t,n),v("b",e,t,n),v("transposeA",e,t,n),v("transposeB",e,t,n))];case"Einsum":return[s.einsum(v("equation",e,t,n),...v("tensors",e,t,n))];case"Transpose":return[s.transpose(v("x",e,t,n),v("perm",e,t,n))];case"_FusedMatMul":const[r,a]=v("fusedOps",e,t,n),o=r==="biasadd",i=a==="prelu",u=v("numArgs",e,t,n),c=v("leakyreluAlpha",e,t,n);if(o){if(i&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[l,f]=v("args",e,t,n);return[s.fused.matMul({a:v("a",e,t,n),b:v("b",e,t,n),transposeA:v("transposeA",e,t,n),transposeB:v("transposeB",e,t,n),bias:l,activation:a,preluActivationWeights:f,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(v("a",e,t,n),v("numLower",e,t,n),v("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fC=(e,t,n,s=Ze)=>{switch(e.op){case"EuclideanNorm":return[s.euclideanNorm(v("x",e,t,n),v("axis",e,t,n),v("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(v("x",e,t,n),v("mean",e,t,n),v("variance",e,t,n),v("offset",e,t,n),v("scale",e,t,n),v("epsilon",e,t,n))];case"FusedBatchNormV3":return[s.batchNorm(v("x",e,t,n),v("mean",e,t,n),v("variance",e,t,n),v("offset",e,t,n),v("scale",e,t,n),v("epsilon",e,t,n))];case"LRN":return[s.localResponseNormalization(v("x",e,t,n),v("radius",e,t,n),v("bias",e,t,n),v("alpha",e,t,n),v("beta",e,t,n))];case"Softmax":return[s.softmax(v("x",e,t,n))];case"LogSoftmax":return[s.logSoftmax(v("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hC=(e,t,n,s=Ze)=>{switch(e.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:a}=s.raggedGather(v("paramsNestedSplits",e,t,n),v("paramsDenseValues",e,t,n),v("indices",e,t,n),v("outputRaggedRank",e,t,n));return r.concat(a)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:a}=s.raggedRange(v("starts",e,t,n),v("limits",e,t,n),v("splits",e,t,n));return[r,a]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(v("shape",e,t,n),v("values",e,t,n),v("defaultValue",e,t,n),v("rowPartitionTensors",e,t,n),v("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dC=(e,t,n,s=Ze)=>{switch(e.op){case"Max":{const i=v("axis",e,t,n),u=v("keepDims",e,t,n);return[s.max(v("x",e,t,n),i,u)]}case"Mean":{const i=v("axis",e,t,n),u=v("keepDims",e,t,n);return[s.mean(v("x",e,t,n),i,u)]}case"Min":{const i=v("axis",e,t,n),u=v("keepDims",e,t,n);return[s.min(v("x",e,t,n),i,u)]}case"Sum":{const i=v("axis",e,t,n),u=v("keepDims",e,t,n);return[s.sum(v("x",e,t,n),i,u)]}case"All":{const i=v("axis",e,t,n),u=v("keepDims",e,t,n);return[s.all(v("x",e,t,n),i,u)]}case"Any":{const i=v("axis",e,t,n),u=v("keepDims",e,t,n);return[s.any(v("x",e,t,n),i,u)]}case"ArgMax":{const i=v("axis",e,t,n);return[s.argMax(v("x",e,t,n),i)]}case"ArgMin":{const i=v("axis",e,t,n);return[s.argMin(v("x",e,t,n),i)]}case"Prod":{const i=v("axis",e,t,n),u=v("keepDims",e,t,n);return[s.prod(v("x",e,t,n),i,u)]}case"Cumprod":{const i=v("axis",e,t,n),u=v("exclusive",e,t,n),c=v("reverse",e,t,n);return[s.cumprod(v("x",e,t,n),i,u,c)]}case"Cumsum":{const i=v("axis",e,t,n),u=v("exclusive",e,t,n),c=v("reverse",e,t,n);return[s.cumsum(v("x",e,t,n),i,u,c)]}case"Bincount":const r=v("x",e,t,n),a=v("weights",e,t,n),o=v("size",e,t,n);return[s.bincount(r,a,o)];case"DenseBincount":{const i=v("x",e,t,n),u=v("weights",e,t,n),c=v("size",e,t,n),l=v("binaryOutput",e,t,n);return[s.denseBincount(i,u,c,l)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pC=(e,t,n,s=Ze)=>{switch(e.op){case"ConcatV2":case"Concat":{const r=v("n",e,t,n),a=v("axis",e,t,n);let o=v("tensors",e,t,n);return o=o.slice(0,r),[s.concat(o,a)]}case"Gather":{const r=v("x",e,t,n),a=v("indices",e,t,n);return[s.gather(r,s.cast(a,"int32"),0)]}case"GatherV2":{const r=v("axis",e,t,n),a=v("batchDims",e,t,n),o=v("x",e,t,n),i=v("indices",e,t,n);return[s.gather(o,s.cast(i,"int32"),r,a)]}case"Reverse":{const r=v("dims",e,t,n),a=[];for(let i=0;i<r.length;i++)r[i]&&a.push(i);const o=v("x",e,t,n);return[s.reverse(o,a)]}case"ReverseV2":{const r=v("axis",e,t,n),a=v("x",e,t,n);return[s.reverse(a,r)]}case"Slice":{const r=v("begin",e,t,n),a=v("size",e,t,n);return[s.slice(v("x",e,t,n),r,a)]}case"StridedSlice":{const r=v("begin",e,t,n),a=v("end",e,t,n),o=v("strides",e,t,n),i=v("beginMask",e,t,n),u=v("endMask",e,t,n),c=v("ellipsisMask",e,t,n),l=v("newAxisMask",e,t,n),f=v("shrinkAxisMask",e,t,n),d=v("x",e,t,n);return[s.stridedSlice(d,r,a,o,i,u,c,l,f)]}case"Pack":return de(()=>{const r=v("axis",e,t,n),a=v("tensors",e,t,n),o=a[0].shape,i=s.squeeze(a[0]).shape,u=a.map(c=>{const l=Un(c.shape,o);if(!l&&!Un(s.squeeze(c).shape,i))throw new Error("the input tensors shape does not match");return l?c:s.reshape(c,o)});return[s.stack(u,r)]});case"Unpack":{const r=v("axis",e,t,n),a=v("tensor",e,t,n);return s.unstack(a,r)}case"Tile":{const r=v("reps",e,t,n);return[s.tile(v("x",e,t,n),r)]}case"Split":case"SplitV":{const r=v("axis",e,t,n),a=v("numOrSizeSplits",e,t,n),o=v("x",e,t,n);return s.split(o,a,r)}case"ScatterNd":{const r=v("indices",e,t,n),a=v("values",e,t,n),o=v("shape",e,t,n);return[s.scatterND(r,a,o)]}case"GatherNd":{const r=v("x",e,t,n),a=v("indices",e,t,n);return[s.gatherND(r,a)]}case"SparseToDense":{const r=v("sparseIndices",e,t,n),a=v("outputShape",e,t,n),o=v("sparseValues",e,t,n),i=v("defaultValue",e,t,n);return[s.sparseToDense(r,o,a,o.dtype===i.dtype?i:s.cast(i,o.dtype))]}case"TensorScatterUpdate":{const r=v("indices",e,t,n),a=v("values",e,t,n),o=v("tensor",e,t,n);return[s.tensorScatterUpdate(o,r,a)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mC=(e,t,n,s=Ze)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:o,reverseIndexMap:i}=s.sparse.sparseFillEmptyRows(v("indices",e,t,n),v("values",e,t,n),v("denseShape",e,t,n),v("defaultValue",e,t,n));return[r,a,o,i]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=s.sparse.sparseReshape(v("inputIndices",e,t,n),v("inputShape",e,t,n),v("newShape",e,t,n));return[r,a]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(v("data",e,t,n),v("indices",e,t,n),v("segmentIds",e,t,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(v("data",e,t,n),v("indices",e,t,n),v("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gC=(e,t,n,s=Ze)=>{switch(e.op){case"FFT":return[s.fft(v("x",e,t,n))];case"IFFT":return[s.ifft(v("x",e,t,n))];case"RFFT":return[s.rfft(v("x",e,t,n))];case"IRFFT":return[s.irfft(v("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yC=(e,t,n,s=Ze)=>{switch(e.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(v("input",e,t,n),v("pattern",e,t,n),v("rewrite",e,t,n),v("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=s.string.stringNGrams(v("data",e,t,n),v("dataSplits",e,t,n),v("separator",e,t,n),v("nGramWidths",e,t,n),v("leftPad",e,t,n),v("rightPad",e,t,n),v("padWidth",e,t,n),v("preserveShortSequences",e,t,n));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:o}=s.string.stringSplit(v("input",e,t,n),v("delimiter",e,t,n),v("skipEmpty",e,t,n));return[r,a,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(v("input",e,t,n),v("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bC=(e,t,n,s=Ze)=>{switch(e.op){case"Cast":return[s.cast(v("x",e,t,n),v("dtype",e,t,n))];case"ExpandDims":{const r=v("axis",e,t,n);return[s.expandDims(v("x",e,t,n),r)]}case"Squeeze":{const r=v("axis",e,t,n);return[s.squeeze(v("x",e,t,n),r)]}case"Reshape":return[s.reshape(v("x",e,t,n),v("shape",e,t,n))];case"EnsureShape":return[s.ensureShape(v("x",e,t,n),v("shape",e,t,n))];case"MirrorPad":return[s.mirrorPad(v("x",e,t,n),v("padding",e,t,n),v("mode",e,t,n))];case"PadV2":case"Pad":return[s.pad(v("x",e,t,n),v("padding",e,t,n),v("constantValue",e,t,n))];case"SpaceToBatchND":{const r=v("blockShape",e,t,n),a=v("paddings",e,t,n);return[s.spaceToBatchND(v("x",e,t,n),r,a)]}case"BatchToSpaceND":{const r=v("blockShape",e,t,n),a=v("crops",e,t,n);return[s.batchToSpaceND(v("x",e,t,n),r,a)]}case"DepthToSpace":{const r=v("blockSize",e,t,n),a=v("dataFormat",e,t,n).toUpperCase();return[s.depthToSpace(v("x",e,t,n),r,a)]}case"BroadcastTo":return[s.broadcastTo(v("x",e,t,n),v("shape",e,t,n))];case"BroadcastArgs":return[s.broadcastArgs(v("s0",e,t,n),v("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function up(e,t,n,s,r=de){const a=((o,i,u)=>{switch(o.category){case"arithmetic":return r(()=>U$(o,i,u));case"basic_math":return r(()=>G$(o,i,u));case"control":return tC(o,i,u);case"convolution":return r(()=>eC(o,i,u));case"creation":return r(()=>nC(o,i,u));case"dynamic":return sC(o,i,u);case"evaluation":return r(()=>rC(o,i,u));case"image":return r(()=>uC(o,i,u));case"graph":return r(()=>aC(o,i,u));case"logical":return r(()=>cC(o,i,u));case"matrices":return r(()=>lC(o,i,u));case"normalization":return r(()=>fC(o,i,u));case"ragged":return r(()=>hC(o,i,u));case"reduction":return r(()=>dC(o,i,u));case"slice_join":return r(()=>pC(o,i,u));case"sparse":return r(()=>mC(o,i,u));case"spectral":return r(()=>gC(o,i,u));case"string":return r(()=>yC(o,i,u));case"transformation":return r(()=>bC(o,i,u));case"hash_table":return iC(o,i,u,s);case"custom":const c=yb(o.op);if(c&&c.customExecutor)return c.customExecutor(new K$(o,i,u));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return zr(a)?a.then(o=>[].concat(o)):[].concat(a)}class cp{constructor(t={},n={},s={},r={},a){this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,n){return{id:t,frameName:n,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(s))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(t);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lp(e,t,n,s){const r=new Set,a=[];let o=null,i=null;const u=new Set,c=new Set(Object.keys(e).map(d=>En(d)[0]));s=s||[];const l=new Set(s.map(d=>En(d.name)[0])),f=[...t];for(;f.length>0;){const d=f.pop();if((Fr(d)||_C(d)||TC(d))&&o==null&&(o=d,i=o.children.map(m=>m.name).filter(m=>r.has(m))),r.add(d.name),n[d.name]==null&&!c.has(d.name)&&!l.has(d.name)){if(d.inputs.length===0){a.push(d.name);continue}d.inputs.forEach(m=>{u.has(m.name)||(u.add(m.name),f.push(m))})}}return{inputs:e,outputs:t,usedNodes:r,missingInputs:a,dynamicNode:o,syncInputs:i}}function wC(e,t){const{usedNodes:n,inputs:s}=t,r=Object.keys(s).map(b=>En(b)[0]).map(b=>e.nodes[b]),a=e.initNodes||[],o=b=>n.has(typeof b=="string"?b:b.name);function i(b){return[...new Map(b.map(k=>[k.name,k])).values()]}const u=i([...r,...e.weights,...a]).filter(o),c=i([...u,...Object.values(e.nodes)]).filter(o),l=new Map(c.map(b=>[b.name,b])),f={};for(const b of c){f[b.name]=f[b.name]||0;for(const k of b.children)o(k)||(f[k.name]=Number.POSITIVE_INFINITY),f[k.name]=(f[k.name]||0)+1}const d=Object.entries(f).filter(([,b])=>b===0).map(([b])=>b),m=[...d];for(;d.length>0;){const b=d.pop(),k=l.get(b);for(const I of k.children.filter(o))--f[I.name]===0&&(m.push(I.name),d.push(I.name))}const g=m.map(b=>l.get(b)),w=vC(g,u);return kC(w,u),w}function vC(e,t){const n=new Map(e.map(o=>[o.name,o])),s=t.map(o=>o.name),r=new Set(s);for(;s.length>0;){const o=s.pop(),i=n.get(o);for(const u of i.children)!n.has(u.name)||r.has(u.name)||(r.add(u.name),s.push(u.name))}return e.filter(o=>r.has(o.name))}class vi extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}function kC(e,t){const n=new Map(e.map((i,u)=>[i.name,u])),s=new Set(t.map(i=>i.name)),r=i=>s.has(typeof i=="string"?i:i.name),a=new Set(e.map(i=>i.name)),o=i=>a.has(typeof i=="string"?i:i.name);for(const i of e){for(const u of i.children.filter(o)){if(!n.has(u.name))throw new vi(`Child ${u.name} of node ${i.name} is unreachable.`);if(n.get(i.name)>n.get(u.name))throw new vi(`Node ${i.name} is scheduled to run after its child ${u.name}.`)}if(!r(i))for(const u of i.inputs){if(!n.has(u.name))throw new vi(`Input ${u.name} of node ${i.name} is unreachable.`);if(n.get(u.name)>n.get(i.name))throw new vi(`Node ${i.name} is scheduled to run before its input ${u.name}.`)}}}function xC(e){const t=new Map(e.map((i,u)=>[i.name,u])),n=Number.MAX_SAFE_INTEGER,s=e.map((i,u)=>Fr(i)?n:u),r=i=>{const u=s[t.get(i.name)];return u??-1},a=e.map((i,u)=>i.children.map(r).reduce((c,l)=>Math.max(c,l),s[u])),o=new Map;for(let i=0;i<e.length;++i){const u=a[i];if(u===n)continue;const c=e[i],l=e[u];o.has(l.name)||o.set(l.name,[]),o.get(l.name).push(c)}return o}const SC=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),NC=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),IC=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Fr(e){return SC.has(e.op)}function _C(e){return NC.has(e.op)}function TC(e){return IC.has(e.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ji{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const n=Object.keys(t).map(s=>t[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(s=>{this._functionExecutorMap[s]=new Ji(t.functions[s],this)})}getCompilationKey(t,n){const s=t.map(a=>a.name).sort(),r=n.map(a=>a.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(t,n){const s=lp(t,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:o}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const c=n.map(f=>f.name),l=Object.keys(t);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${l}]. Missing the following inputs: [${r}]`)}const i=wC(this.graph,s),u=xC(i);return{orderedNodes:i,nodeLiveUntilMap:u}}cloneAndKeepTensor(t){if(t==null)return null;const n=t.clone();return ls(n),n}cloneTensorList(t){return t?t.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(t,n){this.disposeIntermediateTensors(),t=this.mapInputs(t);const s=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(d=>this.graph.nodes[En(d)[0]]),a=n.map(d=>En(d)[0]),o=new Set(a);let i=a.map(d=>this.graph.nodes[d]);i.length===0&&(i=this._outputs);const u=this.getCompilationKey(r,i);let c=this.compiledMap.get(u);c==null&&(c=this.compile(t,i),this.compiledMap.set(u,c));try{this.keepIntermediateTensors=ie().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const l={},f={};return de(()=>{const d=new cp(this.weightMap,l,f,this.functionExecutorMap,this.parseNodeNameCache),m=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(k=>{const[I,T]=En(k,d),N=[];N[T]=t[k],m[I]=N,this.keepIntermediateTensors&&(this.clonedTensorsMap[I]=this.cloneTensorList(N))});const g=this.getFrozenTensorIds(m),{orderedNodes:w,nodeLiveUntilMap:b}=c;for(const k of w){if(m[k.name])continue;const I=up(k,m,d,this._resourceManager);if(zr(I))throw new Error(`The execution of the op '${k.op}' returned a promise. Please use model.executeAsync() instead.`);m[k.name]=I,this.keepIntermediateTensors&&(this.clonedTensorsMap[k.name]=this.cloneTensorList(I)),this.checkTensorForDisposalWithNodeLiveUntilInfo(k,m,d,g,o,b.get(k.name))}return this.parent==null&&d.dispose(g),n.map(k=>Xe(k,m,d))})}getFrozenTensorIds(t){const n=[].concat.apply([],Object.keys(t).map(s=>t[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(t,n,s,r,a,o,i){if(!(Fr(n)||o.has(t))){for(const u of s[t])u!=null&&(i[u.id]=(i[u.id]||0)+n.children.length);for(const u of n.inputs){if(Fr(u))continue;const c=sp(u.name,s,r);if(c!=null)for(const l of c){if(!l||l.kept||a.has(l.id))continue;const f=i[l.id];f===1?(l.dispose(),delete i[l.id]):f!=null&&i[l.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,n,s,r,a,o){function i(u){return Fr(u)||a.has(u.name)}if(!(Fr(t)||o==null))for(const u of o){if(i(u))continue;const c=sp(u.name,n,s);for(const l of c)!l||l.kept||r.has(l.id)||l.dispose()}}async executeAsync(t,n){return this._executeAsync(t,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(const n of t)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,n,s=!1,r={},a={}){this.disposeIntermediateTensors(),s||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=ie().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const o=new cp(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const i=await this.executeWithControlFlow(t,o,n,s),u=n.map(d=>Xe(d,i,o)),c=u.map(d=>d.id),l=Object.keys(t).map(d=>t[d].id),f=new Set([...c,...l,...this.weightIds]);return Object.values(i).forEach(d=>{d.forEach(m=>{m&&!m.isDisposed&&!f.has(m.id)&&m.dispose()})}),this.parent==null&&o.dispose(f),u}async executeFunctionAsync(t,n,s){const r=t.reduce((a,o,i)=>(a[this.inputs[i].name]=o,a),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(t,n,s,r){const a=Object.keys(t),o=a.map(N=>this.graph.nodes[En(N)[0]]),i=s.map(N=>En(N)[0]),u=new Set(i);let c=i.map(N=>this.graph.nodes[N]);c.length===0&&(c=this._outputs);const{usedNodes:l,missingInputs:f,dynamicNode:d,syncInputs:m}=lp(t,c,this.weightMap,this._initNodes),g=[...o,...this.graph.weights,...this._initNodes||[]].map(N=>({node:N,contexts:n.currentContext})),w=Object.assign({},this.weightMap);Object.keys(t).forEach(N=>{const[$,D]=En(N),P=[];P[D]=t[N],w[$]=P});const b={},k=this.getFrozenTensorIds(w),I={};for(;g.length>0;){const N=this.processStack(o,g,n,w,I,k,u,b,l);await Promise.all(N)}d==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const T=c.filter(N=>!Fr(N)&&!Xe(N.name,w,n)).map(N=>N.name);if(T.length>0){let N="";throw d!=null&&(N=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${m}]`),new Error(`Cannot compute the outputs [${T}] from the provided inputs [${a}]. Consider providing the following inputs: [${f}]. ${N}`)}return w}processStack(t,n,s,r,a,o,i,u,c){const l=[];for(;n.length>0;){const f=n.pop();s.currentContext=f.contexts;let d="";if(f.node.op==="Enter"&&v("isConstant",f.node,r,s)&&([d]=Es(f.node.name,s)),r[f.node.name]==null){const m=up(f.node,r,s,this._resourceManager);d||([d]=Es(f.node.name,s));const g=s.currentContext;zr(m)?l.push(m.then(w=>(r[d]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(w)),s.currentContext=g,this.checkTensorForDisposal(d,f.node,r,s,o,i,u),this.processChildNodes(f.node,n,s,r,a,c),w))):(r[d]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(m)),this.checkTensorForDisposal(d,f.node,r,s,o,i,u),this.processChildNodes(f.node,n,s,r,a,c))}else this.processChildNodes(f.node,n,s,r,a,c)}return l}processChildNodes(t,n,s,r,a,o){t.children.forEach(i=>{const[u]=Es(i.name,s);a[u]||!o.has(i.name)||(i.op==="Merge"?i.inputNames.some(c=>!!Xe(c,r,s))&&(a[u]=!0,n.push({contexts:s.currentContext,node:i})):i.inputNames.every(c=>!!Xe(c,r,s))&&(a[u]=!0,n.push({contexts:s.currentContext,node:i})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{const s=t[n],[r]=En(n),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const o=a.attrParams.shape.value,i=o.length===s.shape.length&&s.shape.every((u,c)=>o[c]===-1||o[c]===u);A(i,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&A(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(t){var n,s;const r={};for(const a in t){const o=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[a];o!=null?r[o.name]=t[a]:r[a]=t[a]}return r}checkInputs(t){const n=Object.keys(t).filter(s=>{const[r]=En(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>{var s,r;const a=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return a!=null?a.name:n},{})}checkOutputs(t){t.forEach(n=>{const[s]=En(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class EC{constructor(t={},n={}){this.hashTableNameToHandle=t,this.hashTableMap=n}addHashTable(t,n){this.hashTableNameToHandle[t]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $C="?tfjs-format=file",CC="model.json";class AC{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,n={},s=hb){this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new EC}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const n=this.io.getLoadHandlers(t,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[t]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return zr(t)?t.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(t)}loadSync(t){const n=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,n)}async loadStreaming(t){if(t.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await iy(t.getWeightStream(),t.weightSpecs);return this.loadWithWeightMap(t,n)}loadWithWeightMap(t,n){this.artifacts=t;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new Ji(rp.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const a=rp.Instance.transformGraph(t.modelInitializer);this.initializer=new Ji(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}async save(t,n){if(typeof t=="string"){const s=this.io.getSaveHandlers(t);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${t}'`);t=s[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}addStructuredOutputNames(t){if(this.structuredOutputKeys){const n=t instanceof cn?[t]:t,s={};return n.forEach((r,a)=>s[this.structuredOutputKeys[a]]=r),s}return t}predict(t,n){const s=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(t,n){const s=await this.executeAsync(t,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(t){var n;if(!(t instanceof cn)&&!Array.isArray(t)){const a=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(a!=null)for(const o in a){const i=a[o];i.resourceId!=null&&(t[o]=this.resourceIdToCapturedInput[i.resourceId])}return t}t=Array.isArray(t)?t:[t];const s=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${t.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,o)=>{var i,u,c;const l=(c=(u=(i=this.signature)===null||i===void 0?void 0:i.inputs)===null||u===void 0?void 0:u[o])===null||c===void 0?void 0:c.resourceId;return l!=null?a[o]=this.resourceIdToCapturedInput[l]:a[o]=t[r++],a},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const a=s[r],o=n[a];this.resourceIdToCapturedInput[o.resourceId]=t[r]}}}execute(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=this.executor.execute(t,n);return s.length>1?s:s[0]}async executeAsync(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(t,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((n,s)=>(n[s]=[t[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Sn(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function DC(e,t={},n=hb){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=OC(e));const s=new AC(e,t,n);return await s.load(),s}function OC(e){return e.endsWith("/")||(e=e+"/"),`${e}${CC}${$C}`}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jt(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&A(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FC=Jy;class $u extends Jp{nextDataId(){return $u.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Vw(this,Rd())}write(t,n,s){this.firstUse&&(this.firstUse=!1,ie().get("IS_NODE")&&Ar(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:s,refCount:1}),r}makeTensorInfo(t,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&gu(s[0])){const a=s.map(o=>Mr(o));r=this.write(a,t,n)}else r=this.write(s,t,n);return{dataId:r,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,s,r,a){this.data.set(t,{values:n,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:s}=this.data.get(t);if(n==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return Ea(r,a)}return Gw(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(r=>xo(r));return ce(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ce(t.shape,t.dtype,n)}makeOutput(t,n,s){return Rd().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=Na();return t(),{kernelMs:Na()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){jt([t],"where");const n=this.readSync(t.dataId);return FC(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}$u.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RC(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const PC=e=>{const{x:t}=e.inputs,n=e.backend;jt(t,"abs");let s=new Float32Array(Nt(t.shape));const r=n.data.get(t.dataId).values;return s=RC(r),n.makeOutput(s,t.shape,t.dtype)},MC={kernelName:sm,backendName:"cpu",kernelFunc:PC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Me(e){return(t,n,s,r,a)=>{const o=Fe(t,n),i=o.length,u=Kt(o),c=Nt(o),l=pn(a,c),f=t.length,d=n.length,m=Kt(t),g=Kt(n),w=Ki(t,o),b=Ki(n,o);if(w.length+b.length===0)for(let k=0;k<l.length;++k)l[k]=e(s[k%s.length],r[k%r.length]);else for(let k=0;k<l.length;++k){const I=Ma(k,i,u),T=I.slice(-f);w.forEach(P=>T[P]=0);const N=fs(T,f,m),$=I.slice(-d);b.forEach(P=>$[P]=0);const D=fs($,d,g);l[k]=e(s[N],r[D])}return[l,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cn(e){const{inputs:t,backend:n}=e,{real:s,imag:r}=t,a=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,i=n.makeTensorInfo(s.shape,"complex64"),u=n.data.get(i.dataId);return u.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",a),imag:n.makeTensorInfo(r.shape,"float32",o)},i}const VC={kernelName:mm,backendName:"cpu",kernelFunc:Cn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qi(e,t,n="float32"){if(n==="complex64"){const r=Qi(e,t,"float32"),a=Qi(e,t,"float32");return Cn({inputs:{real:r,imag:a},backend:e})}const s=tn(Nt(t),n);return e.makeTensorInfo(t,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ys(e){const{inputs:t,backend:n}=e,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const LC={kernelName:gf,backendName:"cpu",kernelFunc:ys};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gr(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.real,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const zC={kernelName:pg,backendName:"cpu",kernelFunc:Gr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BC(e,t,n,s){if(s==="int32"){const r=Int32Array.from(e);return[t,"int32",r]}if(s==="bool"){const r=Xr([0],n),[a,o]=Me((i,u)=>i!==u?1:0)(t,[],e,r,"bool");return[o,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function hr(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return ys({inputs:{x:r},backend:n});const l=Qi(n,r.shape,r.dtype),f=hr({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),d=Cn({inputs:{real:f,imag:l},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),d}if(r.dtype==="complex64"){const l=Gr({inputs:{input:r},backend:n}),f=hr({inputs:{x:l},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(l),f}if(!Hw(r.dtype,a)){const l=ys({inputs:{x:r},backend:n});return{dataId:l.dataId,shape:l.shape,dtype:a}}const o=n.data.get(r.dataId).values,[i,u,c]=BC(o,r.shape,r.dtype,a);return n.makeTensorInfo(i,u,c)}const WC={kernelName:tf,backendName:"cpu",kernelFunc:hr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function He(e,t,n,s){return n==null?({inputs:r,backend:a})=>{const{a:o,b:i}=r,u=a;jt([o,i],e);const c=u.data.get(o.dataId).values,l=u.data.get(i.dataId).values,f=o.dtype==="string"?Ao(c):c,d=o.dtype==="string"?Ao(l):l,m=s||o.dtype,[g,w]=t(o.shape,i.shape,f,d,m);return u.makeTensorInfo(w,m,g)}:({inputs:r,backend:a})=>{const{a:o,b:i}=r,u=a;if(o.dtype==="complex64"||i.dtype==="complex64"){const c=hr({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),l=u.data.get(c.dataId),f=l.complexTensorInfos.real,d=l.complexTensorInfos.imag,m=u.data.get(f.dataId).values,g=u.data.get(d.dataId).values,w=hr({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),b=u.data.get(w.dataId),k=b.complexTensorInfos.real,I=b.complexTensorInfos.imag,T=u.data.get(k.dataId).values,N=u.data.get(I.dataId).values,[$,D,P]=n(o.shape,i.shape,m,g,T,N),L=u.makeTensorInfo(P,"float32",$),R=u.makeTensorInfo(P,"float32",D),M=Cn({inputs:{real:L,imag:R},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(w),u.disposeIntermediateTensorInfo(L),u.disposeIntermediateTensorInfo(R),M}else{const c=u.data.get(o.dataId).values,l=u.data.get(i.dataId).values,f=s||o.dtype,[d,m]=t(o.shape,i.shape,c,l,f);return u.makeTensorInfo(m,f,d)}}}function vh(e){return(t,n,s,r,a,o)=>{const i=Fe(t,n),u=Nt(i),c=i.length,l=Kt(i),f=pn("float32",u),d=pn("float32",u),m=Ki(t,i),g=Ki(n,i),w=Ea(s,r),b=Ea(a,o),k=t.length,I=Kt(t),T=n.length,N=Kt(n);if(m.length+g.length===0)for(let $=0;$<f.length;$++){const D=$%w.length,P=$%b.length,L=e(w[D*2],w[D*2+1],b[P*2],b[P*2+1]);f[$]=L.real,d[$]=L.imag}else for(let $=0;$<f.length;$++){const D=Ma($,c,l),P=D.slice(-k);m.forEach(K=>P[K]=0);const L=fs(P,k,I),R=D.slice(-T);g.forEach(K=>R[K]=0);const M=fs(R,T,N),E=e(w[L*2],w[L*2+1],b[M*2],b[M*2+1]);f[$]=E.real,d[$]=E.imag}return[f,d,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jC=Me(((e,t)=>e+t)),HC=vh(((e,t,n,s)=>({real:e+n,imag:t+s}))),$a=He(yu,jC,HC),qC={kernelName:yu,backendName:"cpu",kernelFunc:$a};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vb(e,t,n,s,r){const a=Nt(s),o=tn(r,n);for(let i=0;i<e.length;i++){const u=e[i];if(u<0)throw new Error("Input x must be non-negative!");u>=r||(a>0?o[u]+=t[i]:o[u]+=1)}return o}function KC(e,t,n,s=!1){const r=e.shape[0],a=e.shape[1],o=ce([r,n],t.dtype);for(let i=0;i<r;i++)for(let u=0;u<a;u++){const c=e.get(i,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,i,c):t.size>0?o.set(o.get(i,c)+t.get(i,u),i,c):o.set(o.get(i,c)+1,i,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UC=Me(((e,t)=>e&t)),GC=He(Ql,UC),YC={kernelName:Ql,backendName:"cpu",kernelFunc:GC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yr(e){return(t,n,s)=>{const r=ze(n,t.length);for(let a=0;a<t.length;++a)r[a]=e(t[a],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(e,t,n){const s=yr(t);return br(e,s,n)}function br(e,t,n){return({inputs:s,attrs:r,backend:a})=>{const{x:o}=s;jt(o,e);const i=a,u=i.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");c=Ao(u)}else c=u;const l=n||o.dtype,f=t(c,l,r);return i.makeTensorInfo(o.shape,l,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XC=yr(e=>Math.ceil(e)),ZC=br(ef,XC),JC={kernelName:ef,backendName:"cpu",kernelFunc:ZC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QC(e,t,n,s){const r=ze(n,Nt(t));if(s&&n!=="string"){let a=0;e.forEach(o=>{const i=Nt(o.shape);r.set(o.vals,a),a+=i})}else{let a=0;e.forEach(o=>{const i=n==="string"?Ao(o.vals):o.vals;let u=0;for(let c=0;c<o.shape[0];++c){const l=c*t[1]+a;for(let f=0;f<o.shape[1];++f)r[l+f]=i[u++]}a+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tA=Me((e,t)=>e===t?1:0),kb=He(cf,tA,null,"bool"),eA={kernelName:cf,backendName:"cpu",kernelFunc:kb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nA=yr(e=>Math.exp(e)),xb=br(lf,nA,"float32"),sA={kernelName:lf,backendName:"cpu",kernelFunc:xb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rA=yr(e=>Math.expm1(e)),aA=br(ff,rA),oA={kernelName:ff,backendName:"cpu",kernelFunc:aA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iA=yr(e=>Math.floor(e)),uA=br(hf,iA),cA={kernelName:hf,backendName:"cpu",kernelFunc:uA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lA=Me((e,t)=>Math.floor(e/t)),fA=He(df,lA,null,"int32"),hA={kernelName:df,backendName:"cpu",kernelFunc:fA};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dA(e,t,n,s,r,a,o,i,u){const c=ce([s,a],n);for(let l=0;l<s;l++){const f=[];let d=0;for(let m=0;m<r;m++){const g=e[l*r+m];d+=g*o[m],f.push(g)}if(d<0||d>=u/a)throw new Error(`Invalid indices: ${f} does not index into ${i}`);for(let m=0;m<a;m++)c.values[l*a+m]=t.get(...t.indexToLoc(d*a+m))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pA(e,t,n){const s=ce(n,e.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),i=o[0],u=o[2],c=t.locToIndex([i,u]);o[2]=t.values[c];const l=e.locToIndex(o);0<=l&&l<e.values.length&&(s.values[r]=e.values[l])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mA=Me((e,t)=>e>t?1:0),gA=He(pf,mA,null,"bool"),yA={kernelName:pf,backendName:"cpu",kernelFunc:gA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bA=Me((e,t)=>e>=t?1:0),wA=He(mf,bA,null,"bool"),vA={kernelName:mf,backendName:"cpu",kernelFunc:wA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kA=Me((e,t)=>e<t?1:0),xA=He(vf,kA,null,"bool"),SA={kernelName:vf,backendName:"cpu",kernelFunc:xA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NA=Me((e,t)=>e<=t?1:0),IA=He(kf,NA,null,"bool"),_A={kernelName:kf,backendName:"cpu",kernelFunc:IA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TA(e,t,n){const s=(t-e)/(n-1),r=tn(n,"float32");r[0]=e;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EA=yr(e=>Math.log(e)),$A=br(xf,EA),CA={kernelName:xf,backendName:"cpu",kernelFunc:$A};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AA(e,t,n,s){const r=pn(s,Nt(n));for(let a=0;a<r.length;++a){const o=a*t;let i=e[o];for(let u=0;u<t;++u){const c=e[o+u];(Number.isNaN(c)||c>i)&&(i=c)}r[a]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DA=Me(((e,t)=>Math.max(e,t))),OA=He(Tf,DA),FA={kernelName:Tf,backendName:"cpu",kernelFunc:OA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RA=Me(((e,t)=>Math.min(e,t))),PA=He(Ef,RA),MA={kernelName:Ef,backendName:"cpu",kernelFunc:PA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sb=Me(((e,t)=>e*t)),VA=vh(((e,t,n,s)=>({real:e*n-t*s,imag:e*s+t*n}))),Cu=He(Cf,Sb,VA),LA={kernelName:Cf,backendName:"cpu",kernelFunc:Cu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zA(e,t,n){const s=Jf(-1,n);return Sb([],t,s,e,n)}function BA(e){const{inputs:t,backend:n}=e,{x:s}=t;jt(s,"neg");const r=n.data.get(s.dataId).values,[a,o]=zA(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,a)}const WA={kernelName:tg,backendName:"cpu",kernelFunc:BA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jA=Me(((e,t)=>e!==t?1:0)),HA=He(Af,jA,null,"bool"),qA={kernelName:Af,backendName:"cpu",kernelFunc:HA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nb(e,t,n,s,r){const a=t.length,o=Nt(t),i=Kt(t),u=Kt(r),c=pn(n,Nt(r));for(let l=0;l<o;++l){const f=Ma(l,a,i),d=new Array(f.length);for(let g=0;g<d.length;g++)d[g]=f[s[g]];const m=fs(d,a,u);c[m]=e[l]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function In(e){const{inputs:t,attrs:n,backend:s}=e,{x:r}=t,{perm:a}=n;jt(r,"transpose");const o=r.shape.length,i=new Array(o);for(let f=0;f<i.length;f++)i[f]=r.shape[a[f]];const u=s.data.get(r.dataId).values,c=Nb(u,r.shape,r.dtype,a,i);return{dataId:s.write(c,i,r.dtype),shape:i,dtype:r.dtype}}const KA={kernelName:_i,backendName:"cpu",kernelFunc:In};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UA(e,t,n,s){const[r,a]=Bs(e,s),o=Va(t,"int32"),i=tn(Nt(r),o),u=Nt(a);for(let c=0;c<i.length;++c){const l=c*u;let f=1;for(let d=0;d<u;++d)f*=n[l+d];i[c]=f}return{outVals:i,outShape:r,outDtype:o}}function GA(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,keepDims:o}=s;jt(r,"prod");const i=r.shape.length,u=Ue(a,r.shape),c=ks(u,i);let l=u,f=r;const d=[];c!=null&&(f=In({inputs:{x:r},backend:n,attrs:{perm:c}}),d.push(f),l=xs(l.length,i));const m=n.data.get(f.dataId).values,{outVals:g,outShape:w,outDtype:b}=UA(f.shape,f.dtype,m,l);let k=w;return o&&(k=es(w,u)),d.forEach(I=>n.disposeIntermediateTensorInfo(I)),n.makeTensorInfo(k,b,g)}const YA={kernelName:cg,backendName:"cpu",kernelFunc:GA};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XA(e,t,n){e.forEach((s,r)=>{if(s<0||s>=n){const a=Ma(r,t.length,Kt(t)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${n})`)}})}function ZA(e,t){for(let n=0;n<e.length;++n){const s=e[n],r=n===e.length-1?t:e[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function JA(e,t,n,s){const r=[];let a=0;const o=t.length-1+n.length,i=new Array(o).fill(null).map(()=>[0]);ZA(n,s);let u=1;for(let c=0;c<t.length-1;++c){u*=t[c];const l=t[c+1];for(let f=1;f<u+1;++f)i[c].push(f*l)}for(let c=0;c<e.length;++c){let l=e[c],f=e[c]+1;for(let d=0;d<n.length;++d){const m=n[d],g=d+t.length-1;if(g>=0){const w=i[g],b=w[w.length-1]-m[l];for(let k=l;k<f;++k)i[g].push(m[k+1]+b)}l=m[l],f=m[f]}f!==l&&(r.push([l,f]),a+=f-l)}return{outSplits:i,valueSlices:r,numValues:a}}function QA(e){const t=[];for(let n=0;n<e.length;++n){const s=e[n].length,r=ze("int32",s);t.push(r),e[n].forEach((a,o)=>r[o]=a)}return t}function fp(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let s=t;s<e.length;s++)n[t-1]*=e[s];return n}function tD(e,t,n,s,r,a){const o=fp(t,2)[1],i=fp(a,2)[1];let u=0;for(const c of n)for(let l=c[0];l<c[1];++l){for(let f=0;f<s;++f)r[u*i+f]=e[l*o+f];++u}}function eD(e,t,n,s,r){const a=t.slice();a[0]=r;const o=ze(n,Nt(a)),i=e.length,u=i===0?0:i/t[0];return tD(e,t,s,u,o,a),[o,a]}function nD(e,t,n,s,r,a,o,i){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const u=t[0][0]-1;if(XA(a,o,u),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:l,valueSlices:f,numValues:d}=JA(a,o,e,c),m=QA(l),g=eD(n,s,r,f,d);return[m,g[0],g[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hp=2147483647;function sD(e,t,n,s,r,a,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const i=t.length===0,u=r.length===0,c=o.length===0,l=[];i||l.push(t[0]),u||l.push(r[0]),c||l.push(o[0]);for(let b=1;b<l.length;++b)if(l[b]!==l[b-1])throw new Error("starts, limits, and deltas must have the same shape");const f=l.length===0?1:l[0],d=ze("int32",f+1);d[0]=0;for(let b=0;b<f;++b){const k=i?e[0]:e[b],I=u?s[0]:s[b],T=c?a[0]:a[b];if(T===0)throw new Error("Requires delta != 0");let N;if(T>0&&I<k||T<0&&I>k)N=0;else if(N=Math.ceil(Math.abs((I-k)/T)),N>hp)throw new Error(`Requires ((limit - start) / delta) <= ${hp}`);d[b+1]=d[b]+N}const m=d[f],g=ze(n,m);let w=0;for(let b=0;b<f;++b){const k=d[b+1]-d[b];let I=i?e[0]:e[b];const T=c?a[0]:a[b];for(let N=0;N<k;++N)g[w++]=I,I+=T}return[d,g]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zn=us;class tu{constructor(t,n,s,r,a,o,i,u,c,l){this.shape=t,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=i,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=b2(l),this.raggedRank=w2(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===zn.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===zn.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case zn.VALUE_ROWIDS:return tu.getMaxWidthValueRowID(n);case zn.ROW_SPLITS:return tu.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${zn[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const a=t[r+1]-t[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let s=0,r=t[0],a=0;for(let o=1;o<n;++o){const i=t[o];i!==r&&(r=i,a=Math.max(o-s,a),s=o)}return Math.max(n-s,a)}tensorShapeFromTensor(t,n,s=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return pp(t,s)}calculateOutputSize(t){const n=this.valuesShape,s=this.defaultValueShape;v2(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=y2(this.raggedRank,r,n);o[0]<0&&(o[0]=t);for(let i=1;i<=this.raggedRank;++i)o[i]<0&&(o[i]=this.getMaxWidth(i));return o}calculateFirstParentOutputIndex(t,n,s){const r=Math.min(t,s),a=[];let o=0;for(let i=0;i<r;++i,o+=n)a.push(o);for(let i=r;i<t;++i)a.push(-1);return A(a.length===t,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(t,n,s,r){const a=t.length,o=[];for(let i=0;i<a-1;++i){const u=t[i+1]-t[i];let c=Math.min(r,u),l=n[i];l===-1&&(c=0);for(let f=0;f<c;++f)o.push(l),l+=s;for(let f=0;f<u-c;++f)o.push(-1)}if(a>0&&o.length!==t[a-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,n,s,r){const a=t.length,o=[];if(a===0)return[];let i=0,u=t[0];if(u>=n.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${n.length}`);let c=n[u];o.push(c);for(let l=1;l<a;++l){const f=t[l];if(f===u)c>=0&&(++i,i<r?c+=s:c=-1);else{if(i=0,u=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);c=n[f]}o.push(c)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,n,s,r){const a=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case zn.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,s,r);case zn.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,s,r);default:throw new Error(`Unsupported partition type: ${zn[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case zn.FIRST_DIM_SIZE:return t[0];case zn.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case zn.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${zn[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let u=r.length-2;u>=0;--u)r[u]=r[u+1]*s[u+1];const a=pp(s,!1),o=ze(this.valuesDType,Nt(a));if(r[0]*s[0]>0){let u=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)u=this.calculateOutputIndex(c-1,u,r[c],s[c]);this.setOutput(this.raggedRank,u,o,a)}return[a,o]}setOutput(t,n,s,r){if(s.length===0)return;const a=this.values,o=s;let i=r.slice();i=i.slice(t+1);const u=Nt(i),c=n.length;let l=this.defaultValue;if(l.length!==u&&l.length!==1){const g=this.defaultValueShape;de(()=>{const w=pt(l,g);l=uo(w,i).dataSync()})}let f=0,d=0,m=0;for(let g=0;g<=c;++g){let w=g<c?n[g]:-1;if(w===m){++m;continue}if(d<m){const b=a.subarray(f*u),k=o.subarray(d*u),I=(m-d)*u;dp(k,b,I)}if(g>=c){const b=s.length;w=Math.floor(b/u)}if(w>m)if(this.defaultValue.length===1)o.subarray(m*u,w*u).fill(this.defaultValue[0]),m=w;else for(;w>m;){const b=o.slice(m*u);dp(b,l,u),++m}w<0?(f=g+1,d=m):(f=g,d=m,m=d+1)}}}function dp(e,t,n){for(let s=0;s<n;s++)e[s]=t[s]}function pp(e,t){const n=[];for(let s of e){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function rD(e,t,n,s,r,a,o,i,u,c){return new tu(e,t,n,s,r,a,o,i,u,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aD(e,t,n,s){const r=e===t,a=e<t&&n<0,o=t<e&&n>1;if(r||a||o)return tn(0,s);const i=Math.abs(Math.ceil((t-e)/n)),u=tn(i,s);t<e&&n===1&&(n=-1),u[0]=e;for(let c=1;c<u.length;c++)u[c]=u[c-1]+n;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oD=yr(e=>1/Math.sqrt(e)),iD=br(Mf,oD),uD={kernelName:Mf,backendName:"cpu",kernelFunc:iD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pa(e,t,n,s,r,a,o,i,u,c){const l=[s/r,r],f=e.values,d=t.values;if(s===0)return ce(n,t.dtype);const m=u instanceof je?u:ce(l,t.dtype);typeof u=="string"||typeof u=="number"?m.values.fill(u):typeof u=="boolean"&&m.values.fill(+u);for(let g=0;g<a;g++){const w=[];let b=0;for(let k=0;k<o;k++){const I=f[g*o+k];w.push(I),b+=I*i[k]}if(b<0||b>=s/r)throw new Error(`Invalid indices: ${w} does not index into ${n}`);for(let k=0;k<r;k++)c?m.values[b*r+k]+=d[g*r+k]:m.values[b*r+k]=t.rank===0?d[0]:d[g*r+k]}return m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ib=ye(Wf,e=>1/(1+Math.exp(-e))),cD={kernelName:Wf,backendName:"cpu",kernelFunc:Ib};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lD(e,t,n,s,r){const a=f2(s,t,n),o=Nt(n),i=Kt(s);if(a){const f=h2(t,i);return r==="string"?e.slice(f,f+o):e.subarray(f,f+o)}const u=r==="string"?Ao(e):e,c=ce(s,r,u),l=ce(n,r);for(let f=0;f<l.size;++f){const d=l.indexToLoc(f),m=d.map((g,w)=>g+t[w]);l.set(c.get(...m),...d)}return r==="string"?r$(l.values):l.values}function Yr(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:a,size:o}=s;jt(r,"slice");const[i,u]=d2(r,a,o);c2(r,i,u);const c=n.data.get(r.dataId).values,l=lD(c,i,u,r.shape,r.dtype);return n.makeTensorInfo(u,r.dtype,l)}const fD={kernelName:Sg,backendName:"cpu",kernelFunc:Yr};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hD(e,t,n,s,r,a,o){const i=t[0],u=a[0],c=new Array(u),l=new Array(i),f=t[1];if(u===0){if(i!==0)throw new Error(K2(i));const b=ze(n,0),k=ze(r,0);return[b,[0,f],k,c,l]}let d=!0,m=0;const g=new Array(u).fill(0);for(let b=0;b<i;++b){const k=e[b*f];if(k<0)throw new Error(U2(b,k));if(k>=u)throw new Error(G2(b,k,u));++g[k],d=d&&k>=m,m=k}let w=!0;for(let b=0;b<u;++b){const k=g[b]===0;c[b]=k,w=w&&!k,g[b]=Math.max(g[b],1),b>0&&(g[b]+=g[b-1])}if(w&&d){const b=e,k=s;for(let I=0;I<i;++I)l[I]=I;return[b,[i,f],k,c,l]}else{const b=g[u-1],k=ze(n,b*f),I=ze(r,b),T=new Array(u).fill(0);for(let N=0;N<i;++N){const $=e[N*f],D=T[$],P=($===0?0:g[$-1])+D;T[$]++;for(let L=0;L<f;++L)k[P*f+L]=e[N*f+L];I[P]=s[N],l[N]=P}for(let N=0;N<u;++N)if(T[N]===0){const D=N===0?0:g[N-1];k[D*f+0]=N;for(let P=1;P<f;++P)k[D*f+P]=0;I[D]=o}return[k,[b,f],I,c,l]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dD(e,t,n,s,r){const a=Nt(s),o=t[0],i=r.length,u=[];let c=1,l=-1;for(let b=0;b<i;++b){const k=r[b];if(k===-1){if(l!==-1)throw new Error(Y2(l,b));l=b,u.push(1)}else{if(k<0)throw new Error(X2(b,k));c*=k,u.push(k)}}if(l!==-1){if(c<=0)throw new Error(Z2());const b=Math.trunc(a/c);if(c*b!==a)throw new Error(J2(s,u));u[l]=b}if(Nt(u)!==a)throw new Error(Q2(s,u));const d=s.length,m=[];if(d>0){m[d-1]=1;for(let b=d-2;b>=0;--b)m[b]=m[b+1]*s[b+1]}const g=[];if(i>0){g[i-1]=1;for(let b=i-2;b>=0;--b)g[b]=g[b+1]*u[b+1]}const w=ze(n,o*i);for(let b=0;b<o;++b){let k=0;for(let I=0;I<d;++I)k+=e[b*d+I]*m[I];for(let I=0;I<i;++I)w[b*i+I]=Math.trunc(k/g[I]),k%=g[I]}return[w,[o,i],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _b(e,t,n,s,r,a=!1,o=0){const i=s.length,u=[t[0],e.length/t[0]],c=u[1],f=i>0?r[i-1]+1:0;if(f<0)throw new Error(ep());const d=t.slice();d[0]=f;const m=d.reduce((T,N)=>T*N,1),g=ze(n,m);if(i===0)return f>0&&g.fill(o),[g,d];if(f<=0)throw new Error(ep());let w=0,b=1,k=0,I=r[w];for(;;){let T=0;if(b<i){if(T=r[b],I===T){++b;continue}if(I>=T)throw new Error(t$())}if(I<0||I>=f)throw new Error(e$(I,f));I>k&&g.fill(o,k*c,I*c);for(let N=w;N<b;++N){const $=s[N];if($<0||$>=u[0])throw new Error(n$(N,s[N],u[0]));for(let D=0;D<c;D++)g[I*c+D]+=e[$*c+D]}if(a)for(let N=0;N<c;N++)g[I*c+N]/=b-w;if(w=b,++b,k=I+1,I=T,b>i)break}return k<f&&g.fill(o,k*c,f*c),[g,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pD=ye(Hf,e=>Math.sqrt(e)),mD={kernelName:Hf,backendName:"cpu",kernelFunc:pD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gD=Me(((e,t)=>{const n=e-t;return n*n})),yD=He(qf,gD),bD={kernelName:qf,backendName:"cpu",kernelFunc:yD};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wD=yr((e,t)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=t;return e.replace(new RegExp(n,s?"g":""),r)}),vD=br(Kf,wD),kD={kernelName:Kf,backendName:"cpu",kernelFunc:vD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xD(e,t,n,s){const r=ce(e,t.dtype);for(let a=0;a<r.size;a++){const o=r.indexToLoc(a),i=new Array(o.length);for(let u=0;u<i.length;u++)i[u]=o[u]*n[u]+s[u];r.set(t.get(...i),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SD{constructor(t,n,s,r,a,o){this.separator=Mr(t),this.nGramWidths=n,this.leftPad=Mr(s),this.rightPad=Mr(r),this.padWidth=a,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const s=this.getPadWidth(n);return Math.max(0,t+2*s-n+1)}createNGrams(t,n,s,r,a,o){for(let i=0;i<a;++i){const u=this.getPadWidth(o),c=Math.max(0,u-i),l=Math.max(0,u-(a-(i+1))),f=o-(c+l),d=n+(c>0?0:i-u);let m=0;m+=c*this.leftPad.length;for(let I=0;I<f;++I)m+=t[d+I].length;m+=l*this.rightPad.length;const g=c+l+f-1;m+=g*this.separator.length,s[r+i]=new Uint8Array(m);const w=s[r+i];let b=0;const k=I=>I.forEach(T=>w[b++]=T);for(let I=0;I<c;++I)k(this.leftPad),k(this.separator);for(let I=0;I<f-1;++I)k(t[d+I]),k(this.separator);if(f>0){k(t[d+f-1]);for(let I=0;I<l;++I)k(this.separator),k(this.rightPad)}else{for(let I=0;I<l-1;++I)k(this.rightPad),k(this.separator);k(this.rightPad)}}}compute(t,n){const s=t.length,r=n.length;if(r>0){let u=n[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let c=1;c<r;++c){let l=n[c]>=u;if(l=l&&n[c]<=s,!l)throw new Error(`Invalid split value ${n[c]}, must be in [${u}, ${s}]`);u=n[c]}if(u!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${u}`)}const a=r-1,o=ze("int32",r);if(s===0||r===0){const u=new Array(s);for(let c=0;c<=a;++c)o[c]=0;return[u,o]}o[0]=0;for(let u=1;u<=a;++u){const c=n[u]-n[u-1];let l=0;this.nGramWidths.forEach(f=>{l+=this.getNumNGrams(c,f)}),this.preserveShort&&c>0&&l===0&&(l=1),o[u]=o[u-1]+l}const i=new Array(o[a]);for(let u=0;u<a;++u){const c=n[u];let l=o[u];if(this.nGramWidths.forEach(f=>{const d=n[u+1]-n[u],m=this.getNumNGrams(d,f);this.createNGrams(t,c,i,l,m,f),l+=m}),this.preserveShort&&l===o[u]){const f=n[u+1]-n[u];if(f===0)continue;const d=f+2*this.padWidth;this.createNGrams(t,c,i,l,1,d)}}return[i,o]}}function ND(e,t,n,s,r,a,o,i){return new SD(n,s,r,a,o,i).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ID(e,t,n,s){if(!e.length)return;if(t.length===0){for(let a=0;a<e.length;++a)s.push(e.subarray(a,a+1));return}if(t.length===1){const a=t[0];let o=e.indexOf(a);for(;o!==-1;){const i=e.subarray(0,o);(!n||i.length!==0)&&s.push(i),e=e.subarray(o+1),o=e.indexOf(a)}(!n||e.length!==0)&&s.push(e);return}let r=0;for(let a=0;a<e.length+1;a++)if(a===e.length||t.indexOf(e[a])!==-1){const o=e.subarray(r,a);(!n||o.length!==0)&&s.push(o),r=a+1}}function _D(e,t,n){const s=e.length,r=[];let a=0,o=0;const i=new Array(s);for(let d=0;d<s;++d){const m=r.length;ID(e[d],t,n,r);const g=r.length-m;i[d]=g,a+=g,o=Math.max(o,g)}const u=ze("int32",a*2),c=new Array(a),l=[s,o];let f=0;for(let d=0;d<s;++d)for(let m=0;m<i[d];++m)u[f*2]=d,u[f*2+1]=m,c[f]=r[f],++f;return[u,c,l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TD(e,t){const n=ze("int32",e.length);for(let s=0;s<e.length;++s)n[s]=xv(e[s]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ED=Me(((e,t)=>e-t)),$D=vh(((e,t,n,s)=>({real:e-n,imag:t-s}))),kh=He(Uf,ED,$D),CD={kernelName:Uf,backendName:"cpu",kernelFunc:kh};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AD(e,t){const n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];const s=ce(n,e.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),o=new Array(e.rank);for(let u=0;u<o.length;u++)o[u]=a[u]%e.shape[u];const i=e.locToIndex(o);s.values[r]=e.values[i]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ao=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function Tb(e,t,n=0,s=e.length-1){for(;s>n;){if(s-n>600){const i=s-n+1,u=t-n+1,c=Math.log(i),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(i-l)/i)*Math.sign(u-i/2),d=Math.max(n,Math.floor(t-u*l/i+f)),m=Math.min(s,Math.floor(t+(i-u)*l/i+f));Tb(e,t,d,m)}const r=e[t];let a=n,o=s;for(Za(e,n,t),ao(e[s],r)>0&&Za(e,n,s);a<o;){for(Za(e,a,o),a++,o--;ao(e[a],r)<0;)a=a+1;for(;ao(e[o],r)>0;)o=o-1}ao(e[n],r)===0?Za(e,n,o):(o=o+1,Za(e,o,s)),o<=t&&(n=o+1),t<=o&&(s=o-1)}}function DD(e,t,n,s,r){const a=t[t.length-1],[o,i]=[e.length/a,a],u=pn(n,o*s),c=pn("int32",o*s);for(let f=0;f<o;f++){const d=f*i,m=e.subarray(d,d+i);let g=new Array(m.length);m.forEach((I,T)=>g[T]={value:I,index:T}),s<g.length&&(Tb(g,s),g=g.slice(0,s)),r&&g.sort(ao);const w=f*s,b=u.subarray(w,w+s),k=c.subarray(w,w+s);for(let I=0;I<s;I++)b[I]=g[I].value,k[I]=g[I].index}const l=t.slice();return l[l.length-1]=s,[ce(l,n,u),ce(l,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OD(e,t,n,s){const r=Ue(t,n)[0],a=[1,n[0],1];for(let g=0;g<r;g++)a[0]*=n[g];a[1]=n[r];for(let g=r+1;g<n.length;g++)a[2]*=n[g];const o=new Map,i=new Int32Array(n[r]),u=new je(a,s,e),c=[],l=a[0]===1&&a[2]===1;for(let g=0;g<n[r];g++){let w;if(l)w=e[g].toString();else{const k=[];for(let I=0;I<a[0];I++)for(let T=0;T<a[2];T++)k.push(u.get(I,g,T));w=k.join(",")}const b=o.get(w);if(b!=null)i[g]=b;else{const k=o.size;o.set(w,k),i[g]=k,c.push(g)}}const f=a.slice();f[1]=o.size;const d=new je(f,s);c.forEach((g,w)=>{for(let b=0;b<a[0];b++)for(let k=0;k<a[2];k++)d.set(u.get(b,g,k),b,w,k)});const m=n.slice();return m[r]=f[1],{outputValues:d.values,outputShape:m,indices:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */jv("cpu",()=>new $u,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eb=ye(of,e=>e>=0?e:Math.exp(e)-1),FD={kernelName:of,backendName:"cpu",kernelFunc:Eb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $b(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{alpha:a}=s;jt([r],"leakyRelu");const o=Nt(r.shape),i=n.data.get(r.dataId).values,u=pn("float32",o);for(let c=0;c<i.length;c++)u[c]=i[c]<0?a*i[c]:i[c];return n.makeTensorInfo(r.shape,"float32",u)}const RD={kernelName:jm,backendName:"cpu",kernelFunc:$b};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PD=Me((e,t)=>e<0?t*e:e);function Cb(e){const{inputs:t,backend:n}=e,{x:s,alpha:r}=t;jt([s,r],"prelu");const a=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[i,u]=PD(s.shape,r.shape,a,o,"float32");return n.makeTensorInfo(u,"float32",i)}const MD={kernelName:ug,backendName:"cpu",kernelFunc:Cb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ab=ye(Ff,e=>Math.max(0,e)),VD={kernelName:Ff,backendName:"cpu",kernelFunc:Ab};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Db=ye(Rf,e=>Math.min(Math.max(0,e),6)),LD={kernelName:Rf,backendName:"cpu",kernelFunc:Db};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(e,t,n,s,r){if(n==="linear")return ys({inputs:{x:t},backend:e});if(n==="relu")return Ab({inputs:{x:t},backend:e});if(n==="elu")return Eb({inputs:{x:t},backend:e});if(n==="relu6")return Db({inputs:{x:t},backend:e});if(n==="prelu")return Cb({inputs:{x:t,alpha:s},backend:e});if(n==="leakyrelu")return $b({inputs:{x:t},backend:e,attrs:{alpha:r}});if(n==="sigmoid")return Ib({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Se(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{shape:a}=s,o=Nt(r.shape),i=zw(a,o),u=Nt(i);A(o===u,()=>`The new shape (${i}) has ${u} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const l=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;l.shape=i,f.shape=i}return{dataId:r.dataId,shape:i,dtype:r.dtype}}const zD={kernelName:mg,backendName:"cpu",kernelFunc:Se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ob(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:a}=t,{transposeA:o,transposeB:i}=s;jt([r,a],"matMul");const u=r.shape.length,c=a.shape.length,l=o?r.shape[u-2]:r.shape[u-1],f=i?a.shape[c-1]:a.shape[c-2],d=o?r.shape[u-1]:r.shape[u-2],m=i?a.shape[c-2]:a.shape[c-1],g=r.shape.slice(0,-2),w=a.shape.slice(0,-2),b=Nt(g),k=Nt(w),T=Fe(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([d,m]);A(l===f,()=>`Error in matMul: inner shapes (${l}) and (${f}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${o} and transposeB=${i} must match.`);const N=o?[b,l,d]:[b,d,l],$=i?[k,m,f]:[k,f,m],D=Se({inputs:{x:r},backend:n,attrs:{shape:N}}),P=Se({inputs:{x:a},backend:n,attrs:{shape:$}}),L=o?D.shape[1]:D.shape[2],R=o?D.shape[2]:D.shape[1],M=i?P.shape[1]:P.shape[2],E=Math.max(b,k),K=n.data.get(D.dataId).values,X=n.data.get(P.dataId).values,rt=Kt(D.shape),nt=Kt(P.shape),[st,it,tt]=o?[rt[0],1,rt[1]]:[rt[0],rt[1],1],[ut,ht,mt]=i?[1,nt[1],nt[0]]:[nt[1],1,nt[0]],vt=R*M,bt=ce([E,R,M],D.dtype),$t=bt.values,Tt=n.blockSize;for(let Ot=0;Ot<E;Ot++){const Lt=Ot%b,qt=Ot%k;for(let wt=0;wt<R;wt+=Tt){const Ut=Math.min(wt+Tt,R);for(let Jt=0;Jt<M;Jt+=Tt){const F=Math.min(Jt+Tt,M);for(let W=0;W<L;W+=Tt){const at=Math.min(W+Tt,L);for(let lt=wt;lt<Ut;lt++)for(let ct=Jt;ct<F;ct++){let dt=0;for(let xt=W;xt<at;xt++){const _t=K[Lt*st+lt*it+xt*tt],kt=X[xt*ut+ct*ht+qt*mt];dt+=_t*kt}$t[Ot*vt+(lt*M+ct)]+=dt}}}}}return n.disposeIntermediateTensorInfo(D),n.disposeIntermediateTensorInfo(P),n.makeTensorInfo(T,bt.dtype,bt.values)}const BD={kernelName:fm,backendName:"cpu",kernelFunc:Ob};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WD(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:a,bias:o,preluActivationWeights:i}=t,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:f}=s;let d,m,g;const w=[];d=Ob({inputs:{a:r,b:a},attrs:{transposeA:u,transposeB:c},backend:n}),o&&(m=$a({inputs:{a:d,b:o},backend:n}),w.push(d),d=m),l&&(g=eu(n,d,l,i,f),w.push(d),d=g);for(const k of w)n.disposeIntermediateTensorInfo(k);return d}const jD={kernelName:Kc,backendName:"cpu",kernelFunc:WD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HD=ye(Kl,e=>Math.acos(e)),qD={kernelName:Kl,backendName:"cpu",kernelFunc:HD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KD=ye(Ul,e=>Math.acosh(e)),UD={kernelName:Ul,backendName:"cpu",kernelFunc:KD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GD(e){const{inputs:t,backend:n}=e,s=t;jt(t,"addN");const r=s.map(i=>n.data.get(i.dataId).values),a=ce(s[0].shape,s[0].dtype),o=a.values;for(let i=0;i<s.length;i++){const u=r[i];for(let c=0;c<o.length;c++)o[c]+=u[c]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}const YD={kernelName:rm,backendName:"cpu",kernelFunc:GD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XD(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,keepDims:o}=s;jt(r,"all");const i=Ue(a,r.shape);let u=i;const c=ks(u,r.shape.length);let l=r;c!=null&&(l=In({inputs:{x:r},backend:n,attrs:{perm:c}}),u=xs(u.length,r.shape.length)),Zr("all",u,l.shape.length);const[f,d]=Bs(l.shape,u),m=Nt(d),g=tn(Nt(f),l.dtype),w=n.data.get(l.dataId).values;for(let k=0;k<g.length;++k){const I=k*m;let T=w[I];for(let N=0;N<m;++N){const $=w[I+N];T=T&&$}g[k]=T}c!=null&&n.disposeIntermediateTensorInfo(l);const b=n.makeTensorInfo(f,l.dtype,g);if(o){const k=es(f,i),I=Se({inputs:{x:b},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(b),I}return b}const ZD={kernelName:am,backendName:"cpu",kernelFunc:XD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JD(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,keepDims:o}=s;jt(r,"any");const i=Ue(a,r.shape);let u=i;const c=ks(u,r.shape.length);let l=r;c!=null&&(l=In({inputs:{x:r},backend:n,attrs:{perm:c}}),u=xs(u.length,r.shape.length)),Zr("any",u,l.shape.length);const[f,d]=Bs(l.shape,u),m=Nt(d),g=tn(Nt(f),l.dtype),w=n.data.get(l.dataId).values;for(let k=0;k<g.length;++k){const I=k*m;let T=w[I];for(let N=0;N<m;++N){const $=w[I+N];T=T||$}g[k]=T}c!=null&&n.disposeIntermediateTensorInfo(l);const b=n.makeTensorInfo(f,l.dtype,g);if(o){const k=es(f,i),I=Se({inputs:{x:b},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(b),I}return b}const QD={kernelName:om,backendName:"cpu",kernelFunc:JD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a}=s;jt(r,"argMax");let o=Ue(a,r.shape);const i=ks(o,r.shape.length);let u=r;const c=[];i!=null&&(u=In({inputs:{x:r},backend:n,attrs:{perm:i}}),c.push(u),o=xs(o.length,u.shape.length)),o=[o[0]],Zr("argMax",o,u.shape.length);const[l,f]=Bs(u.shape,o),d=Nt(l),m=tn(d,"int32"),g=Nt(f),w=n.data.get(u.dataId).values;for(let b=0;b<m.length;++b){const k=b*g;let I=w[k],T=0;for(let N=0;N<g;++N){const $=w[k+N];$>I&&(I=$,T=N)}m[b]=T}return c.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(l,"int32",m)}const eO={kernelName:im,backendName:"cpu",kernelFunc:tO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a}=s;jt(r,"argMin");let o=Ue(a,r.shape);const i=ks(o,r.shape.length);let u=r;const c=[];i!=null&&(u=In({inputs:{x:r},backend:n,attrs:{perm:i}}),c.push(u),o=xs(o.length,u.shape.length)),o=[o[0]],Zr("argMin",o,u.shape.length);const[l,f]=Bs(u.shape,o),d=Nt(l),m=tn(d,"int32"),g=Nt(f),w=n.data.get(u.dataId).values;for(let b=0;b<m.length;++b){const k=b*g;let I=w[k],T=0;for(let N=0;N<g;++N){const $=w[k+N];$<I&&(I=$,T=N)}m[b]=T}return c.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(l,"int32",m)}const sO={kernelName:um,backendName:"cpu",kernelFunc:nO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rO=ye(Gl,e=>Math.asin(e)),aO={kernelName:Gl,backendName:"cpu",kernelFunc:rO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oO=ye(Yl,e=>Math.asinh(e)),iO={kernelName:Yl,backendName:"cpu",kernelFunc:oO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uO=ye(Xl,e=>Math.atan(e)),cO={kernelName:Xl,backendName:"cpu",kernelFunc:uO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lO=Me((e,t)=>Math.atan2(e,t)),fO=He(Jl,lO),hO={kernelName:Jl,backendName:"cpu",kernelFunc:fO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dO=ye(Zl,e=>Math.atanh(e)),pO={kernelName:Zl,backendName:"cpu",kernelFunc:dO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xh(e,t,n,s,r,a){const o=r.strideHeight,i=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,m=r.padInfo.left,g=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=ce(r.outShape,n),b=w.values,k=r.outShape[1]*r.outShape[2]*r.outShape[3],I=r.outShape[2]*r.outShape[3],T=r.outShape[3];for(let N=0;N<r.batchSize;++N){const $=N*k,D=N*s[0];for(let P=0;P<r.inChannels;++P)for(let L=0;L<r.outHeight;++L){const R=L*o-d,M=Math.max(0,R),E=Math.min(r.inHeight,l+R),K=$+L*I;for(let X=0;X<r.outWidth;++X){const rt=X*i-m,nt=Math.max(0,rt),st=Math.min(r.inWidth,f+rt);let it=g,tt=0,ut=0;for(let mt=M;mt<E;mt+=u){const vt=D+mt*s[1];for(let bt=nt;bt<st;bt+=c){const $t=vt+bt*s[2],Tt=e[$t+P];a==="max"&&Tt>it?it=Tt:a==="avg"&&(tt+=Tt,ut++)}if(isNaN(it))break}const ht=K+X*T+P;b[ht]=a==="avg"?tt/ut:it}}}return w}function Fb(e,t,n,s,r=!1,a=!1){const o=ce(s.outShape,"int32"),i=s.strideHeight,u=s.strideWidth,c=s.dilationHeight,l=s.dilationWidth,f=s.effectiveFilterHeight,d=s.effectiveFilterWidth,m=s.padInfo.top,g=s.padInfo.left,w=ce(t,n,e);for(let b=0;b<s.batchSize;++b)for(let k=0;k<s.inChannels;++k)for(let I=0;I<s.outHeight;++I){const T=I*i-m;let N=T;for(;N<0;)N+=c;const $=Math.min(s.inHeight,f+T);for(let D=0;D<s.outWidth;++D){const P=D*u-g;let L=P;for(;L<0;)L+=l;const R=Math.min(s.inWidth,d+P);let M=Number.NEGATIVE_INFINITY,E=-1;for(let K=N;K<$;K+=c){const X=K-T;for(let rt=L;rt<R;rt+=l){const nt=rt-P,st=w.get(b,K,rt,k);st>M&&(M=st,r?E=a?((b*s.inHeight+K)*s.inWidth+rt)*s.inChannels+k:(K*s.inWidth+rt)*s.inChannels+k:E=X*d+nt)}}o.set(E,b,I,D,k)}}return o}function Rb(e,t,n,s,r,a){const o=r.strideDepth,i=r.strideHeight,u=r.strideWidth,c=r.dilationDepth,l=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,w=r.padInfo.front,b=r.padInfo.top,k=r.padInfo.left,I=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=ce(r.outShape,n),N=T.values,$=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[2]*r.outShape[3]*r.outShape[4],P=r.outShape[3]*r.outShape[4],L=r.outShape[4];for(let R=0;R<r.batchSize;++R){const M=R*$,E=R*s[0];for(let K=0;K<r.inChannels;++K)for(let X=0;X<r.outDepth;++X){const rt=X*o-w;let nt=rt;for(;nt<0;)nt+=c;const st=Math.min(r.inDepth,d+rt),it=M+X*D;for(let tt=0;tt<r.outHeight;++tt){const ut=tt*i-b;let ht=ut;for(;ht<0;)ht+=l;const mt=Math.min(r.inHeight,m+ut),vt=it+tt*P;for(let bt=0;bt<r.outWidth;++bt){const $t=bt*u-k;let Tt=$t;for(;Tt<0;)Tt+=f;const Ot=Math.min(r.inWidth,g+$t),Lt=vt+bt*L;let qt=I,wt=0,Ut=0;for(let F=nt;F<st;F+=c){const W=E+F*s[1];for(let at=ht;at<mt;at+=l){const lt=W+at*s[2];for(let ct=Tt;ct<Ot;ct+=f){const dt=lt+ct*s[3],xt=e[dt+K];if(a==="max"&&xt>qt?qt=xt:a==="avg"&&(wt+=xt,Ut++),isNaN(qt))break}if(isNaN(qt))break}if(isNaN(qt))break}const Jt=Lt+K;N[Jt]=a==="avg"?wt/Math.max(Ut,1):qt}}}}return T}function mO(e,t){const n=ce(t.outShape,"int32"),s=t.strideDepth,r=t.strideHeight,a=t.strideWidth,o=t.dilationDepth,i=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,m=t.padInfo.top,g=t.padInfo.left;for(let w=0;w<t.batchSize;++w)for(let b=0;b<t.inChannels;++b)for(let k=0;k<t.outDepth;++k){const I=k*s-d;let T=I;for(;T<0;)T+=o;const N=Math.min(t.inDepth,c+I);for(let $=0;$<t.outHeight;++$){const D=$*r-m;let P=D;for(;P<0;)P+=i;const L=Math.min(t.inHeight,l+D);for(let R=0;R<t.outWidth;++R){const M=R*a-g;let E=M;for(;E<0;)E+=u;const K=Math.min(t.inWidth,f+M);let X=Number.NEGATIVE_INFINITY,rt=-1;for(let nt=T;nt<N;nt+=o){const st=nt-I;for(let it=P;it<L;it+=i){const tt=it-D;for(let ut=E;ut<K;ut+=u){const ht=ut-M,mt=e.get(w,nt,it,ut,b);mt>=X&&(X=mt,rt=st*l*f+tt*l+ht)}}}n.set(rt,w,k,$,R,b)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;jt(r,"avgPool");const{filterSize:a,strides:o,pad:i,dimRoundingMode:u}=s,c=1;A(Qn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const l=La(r.shape,a,o,c,i,u);let f;if(l.filterWidth===1&&l.filterHeight===1&&Un(l.inShape,l.outShape))f=ys({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,m=Kt(r.shape),g=xh(d,r.shape,r.dtype,m,l,"avg");f=n.makeTensorInfo(l.outShape,r.dtype,g.values)}return f}const yO={kernelName:cm,backendName:"cpu",kernelFunc:gO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:a,strides:o,pad:i,dimRoundingMode:u,dataFormat:c}=s;jt(r,"avgPool3d");const l=wu(r.shape,a,o,1,i,u,c),f=n.data.get(r.dataId).values,d=Rb(f,r.shape,r.dtype,Kt(r.shape),l,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const wO={kernelName:lm,backendName:"cpu",kernelFunc:bO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vO(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:a}=t,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=s;jt([r,a],"avgPool3DGrad");const l=wu(a.shape,o,i,1,u,c),f=l.strideDepth,d=l.strideHeight,m=l.strideWidth,g=l.filterDepth,w=l.filterHeight,b=l.filterWidth,k=l.dilationDepth,I=l.dilationHeight,T=l.dilationWidth,N=l.effectiveFilterDepth,$=l.effectiveFilterHeight,D=l.effectiveFilterWidth,P=N-1-l.padInfo.front,L=D-1-l.padInfo.left,R=$-1-l.padInfo.top,M=ce(a.shape,"float32"),E=1/(g*w*b),K=n.bufferSync(r);for(let X=0;X<l.batchSize;++X)for(let rt=0;rt<l.inChannels;++rt)for(let nt=0;nt<l.inDepth;++nt)for(let st=0;st<l.inHeight;++st)for(let it=0;it<l.inWidth;++it){const tt=nt-P,ut=st-R,ht=it-L;let mt=0;for(let vt=0;vt<N;vt+=k){const bt=(tt+vt)/f;if(!(bt<0||bt>=l.outDepth||Math.floor(bt)!==bt))for(let $t=0;$t<$;$t+=I){const Tt=(ut+$t)/d;if(!(Tt<0||Tt>=l.outHeight||Math.floor(Tt)!==Tt))for(let Ot=0;Ot<D;Ot+=T){const Lt=(ht+Ot)/m;if(Lt<0||Lt>=l.outWidth||Math.floor(Lt)!==Lt)continue;const qt=K.get(X,bt,Tt,Lt,rt);mt+=qt}}}M.set(mt*E,X,nt,st,it,rt)}return n.makeTensorInfo(M.shape,M.dtype,M.values)}const kO={kernelName:nv,backendName:"cpu",kernelFunc:vO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xO(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:a}=t,o=a;jt([r,a],"avgPoolGrad");const{filterSize:i,strides:u,pad:c}=s,l=La(o.shape,i,u,1,c),f=l.strideHeight,d=l.strideWidth,m=l.filterHeight,g=l.filterWidth,w=l.dilationHeight,b=l.dilationWidth,k=l.effectiveFilterHeight,I=l.effectiveFilterWidth,T=I-1-l.padInfo.left,N=k-1-l.padInfo.top,$=ce(o.shape,"float32"),D=1/(m*g),P=n.data.get(r.dataId).values,L=ce(r.shape,"float32",P);for(let R=0;R<l.batchSize;++R)for(let M=0;M<l.inChannels;++M)for(let E=0;E<l.inHeight;++E)for(let K=0;K<l.inWidth;++K){const X=E-N,rt=K-T;let nt=0;for(let st=0;st<k;st+=w){const it=(X+st)/f;if(!(it<0||it>=l.outHeight||Math.floor(it)!==it))for(let tt=0;tt<I;tt+=b){const ut=(rt+tt)/d;if(ut<0||ut>=l.outWidth||Math.floor(ut)!==ut)continue;const ht=L.get(R,it,ut,M);nt+=ht}}$.set(nt*D,R,E,K,M)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const SO={kernelName:ev,backendName:"cpu",kernelFunc:xO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,scale:a,offset:o,mean:i,variance:u}=t;A(i.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),A(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),A(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),jt([r,i,u,a,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const l=n.data.get(r.dataId).values,f=n.data.get(i.dataId).values,d=n.data.get(u.dataId).values,m=a?n.data.get(a.dataId).values:new Float32Array([1]),g=o?n.data.get(o.dataId).values:new Float32Array([0]),w=new Float32Array(l.length),b=g.length,k=m.length,I=d.length,T=f.length;let N=0,$=0,D=0,P=0;for(let L=0;L<l.length;++L)w[L]=g[N++]+(l[L]-f[$++])*m[D++]/Math.sqrt(d[P++]+c),N>=b&&(N=0),$>=T&&($=0),D>=k&&(D=0),P>=I&&(P=0);return n.makeTensorInfo(r.shape,r.dtype,w)}const IO={kernelName:Vm,backendName:"cpu",kernelFunc:NO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _O(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:a,crops:o}=s;jt([r],"batchToSpaceND");const i=a.reduce((k,I)=>k*I),u=db(r.shape,a,i),c=pb(u.length,a.length),l=mb(r.shape,a,i),f=x2(o,a.length),d=S2(l,o,a.length),m=Se({inputs:{x:r},backend:n,attrs:{shape:u}}),g=In({inputs:{x:m},backend:n,attrs:{perm:c}}),w=Se({inputs:{x:g},backend:n,attrs:{shape:l}}),b=Yr({inputs:{x:w},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),b}const TO={kernelName:hm,backendName:"cpu",kernelFunc:_O};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:a}=t,{size:o}=s,i=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=vb(i,u,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,c)}const $O={kernelName:dm,backendName:"cpu",kernelFunc:EO};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CO(e){const{inputs:t,backend:n}=e,{s0:s,s1:r}=t,a=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,i=Fe(Array.from(a),Array.from(o));return n.makeTensorInfo([i.length],"int32",Int32Array.from(i))}const AO={kernelName:pm,backendName:"cpu",kernelFunc:CO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DO=ye(nf,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),OO={kernelName:nf,backendName:"cpu",kernelFunc:DO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FO=e=>{const{x:t}=e.inputs,n=e.backend,s=new Float32Array(Nt(t.shape)),r=n.data.get(t.dataId),a=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,i=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values;for(let c=0;c<i.length;c++){const l=i[c],f=u[c];s[c]=Math.hypot(l,f)}return n.makeOutput(s,t.shape,"float32")},RO={kernelName:gm,backendName:"cpu",kernelFunc:FO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.imag,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const PO={kernelName:Wm,backendName:"cpu",kernelFunc:Ca};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aa(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s,a=Ue(r,t[0].shape)[0],o=t.map(w=>w.shape);g2(o,a);let i=Ac(t.map(w=>w.shape),a);if(Nt(i)===0)return n.makeTensorInfo(i,t[0].dtype,[]);const u=t.filter(w=>Nt(w.shape)>0);if(u.length===1)return ys({inputs:{x:u[0]},backend:n});if(u[0].dtype==="complex64"){const w=u.map(N=>Gr({inputs:{input:N},backend:n})),b=u.map(N=>Ca({inputs:{input:N},backend:n})),k=Aa({inputs:w,backend:n,attrs:{axis:a}}),I=Aa({inputs:b,backend:n,attrs:{axis:a}}),T=Cn({inputs:{real:k,imag:I},backend:n});return w.forEach(N=>n.disposeIntermediateTensorInfo(N)),b.forEach(N=>n.disposeIntermediateTensorInfo(N)),n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(I),T}const c=u.map(w=>{const k=[-1,Nt(w.shape.slice(a))];return Se({inputs:{x:w},backend:n,attrs:{shape:k}})}),l=c.map(w=>({vals:n.data.get(w.dataId).values,shape:w.shape}));i=Ac(c.map(w=>w.shape),1);const f=c[0].shape[0]===1,d=QC(l,i,t[0].dtype,f),m=Ac(u.map(w=>w.shape),a),g=n.makeTensorInfo(m,t[0].dtype,d);return c.forEach(w=>n.disposeIntermediateTensorInfo(w)),g}const MO={kernelName:ym,backendName:"cpu",kernelFunc:Aa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pb(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:a}=t,{strides:o,pad:i,dataFormat:u,dilations:c,dimRoundingMode:l}=s;jt([r,a],"conv2d");const f=ku(u),d=vs(r.shape,a.shape,o,c,i,l,!1,f),m=d.filterHeight,g=d.filterWidth,w=d.dilationHeight,b=d.dilationWidth,k=d.padInfo.left,I=d.padInfo.top,T=d.dataFormat==="channelsLast",N=new je(d.outShape,r.dtype),$=Kt(r.shape),D=Kt(a.shape),P=$[0],L=T?$[1]:$[2],R=T?$[2]:1,M=T?1:$[1],E=N.strides[0],K=T?N.strides[1]:N.strides[2],X=T?N.strides[2]:1,rt=T?1:N.strides[1],nt=n.data.get(r.dataId).values,st=n.data.get(a.dataId).values,it=N.values;for(let tt=0;tt<d.batchSize;++tt){const ut=tt*P,ht=tt*E;for(let mt=0;mt<d.outHeight;++mt){const vt=ht+mt*K,bt=mt*d.strideHeight-I;for(let $t=0;$t<m;++$t){const Tt=bt+$t*w;if(Tt<0||Tt>=d.inHeight)continue;const Ot=$t*D[0],Lt=ut+Tt*L;for(let qt=0;qt<d.outWidth;++qt){const wt=vt+qt*X,Ut=qt*d.strideWidth-k;for(let Jt=0;Jt<g;++Jt){const F=Ut+Jt*b;if(F<0||F>=d.inWidth)continue;const W=Ot+Jt*D[1],at=Lt+F*R;let lt=W;for(let ct=0;ct<d.inChannels;++ct){const dt=nt[at+ct*M];for(let xt=0;xt<d.outChannels;++xt)it[wt+xt*rt]+=dt*st[lt+xt];lt+=d.outChannels}}}}}}return n.makeTensorInfo(N.shape,N.dtype,it)}const VO={kernelName:bm,backendName:"cpu",kernelFunc:Pb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:a}=t,{strides:o,pad:i,dataFormat:u,dimRoundingMode:c,filterShape:l}=s;jt([r,a],"conv2dBackpropFilter");const f=ku(u),d=vs(r.shape,l,o,1,i,c,!1,f),{strideHeight:m,strideWidth:g,filterHeight:w,filterWidth:b}=d,k=d.dataFormat==="channelsLast",I=new je(d.filterShape,"float32"),T=d.padInfo.left,N=d.padInfo.top,$=n.data.get(r.dataId).values,D=n.data.get(a.dataId).values,P=new je(r.shape,r.dtype,$),L=new je(a.shape,a.dtype,D);for(let R=0;R<w;++R){const M=Math.max(0,Math.ceil((N-R)/m)),E=Math.min(d.outHeight,(d.inHeight+N-R)/m);for(let K=0;K<b;++K){const X=Math.max(0,Math.ceil((T-K)/g)),rt=Math.min(d.outWidth,(d.inWidth+T-K)/g);for(let nt=0;nt<d.inChannels;++nt)for(let st=0;st<d.outChannels;++st){let it=0;for(let tt=0;tt<d.batchSize;++tt)for(let ut=M;ut<E;++ut){const ht=R+ut*m-N;for(let mt=X;mt<rt;++mt){const vt=K+mt*g-T;k?it+=P.get(tt,ht,vt,nt)*L.get(tt,ut,mt,st):it+=P.get(tt,nt,ht,vt)*L.get(tt,st,ut,mt)}}I.set(it,R,K,nt,st)}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const zO={kernelName:wm,backendName:"cpu",kernelFunc:LO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BO(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:a}=t,{inputShape:o,strides:i,pad:u,dataFormat:c,dimRoundingMode:l}=s;jt([r,a],"conv2dBackpropInput");const f=Kt(a.shape),d=Kt(r.shape);let m=ku(c);const g=vs(o,a.shape,i,1,u,l,!1,m),w=new je(g.inShape,"float32"),b=w.values,k=n.data.get(r.dataId).values,I=n.data.get(a.dataId).values,[T,N,$]=f,{batchSize:D,filterHeight:P,filterWidth:L,inChannels:R,inHeight:M,inWidth:E,outChannels:K,outHeight:X,outWidth:rt,strideHeight:nt,strideWidth:st}=g;m=g.dataFormat;const it=P-1-g.padInfo.top,tt=L-1-g.padInfo.left,ut=m==="channelsLast",ht=w.strides[0],mt=ut?w.strides[1]:w.strides[2],vt=ut?w.strides[2]:1,bt=ut?1:w.strides[1],$t=d[0],Tt=ut?d[1]:d[2],Ot=ut?d[2]:1,Lt=ut?1:d[1];for(let qt=0;qt<D;++qt)for(let wt=0;wt<R;++wt)for(let Ut=0;Ut<M;++Ut){const Jt=Ut-it,F=Math.max(0,Math.ceil(Jt/nt)),W=Math.min(X,(P+Jt)/nt);for(let at=0;at<E;++at){const lt=at-tt,ct=Math.max(0,Math.ceil(lt/st)),dt=Math.min(rt,(L+lt)/st);let xt=0;for(let kt=F;kt<W;++kt){const yt=kt*nt-Jt;for(let zt=ct;zt<dt;++zt){const Ct=zt*st-lt,Bt=$t*qt+Tt*kt+Ot*zt,Ht=T*(P-1-yt)+N*(L-1-Ct)+$*wt;for(let Gt=0;Gt<K;++Gt){const Qt=k[Bt+Lt*Gt],ne=I[Ht+Gt];xt+=Qt*ne}}}const _t=ht*qt+mt*Ut+vt*at+bt*wt;b[_t]=xt}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const WO={kernelName:vm,backendName:"cpu",kernelFunc:BO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:a}=t,{strides:o,pad:i,dilations:u}=s;jt([r,a],"conv3d");const c=vu(r.shape,a.shape,o,u,i),{filterDepth:l,filterHeight:f,filterWidth:d,dilationDepth:m,dilationHeight:g,dilationWidth:w,padInfo:b}=c,k=b.front,I=b.left,T=b.top,N=new je(c.outShape,r.dtype),$=n.data.get(r.dataId).values,D=n.data.get(a.dataId).values,P=N.values,L=Kt(r.shape),R=Kt(a.shape);for(let M=0;M<c.batchSize;++M){const E=M*L[0],K=M*N.strides[0];for(let X=0;X<c.outDepth;++X){const rt=K+X*N.strides[1],nt=X*c.strideDepth-k;for(let st=0;st<l;++st){const it=nt+st*m;if(it<0||it>=c.inDepth)continue;const tt=st*R[0],ut=E+it*L[1];for(let ht=0;ht<c.outHeight;++ht){const mt=rt+ht*N.strides[2],vt=ht*c.strideHeight-T;for(let bt=0;bt<f;++bt){const $t=vt+bt*g;if($t<0||$t>=c.inHeight)continue;const Tt=tt+bt*R[1],Ot=ut+$t*L[2];for(let Lt=0;Lt<c.outWidth;++Lt){const qt=mt+Lt*c.outChannels,wt=Lt*c.strideWidth-I;for(let Ut=0;Ut<d;++Ut){const Jt=wt+Ut*w;if(Jt<0||Jt>=c.inWidth)continue;const F=Tt+Ut*R[2],W=Ot+Jt*c.inChannels;let at=F;for(let lt=0;lt<c.inChannels;++lt){const ct=$[W+lt];for(let dt=0;dt<c.outChannels;++dt)P[qt+dt]+=ct*D[at+dt];at+=c.outChannels}}}}}}}}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const HO={kernelName:km,backendName:"cpu",kernelFunc:jO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:a}=t,{strides:o,pad:i,filterShape:u}=s;jt([r,a],"conv3dBackpropFilterV2");const c=Kt(r.shape),l=Kt(a.shape),f=vu(r.shape,u,o,1,i),d=f.strideDepth,m=f.strideHeight,g=f.strideWidth,w=f.filterDepth,b=f.filterHeight,k=f.filterWidth,I=new je(f.filterShape,"float32"),T=I.values,[N,$,D,P]=I.strides,L=n.data.get(a.dataId).values,[R,M,E,K]=l,X=n.data.get(r.dataId).values,[rt,nt,st,it]=c,tt=f.padInfo.front,ut=f.padInfo.left,ht=f.padInfo.top;for(let mt=0;mt<w;++mt){const vt=Math.max(0,Math.ceil((tt-mt)/d)),bt=Math.min(f.outDepth,(f.inDepth+tt-mt)/d),$t=mt*N;for(let Tt=0;Tt<b;++Tt){const Ot=Math.max(0,Math.ceil((ht-Tt)/m)),Lt=Math.min(f.outHeight,(f.inHeight+ht-Tt)/m),qt=Tt*$+$t;for(let wt=0;wt<k;++wt){const Ut=Math.max(0,Math.ceil((ut-wt)/g)),Jt=Math.min(f.outWidth,(f.inWidth+ut-wt)/g),F=wt*D+qt;for(let W=0;W<f.inChannels;++W){const at=W*P+F;for(let lt=0;lt<f.outChannels;++lt){let ct=0;for(let dt=0;dt<f.batchSize;++dt){const xt=dt*rt,_t=dt*R;for(let kt=vt;kt<bt;++kt){const zt=(mt+kt*d-tt)*nt+xt,Ct=kt*M+_t;for(let Bt=Ot;Bt<Lt;++Bt){const Gt=(Tt+Bt*m-ht)*st+zt,Qt=Bt*E+Ct;for(let ne=Ut;ne<Jt;++ne){const Re=(wt+ne*g-ut)*it+Gt,qe=ne*K+Qt;ct+=X[Re+W]*L[qe+lt]}}}}T[at+lt]=ct}}}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const KO={kernelName:sv,backendName:"cpu",kernelFunc:qO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UO(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:a}=t,{pad:o,strides:i,inputShape:u}=s;jt([r],"conv3dBackpropInputV2");const c=Kt(r.shape),l=Kt(a.shape),f=vu(u,a.shape,i,1,o),d=new je(f.inShape,"float32"),m=d.values,[g,w,b,k]=d.strides,I=n.data.get(r.dataId).values,[T,N,$,D]=c,P=n.data.get(a.dataId).values,[L,R,M,E]=l,{batchSize:K,filterDepth:X,filterHeight:rt,filterWidth:nt,inChannels:st,inDepth:it,inHeight:tt,inWidth:ut,outChannels:ht,outDepth:mt,outHeight:vt,outWidth:bt,strideDepth:$t,strideHeight:Tt,strideWidth:Ot}=f,Lt=X-1-f.padInfo.front,qt=rt-1-f.padInfo.top,wt=nt-1-f.padInfo.left;for(let Ut=0;Ut<K;++Ut)for(let Jt=0;Jt<st;++Jt)for(let F=0;F<it;++F){const W=F-Lt,at=Math.max(0,Math.ceil(W/$t)),lt=Math.min(mt,(X+W)/$t);for(let ct=0;ct<tt;++ct){const dt=ct-qt,xt=Math.max(0,Math.ceil(dt/Tt)),_t=Math.min(vt,(rt+dt)/Tt);for(let kt=0;kt<ut;++kt){const yt=kt-wt,zt=Math.max(0,Math.ceil(yt/Ot)),Ct=Math.min(bt,(nt+yt)/Ot);let Bt=0;for(let Ht=at;Ht<lt;++Ht){const Gt=Ht*$t-W;for(let Qt=xt;Qt<_t;++Qt){const ne=Qt*Tt-dt;for(let Ne=zt;Ne<Ct;++Ne){const Re=Ne*Ot-yt,qe=T*Ut+N*Ht+$*Qt+D*Ne,We=L*(X-1-Gt)+R*(rt-1-ne)+M*(nt-1-Re)+E*Jt;for(let mn=0;mn<ht;++mn){const qs=I[qe+mn],$e=P[We+mn];Bt+=qs*$e}}}}m[g*Ut+w*F+b*ct+k*kt+Jt]=Bt}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const GO={kernelName:xm,backendName:"cpu",kernelFunc:UO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YO=ye(sf,e=>Math.cos(e)),XO={kernelName:sf,backendName:"cpu",kernelFunc:YO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZO=ye(rf,e=>Math.cosh(e)),JO={kernelName:rf,backendName:"cpu",kernelFunc:ZO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QO(e){const{inputs:t,backend:n,attrs:s}=e,{image:r,boxes:a,boxInd:o}=t,{cropSize:i,method:u,extrapolationValue:c}=s,[l,f,d,m]=r.shape,g=a.shape[0],[w,b]=i,k=ce([g,w,b,m],"float32"),I=n.data.get(a.dataId).values,T=n.data.get(o.dataId).values,N=n.data.get(r.dataId).values,$=Kt(r.shape),D=Kt(k.shape);for(let P=0;P<g;P++){const L=P*4,R=I[L],M=I[L+1],E=I[L+2],K=I[L+3],X=T[P];if(X>=l)continue;const rt=w>1?(E-R)*(f-1)/(w-1):0,nt=b>1?(K-M)*(d-1)/(b-1):0;for(let st=0;st<w;st++){const it=w>1?R*(f-1)+st*rt:.5*(R+E)*(f-1);if(it<0||it>f-1){for(let tt=0;tt<b;tt++)for(let ut=0;ut<m;ut++){const ht=ut+tt*D[2]+st*D[1]+P*D[0];k.values[ht]=c}continue}if(u==="bilinear"){const tt=Math.floor(it),ut=Math.ceil(it),ht=it-tt;for(let mt=0;mt<b;mt++){const vt=b>1?M*(d-1)+mt*nt:.5*(M+K)*(d-1);if(vt<0||vt>d-1){for(let Ot=0;Ot<m;Ot++){const Lt=Ot+mt*D[2]+st*D[1]+P*D[0];k.values[Lt]=c}continue}const bt=Math.floor(vt),$t=Math.ceil(vt),Tt=vt-bt;for(let Ot=0;Ot<m;Ot++){let Lt=Ot+bt*$[2]+tt*$[1]+X*$[0];const qt=N[Lt];Lt=Ot+$t*$[2]+tt*$[1]+X*$[0];const wt=N[Lt];Lt=Ot+bt*$[2]+ut*$[1]+X*$[0];const Ut=N[Lt];Lt=Ot+$t*$[2]+ut*$[1]+X*$[0];const Jt=N[Lt],F=qt+(wt-qt)*Tt,W=Ut+(Jt-Ut)*Tt;Lt=Ot+mt*D[2]+st*D[1]+P*D[0],k.values[Lt]=F+(W-F)*ht}}}else for(let tt=0;tt<b;++tt){const ut=b>1?M*(d-1)+tt*nt:.5*(M+K)*(d-1);if(ut<0||ut>d-1){for(let vt=0;vt<m;vt++){const bt=vt+tt*D[2]+st*D[1]+P*D[0];k.values[bt]=c}continue}const ht=Math.round(ut),mt=Math.round(it);for(let vt=0;vt<m;vt++){const bt=vt+ht*$[2]+mt*$[1]+X*$[0],$t=vt+tt*D[2]+st*D[1]+P*D[0];k.values[$t]=N[bt]}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const tF={kernelName:Im,backendName:"cpu",kernelFunc:QO};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,exclusive:o,reverse:i}=s;jt(r,"cumprod");const u=ks([a],r.shape.length);let c=r;u!=null&&(c=In({inputs:{x:r},backend:n,attrs:{perm:u}}));const l=xs(1,r.shape.length)[0];if(l!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${l}`);const f=Va(c.dtype,"int32"),d=Hl(Nt(c.shape),f),m=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],w=i?(k,I)=>k+g-I-1:(k,I)=>k+I;for(let k=0;k<m.length;k+=g)for(let I=0;I<g;I++){const T=w(k,I);if(I===0)d[T]=o?1:m[T];else{const N=w(k,I-1);d[T]=o?m[N]*d[N]:m[T]*d[N]}}const b=n.makeTensorInfo(c.shape,f,d);if(u!=null){const k=Ty(u),I=In({inputs:{x:b},backend:n,attrs:{perm:k}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),I}return b}const nF={kernelName:Sm,backendName:"cpu",kernelFunc:eF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,exclusive:o,reverse:i}=s;jt(r,"cumsum");const u=ks([a],r.shape.length);let c=r;u!=null&&(c=In({inputs:{x:r},backend:n,attrs:{perm:u}}));const l=xs(1,r.shape.length)[0];if(l!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${l}`);const f=Va(c.dtype,"int32"),d=tn(Nt(c.shape),f),m=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],w=i?(k,I)=>k+g-I-1:(k,I)=>k+I;for(let k=0;k<m.length;k+=g)for(let I=0;I<g;I++){const T=w(k,I);if(I===0)d[T]=o?0:m[T];else{const N=w(k,I-1);d[T]=o?m[N]+d[N]:m[T]+d[N]}}const b=n.makeTensorInfo(c.shape,f,d);if(u!=null){const k=Ty(u),I=In({inputs:{x:b},backend:n,attrs:{perm:k}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),I}return b}const rF={kernelName:Nm,backendName:"cpu",kernelFunc:sF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:a}=t,{size:o,binaryOutput:i}=s;if(r.shape.length===1){const u=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=vb(u,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,l)}else if(r.shape.length===2){const u=n.bufferSync(r),c=n.bufferSync(a),l=KC(u,c,o,i);return n.makeTensorInfo(l.shape,a.dtype,l.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const oF={kernelName:_m,backendName:"cpu",kernelFunc:aF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockSize:a,dataFormat:o}=s;A(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const i=r.shape[0],u=r.shape[1],c=r.shape[2],l=r.shape[3],f=u*a,d=c*a,m=l/(a*a),g=n.data.get(r.dataId).values,w=new Float32Array(i*f*d*m);let b=0;for(let k=0;k<i;++k)for(let I=0;I<f;++I){const T=Math.floor(I/a),N=I%a;for(let $=0;$<d;++$){const D=Math.floor($/a),P=$%a,L=(N*a+P)*m;for(let R=0;R<m;++R){const E=R+L+l*(D+c*(T+u*k));w[b++]=g[E]}}}return n.makeTensorInfo([i,f,d,m],r.dtype,w)}const uF={kernelName:Tm,backendName:"cpu",kernelFunc:iF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mb(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:a}=t,{strides:o,pad:i,dilations:u,dimRoundingMode:c}=s;jt([r,a],"depthwiseConv2DNative");const l=Kt(r.shape),f=Kt(a.shape);let d=u;d==null&&(d=[1,1]),A(Qn(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const m=vs(r.shape,a.shape,o,d,i,c,!0),{filterHeight:g,filterWidth:w,dilationHeight:b,dilationWidth:k,padInfo:I}=m,T=I.left,N=I.top,$=m.outChannels/m.inChannels,D=new je(m.outShape,r.dtype),P=n.data.get(r.dataId).values,L=n.data.get(a.dataId).values,R=D.values;for(let M=0;M<m.batchSize;++M){const E=M*l[0],K=M*D.strides[0];for(let X=0;X<m.outHeight;++X){const rt=K+X*D.strides[1],nt=X*m.strideHeight-N;for(let st=0;st<g;++st){const it=nt+st*b;if(it<0||it>=m.inHeight)continue;const tt=st*f[0],ut=E+it*l[1];for(let ht=0;ht<m.outWidth;++ht){const mt=rt+ht*D.strides[2],vt=ht*m.strideWidth-T;for(let bt=0;bt<w;++bt){const $t=vt+bt*k;if($t<0||$t>=m.inWidth)continue;const Tt=tt+bt*f[1],Ot=ut+$t*m.inChannels;let Lt=mt,qt=Tt;for(let wt=0;wt<m.inChannels;++wt){const Ut=P[Ot+wt];for(let Jt=0;Jt<$;++Jt)R[Lt+Jt]+=Ut*L[qt+Jt];Lt+=$,qt+=$}}}}}}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const cF={kernelName:Em,backendName:"cpu",kernelFunc:Mb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:a}=t,{strides:o,dilations:i,pad:u,dimRoundingMode:c,filterShape:l}=s;jt([r,a],"depthwiseConv2dNativeBackpropFilter");const f=vs(r.shape,l,o,i,u,c,!0),{strideHeight:d,strideWidth:m,filterHeight:g,filterWidth:w}=f,b=new je(f.filterShape,"float32"),k=f.padInfo.left,I=f.padInfo.top,T=f.outChannels/f.inChannels,N=n.data.get(r.dataId).values,$=new je(r.shape,r.dtype,N),D=n.data.get(a.dataId).values,P=new je(a.shape,a.dtype,D);for(let L=0;L<g;++L){const R=Math.max(0,Math.ceil((I-L)/d)),M=Math.min(f.outHeight,(f.inHeight+I-L)/d);for(let E=0;E<w;++E){const K=Math.max(0,Math.ceil((k-E)/m)),X=Math.min(f.outWidth,(f.inWidth+k-E)/m);for(let rt=0;rt<f.outChannels;++rt){const nt=Math.trunc(rt/T),st=rt%T;let it=0;for(let tt=0;tt<f.batchSize;++tt)for(let ut=R;ut<M;++ut){const ht=L+ut*d-I;for(let mt=K;mt<X;++mt){const vt=E+mt*m-k;it+=$.get(tt,ht,vt,nt)*P.get(tt,ut,mt,rt)}}b.set(it,L,E,nt,st)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const fF={kernelName:$m,backendName:"cpu",kernelFunc:lF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hF(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:a}=t,{strides:o,dilations:i,pad:u,dimRoundingMode:c,inputShape:l}=s;jt([r,a],"depthwiseConv2DNativeBackpropInput");const f=Kt(r.shape),d=Kt(a.shape),m=vs(l,a.shape,o,i,u,c,!0),g=new je(m.inShape,"float32"),w=g.values,[b,k,I]=g.strides,T=n.data.get(r.dataId).values,[N,$,D]=f,P=n.data.get(a.dataId).values,[L,R,M]=d,{batchSize:E,filterHeight:K,filterWidth:X,inChannels:rt,inHeight:nt,inWidth:st,outChannels:it,outHeight:tt,outWidth:ut,strideHeight:ht,strideWidth:mt}=m,vt=K-1-m.padInfo.top,bt=X-1-m.padInfo.left,$t=it/rt;for(let Tt=0;Tt<E;++Tt)for(let Ot=0;Ot<rt;++Ot)for(let Lt=0;Lt<nt;++Lt){const qt=Lt-vt,wt=Math.max(0,Math.ceil(qt/ht)),Ut=Math.min(tt,(K+qt)/ht);for(let Jt=0;Jt<st;++Jt){const F=Jt-bt,W=Math.max(0,Math.ceil(F/mt)),at=Math.min(ut,(X+F)/mt);let lt=0;for(let ct=wt;ct<Ut;++ct){const dt=ct*ht-qt;for(let xt=W;xt<at;++xt){const _t=xt*mt-F,kt=N*Tt+$*ct+D*xt,yt=L*(K-1-dt)+R*(X-1-_t)+M*Ot;for(let zt=0;zt<$t;++zt){const Ct=Ot*$t+zt,Bt=T[kt+Ct],Ht=P[yt+zt];lt+=Bt*Ht}}}w[b*Tt+k*Lt+I*Jt+Ot]=lt}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const dF={kernelName:Cm,backendName:"cpu",kernelFunc:hF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pF(e){const{inputs:t,backend:n}=e,{x:s}=t,r=Nt(s.shape),a=n.data.get(s.dataId).values,o=ce([r,r],s.dtype),i=o.values;for(let c=0;c<a.length;c++)i[c*r+c]=a[c];const u=[...s.shape,...s.shape];return n.makeTensorInfo(u,o.dtype,o.values)}const mF={kernelName:Am,backendName:"cpu",kernelFunc:pF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gF={kernelName:Dm,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r}=e,{strides:a,pad:o,dilations:i}=n,u=t,c=u.data.get(s.dataId).values,l=s.shape.length,f=u.data.get(r.dataId).values,d=r.shape.length,{batchSize:m,inHeight:g,inWidth:w,inChannels:b,outHeight:k,outWidth:I,padInfo:T,strideHeight:N,strideWidth:$,filterHeight:D,filterWidth:P,dilationHeight:L,dilationWidth:R,outShape:M}=eh(s.shape,r.shape,a,o,"NHWC",i),E=Nt(M),K=M.length,X=ze(s.dtype,E);for(let nt=0;nt<m;++nt)for(let st=0;st<k;++st){const it=st*N-T.top;for(let tt=0;tt<I;++tt){const ut=tt*$-T.left;for(let ht=0;ht<b;++ht){let mt=Number.MIN_SAFE_INTEGER;for(let bt=0;bt<D;++bt){const $t=it+bt*L;if($t>=0&&$t<g)for(let Tt=0;Tt<P;++Tt){const Ot=ut+Tt*R;if(Ot>=0&&Ot<w){const Lt=fs([nt,$t,Ot,ht],l,Kt(s.shape)),qt=fs([bt,Tt,ht],d,Kt(r.shape)),wt=c[Lt]+f[qt];wt>mt&&(mt=wt)}}}const vt=fs([nt,st,tt,ht],K,Kt(M));X[vt]=mt}}}return{dataId:u.write(Xr(X,s.dtype),M,s.dtype),shape:M,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yF={kernelName:Id,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:a}=e,{strides:o,pad:i,dilations:u}=n,c=t,l=Hn(s.shape,c.data.get(s.dataId).values),f=Hn(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:m,inWidth:g,inChannels:w,outHeight:b,outWidth:k,padInfo:I,strideHeight:T,strideWidth:N,filterHeight:$,filterWidth:D,dilationHeight:P,dilationWidth:L,outShape:R}=eh(s.shape,r.shape,o,i,"NHWC",u);A(a.rank===R.length,()=>`Error in ${Id}, dy must have the same rank as output ${R.length}, but got ${a.rank}`);const M=Hn(R,c.data.get(a.dataId).values),E=tm(r.shape,r.dtype);for(let X=0;X<d;++X)for(let rt=0;rt<b;++rt){const nt=rt*T-I.top;for(let st=0;st<k;++st){const it=st*N-I.left;for(let tt=0;tt<w;++tt){let ut=Number.MIN_SAFE_INTEGER,ht=0,mt=0;for(let vt=0;vt<$;++vt){const bt=nt+vt*P;if(bt>=0&&bt<m)for(let $t=0;$t<D;++$t){const Tt=it+$t*L;if(Tt>=0&&Tt<g){const Ot=l[X][bt][Tt][tt]+f[vt][$t][tt];Ot>ut&&(ut=Ot,ht=vt,mt=$t)}}}E[ht][mt][tt]+=M[X][rt][st][tt]}}}return{dataId:c.write(Xr(E,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bF={kernelName:Nd,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:a}=e,{strides:o,pad:i,dilations:u}=n,c=t,l=Hn(s.shape,c.data.get(s.dataId).values),f=Hn(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:m,inWidth:g,inChannels:w,outHeight:b,outWidth:k,padInfo:I,strideHeight:T,strideWidth:N,filterHeight:$,filterWidth:D,dilationHeight:P,dilationWidth:L,outShape:R}=eh(s.shape,r.shape,o,i,"NHWC",u);A(a.rank===R.length,()=>`Error in ${Nd}, dy must have the same rank as output ${R.length}, but got ${a.rank}`);const M=Hn(R,c.data.get(a.dataId).values),E=tm(s.shape,s.dtype);for(let X=0;X<d;++X)for(let rt=0;rt<b;++rt){const nt=rt*T-I.top;for(let st=0;st<k;++st){const it=st*N-I.left;for(let tt=0;tt<w;++tt){let ut=Number.MIN_SAFE_INTEGER,ht=nt<0?0:nt,mt=it<0?0:it;for(let vt=0;vt<$;++vt){const bt=nt+vt*P;if(bt>=0&&bt<m)for(let $t=0;$t<D;++$t){const Tt=it+$t*L;if(Tt>=0&&Tt<g){const Ot=l[X][bt][Tt][tt]+f[vt][$t][tt];Ot>ut&&(ut=Ot,ht=bt,mt=Tt)}}}E[X][ht][mt][tt]+=M[X][rt][st][tt]}}}return{dataId:c.write(Xr(E,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wF(e){const{inputs:t,backend:n,attrs:s}=e,{image:r}=t,{canvas:a,options:o}=s,{contextOptions:i,imageOptions:u}=o||{},c=(u==null?void 0:u.alpha)||1,l=(i==null?void 0:i.contextType)||"2d";if(l!=="2d")throw new Error(`Context type ${i.contextType} is not supported by the CPU backend.`);const f=a.getContext(l,(i==null?void 0:i.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${l} type.`);const[d,m]=r.shape.slice(0,2),g=r.shape.length===2?1:r.shape[2],w=n.data.get(r.dataId).values,b=r.dtype==="float32"?255:1,k=new Uint8ClampedArray(m*d*4);for(let T=0;T<d*m;++T){const N=[0,0,0,255*c];for(let D=0;D<g;D++){const P=w[T*g+D];if(r.dtype==="float32"){if(P<0||P>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${P}.`)}else if(r.dtype==="int32"&&(P<0||P>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${P}.`);g===1?(N[0]=P*b,N[1]=P*b,N[2]=P*b):N[D]=P*b}const $=T*4;k[$+0]=Math.round(N[0]),k[$+1]=Math.round(N[1]),k[$+2]=Math.round(N[2]),k[$+3]=Math.round(N[3])}a.width=m,a.height=d;const I=new ImageData(k,m,d);return f.putImageData(I,0,0),r}const vF={kernelName:rv,backendName:"cpu",kernelFunc:wF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,keepDims:o}=s;jt(r,"sum");let i;r.dtype==="bool"?i=hr({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):i=ys({inputs:{x:r},backend:n});const u=i.shape.length,c=Ue(a,i.shape),l=ks(c,u);let f=c,d=i;l!=null&&(d=In({inputs:{x:i},backend:n,attrs:{perm:l}}),f=xs(f.length,u)),Zr("sum",f,d.shape.length);const[m,g]=Bs(d.shape,f),w=Va(d.dtype,"int32");let b=Qi(n,m,w);const k=Nt(g),I=n.data.get(b.dataId).values,T=n.data.get(d.dataId).values;for(let N=0;N<I.length;++N){const $=N*k;let D=0;for(let P=0;P<k;++P)D+=T[$+P];I[N]=D}if(o){const N=es(b.shape,c),$=b;b=Se({inputs:{x:b},backend:n,attrs:{shape:N}}),n.disposeIntermediateTensorInfo($)}return n.disposeIntermediateTensorInfo(i),l!=null&&n.disposeIntermediateTensorInfo(d),b}const kF={kernelName:Ng,backendName:"cpu",kernelFunc:jo};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xF(e){const{inputs:t,backend:n,attrs:s}=e,{equation:r}=s,a=t,{allDims:o,summedDims:i,idDims:u}=L2(r,a.length);B2(o.length,u,a);const{path:c,steps:l}=W2(i,u),f=l.length;let d=null,m=o.length;const g=[];for(let w=0;w<f;++w){for(const b of l[w]){const{permutationIndices:k,expandDims:I}=z2(m,u[b]);let T;j2(k)?T=a[b]:(T=In({inputs:{x:a[b]},backend:n,attrs:{perm:k}}),g.push(T));const N=T.shape.slice();for(let $=0;$<I.length;++$)N.splice(I[$],0,1);Un(T.shape,N)||(T=Se({inputs:{x:T},backend:n,attrs:{shape:N}}),g.push(T)),d===null?d=T:(d=Cu({inputs:{a:T,b:d},backend:n}),g.push(d))}w<f-1&&(c[w]>=0&&(d=jo({inputs:{x:d},backend:n,attrs:{axis:c[w]-(o.length-m),keepDims:!1}}),g.push(d)),m--)}for(const w of g)w!==d&&n.disposeIntermediateTensorInfo(w);return d}const SF={kernelName:Om,backendName:"cpu",kernelFunc:xF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NF(e){const{inputs:t,backend:n}=e,{dy:s,y:r}=t;jt([s,r],"eluGrad");const a=new Float32Array(Nt(r.shape)),o=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values;for(let u=0;u<o.length;++u){const c=o[u];c>=0?a[u]=i[u]:a[u]=i[u]*(c+1)}return n.makeTensorInfo(r.shape,"float32",a)}const IF={kernelName:av,backendName:"cpu",kernelFunc:NF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _F=_2,TF=T2,EF=E2,$F=$2,CF=C2,AF=A2,DF=ye(uf,e=>{const t=Math.sign(e),n=Math.abs(e),s=1/(1+_F*n);return t*(1-((((AF*s+CF)*s+$F)*s+EF)*s+TF)*s*Math.exp(-n*n))}),OF={kernelName:uf,backendName:"cpu",kernelFunc:DF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nu(e){const{inputs:t,backend:n,attrs:s}=e,{input:r}=t,{dim:a}=s,o=r.shape.length,i=r.shape.slice();let u=a;return a<0&&(A(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+a+1),i.splice(u,0,1),Se({inputs:{x:r},backend:n,attrs:{shape:i}})}const FF={kernelName:Fm,backendName:"cpu",kernelFunc:nu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RF=Me((e,t)=>e/t),Sh=He(af,RF),Sl={kernelName:af,backendName:"cpu",kernelFunc:Sh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vb(e,t,n){const s=e.shape,r=s[0],a=s[1],o=n.data.get(e.dataId),i=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[r,a],l=Nt(c),f=pn("float32",l),d=pn("float32",l);for(let b=0;b<r;b++){const k=Yr({inputs:{x:i},backend:n,attrs:{begin:[b,0],size:[1,a]}}),I=Yr({inputs:{x:u},backend:n,attrs:{begin:[b,0],size:[1,a]}}),T=Cn({inputs:{real:k,imag:I},backend:n}),{real:N,imag:$}=PF(T,t,n),D=Ea(N,$);for(let P=0;P<a;P++){const L=gb(D,P);f[b*a+P]=L.real,d[b*a+P]=L.imag}n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(T)}const m=n.makeTensorInfo(c,"float32",f),g=n.makeTensorInfo(c,"float32",d),w=Cn({inputs:{real:m,imag:g},backend:n});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),w}function PF(e,t,n){const s=Nt(e.shape),r=n.data.get(e.dataId),a=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(MF(s)){const i=Nl(a,o,s,t,n),u=[e.shape[0],e.shape[1]];if(t){const c=n.makeTensorInfo(u,"float32",i.real),l=n.makeTensorInfo(u,"float32",i.imag),f=n.makeTensorInfo([],"float32",Jf(s,"float32")),d=ys({inputs:{x:f},backend:n}),m=Sl.kernelFunc({inputs:{a:c,b:f},backend:n}),g=Sl.kernelFunc({inputs:{a:l,b:d},backend:n}),w=n.data.get(m.dataId).values,b=n.data.get(g.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),{real:w,imag:b}}return i}else{const i=Ea(a,o),u=VF(i,s,t);return D2(u)}}function MF(e){return(e&e-1)===0}function Nl(e,t,n,s,r){if(n===1)return{real:e,imag:t};const a=Ea(e,t),o=n/2,i=O2(a),u=i.real,c=i.imag,l=[u.length],f=r.makeTensorInfo(l,"float32",u),d=r.makeTensorInfo(l,"float32",c),m=Cn({inputs:{real:f,imag:d},backend:r}),g=F2(a),w=g.real,b=g.imag,k=[w.length],I=r.makeTensorInfo(k,"float32",w),T=r.makeTensorInfo(k,"float32",b),N=Cn({inputs:{real:I,imag:T},backend:r}),$=Nl(u,c,o,s,r),D=$.real,P=$.imag,L=[D.length],R=r.makeTensorInfo(L,"float32",D),M=r.makeTensorInfo(L,"float32",P),E=Cn({inputs:{real:R,imag:M},backend:r}),K=Nl(w,b,o,s,r),X=K.real,rt=K.imag,nt=[X.length],st=r.makeTensorInfo(nt,"float32",X),it=r.makeTensorInfo(nt,"float32",rt),tt=Cn({inputs:{real:st,imag:it},backend:r}),ut=P2(n,s),ht=[ut.real.length],mt=r.makeTensorInfo(ht,"float32",ut.real),vt=r.makeTensorInfo(ht,"float32",ut.imag),bt=Cn({inputs:{real:mt,imag:vt},backend:r}),$t=Cu({inputs:{a:bt,b:tt},backend:r}),Tt=$a({inputs:{a:E,b:$t},backend:r}),Ot=kh({inputs:{a:E,b:$t},backend:r}),Lt=Gr({inputs:{input:Tt},backend:r}),qt=Gr({inputs:{input:Ot},backend:r}),wt=Ca({inputs:{input:Tt},backend:r}),Ut=Ca({inputs:{input:Ot},backend:r}),Jt=Aa({inputs:[Lt,qt],backend:r,attrs:{axis:0}}),F=Aa({inputs:[wt,Ut],backend:r,attrs:{axis:0}}),W=r.data.get(Jt.dataId).values,at=r.data.get(F.dataId).values;return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(st),r.disposeIntermediateTensorInfo(it),r.disposeIntermediateTensorInfo(tt),r.disposeIntermediateTensorInfo(mt),r.disposeIntermediateTensorInfo(vt),r.disposeIntermediateTensorInfo(bt),r.disposeIntermediateTensorInfo($t),r.disposeIntermediateTensorInfo(Tt),r.disposeIntermediateTensorInfo(Ot),r.disposeIntermediateTensorInfo(Lt),r.disposeIntermediateTensorInfo(wt),r.disposeIntermediateTensorInfo(qt),r.disposeIntermediateTensorInfo(Ut),r.disposeIntermediateTensorInfo(Jt),r.disposeIntermediateTensorInfo(F),{real:W,imag:at}}function VF(e,t,n){const s=new Float32Array(t*2);for(let r=0;r<t;r++){let a=0,o=0;for(let i=0;i<t;i++){const u=M2(r*i,t,n),c=gb(e,i);a+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(a/=t,o/=t),R2(s,a,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LF(e){const{inputs:t,backend:n}=e,{input:s}=t,r=Nt(s.shape),a=s.shape[s.shape.length-1],o=r/a,i=Se({inputs:{x:s},backend:n,attrs:{shape:[o,a]}}),u=Vb(i,!1,n),c=Se({inputs:{x:u},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(u),c}const zF={kernelName:Rm,backendName:"cpu",kernelFunc:LF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nh(e){const{backend:t,attrs:n}=e,{shape:s,value:r,dtype:a}=n,o=a||Lo(r),i=ze(o,Nt(s));return WF(i,r,o),t.makeTensorInfo(s,o,i)}const BF={kernelName:Pm,backendName:"cpu",kernelFunc:Nh};function WF(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jF={kernelName:Mm,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,r=n,a=pn(s.dtype,Nt(s.shape)),[o,i,u,c]=s.shape,l=r.data.get(s.dataId).values;for(let d=0;d<o;d++){const m=d*u*i*c;for(let g=0;g<i;g++){const w=g*(u*c);for(let b=0;b<u;b++){const k=b*c;for(let I=0;I<c;I++){const T=Math.round(u-b-1),N=m+w+k+I;let $=l[N];if(T>=0&&T<u){const D=T*c,P=m+w+D+I;$=l[P]}a[N]=$}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:a,bias:o,preluActivationWeights:i}=t,{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d,activation:m,leakyreluAlpha:g}=s;let w=Pb({inputs:{x:r,filter:a},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){const b=w;if(l==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const k=Se({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});w=$a({inputs:{a:w,b:k},backend:n}),n.disposeIntermediateTensorInfo(k)}else w=$a({inputs:{a:w,b:o},backend:n});n.disposeIntermediateTensorInfo(b)}if(m){const b=w;if(l==="NCHW"&&m==="prelu"&&i.shape.length===1&&i.shape[0]!==1){const k=Se({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});w=eu(n,w,m,k,g),n.disposeIntermediateTensorInfo(k)}else w=eu(n,w,m,i,g);n.disposeIntermediateTensorInfo(b)}return w}const qF={kernelName:Uc,backendName:"cpu",kernelFunc:HF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:a,bias:o,preluActivationWeights:i}=t,{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d,activation:m,leakyreluAlpha:g}=s;let w=Mb({inputs:{x:r,filter:a},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){const b=w;w=$a({inputs:{a:w,b:o},backend:n}),n.disposeIntermediateTensorInfo(b)}if(m){const b=w;w=eu(n,w,m,i,g),n.disposeIntermediateTensorInfo(b)}return w}const UF={kernelName:Gc,backendName:"cpu",kernelFunc:KF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GF(e){const{inputs:t,backend:n}=e,{params:s,indices:r}=t,a=Nt(s.shape),o=r.shape,i=o[o.length-1],[u,c,l,f]=i2(s,r);if(c===0)return n.makeTensorInfo(u,s.dtype,[]);const d=n.data.get(r.dataId).values,m=n.bufferSync(s),g=dA(d,m,s.dtype,c,i,l,f,s.shape,a);return n.makeTensorInfo(u,s.dtype,g.values)}const YF={kernelName:zm,backendName:"cpu",kernelFunc:GF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,indices:a}=t,{axis:o,batchDims:i}=s;jt([r,a],"gatherV2");const u=Ue(o,r.shape)[0],c=n.data.get(a.dataId).values,l=r.shape[u];for(let N=0;N<c.length;++N){const $=c[N];A($<=l-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${l-1}]`)}let f=i;i==null&&(f=0);const d=Nt(a.shape),m=s$(r,a,u,f),g=Se({inputs:{x:r},backend:n,attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]}}),w=Se({inputs:{x:a},backend:n,attrs:{shape:[m.batchSize,d/m.batchSize]}}),b=[m.batchSize,m.outerSize,d/m.batchSize,m.sliceSize],k=n.bufferSync(w),I=n.bufferSync(g),T=pA(I,k,b);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(m.outputShape,T.dtype,T.values)}const ZF={kernelName:Lm,backendName:"cpu",kernelFunc:XF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JF(e){const{inputs:t,backend:n}=e,{input:s}=t,r=Nt(s.shape),a=s.shape[s.shape.length-1],o=r/a,i=Se({inputs:{x:s},backend:n,attrs:{shape:[o,a]}}),u=Vb(i,!0,n),c=Se({inputs:{x:u},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(u),c}const QF={kernelName:Bm,backendName:"cpu",kernelFunc:JF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t3=ye(yf,e=>Number.isFinite(e)?1:0,"bool"),e3={kernelName:yf,backendName:"cpu",kernelFunc:t3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3=ye(bf,e=>Math.abs(e)===1/0?1:0,"bool"),s3={kernelName:bf,backendName:"cpu",kernelFunc:n3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3=ye(wf,e=>Number.isNaN(e)?1:0,"bool"),a3={kernelName:wf,backendName:"cpu",kernelFunc:r3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o3(e){const{backend:t,attrs:n}=e,{start:s,stop:r,num:a}=n,o=TA(s,r,a);return t.makeTensorInfo([o.length],"float32",o)}const i3={kernelName:Hm,backendName:"cpu",kernelFunc:o3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u3=ye(Sf,e=>Math.log1p(e)),c3={kernelName:Sf,backendName:"cpu",kernelFunc:u3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l3=Me((e,t)=>e&&t),f3=He(Nf,l3,null,"bool"),h3={kernelName:Nf,backendName:"cpu",kernelFunc:f3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3=ye(If,e=>e?0:1,"bool"),p3={kernelName:If,backendName:"cpu",kernelFunc:d3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m3=Me((e,t)=>e||t),g3=He(_f,m3,null,"bool"),y3={kernelName:_f,backendName:"cpu",kernelFunc:g3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{depthRadius:a,bias:o,alpha:i,beta:u}=s;jt(r,"LRN");const c=r.shape[3],l=c-1,f=n.data.get(r.dataId).values,d=Nt(r.shape),m=new Float32Array(d);function g(w){const b=w%c;let k=w-b+Math.max(0,b-a);const I=w-b+Math.min(b+a,l);let T=0;for(;k<=I;k++){const N=f[k];T+=N*N}return T}for(let w=0;w<d;w++){const b=g(w),k=f[w]*Math.pow(o+i*b,-u);m[w]=k}return n.makeTensorInfo(r.shape,r.dtype,m)}const w3={kernelName:qm,backendName:"cpu",kernelFunc:b3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,y:a,dy:o}=t,{depthRadius:i,bias:u,alpha:c,beta:l}=s;jt(o,"LRNGrad");const f=Nt(o.shape),d=o.shape[3],m=n.data.get(o.dataId).values,g=n.data.get(r.dataId).values,w=n.data.get(a.dataId).values,b=new Float32Array(f),k=f;for(let I=0;I<k;I++){const T=I%d,N=I-T+Math.max(0,T-i),$=I-T+Math.min(d,T+i+1);let D=0;for(let P=N;P<$;P++)D+=Math.pow(g[P],2);D=c*D+u;for(let P=N;P<$;P++){let L=-2*c*l*g[P]*w[I]/D;I===P&&(L+=Math.pow(D,-l)),L*=m[I],b[P]+=L}}return n.makeTensorInfo(o.shape,r.dtype,b)}const k3={kernelName:ov,backendName:"cpu",kernelFunc:v3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lb(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reductionIndices:a,keepDims:o}=s,i=n;let u=r.shape;const c=u.length,l=Ue(a,u);let f=l;const d=ks(f,c);let m=i.data.get(r.dataId).values;if(d!=null){const N=new Array(c);for(let $=0;$<N.length;$++)N[$]=u[d[$]];m=Nb(m,u,r.dtype,d,N),f=xs(f.length,c),u=N}jt(r,"max"),Zr("max",f,c);const[g,w]=Bs(u,f),b=Nt(w),k=AA(m,b,g,r.dtype),I=i.write(k,g,r.dtype);let T=g;return o&&(T=es(g,l)),{dataId:I,shape:T,dtype:r.dtype}}const x3={kernelName:Km,backendName:"cpu",kernelFunc:Lb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;jt(r,"maxPool");const{filterSize:a,strides:o,pad:i,dimRoundingMode:u}=s,c=1;A(Qn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const l=La(r.shape,a,o,c,i,u);let f;if(l.filterWidth===1&&l.filterHeight===1&&Un(l.inShape,l.outShape))f=ys({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,m=Kt(r.shape),g=xh(d,r.shape,r.dtype,m,l,"max");f=n.makeTensorInfo(l.outShape,r.dtype,g.values)}return f}const N3={kernelName:Um,backendName:"cpu",kernelFunc:S3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:a,strides:o,pad:i,dimRoundingMode:u,dataFormat:c}=s;jt(r,"maxPool3d");const l=wu(r.shape,a,o,1,i,u,c),f=n.data.get(r.dataId).values,d=Rb(f,r.shape,r.dtype,Kt(r.shape),l,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const _3={kernelName:Gm,backendName:"cpu",kernelFunc:I3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:a}=t,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=s;jt([r,a],"maxPool3DGrad");const l=wu(a.shape,o,i,1,u,c),f=n.bufferSync(a),d=mO(f,l),m=l.strideDepth,g=l.strideHeight,w=l.strideWidth,b=l.dilationDepth,k=l.dilationHeight,I=l.dilationWidth,T=l.effectiveFilterDepth,N=l.effectiveFilterHeight,$=l.effectiveFilterWidth,D=T-1-l.padInfo.front,P=$-1-l.padInfo.left,L=N-1-l.padInfo.top,R=ce(a.shape,"float32"),M=n.bufferSync(r);for(let E=0;E<l.batchSize;++E)for(let K=0;K<l.inChannels;++K)for(let X=0;X<l.inDepth;++X)for(let rt=0;rt<l.inHeight;++rt)for(let nt=0;nt<l.inWidth;++nt){const st=X-D,it=rt-L,tt=nt-P;let ut=0;for(let ht=0;ht<T;ht+=b){const mt=(st+ht)/m;if(!(mt<0||mt>=l.outDepth||Math.floor(mt)!==mt))for(let vt=0;vt<N;vt+=k){const bt=(it+vt)/g;if(!(bt<0||bt>=l.outHeight||Math.floor(bt)!==bt))for(let $t=0;$t<$;$t+=I){const Tt=(tt+$t)/w;if(Tt<0||Tt>=l.outWidth||Math.floor(Tt)!==Tt)continue;const Ot=T*N*$-1-d.get(E,mt,bt,Tt,K),Lt=ht*N*$+vt*$+$t,qt=Ot===Lt?1:0;if(qt===0)continue;const wt=M.get(E,mt,bt,Tt,K);ut+=wt*qt}}}R.set(ut,E,X,rt,nt,K)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const E3={kernelName:uv,backendName:"cpu",kernelFunc:T3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:a,output:o}=t,i=a;jt([a,o],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:f}=s,d=La(i.shape,u,c,1,l,f),m=n.data.get(i.dataId).values,g=ce(d.outShape,i.dtype,Fb(m,i.shape,i.dtype,d).values),w=d.strideHeight,b=d.strideWidth,k=d.dilationHeight,I=d.dilationWidth,T=d.effectiveFilterHeight,N=d.effectiveFilterWidth,$=N-1-d.padInfo.left,D=T-1-d.padInfo.top,P=ce(i.shape,"float32"),L=n.data.get(r.dataId).values,R=ce(r.shape,"float32",L);for(let M=0;M<d.batchSize;++M)for(let E=0;E<d.inChannels;++E)for(let K=0;K<d.inHeight;++K)for(let X=0;X<d.inWidth;++X){const rt=K-D,nt=X-$;let st=0;for(let it=0;it<T;it+=k){const tt=(rt+it)/w;if(!(tt<0||tt>=d.outHeight||Math.floor(tt)!==tt))for(let ut=0;ut<N;ut+=I){const ht=(nt+ut)/b;if(ht<0||ht>=d.outWidth||Math.floor(ht)!==ht)continue;const mt=T*N-1-g.get(M,tt,ht,E),vt=it*N+ut,bt=mt===vt?1:0;if(bt===0)continue;const $t=R.get(M,tt,ht,E);st+=$t*bt}}P.set(st,M,K,X,E)}return n.makeTensorInfo(P.shape,P.dtype,P.values)}const C3={kernelName:iv,backendName:"cpu",kernelFunc:$3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3(e,t,n,s,r){const a=Kt(t),o=xh(e,t,n,a,r,"max"),i=Fb(e,t,n,r,!0,s);return[o.values,i.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D3={kernelName:Ym,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{filterSize:r,strides:a,pad:o,includeBatchInIndex:i}=t,u=n;jt(s,"MaxPoolWithArgmax");const c=u.data.get(s.dataId).values,l=La(s.shape,r,a,[1,1],o),[f,d]=A3(c,s.shape,s.dtype,i,l),m=u.write(f,l.outShape,s.dtype),g=u.write(d,l.outShape,s.dtype);return[{dataId:m,shape:l.outShape,dtype:s.dtype},{dataId:g,shape:l.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,keepDims:o}=s,i=Ue(a,r.shape),c=Bs(r.shape,i)[1],l=Nt(c),f=[],d=n.makeTensorInfo([],"float32",new Float32Array([l]));f.push(d);const m=hr({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});f.push(m);const g=Sh({inputs:{a:m,b:d},backend:n});f.push(g);const w=jo({inputs:{x:g},backend:n,attrs:{axis:a,keepDims:o}});return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),w}const F3={kernelName:Xm,backendName:"cpu",kernelFunc:O3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:a,keepDims:o}=s;jt(r,"min");const i=Ue(a,r.shape);let u=i;const c=ks(u,r.shape.length);let l=r;c!=null&&(l=In({inputs:{x:r},backend:n,attrs:{perm:c}}),u=xs(u.length,r.shape.length)),Zr("min",u,l.shape.length);const[f,d]=Bs(l.shape,u),m=Nt(d),g=tn(Nt(f),l.dtype),w=n.data.get(l.dataId).values;for(let k=0;k<g.length;++k){const I=k*m;let T=w[I];for(let N=0;N<m;++N){const $=w[I+N];(Number.isNaN($)||$<T)&&(T=$)}g[k]=T}c!=null&&n.disposeIntermediateTensorInfo(l);const b=n.makeTensorInfo(f,l.dtype,g);if(o){const k=es(f,i),I=Se({inputs:{x:b},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(b),I}return b}const P3={kernelName:Zm,backendName:"cpu",kernelFunc:R3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:a,mode:o}=s;jt(r,"mirrorPad");const i=a.map((T,N)=>T[0]+r.shape[N]+T[1]),u=a.map(T=>T[0]),c=a.map((T,N)=>T[0]+r.shape[N]),l=o==="reflect"?0:1,f=n.data.get(r.dataId).values,d=r.shape.length,m=Kt(r.shape),g=Nt(i),w=i.length,b=Kt(i),k=pn(r.dtype,g);for(let T=0;T<g;T++){let N=Ma(T,w,b);for(let D=0;D<w;D++)N[D]<u[D]?N[D]=u[D]*2-N[D]-l:N[D]>=c[D]&&(N[D]=(c[D]-1)*2-N[D]+l);N=N.map((D,P)=>D-u[P]);const $=fs(N,d,m);k[T]=f[$]}return{dataId:n.write(k,i,r.dtype),shape:i,dtype:r.dtype}}const V3={kernelName:Jm,backendName:"cpu",kernelFunc:M3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L3=Me(((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),z3=He($f,L3),B3={kernelName:$f,backendName:"cpu",kernelFunc:z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zb(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{dim:a}=s,o=r.shape.length;let i=a;if(i===-1&&(i=o-1),i!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${i}`);const u=Ue([i],r.shape),c=Lb({inputs:{x:r},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=es(c.shape,u),f=Se({inputs:{x:c},backend:n,attrs:{shape:l}}),d=kh({inputs:{a:r,b:f},backend:n}),m=xb({inputs:{x:d},backend:n}),g=jo({inputs:{x:m},backend:n,attrs:{axis:u,keepDims:!1}}),w=Se({inputs:{x:g},backend:n,attrs:{shape:l}}),b=Sh({inputs:{a:m,b:w},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),b}const W3={kernelName:Tg,backendName:"cpu",kernelFunc:zb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{numSamples:a,seed:o,normalized:i}=s;jt(r,"multinomial");const u=i?r:zb({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],f=n.data.get(u.dataId).values,d=[c,a],m=tn(Nt(d),"int32");for(let g=0;g<c;++g){const w=g*l,b=new Float32Array(l-1);b[0]=f[w];for(let T=1;T<b.length;++T)b[T]=b[T-1]+f[w+T];const k=Tu.alea(o.toString()),I=g*a;for(let T=0;T<a;++T){const N=k();m[I+T]=b.length;for(let $=0;$<b.length;$++)if(N<b[$]){m[I+T]=$;break}}}return i||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(d,"int32",m)}const H3={kernelName:Qm,backendName:"cpu",kernelFunc:j3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q3=sb;function K3(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:a}=t,{maxOutputSize:o,iouThreshold:i,scoreThreshold:u}=s;jt(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,{selectedIndices:f}=q3(c,l,o,i,u);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const U3={kernelName:eg,backendName:"cpu",kernelFunc:K3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G3=rb;function Y3(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:a}=t,{maxOutputSize:o,iouThreshold:i,scoreThreshold:u,padToMaxOutputSize:c}=s;jt(r,"NonMaxSuppressionPadded");const l=n.data.get(r.dataId).values,f=n.data.get(a.dataId).values,{selectedIndices:d,validOutputs:m}=G3(l,f,o,i,u,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([m]))]}const X3={kernelName:ng,backendName:"cpu",kernelFunc:Y3};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z3=ab;function J3(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:a}=t,{maxOutputSize:o,iouThreshold:i,scoreThreshold:u,softNmsSigma:c}=s;jt(r,"NonMaxSuppressionWithScore");const l=n.data.get(r.dataId).values,f=n.data.get(a.dataId).values,d=o,m=i,g=u,w=c,{selectedIndices:b,selectedScores:k}=Z3(l,f,d,m,g,w);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([k.length],"float32",new Float32Array(k))]}const Q3={kernelName:sg,backendName:"cpu",kernelFunc:J3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tR(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r}=t,{dtype:a,depth:o,onValue:i,offValue:u}=s;jt(r,"oneHot");const c=Nt(r.shape),l=new Float32Array(c*o);l.fill(u);const f=n.data.get(r.dataId).values;for(let d=0;d<c;++d)f[d]>=0&&f[d]<o&&(l[d*o+f[d]]=i);return n.makeTensorInfo([...r.shape,o],a,l)}const eR={kernelName:ag,backendName:"cpu",kernelFunc:tR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function su(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Gr({inputs:{input:s},backend:n}),a=su({inputs:{x:r},backend:n}),o=Ca({inputs:{input:s},backend:n}),i=su({inputs:{x:o},backend:n}),u=Cn({inputs:{real:a,imag:i},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),u}else return Nh({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const nR={kernelName:Wg,backendName:"cpu",kernelFunc:su};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bb(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Gr({inputs:{input:s},backend:n}),a=Bb({inputs:{x:r},backend:n}),o=Ca({inputs:{input:s},backend:n}),i=su({inputs:{x:o},backend:n}),u=Cn({inputs:{real:a,imag:i},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),u}else return Nh({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const sR={kernelName:rg,backendName:"cpu",kernelFunc:Bb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wb(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s;if(t.length===1)return nu({inputs:{input:t[0]},backend:n,attrs:{dim:r}});const a=t[0].shape,o=t[0].dtype;t.forEach(l=>{Mn(a,l.shape,"All tensors passed to stack must have matching shapes"),A(o===l.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],u=t.map(l=>{const f=nu({inputs:{input:l},backend:n,attrs:{dim:r}});return i.push(f),f}),c=Aa({inputs:u,backend:n,attrs:{axis:r}});return i.forEach(l=>n.disposeIntermediateTensorInfo(l)),c}const rR={kernelName:og,backendName:"cpu",kernelFunc:Wb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aR(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:a,constantValue:o}=s;jt(r,"pad");const i=a.map((I,T)=>I[0]+r.shape[T]+I[1]),u=a.map(I=>I[0]),c=n.data.get(r.dataId).values,l=Nt(r.shape),f=r.shape.length,d=Kt(r.shape),m=Nt(i),g=i.length,w=Kt(i),b=pn(r.dtype,m);o!==0&&b.fill(o);for(let I=0;I<l;I++){const N=Ma(I,f,d).map((D,P)=>D+u[P]),$=fs(N,g,w);b[$]=c[I]}return{dataId:n.write(b,i,r.dtype),shape:i,dtype:r.dtype}}const jb={kernelName:ig,backendName:"cpu",kernelFunc:aR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oR=Me((e,t)=>Math.pow(e,t)),iR=He(Df,oR),uR={kernelName:Df,backendName:"cpu",kernelFunc:iR};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cR(e){const{inputs:t,backend:n,attrs:s}=e,{paramsNestedSplits:r,paramsDenseValues:a,indices:o}=t,{outputRaggedRank:i}=s,u=r.map(k=>n.data.get(k.dataId).values),c=r.map(k=>k.shape),l=n.data.get(a.dataId).values,f=n.data.get(o.dataId).values,[d,m,g]=nD(u,c,l,a.shape,a.dtype,f,o.shape),w=d.map(k=>n.makeTensorInfo([k.length],"int32",k)),b=n.makeTensorInfo(g,a.dtype,m);return w.concat([b])}const lR={kernelName:lg,backendName:"cpu",kernelFunc:cR};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fR(e){const{inputs:t,backend:n}=e,{starts:s,limits:r,deltas:a}=t,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,[c,l]=sD(o,s.shape,s.dtype,i,r.shape,u,a.shape),f=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([l.length],s.dtype,l);return[f,d]}const hR={kernelName:fg,backendName:"cpu",kernelFunc:fR};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dR(e){const{inputs:t,backend:n,attrs:s}=e,{shape:r,values:a,defaultValue:o,rowPartitionTensors:i}=t,{rowPartitionTypes:u}=s,c=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,f=n.data.get(o.dataId).values,d=i.map(b=>n.data.get(b.dataId).values),m=i.map(b=>b.shape),[g,w]=rD(c,r.shape,l,a.shape,a.dtype,f,o.shape,d,m,u);return n.makeTensorInfo(g,a.dtype,w)}const pR={kernelName:hg,backendName:"cpu",kernelFunc:dR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mR(e){const{backend:t,attrs:n}=e,{start:s,stop:r,dtype:a,step:o}=n,i=aD(s,r,o,a);return t.makeTensorInfo([i.length],a,i)}const gR={kernelName:dg,backendName:"cpu",kernelFunc:mR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yR=ye(Of,e=>1/e),bR={kernelName:Of,backendName:"cpu",kernelFunc:yR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wR(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:a,halfPixelCenters:o,size:i}=s;jt(r,"resizeBilinear");const u=Kt(r.shape),[c,l]=i,[f,d,m,g]=r.shape,w=n.data.get(r.dataId).values,b=new Float32Array(Nt([f,c,l,g])),k=[a&&c>1?d-1:d,a&&l>1?m-1:m],I=[a&&c>1?c-1:c,a&&l>1?l-1:l];let T=0;const N=k[0]/I[0],$=k[1]/I[1];for(let D=0;D<f;D++)for(let P=0;P<c;P++){let L;o?L=N*(P+.5)-.5:L=N*P;const R=Math.max(0,Math.floor(L)),M=L-R,E=Math.min(d-1,Math.ceil(L)),K=D*u[0]+R*u[1],X=D*u[0]+E*u[1];for(let rt=0;rt<l;rt++){let nt;o?nt=$*(rt+.5)-.5:nt=$*rt;const st=Math.max(0,Math.floor(nt)),it=nt-st,tt=Math.min(m-1,Math.ceil(nt)),ut=K+st*u[2],ht=X+st*u[2],mt=K+tt*u[2],vt=X+tt*u[2];for(let bt=0;bt<g;bt++){const $t=w[ut+bt],Tt=w[ht+bt],Ot=w[mt+bt],Lt=w[vt+bt],qt=$t+(Ot-$t)*it,wt=Tt+(Lt-Tt)*it,Ut=qt+(wt-qt)*M;b[T++]=Ut}}}return n.makeTensorInfo([f,c,l,g],"float32",b)}const vR={kernelName:yg,backendName:"cpu",kernelFunc:wR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kR(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:a}=t,{alignCorners:o}=s;jt([a,r],"resizeBilinearGrad");const i=Kt(r.shape),[u,c,l,f]=r.shape,[,d,m]=a.shape,g=new Float32Array(u*c*l*f),w=[o&&d>1?c-1:c,o&&m>1?l-1:l],b=[o&&d>1?d-1:d,o&&m>1?m-1:m],k=w[0]/b[0],I=w[1]/b[1],T=n.data.get(a.dataId).values;let N=0;for(let $=0;$<u;$++){const D=$*i[0];for(let P=0;P<d;P++){const L=P*k,R=Math.floor(L),M=Math.min(Math.ceil(L),c-1),E=D+R*i[1],K=D+M*i[1],X=L-R,rt=1-X;for(let nt=0;nt<m;nt++){const st=nt*I,it=Math.floor(st),tt=Math.min(Math.ceil(st),l-1),ut=st-it,ht=1-ut,mt=E+it*i[2],vt=E+tt*i[2],bt=K+it*i[2],$t=K+tt*i[2],Tt=rt*ht,Ot=rt*ut,Lt=X*ht,qt=X*ut;for(let wt=0;wt<f;wt++){const Ut=T[N++];g[mt+wt]+=Ut*Tt,g[vt+wt]+=Ut*Ot,g[bt+wt]+=Ut*Lt,g[$t+wt]+=Ut*qt}}}}return n.makeTensorInfo([u,l,c,f],"float32",g)}const xR={kernelName:lv,backendName:"cpu",kernelFunc:kR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SR(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:a,halfPixelCenters:o,size:i}=s;jt(r,"resizeNearestNeighbor");const u=Kt(r.shape),[c,l]=i,[f,d,m,g]=r.shape,w=n.data.get(r.dataId).values,b=new Float32Array(f*c*l*g),k=[a&&c>1?d-1:d,a&&l>1?m-1:m],I=[a&&c>1?c-1:c,a&&l>1?l-1:l],T=k[0]/I[0],N=k[1]/I[1];let $=0;for(let D=0;D<f;D++){const P=D*u[0];for(let L=0;L<c;L++){const R=o?T*(L+.5):T*L;let M=Math.min(d-1,a?Math.round(R):Math.floor(R));o&&(M=Math.max(0,M));const E=P+M*u[1];for(let K=0;K<l;K++){const X=o?N*(K+.5):N*K;let rt=Math.min(m-1,a?Math.round(X):Math.floor(X));o&&(rt=Math.max(0,rt));const nt=E+rt*u[2];for(let st=0;st<g;st++){const it=w[nt+st];b[$++]=it}}}}return n.makeTensorInfo([f,c,l,g],r.dtype,b)}const NR={kernelName:gg,backendName:"cpu",kernelFunc:SR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IR(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:a}=t,{alignCorners:o}=s;jt([a,r],"resizeNearestNeighborGrad");const i=Kt(r.shape),u=Kt(a.shape),[c,l,f,d]=r.shape,[,m,g]=a.shape,w=new Float32Array(c*l*f*d),b=n.data.get(a.dataId).values,k=[o&&m>1?l-1:l,o&&g>1?f-1:f],I=[o&&m>1?m-1:m,o&&g>1?g-1:g],T=k[0]/I[0],N=k[1]/I[1],$=1/T,D=1/N,P=Math.ceil($)*2+2,L=Math.ceil(D)*2+2;for(let R=0;R<c;R++){const M=R*i[0];for(let E=0;E<l;E++){const K=M+E*i[1],X=Math.floor(E*$),rt=Math.floor(X-P/2);for(let nt=0;nt<f;nt++){const st=K+nt*i[2],it=Math.floor(nt*D),tt=Math.floor(it-L/2);for(let ut=0;ut<d;ut++){let ht=0;for(let mt=0;mt<P;mt++){const vt=mt+rt;if(vt<0||vt>=m)continue;const bt=M+vt*u[1],$t=vt*T,Tt=Math.min(l-1,o?Math.round($t):Math.floor($t));if(E===Tt)for(let Ot=0;Ot<L;Ot++){const Lt=Ot+tt;if(Lt<0||Lt>=g)continue;const qt=bt+Lt*u[2],wt=Lt*N,Ut=Math.min(f-1,o?Math.round(wt):Math.floor(wt));nt===Ut&&(ht+=b[qt+ut])}}w[st+ut]=ht}}}}return n.makeTensorInfo(r.shape,r.dtype,w)}const _R={kernelName:cv,backendName:"cpu",kernelFunc:IR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TR(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dims:a}=s;jt(r,"reverse");const o=r.shape.length,i=Ue(a,r.shape);if(o===0)return ys({inputs:{x:r},backend:n});const u=new je(r.shape,r.dtype),c=n.bufferSync(r);for(let l=0;l<u.size;l++){const f=u.indexToLoc(l),d=f.slice();i.forEach(m=>d[m]=r.shape[m]-1-d[m]),u.set(c.get(...d),...f)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}const ER={kernelName:bg,backendName:"cpu",kernelFunc:TR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $R={kernelName:jg,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,{radians:r,fillValue:a,center:o}=t,i=n,u=pn(s.dtype,Nt(s.shape)),[c,l,f,d]=s.shape,[m,g]=k2(o,l,f),w=255,b=Math.sin(r),k=Math.cos(r),I=i.data.get(s.dataId).values;for(let N=0;N<c;N++){const $=N*f*l*d;for(let D=0;D<l;D++){const P=D*(f*d);for(let L=0;L<f;L++){const R=L*d;for(let M=0;M<d;M++){const E=[c,D,L,M],K=E[2],X=E[1];let rt=(K-m)*k-(X-g)*b,nt=(K-m)*b+(X-g)*k;rt=Math.round(rt+m),nt=Math.round(nt+g);let st=a;if(typeof a!="number"&&(M===3?st=w:st=a[M]),rt>=0&&rt<f&&nt>=0&&nt<l){const tt=nt*(f*d),ut=rt*d,ht=$+tt+ut+M;st=I[ht]}const it=$+P+R+M;u[it]=st}}}}return{dataId:i.write(u,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CR=ye(Pf,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),AR={kernelName:Pf,backendName:"cpu",kernelFunc:CR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DR(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r,updates:a}=t,{shape:o}=s,{sliceRank:i,numUpdates:u,sliceSize:c,strides:l,outputSize:f}=lh(a,r,o),d=!0,m=n.bufferSync(r),g=n.bufferSync(a),w=pa(m,g,o,f,c,u,i,l,0,d);return n.makeTensorInfo(o,w.dtype,w.values)}const OR={kernelName:wg,backendName:"cpu",kernelFunc:DR};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FR(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<t?n=r+1:s=r;return s}function RR(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<=t?n=r+1:s=r;return s}function PR(e,t,n,s,r,a){const o=ze("int32",n*r);for(let i=0;i<n;++i){const u=e.slice(i*s,(i+1)*s),c=i*r;for(let l=0;l<r;++l)o[c+l]=a==="left"?FR(u,t[l+c]):RR(u,t[l+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MR(e){const{inputs:t,backend:n,attrs:s}=e,{sortedSequence:r,values:a}=t,{side:o}=s,i=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=PR(i,u,r.shape[0],r.shape[1],a.shape[1],o);return n.makeTensorInfo(a.shape,"int32",c)}const VR={kernelName:kg,backendName:"cpu",kernelFunc:MR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LR(e){const{inputs:t,backend:n}=e,{condition:s,t:r,e:a}=t;jt([s,r,a],"select");const o=s.shape.length,i=n.data.get(s.dataId).values,u=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=Va(r.dtype,a.dtype),f=tn(Nt(r.shape),l);let d=0;const m=o===0||o>1||r.shape.length===1?1:Nt(r.shape.slice(1));for(let g=0;g<i.length;g++)for(let w=0;w<m;w++)i[g]===1?f[d++]=u[g]:f[d++]=c[g];return n.makeTensorInfo(r.shape,l,f)}const zR={kernelName:xg,backendName:"cpu",kernelFunc:LR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BR=N2,WR=I2,jR=ye(Vf,e=>e>=0?WR*e:BR*(Math.exp(e)-1)),HR={kernelName:Vf,backendName:"cpu",kernelFunc:jR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qR=ye(Bf,e=>e<0?-1:e>0?1:0),KR={kernelName:Bf,backendName:"cpu",kernelFunc:qR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UR=ye(Lf,e=>Math.sin(e)),GR={kernelName:Lf,backendName:"cpu",kernelFunc:UR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YR=ye(zf,e=>Math.sinh(e)),XR={kernelName:zf,backendName:"cpu",kernelFunc:YR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZR=11920928955078125e-23,mp=Math.log(ZR)+2,JR=ye(jf,e=>{const t=e>-mp,n=e<mp,s=Math.exp(e);let r;return n?r=s:t?r=e:r=Math.log(1+s),r}),QR={kernelName:jf,backendName:"cpu",kernelFunc:JR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:a,paddings:o}=s;jt([r],"spaceToBatchND");const i=Nt(a),u=[[0,0]];u.push(...o);for(let D=1+a.length;D<r.shape.length;++D)u.push([0,0]);const c=jb.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:u,constantValue:0}}),l=db(c.shape,a,i,!1),f=pb(l.length,a.length,!1),d=mb(c.shape,a,i,!1),w=Se({inputs:{x:c},backend:n,attrs:{shape:l}}),I=In({inputs:{x:w},backend:n,attrs:{perm:f}}),$=Se({inputs:{x:I},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(I),$}const eP={kernelName:Ig,backendName:"cpu",kernelFunc:tP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nP(e){const{inputs:t,backend:n}=e,{indices:s,values:r,denseShape:a,defaultValue:o}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const i=n.data.get(s.dataId).values,u=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values[0],[f,d,m,g,w]=hD(i,s.shape,s.dtype,u,r.dtype,c,l);return[n.makeTensorInfo(d,s.dtype,f),n.makeTensorInfo([d[0]],r.dtype,m),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(b=>Number(b)))),n.makeTensorInfo([w.length],s.dtype,new Int32Array(w))]}const sP={kernelName:Eg,backendName:"cpu",kernelFunc:nP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rP(e){const{inputs:t,backend:n}=e,{inputIndices:s,inputShape:r,newShape:a}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(n.data.get(r.dataId).values),i=n.data.get(s.dataId).values,u=Array.from(n.data.get(a.dataId).values),[c,l,f]=dD(i,s.shape,s.dtype,o,u);return[n.makeTensorInfo(l,s.dtype,c),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const aP={kernelName:$g,backendName:"cpu",kernelFunc:rP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oP(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,[c,l]=_b(o,s.shape,s.dtype,i,u,!0);return n.makeTensorInfo(l,s.dtype,c)}const iP={kernelName:Cg,backendName:"cpu",kernelFunc:oP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uP(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,[c,l]=_b(o,s.shape,s.dtype,i,u);return n.makeTensorInfo(l,s.dtype,c)}const cP={kernelName:Ag,backendName:"cpu",kernelFunc:uP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lP(e){const{inputs:t,backend:n,attrs:s}=e,{sparseIndices:r,sparseValues:a,defaultValue:o}=t,{outputShape:i}=s,{sliceRank:u,numUpdates:c,sliceSize:l,strides:f,outputSize:d}=lh(a,r,i),m=!1,g=n.bufferSync(r);let w;switch(a.dtype){case"bool":{const b=n.bufferSync(a),k=!!n.data.get(o.dataId).values[0];w=pa(g,b,i,d,l,c,u,f,k,m);break}case"float32":{const b=n.bufferSync(a),k=n.data.get(o.dataId).values[0];w=pa(g,b,i,d,l,c,u,f,k,m);break}case"int32":{const b=n.bufferSync(a),k=n.data.get(o.dataId).values[0];w=pa(g,b,i,d,l,c,u,f,k,m);break}case"string":{const b=n.bufferSync(a),k=xo(n.data.get(o.dataId).values[0]);w=pa(g,b,i,d,l,c,u,f,k,m);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(i,w.dtype,w.values)}const fP={kernelName:Dg,backendName:"cpu",kernelFunc:lP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{numOrSizeSplits:a,axis:o}=s,i=Ue(o,r.shape)[0],u=q2(r,a,i),c=new Array(r.shape.length).fill(0),l=r.shape.slice();return u.map(f=>{const d=[...l];d[i]=f;const m=Yr({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});return c[i]+=f,m})}const dP={kernelName:_g,backendName:"cpu",kernelFunc:hP};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pP={kernelName:fv,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,s=t;jt(n,"square");const r=s.data.get(n.dataId).values,a=new Float32Array(r.length);for(let i=0;i<r.length;++i){const u=r[i];a[i]=u*u}return{dataId:s.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mP=ye(Zf,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),gP={kernelName:Zf,backendName:"cpu",kernelFunc:mP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:a,end:o,strides:i,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:f,shrinkAxisMask:d}=s;jt(r,"stridedSlice");const{finalShapeSparse:m,finalShape:g,isIdentity:w,sliceDim0:b,isSimpleSlice:k,begin:I,end:T,strides:N}=p2(r.shape,a,o,i,u,c,l,f,d);let $;if(w)$=Se({inputs:{x:r},backend:n,attrs:{shape:g}});else if(b||k){A(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const D=l2(I,T,N),P=Yr({inputs:{x:r},backend:n,attrs:{begin:I,size:D}});$=Se({inputs:{x:P},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(P)}else{const D=n.bufferSync(r),P=xD(m,D,N,I);$=n.makeTensorInfo(g,P.dtype,P.values)}return $}const bP={kernelName:Og,backendName:"cpu",kernelFunc:yP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wP(e){const{inputs:t,backend:n,attrs:s}=e,{separator:r,nGramWidths:a,leftPad:o,rightPad:i,padWidth:u,preserveShortSequences:c}=s,{data:l,dataSplits:f}=t,d=n.data.get(l.dataId).values,m=n.data.get(f.dataId).values,[g,w]=ND(d,m,r,a,o,i,u,c);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(f.shape,"int32",w)]}const vP={kernelName:Fg,backendName:"cpu",kernelFunc:wP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kP(e){const{inputs:t,backend:n,attrs:s}=e,{skipEmpty:r}=s,{input:a,delimiter:o}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const i=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values[0],[c,l,f]=_D(i,u,r),d=l.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const xP={kernelName:Rg,backendName:"cpu",kernelFunc:kP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SP(e){const{inputs:t,backend:n,attrs:s}=e,{numBuckets:r}=s,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(a.dataId).values,i=TD(o,r);return n.makeTensorInfo(a.shape,"int32",i)}const NP={kernelName:Pg,backendName:"cpu",kernelFunc:SP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IP=ye(Gf,e=>Math.tan(e)),_P={kernelName:Gf,backendName:"cpu",kernelFunc:IP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TP=ye(Yf,e=>Math.tanh(e)),EP={kernelName:Yf,backendName:"cpu",kernelFunc:TP};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $P(e){const{inputs:t,backend:n}=e,{tensor:s,indices:r,updates:a}=t,{sliceRank:o,numUpdates:i,sliceSize:u,strides:c,outputSize:l}=lh(a,r,s.shape),f=!1,d=n.bufferSync(r),m=n.bufferSync(a),g=n.bufferSync(s),w=pa(d,m,s.shape,l,u,i,o,c,g,f);return n.makeTensorInfo(s.shape,w.dtype,w.values)}const CP={kernelName:vg,backendName:"cpu",kernelFunc:$P};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reps:a}=s;jt(r,"tile");const o=AD(n.bufferSync(r),a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const DP={kernelName:Xf,backendName:"cpu",kernelFunc:AP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{k:a,sorted:o}=s;jt(r,"topk");const i=n.data.get(r.dataId).values,[u,c]=DD(i,r.shape,r.dtype,a,o);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const FP={kernelName:Mg,backendName:"cpu",kernelFunc:OP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(e){const{inputs:t,attrs:n,backend:s}=e,{image:r,transforms:a}=t,{interpolation:o,fillMode:i,fillValue:u,outputShape:c}=n,[l,f,d,m]=r.shape,[g,w]=c??[f,d],b=[l,g,w,m],k=Kt(r.shape),I=k[0],T=k[1],N=k[2],$=Kt(b),D=$[0],P=$[1],L=$[2],R=pn(r.dtype,Nt(b));R.fill(u);const M=s.data.get(r.dataId).values,E=s.data.get(a.dataId).values;for(let X=0;X<l;++X){const rt=a.shape[0]===1?E:E.subarray(X*8,X*8+8);for(let nt=0;nt<g;++nt)for(let st=0;st<w;++st)for(let it=0;it<m;++it){let tt;const ut=rt[6]*st+rt[7]*nt+1;if(ut===0)continue;const ht=(rt[0]*st+rt[1]*nt+rt[2])/ut,mt=(rt[3]*st+rt[4]*nt+rt[5])/ut,vt=gp(ht,d,i),bt=gp(mt,f,i);switch(o){case"nearest":tt=BP(M,f,d,I,T,N,X,bt,vt,it,u);break;case"bilinear":tt=WP(M,f,d,I,T,N,X,bt,vt,it,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const $t=X*D+nt*P+st*L+it;R[$t]=tt}return s.makeTensorInfo(b,r.dtype,R)}return{dataId:s.write(R,b,r.dtype),shape:r.shape,dtype:r.dtype}}const PP={kernelName:Vg,backendName:"cpu",kernelFunc:RP};function gp(e,t,n){switch(n){case"reflect":return MP(e,t);case"wrap":return VP(e,t);case"nearest":return zP(e,t);case"constant":default:return LP(e)}}function MP(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=2*t;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-t?n+s:-n-1}else if(n>t-1)if(t<=1)n=0;else{const s=2*t;n-=s*Math.trunc(n/s),n>=t&&(n=s-n-1)}return jl(0,n,t-1)}function VP(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=t-1;n+=t*(Math.trunc(-n/s)+1)}else if(n>t-1)if(t<=1)n=0;else{const s=t-1;n-=t*Math.trunc(n/s)}return jl(0,n,t-1)}function LP(e,t){return e}function zP(e,t){return jl(0,e,t-1)}function oo(e,t,n,s,r,a,o,i,u,c,l){const f=o*s+i*r+u*a+c;return 0<=i&&i<t&&0<=u&&u<n?e[f]:l}function BP(e,t,n,s,r,a,o,i,u,c,l){const f=Math.round(i),d=Math.round(u);return oo(e,t,n,s,r,a,o,f,d,c,l)}function WP(e,t,n,s,r,a,o,i,u,c,l){const f=Math.floor(i),d=Math.floor(u),m=f+1,g=d+1,w=(g-u)*oo(e,t,n,s,r,a,o,f,d,c,l)+(u-d)*oo(e,t,n,s,r,a,o,f,g,c,l),b=(g-u)*oo(e,t,n,s,r,a,o,m,d,c,l)+(u-d)*oo(e,t,n,s,r,a,o,m,g,c,l);return(m-i)*w+(i-f)*b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jP(e){const{inputs:t,attrs:n,backend:s}=e,{axis:r}=n,{x:a}=t;jt(a,"unique");const o=s.data.get(a.dataId).values,{outputValues:i,outputShape:u,indices:c}=OD(o,r,a.shape,a.dtype);return[s.makeTensorInfo(u,a.dtype,i),s.makeTensorInfo([c.length],"int32",c)]}const HP={kernelName:Lg,backendName:"cpu",kernelFunc:jP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qP(e){const{inputs:t,backend:n,attrs:s}=e,{value:r}=t;let{axis:a}=s;a<0&&(a+=r.shape.length);const o=r.shape.length,i=r.shape[a],u=new Array(o-1);let c=0;for(let m=0;m<o;m++)m!==a&&(u[c++]=r.shape[m]);const l=new Array(o).fill(0),f=r.shape.slice();f[a]=1;const d=new Array(i);for(let m=0;m<d.length;m++){l[a]=m;const g=Yr({inputs:{x:r},backend:n,attrs:{begin:l,size:f}});d[m]=Se({inputs:{x:g},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(g)}return d}const KP={kernelName:zg,backendName:"cpu",kernelFunc:qP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,segmentIds:a}=t,{numSegments:o}=s;jt(r,"unsortedSegmentSum");const i=r.shape.length,u=a.shape.length,c=[],l=[],f=i-u;let d=a;for(let g=0;g<f;++g){const w=nu({inputs:{input:d},backend:n,attrs:{dim:g+1}});d=w,l.push(w)}for(let g=0;g<o;++g){const w=Jf(g,"int32"),b=n.makeTensorInfo([],"int32",w),k=kb({inputs:{a:b,b:d},backend:n}),I=hr({inputs:{x:k},backend:n,attrs:{dtype:"float32"}}),T=Cu({inputs:{a:I,b:r},backend:n}),N=jo({inputs:{x:T},backend:n,attrs:{axis:0,keepDims:!1}});c.push(N),l.push(b),l.push(k),l.push(I),l.push(T),l.push(N)}const m=Wb({inputs:c,backend:n,attrs:{axis:0}});return l.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const GP={kernelName:Bg,backendName:"cpu",kernelFunc:UP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YP=[jD,MC,qD,UD,qC,YD,ZD,QD,eO,sO,aO,iO,cO,hO,pO,yO,wO,kO,SO,BD,IO,TO,$O,YC,AO,WC,JC,OO,VC,RO,MO,VO,zO,WO,HO,KO,GO,XO,JO,tF,nF,rF,oF,uF,cF,fF,dF,mF,gF,yF,bF,vF,SF,FD,IF,eA,OF,sA,FF,oA,zF,BF,jF,cA,hA,qF,UF,YF,ZF,yA,vA,LC,QF,PO,e3,s3,a3,RD,SA,_A,i3,CA,c3,h3,p3,y3,w3,k3,x3,FA,N3,_3,E3,C3,D3,F3,P3,MA,V3,B3,H3,LA,WA,U3,X3,Q3,qA,eR,sR,rR,jb,uR,MD,YA,lR,hR,pR,gR,zC,Sl,bR,VD,LD,zD,vR,xR,NR,_R,ER,$R,AR,uD,OR,VR,zR,HR,cD,KR,GR,XR,fD,W3,QR,eP,sP,aP,iP,cP,fP,dP,mD,pP,bD,kD,gP,bP,vP,xP,NP,CD,kF,_P,EP,CP,DP,FP,PP,KA,HP,KP,GP,nR];for(const e of YP)dv(e);var XP=class{constructor(e){Qs(this,"model");Qs(this,"dict",[]);Qs(this,"canvas");Qs(this,"ctx");Qs(this,"modelPath");Qs(this,"dictPath");Qs(this,"backend");this.modelPath=e.modelPath,this.dictPath=e.dictPath,this.backend=e.backend||"cpu",this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=64,this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0})}async initialize(e){const t=await fetch(this.dictPath).then(n=>n.text());return this.dict=t.split(`
`),this.model=await DC(this.modelPath,{streamWeights:!0,onProgress:e==null?void 0:e.onProgress}),this.backend==="webgl"?(await Pd("webgl"),await Bv(),await this.recognize([10,10,0,20,20,1])):await Pd("cpu"),!0}async recognize(e){if(!this.model)throw new Error("Model not initialized");const{canvas:t,ctx:n,model:s,dict:r}=this;n.fillStyle="white",n.fillRect(0,0,t.width,t.height);const a=e.length/3,o=Array.from({length:a},(k,I)=>({x:e[3*I],y:e[3*I+1],isEnd:e[3*I+2]===1}));let i=1/0,u=1/0,c=-1/0,l=-1/0;for(const{x:k,y:I}of o)k<i&&(i=k),k>c&&(c=k),I<u&&(u=I),I>l&&(l=I);const f=c-i||1,d=l-u||1,m=(i+c)/2,g=(u+l)/2,w=Math.min(t.width*.9/f,t.height*.9/d);n.strokeStyle="black",n.lineWidth=2,n.lineCap="round",n.lineJoin="round";let b=null;for(const k of o){const I=t.width/2+(k.x-m)*w,T=t.height/2+(k.y-g)*w;b&&!b.isEnd?(n.beginPath(),n.moveTo(t.width/2+(b.x-m)*w,t.height/2+(b.y-g)*w),n.lineTo(I,T),n.stroke()):(n.beginPath(),n.moveTo(I,T)),b=k}return de(()=>{const k=o2(t,3),I=Pe(k,"float32"),T=xe(I,255),N=Ts(T,0),$=s.predict(N).dataSync();return Array.from($.keys()).sort((P,L)=>$[L]-$[P]).slice(0,10).map(P=>P<r.length?r[P]:"").filter(Boolean)})}async close(){var e;(e=this.model)==null||e.dispose(),this.model=void 0}};/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ih(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const pe={},wa=[],ps=()=>{},Hb=()=>!1,Au=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),_h=e=>e.startsWith("onUpdate:"),en=Object.assign,Th=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},ZP=Object.prototype.hasOwnProperty,ge=(e,t)=>ZP.call(e,t),Yt=Array.isArray,va=e=>Ho(e)==="[object Map]",Du=e=>Ho(e)==="[object Set]",yp=e=>Ho(e)==="[object Date]",ee=e=>typeof e=="function",Be=e=>typeof e=="string",bs=e=>typeof e=="symbol",Ee=e=>e!==null&&typeof e=="object",qb=e=>(Ee(e)||ee(e))&&ee(e.then)&&ee(e.catch),Kb=Object.prototype.toString,Ho=e=>Kb.call(e),JP=e=>Ho(e).slice(8,-1),Ub=e=>Ho(e)==="[object Object]",Eh=e=>Be(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,fo=Ih(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ou=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},QP=/-\w/g,Vs=Ou(e=>e.replace(QP,t=>t.slice(1).toUpperCase())),tM=/\B([A-Z])/g,wr=Ou(e=>e.replace(tM,"-$1").toLowerCase()),Gb=Ou(e=>e.charAt(0).toUpperCase()+e.slice(1)),Fc=Ou(e=>e?`on${Gb(e)}`:""),$n=(e,t)=>!Object.is(e,t),Mi=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},Yb=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},Il=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let bp;const Fu=()=>bp||(bp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Da(e){if(Yt(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],r=Be(s)?rM(s):Da(s);if(r)for(const a in r)t[a]=r[a]}return t}else if(Be(e)||Ee(e))return e}const eM=/;(?![^(]*\))/g,nM=/:([^]+)/,sM=/\/\*[^]*?\*\//g;function rM(e){const t={};return e.replace(sM,"").split(eM).forEach(n=>{if(n){const s=n.split(nM);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function ur(e){let t="";if(Be(e))t=e;else if(Yt(e))for(let n=0;n<e.length;n++){const s=ur(e[n]);s&&(t+=s+" ")}else if(Ee(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const aM="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",oM=Ih(aM);function Xb(e){return!!e||e===""}function iM(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=Oa(e[s],t[s]);return n}function Oa(e,t){if(e===t)return!0;let n=yp(e),s=yp(t);if(n||s)return n&&s?e.getTime()===t.getTime():!1;if(n=bs(e),s=bs(t),n||s)return e===t;if(n=Yt(e),s=Yt(t),n||s)return n&&s?iM(e,t):!1;if(n=Ee(e),s=Ee(t),n||s){if(!n||!s)return!1;const r=Object.keys(e).length,a=Object.keys(t).length;if(r!==a)return!1;for(const o in e){const i=e.hasOwnProperty(o),u=t.hasOwnProperty(o);if(i&&!u||!i&&u||!Oa(e[o],t[o]))return!1}}return String(e)===String(t)}function Zb(e,t){return e.findIndex(n=>Oa(n,t))}const Jb=e=>!!(e&&e.__v_isRef===!0),fn=e=>Be(e)?e:e==null?"":Yt(e)||Ee(e)&&(e.toString===Kb||!ee(e.toString))?Jb(e)?fn(e.value):JSON.stringify(e,Qb,2):String(e),Qb=(e,t)=>Jb(t)?Qb(e,t.value):va(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[s,r],a)=>(n[Rc(s,a)+" =>"]=r,n),{})}:Du(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>Rc(n))}:bs(t)?Rc(t):Ee(t)&&!Yt(t)&&!Ub(t)?String(t):t,Rc=(e,t="")=>{var n;return bs(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let an;class uM{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=an,!t&&an&&(this.index=(an.scopes||(an.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=an;try{return an=this,t()}finally{an=n}}}on(){++this._on===1&&(this.prevScope=an,an=this)}off(){this._on>0&&--this._on===0&&(an=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function t0(){return an}function cM(e,t=!1){an&&an.cleanups.push(e)}let _e;const Pc=new WeakSet;class e0{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,an&&an.active&&an.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Pc.has(this)&&(Pc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||s0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,wp(this),r0(this);const t=_e,n=Zn;_e=this,Zn=!0;try{return this.fn()}finally{a0(this),_e=t,Zn=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Ah(t);this.deps=this.depsTail=void 0,wp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Pc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){_l(this)&&this.run()}get dirty(){return _l(this)}}let n0=0,ho,po;function s0(e,t=!1){if(e.flags|=8,t){e.next=po,po=e;return}e.next=ho,ho=e}function $h(){n0++}function Ch(){if(--n0>0)return;if(po){let t=po;for(po=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;ho;){let t=ho;for(ho=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=n}}if(e)throw e}function r0(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function a0(e){let t,n=e.depsTail,s=n;for(;s;){const r=s.prevDep;s.version===-1?(s===n&&(n=r),Ah(s),lM(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}e.deps=t,e.depsTail=n}function _l(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(o0(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function o0(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Do)||(e.globalVersion=Do,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!_l(e))))return;e.flags|=2;const t=e.dep,n=_e,s=Zn;_e=e,Zn=!0;try{r0(e);const r=e.fn(e._value);(t.version===0||$n(r,e._value))&&(e.flags|=128,e._value=r,t.version++)}catch(r){throw t.version++,r}finally{_e=n,Zn=s,a0(e),e.flags&=-3}}function Ah(e,t=!1){const{dep:n,prevSub:s,nextSub:r}=e;if(s&&(s.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=s,e.nextSub=void 0),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let a=n.computed.deps;a;a=a.nextDep)Ah(a,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function lM(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Zn=!0;const i0=[];function Ls(){i0.push(Zn),Zn=!1}function zs(){const e=i0.pop();Zn=e===void 0?!0:e}function wp(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=_e;_e=void 0;try{t()}finally{_e=n}}}let Do=0;class fM{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ru{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!_e||!Zn||_e===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==_e)n=this.activeLink=new fM(_e,this),_e.deps?(n.prevDep=_e.depsTail,_e.depsTail.nextDep=n,_e.depsTail=n):_e.deps=_e.depsTail=n,u0(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=_e.depsTail,n.nextDep=void 0,_e.depsTail.nextDep=n,_e.depsTail=n,_e.deps===n&&(_e.deps=s)}return n}trigger(t){this.version++,Do++,this.notify(t)}notify(t){$h();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Ch()}}}function u0(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)u0(s)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Tl=new WeakMap,Vr=Symbol(""),El=Symbol(""),Oo=Symbol("");function ln(e,t,n){if(Zn&&_e){let s=Tl.get(e);s||Tl.set(e,s=new Map);let r=s.get(n);r||(s.set(n,r=new Ru),r.map=s,r.key=n),r.track()}}function As(e,t,n,s,r,a){const o=Tl.get(e);if(!o){Do++;return}const i=u=>{u&&u.trigger()};if($h(),t==="clear")o.forEach(i);else{const u=Yt(e),c=u&&Eh(n);if(u&&n==="length"){const l=Number(s);o.forEach((f,d)=>{(d==="length"||d===Oo||!bs(d)&&d>=l)&&i(f)})}else switch((n!==void 0||o.has(void 0))&&i(o.get(n)),c&&i(o.get(Oo)),t){case"add":u?c&&i(o.get("length")):(i(o.get(Vr)),va(e)&&i(o.get(El)));break;case"delete":u||(i(o.get(Vr)),va(e)&&i(o.get(El)));break;case"set":va(e)&&i(o.get(Vr));break}}Ch()}function ua(e){const t=me(e);return t===e?t:(ln(t,"iterate",Oo),qn(e)?t:t.map(Qe))}function Pu(e){return ln(e=me(e),"iterate",Oo),e}const hM={__proto__:null,[Symbol.iterator](){return Mc(this,Symbol.iterator,Qe)},concat(...e){return ua(this).concat(...e.map(t=>Yt(t)?ua(t):t))},entries(){return Mc(this,"entries",e=>(e[1]=Qe(e[1]),e))},every(e,t){return Is(this,"every",e,t,void 0,arguments)},filter(e,t){return Is(this,"filter",e,t,n=>n.map(Qe),arguments)},find(e,t){return Is(this,"find",e,t,Qe,arguments)},findIndex(e,t){return Is(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Is(this,"findLast",e,t,Qe,arguments)},findLastIndex(e,t){return Is(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Is(this,"forEach",e,t,void 0,arguments)},includes(...e){return Vc(this,"includes",e)},indexOf(...e){return Vc(this,"indexOf",e)},join(e){return ua(this).join(e)},lastIndexOf(...e){return Vc(this,"lastIndexOf",e)},map(e,t){return Is(this,"map",e,t,void 0,arguments)},pop(){return to(this,"pop")},push(...e){return to(this,"push",e)},reduce(e,...t){return vp(this,"reduce",e,t)},reduceRight(e,...t){return vp(this,"reduceRight",e,t)},shift(){return to(this,"shift")},some(e,t){return Is(this,"some",e,t,void 0,arguments)},splice(...e){return to(this,"splice",e)},toReversed(){return ua(this).toReversed()},toSorted(e){return ua(this).toSorted(e)},toSpliced(...e){return ua(this).toSpliced(...e)},unshift(...e){return to(this,"unshift",e)},values(){return Mc(this,"values",Qe)}};function Mc(e,t,n){const s=Pu(e),r=s[t]();return s!==e&&!qn(e)&&(r._next=r.next,r.next=()=>{const a=r._next();return a.done||(a.value=n(a.value)),a}),r}const dM=Array.prototype;function Is(e,t,n,s,r,a){const o=Pu(e),i=o!==e&&!qn(e),u=o[t];if(u!==dM[t]){const f=u.apply(e,a);return i?Qe(f):f}let c=n;o!==e&&(i?c=function(f,d){return n.call(this,Qe(f),d,e)}:n.length>2&&(c=function(f,d){return n.call(this,f,d,e)}));const l=u.call(o,c,s);return i&&r?r(l):l}function vp(e,t,n,s){const r=Pu(e);let a=n;return r!==e&&(qn(e)?n.length>3&&(a=function(o,i,u){return n.call(this,o,i,u,e)}):a=function(o,i,u){return n.call(this,o,Qe(i),u,e)}),r[t](a,...s)}function Vc(e,t,n){const s=me(e);ln(s,"iterate",Oo);const r=s[t](...n);return(r===-1||r===!1)&&Rh(n[0])?(n[0]=me(n[0]),s[t](...n)):r}function to(e,t,n=[]){Ls(),$h();const s=me(e)[t].apply(e,n);return Ch(),zs(),s}const pM=Ih("__proto__,__v_isRef,__isVue"),c0=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(bs));function mM(e){bs(e)||(e=String(e));const t=me(this);return ln(t,"has",e),t.hasOwnProperty(e)}class l0{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,s){if(n==="__v_skip")return t.__v_skip;const r=this._isReadonly,a=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return a;if(n==="__v_raw")return s===(r?a?IM:p0:a?d0:h0).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=Yt(t);if(!r){let u;if(o&&(u=hM[n]))return u;if(n==="hasOwnProperty")return mM}const i=Reflect.get(t,n,dn(t)?t:s);if((bs(n)?c0.has(n):pM(n))||(r||ln(t,"get",n),a))return i;if(dn(i)){const u=o&&Eh(n)?i:i.value;return r&&Ee(u)?Cl(u):u}return Ee(i)?r?Cl(i):Oh(i):i}}class f0 extends l0{constructor(t=!1){super(!1,t)}set(t,n,s,r){let a=t[n];if(!this._isShallow){const u=dr(a);if(!qn(s)&&!dr(s)&&(a=me(a),s=me(s)),!Yt(t)&&dn(a)&&!dn(s))return u||(a.value=s),!0}const o=Yt(t)&&Eh(n)?Number(n)<t.length:ge(t,n),i=Reflect.set(t,n,s,dn(t)?t:r);return t===me(r)&&(o?$n(s,a)&&As(t,"set",n,s):As(t,"add",n,s)),i}deleteProperty(t,n){const s=ge(t,n);t[n];const r=Reflect.deleteProperty(t,n);return r&&s&&As(t,"delete",n,void 0),r}has(t,n){const s=Reflect.has(t,n);return(!bs(n)||!c0.has(n))&&ln(t,"has",n),s}ownKeys(t){return ln(t,"iterate",Yt(t)?"length":Vr),Reflect.ownKeys(t)}}class gM extends l0{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const yM=new f0,bM=new gM,wM=new f0(!0);const $l=e=>e,ki=e=>Reflect.getPrototypeOf(e);function vM(e,t,n){return function(...s){const r=this.__v_raw,a=me(r),o=va(a),i=e==="entries"||e===Symbol.iterator&&o,u=e==="keys"&&o,c=r[e](...s),l=n?$l:t?ru:Qe;return!t&&ln(a,"iterate",u?El:Vr),{next(){const{value:f,done:d}=c.next();return d?{value:f,done:d}:{value:i?[l(f[0]),l(f[1])]:l(f),done:d}},[Symbol.iterator](){return this}}}}function xi(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function kM(e,t){const n={get(r){const a=this.__v_raw,o=me(a),i=me(r);e||($n(r,i)&&ln(o,"get",r),ln(o,"get",i));const{has:u}=ki(o),c=t?$l:e?ru:Qe;if(u.call(o,r))return c(a.get(r));if(u.call(o,i))return c(a.get(i));a!==o&&a.get(r)},get size(){const r=this.__v_raw;return!e&&ln(me(r),"iterate",Vr),r.size},has(r){const a=this.__v_raw,o=me(a),i=me(r);return e||($n(r,i)&&ln(o,"has",r),ln(o,"has",i)),r===i?a.has(r):a.has(r)||a.has(i)},forEach(r,a){const o=this,i=o.__v_raw,u=me(i),c=t?$l:e?ru:Qe;return!e&&ln(u,"iterate",Vr),i.forEach((l,f)=>r.call(a,c(l),c(f),o))}};return en(n,e?{add:xi("add"),set:xi("set"),delete:xi("delete"),clear:xi("clear")}:{add(r){!t&&!qn(r)&&!dr(r)&&(r=me(r));const a=me(this);return ki(a).has.call(a,r)||(a.add(r),As(a,"add",r,r)),this},set(r,a){!t&&!qn(a)&&!dr(a)&&(a=me(a));const o=me(this),{has:i,get:u}=ki(o);let c=i.call(o,r);c||(r=me(r),c=i.call(o,r));const l=u.call(o,r);return o.set(r,a),c?$n(a,l)&&As(o,"set",r,a):As(o,"add",r,a),this},delete(r){const a=me(this),{has:o,get:i}=ki(a);let u=o.call(a,r);u||(r=me(r),u=o.call(a,r)),i&&i.call(a,r);const c=a.delete(r);return u&&As(a,"delete",r,void 0),c},clear(){const r=me(this),a=r.size!==0,o=r.clear();return a&&As(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=vM(r,e,t)}),n}function Dh(e,t){const n=kM(e,t);return(s,r,a)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?s:Reflect.get(ge(n,r)&&r in s?n:s,r,a)}const xM={get:Dh(!1,!1)},SM={get:Dh(!1,!0)},NM={get:Dh(!0,!1)};const h0=new WeakMap,d0=new WeakMap,p0=new WeakMap,IM=new WeakMap;function _M(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function TM(e){return e.__v_skip||!Object.isExtensible(e)?0:_M(JP(e))}function Oh(e){return dr(e)?e:Fh(e,!1,yM,xM,h0)}function EM(e){return Fh(e,!1,wM,SM,d0)}function Cl(e){return Fh(e,!0,bM,NM,p0)}function Fh(e,t,n,s,r){if(!Ee(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=TM(e);if(a===0)return e;const o=r.get(e);if(o)return o;const i=new Proxy(e,a===2?s:n);return r.set(e,i),i}function ka(e){return dr(e)?ka(e.__v_raw):!!(e&&e.__v_isReactive)}function dr(e){return!!(e&&e.__v_isReadonly)}function qn(e){return!!(e&&e.__v_isShallow)}function Rh(e){return e?!!e.__v_raw:!1}function me(e){const t=e&&e.__v_raw;return t?me(t):e}function $M(e){return!ge(e,"__v_skip")&&Object.isExtensible(e)&&Yb(e,"__v_skip",!0),e}const Qe=e=>Ee(e)?Oh(e):e,ru=e=>Ee(e)?Cl(e):e;function dn(e){return e?e.__v_isRef===!0:!1}function ke(e){return m0(e,!1)}function au(e){return m0(e,!0)}function m0(e,t){return dn(e)?e:new CM(e,t)}class CM{constructor(t,n){this.dep=new Ru,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:me(t),this._value=n?t:Qe(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,s=this.__v_isShallow||qn(t)||dr(t);t=s?t:me(t),$n(t,n)&&(this._rawValue=t,this._value=s?t:Qe(t),this.dep.trigger())}}function An(e){return dn(e)?e.value:e}function cr(e){return ee(e)?e():An(e)}const AM={get:(e,t,n)=>t==="__v_raw"?e:An(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const r=e[t];return dn(r)&&!dn(n)?(r.value=n,!0):Reflect.set(e,t,n,s)}};function g0(e){return ka(e)?e:new Proxy(e,AM)}class DM{constructor(t){this.__v_isRef=!0,this._value=void 0;const n=this.dep=new Ru,{get:s,set:r}=t(n.track.bind(n),n.trigger.bind(n));this._get=s,this._set=r}get value(){return this._value=this._get()}set value(t){this._set(t)}}function OM(e){return new DM(e)}class FM{constructor(t,n,s){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Ru(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Do-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&_e!==this)return s0(this,!0),!0}get value(){const t=this.dep.track();return o0(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function RM(e,t,n=!1){let s,r;return ee(e)?s=e:(s=e.get,r=e.set),new FM(s,r,n)}const Si={},ou=new WeakMap;let Cr;function PM(e,t=!1,n=Cr){if(n){let s=ou.get(n);s||ou.set(n,s=[]),s.push(e)}}function MM(e,t,n=pe){const{immediate:s,deep:r,once:a,scheduler:o,augmentJob:i,call:u}=n,c=N=>r?N:qn(N)||r===!1||r===0?Ds(N,1):Ds(N);let l,f,d,m,g=!1,w=!1;if(dn(e)?(f=()=>e.value,g=qn(e)):ka(e)?(f=()=>c(e),g=!0):Yt(e)?(w=!0,g=e.some(N=>ka(N)||qn(N)),f=()=>e.map(N=>{if(dn(N))return N.value;if(ka(N))return c(N);if(ee(N))return u?u(N,2):N()})):ee(e)?t?f=u?()=>u(e,2):e:f=()=>{if(d){Ls();try{d()}finally{zs()}}const N=Cr;Cr=l;try{return u?u(e,3,[m]):e(m)}finally{Cr=N}}:f=ps,t&&r){const N=f,$=r===!0?1/0:r;f=()=>Ds(N(),$)}const b=t0(),k=()=>{l.stop(),b&&b.active&&Th(b.effects,l)};if(a&&t){const N=t;t=(...$)=>{N(...$),k()}}let I=w?new Array(e.length).fill(Si):Si;const T=N=>{if(!(!(l.flags&1)||!l.dirty&&!N))if(t){const $=l.run();if(r||g||(w?$.some((D,P)=>$n(D,I[P])):$n($,I))){d&&d();const D=Cr;Cr=l;try{const P=[$,I===Si?void 0:w&&I[0]===Si?[]:I,m];I=$,u?u(t,3,P):t(...P)}finally{Cr=D}}}else l.run()};return i&&i(T),l=new e0(f),l.scheduler=o?()=>o(T,!1):T,m=N=>PM(N,!1,l),d=l.onStop=()=>{const N=ou.get(l);if(N){if(u)u(N,4);else for(const $ of N)$();ou.delete(l)}},t?s?T(!0):I=l.run():o?o(T.bind(null,!0),!0):l.run(),k.pause=l.pause.bind(l),k.resume=l.resume.bind(l),k.stop=k,k}function Ds(e,t=1/0,n){if(t<=0||!Ee(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,dn(e))Ds(e.value,t,n);else if(Yt(e))for(let s=0;s<e.length;s++)Ds(e[s],t,n);else if(Du(e)||va(e))e.forEach(s=>{Ds(s,t,n)});else if(Ub(e)){for(const s in e)Ds(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&Ds(e[s],t,n)}return e}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function qo(e,t,n,s){try{return s?e(...s):e()}catch(r){Mu(r,t,n)}}function ws(e,t,n,s){if(ee(e)){const r=qo(e,t,n,s);return r&&qb(r)&&r.catch(a=>{Mu(a,t,n)}),r}if(Yt(e)){const r=[];for(let a=0;a<e.length;a++)r.push(ws(e[a],t,n,s));return r}}function Mu(e,t,n,s=!0){const r=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||pe;if(t){let i=t.parent;const u=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;i;){const l=i.ec;if(l){for(let f=0;f<l.length;f++)if(l[f](e,u,c)===!1)return}i=i.parent}if(a){Ls(),qo(a,null,10,[e,u,c]),zs();return}}VM(e,n,r,s,o)}function VM(e,t,n,s=!0,r=!1){if(r)throw e;console.error(e)}const wn=[];let os=-1;const xa=[];let tr=null,da=0;const y0=Promise.resolve();let iu=null;function Fo(e){const t=iu||y0;return e?t.then(this?e.bind(this):e):t}function LM(e){let t=os+1,n=wn.length;for(;t<n;){const s=t+n>>>1,r=wn[s],a=Ro(r);a<e||a===e&&r.flags&2?t=s+1:n=s}return t}function Ph(e){if(!(e.flags&1)){const t=Ro(e),n=wn[wn.length-1];!n||!(e.flags&2)&&t>=Ro(n)?wn.push(e):wn.splice(LM(t),0,e),e.flags|=1,b0()}}function b0(){iu||(iu=y0.then(v0))}function zM(e){Yt(e)?xa.push(...e):tr&&e.id===-1?tr.splice(da+1,0,e):e.flags&1||(xa.push(e),e.flags|=1),b0()}function kp(e,t,n=os+1){for(;n<wn.length;n++){const s=wn[n];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;wn.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function w0(e){if(xa.length){const t=[...new Set(xa)].sort((n,s)=>Ro(n)-Ro(s));if(xa.length=0,tr){tr.push(...t);return}for(tr=t,da=0;da<tr.length;da++){const n=tr[da];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}tr=null,da=0}}const Ro=e=>e.id==null?e.flags&2?-1:1/0:e.id;function v0(e){try{for(os=0;os<wn.length;os++){const t=wn[os];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),qo(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;os<wn.length;os++){const t=wn[os];t&&(t.flags&=-2)}os=-1,wn.length=0,w0(),iu=null,(wn.length||xa.length)&&v0()}}let jn=null,k0=null;function uu(e){const t=jn;return jn=e,k0=e&&e.type.__scopeId||null,t}function BM(e,t=jn,n){if(!t||e._n)return e;const s=(...r)=>{s._d&&Op(-1);const a=uu(t);let o;try{o=e(...r)}finally{uu(a),s._d&&Op(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function is(e,t){if(jn===null)return e;const n=qu(jn),s=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[a,o,i,u=pe]=t[r];a&&(ee(a)&&(a={mounted:a,updated:a}),a.deep&&Ds(o),s.push({dir:a,instance:n,value:o,oldValue:void 0,arg:i,modifiers:u}))}return e}function Tr(e,t,n,s){const r=e.dirs,a=t&&t.dirs;for(let o=0;o<r.length;o++){const i=r[o];a&&(i.oldValue=a[o].value);let u=i.dir[s];u&&(Ls(),ws(u,n,8,[e.el,i,e,t]),zs())}}const x0=Symbol("_vte"),WM=e=>e.__isTeleport,mo=e=>e&&(e.disabled||e.disabled===""),xp=e=>e&&(e.defer||e.defer===""),Sp=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Np=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Al=(e,t)=>{const n=e&&e.to;return Be(n)?t?t(n):null:n},S0={name:"Teleport",__isTeleport:!0,process(e,t,n,s,r,a,o,i,u,c){const{mc:l,pc:f,pbc:d,o:{insert:m,querySelector:g,createText:w,createComment:b}}=c,k=mo(t.props);let{shapeFlag:I,children:T,dynamicChildren:N}=t;if(e==null){const $=t.el=w(""),D=t.anchor=w("");m($,n,s),m(D,n,s);const P=(R,M)=>{I&16&&l(T,R,M,r,a,o,i,u)},L=()=>{const R=t.target=Al(t.props,g),M=N0(R,t,w,m);R&&(o!=="svg"&&Sp(R)?o="svg":o!=="mathml"&&Np(R)&&(o="mathml"),r&&r.isCE&&(r.ce._teleportTargets||(r.ce._teleportTargets=new Set)).add(R),k||(P(R,M),Vi(t,!1)))};k&&(P(n,D),Vi(t,!0)),xp(t.props)?(t.el.__isMounted=!1,bn(()=>{L(),delete t.el.__isMounted},a)):L()}else{if(xp(t.props)&&e.el.__isMounted===!1){bn(()=>{S0.process(e,t,n,s,r,a,o,i,u,c)},a);return}t.el=e.el,t.targetStart=e.targetStart;const $=t.anchor=e.anchor,D=t.target=e.target,P=t.targetAnchor=e.targetAnchor,L=mo(e.props),R=L?n:D,M=L?$:P;if(o==="svg"||Sp(D)?o="svg":(o==="mathml"||Np(D))&&(o="mathml"),N?(d(e.dynamicChildren,N,R,r,a,o,i),zh(e,t,!0)):u||f(e,t,R,M,r,a,o,i,!1),k)L?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Ni(t,n,$,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const E=t.target=Al(t.props,g);E&&Ni(t,E,null,c,0)}else L&&Ni(t,D,P,c,1);Vi(t,k)}},remove(e,t,n,{um:s,o:{remove:r}},a){const{shapeFlag:o,children:i,anchor:u,targetStart:c,targetAnchor:l,target:f,props:d}=e;if(f&&(r(c),r(l)),a&&r(u),o&16){const m=a||!mo(d);for(let g=0;g<i.length;g++){const w=i[g];s(w,t,n,m,!!w.dynamicChildren)}}},move:Ni,hydrate:jM};function Ni(e,t,n,{o:{insert:s},m:r},a=2){a===0&&s(e.targetAnchor,t,n);const{el:o,anchor:i,shapeFlag:u,children:c,props:l}=e,f=a===2;if(f&&s(o,t,n),(!f||mo(l))&&u&16)for(let d=0;d<c.length;d++)r(c[d],t,n,2);f&&s(i,t,n)}function jM(e,t,n,s,r,a,{o:{nextSibling:o,parentNode:i,querySelector:u,insert:c,createText:l}},f){function d(w,b,k,I){b.anchor=f(o(w),b,i(w),n,s,r,a),b.targetStart=k,b.targetAnchor=I}const m=t.target=Al(t.props,u),g=mo(t.props);if(m){const w=m._lpa||m.firstChild;if(t.shapeFlag&16)if(g)d(e,t,w,w&&o(w));else{t.anchor=o(e);let b=w;for(;b;){if(b&&b.nodeType===8){if(b.data==="teleport start anchor")t.targetStart=b;else if(b.data==="teleport anchor"){t.targetAnchor=b,m._lpa=t.targetAnchor&&o(t.targetAnchor);break}}b=o(b)}t.targetAnchor||N0(m,t,l,c),f(w&&o(w),t,m,n,s,r,a)}Vi(t,g)}else g&&t.shapeFlag&16&&d(e,t,e,o(e));return t.anchor&&o(t.anchor)}const HM=S0;function Vi(e,t){const n=e.ctx;if(n&&n.ut){let s,r;for(t?(s=e.el,r=e.anchor):(s=e.targetStart,r=e.targetAnchor);s&&s!==r;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function N0(e,t,n,s){const r=t.targetStart=n(""),a=t.targetAnchor=n("");return r[x0]=a,e&&(s(r,e),s(a,e)),a}const qM=Symbol("_leaveCb");function Mh(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Mh(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function js(e,t){return ee(e)?en({name:e.name},t,{setup:e}):e}function I0(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const cu=new WeakMap;function go(e,t,n,s,r=!1){if(Yt(e)){e.forEach((g,w)=>go(g,t&&(Yt(t)?t[w]:t),n,s,r));return}if(yo(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&go(e,t,n,s.component.subTree);return}const a=s.shapeFlag&4?qu(s.component):s.el,o=r?null:a,{i,r:u}=e,c=t&&t.r,l=i.refs===pe?i.refs={}:i.refs,f=i.setupState,d=me(f),m=f===pe?Hb:g=>ge(d,g);if(c!=null&&c!==u){if(Ip(t),Be(c))l[c]=null,m(c)&&(f[c]=null);else if(dn(c)){c.value=null;const g=t;g.k&&(l[g.k]=null)}}if(ee(u))qo(u,i,12,[o,l]);else{const g=Be(u),w=dn(u);if(g||w){const b=()=>{if(e.f){const k=g?m(u)?f[u]:l[u]:u.value;if(r)Yt(k)&&Th(k,a);else if(Yt(k))k.includes(a)||k.push(a);else if(g)l[u]=[a],m(u)&&(f[u]=l[u]);else{const I=[a];u.value=I,e.k&&(l[e.k]=I)}}else g?(l[u]=o,m(u)&&(f[u]=o)):w&&(u.value=o,e.k&&(l[e.k]=o))};if(o){const k=()=>{b(),cu.delete(e)};k.id=-1,cu.set(e,k),bn(k,n)}else Ip(e),b()}}}function Ip(e){const t=cu.get(e);t&&(t.flags|=8,cu.delete(e))}Fu().requestIdleCallback;Fu().cancelIdleCallback;const yo=e=>!!e.type.__asyncLoader,_0=e=>e.type.__isKeepAlive;function KM(e,t){T0(e,"a",t)}function UM(e,t){T0(e,"da",t)}function T0(e,t,n=kn){const s=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Vu(t,s,n),n){let r=n.parent;for(;r&&r.parent;)_0(r.parent.vnode)&&GM(s,t,n,r),r=r.parent}}function GM(e,t,n,s){const r=Vu(t,e,s,!0);Lu(()=>{Th(s[t],r)},n)}function Vu(e,t,n=kn,s=!1){if(n){const r=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...o)=>{Ls();const i=Uo(n),u=ws(t,n,e,o);return i(),zs(),u});return s?r.unshift(a):r.push(a),a}}const Hs=e=>(t,n=kn)=>{(!Vo||e==="sp")&&Vu(e,(...s)=>t(...s),n)},YM=Hs("bm"),Ko=Hs("m"),XM=Hs("bu"),ZM=Hs("u"),JM=Hs("bum"),Lu=Hs("um"),QM=Hs("sp"),tV=Hs("rtg"),eV=Hs("rtc");function nV(e,t=kn){Vu("ec",e,t)}const sV=Symbol.for("v-ndc");function ms(e,t,n,s){let r;const a=n,o=Yt(e);if(o||Be(e)){const i=o&&ka(e);let u=!1,c=!1;i&&(u=!qn(e),c=dr(e),e=Pu(e)),r=new Array(e.length);for(let l=0,f=e.length;l<f;l++)r[l]=t(u?c?ru(Qe(e[l])):Qe(e[l]):e[l],l,void 0,a)}else if(typeof e=="number"){r=new Array(e);for(let i=0;i<e;i++)r[i]=t(i+1,i,void 0,a)}else if(Ee(e))if(e[Symbol.iterator])r=Array.from(e,(i,u)=>t(i,u,void 0,a));else{const i=Object.keys(e);r=new Array(i.length);for(let u=0,c=i.length;u<c;u++){const l=i[u];r[u]=t(e[l],l,u,a)}}else r=[];return r}const Dl=e=>e?Y0(e)?qu(e):Dl(e.parent):null,bo=en(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Dl(e.parent),$root:e=>Dl(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>$0(e),$forceUpdate:e=>e.f||(e.f=()=>{Ph(e.update)}),$nextTick:e=>e.n||(e.n=Fo.bind(e.proxy)),$watch:e=>_V.bind(e)}),Lc=(e,t)=>e!==pe&&!e.__isScriptSetup&&ge(e,t),rV={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:s,data:r,props:a,accessCache:o,type:i,appContext:u}=e;let c;if(t[0]!=="$"){const m=o[t];if(m!==void 0)switch(m){case 1:return s[t];case 2:return r[t];case 4:return n[t];case 3:return a[t]}else{if(Lc(s,t))return o[t]=1,s[t];if(r!==pe&&ge(r,t))return o[t]=2,r[t];if((c=e.propsOptions[0])&&ge(c,t))return o[t]=3,a[t];if(n!==pe&&ge(n,t))return o[t]=4,n[t];Fl&&(o[t]=0)}}const l=bo[t];let f,d;if(l)return t==="$attrs"&&ln(e.attrs,"get",""),l(e);if((f=i.__cssModules)&&(f=f[t]))return f;if(n!==pe&&ge(n,t))return o[t]=4,n[t];if(d=u.config.globalProperties,ge(d,t))return d[t]},set({_:e},t,n){const{data:s,setupState:r,ctx:a}=e;return Lc(r,t)?(r[t]=n,!0):s!==pe&&ge(s,t)?(s[t]=n,!0):ge(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:r,propsOptions:a,type:o}},i){let u,c;return!!(n[i]||e!==pe&&i[0]!=="$"&&ge(e,i)||Lc(t,i)||(u=a[0])&&ge(u,i)||ge(s,i)||ge(bo,i)||ge(r.config.globalProperties,i)||(c=o.__cssModules)&&c[i])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:ge(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function lu(e){return Yt(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}function Ol(e,t){return!e||!t?e||t:Yt(e)&&Yt(t)?e.concat(t):en({},lu(e),lu(t))}let Fl=!0;function aV(e){const t=$0(e),n=e.proxy,s=e.ctx;Fl=!1,t.beforeCreate&&_p(t.beforeCreate,e,"bc");const{data:r,computed:a,methods:o,watch:i,provide:u,inject:c,created:l,beforeMount:f,mounted:d,beforeUpdate:m,updated:g,activated:w,deactivated:b,beforeDestroy:k,beforeUnmount:I,destroyed:T,unmounted:N,render:$,renderTracked:D,renderTriggered:P,errorCaptured:L,serverPrefetch:R,expose:M,inheritAttrs:E,components:K,directives:X,filters:rt}=t;if(c&&oV(c,s,null),o)for(const it in o){const tt=o[it];ee(tt)&&(s[it]=tt.bind(n))}if(r){const it=r.call(n,n);Ee(it)&&(e.data=Oh(it))}if(Fl=!0,a)for(const it in a){const tt=a[it],ut=ee(tt)?tt.bind(n,n):ee(tt.get)?tt.get.bind(n,n):ps,ht=!ee(tt)&&ee(tt.set)?tt.set.bind(n):ps,mt=xn({get:ut,set:ht});Object.defineProperty(s,it,{enumerable:!0,configurable:!0,get:()=>mt.value,set:vt=>mt.value=vt})}if(i)for(const it in i)E0(i[it],s,n,it);if(u){const it=ee(u)?u.call(n):u;Reflect.ownKeys(it).forEach(tt=>{hV(tt,it[tt])})}l&&_p(l,e,"c");function st(it,tt){Yt(tt)?tt.forEach(ut=>it(ut.bind(n))):tt&&it(tt.bind(n))}if(st(YM,f),st(Ko,d),st(XM,m),st(ZM,g),st(KM,w),st(UM,b),st(nV,L),st(eV,D),st(tV,P),st(JM,I),st(Lu,N),st(QM,R),Yt(M))if(M.length){const it=e.exposed||(e.exposed={});M.forEach(tt=>{Object.defineProperty(it,tt,{get:()=>n[tt],set:ut=>n[tt]=ut,enumerable:!0})})}else e.exposed||(e.exposed={});$&&e.render===ps&&(e.render=$),E!=null&&(e.inheritAttrs=E),K&&(e.components=K),X&&(e.directives=X),R&&I0(e)}function oV(e,t,n=ps){Yt(e)&&(e=Rl(e));for(const s in e){const r=e[s];let a;Ee(r)?"default"in r?a=Li(r.from||s,r.default,!0):a=Li(r.from||s):a=Li(r),dn(a)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):t[s]=a}}function _p(e,t,n){ws(Yt(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,n)}function E0(e,t,n,s){let r=s.includes(".")?z0(n,s):()=>n[s];if(Be(e)){const a=t[e];ee(a)&&gs(r,a)}else if(ee(e))gs(r,e.bind(n));else if(Ee(e))if(Yt(e))e.forEach(a=>E0(a,t,n,s));else{const a=ee(e.handler)?e.handler.bind(n):t[e.handler];ee(a)&&gs(r,a,e)}}function $0(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:r,optionsCache:a,config:{optionMergeStrategies:o}}=e.appContext,i=a.get(t);let u;return i?u=i:!r.length&&!n&&!s?u=t:(u={},r.length&&r.forEach(c=>fu(u,c,o,!0)),fu(u,t,o)),Ee(t)&&a.set(t,u),u}function fu(e,t,n,s=!1){const{mixins:r,extends:a}=t;a&&fu(e,a,n,!0),r&&r.forEach(o=>fu(e,o,n,!0));for(const o in t)if(!(s&&o==="expose")){const i=iV[o]||n&&n[o];e[o]=i?i(e[o],t[o]):t[o]}return e}const iV={data:Tp,props:Ep,emits:Ep,methods:io,computed:io,beforeCreate:yn,created:yn,beforeMount:yn,mounted:yn,beforeUpdate:yn,updated:yn,beforeDestroy:yn,beforeUnmount:yn,destroyed:yn,unmounted:yn,activated:yn,deactivated:yn,errorCaptured:yn,serverPrefetch:yn,components:io,directives:io,watch:cV,provide:Tp,inject:uV};function Tp(e,t){return t?e?function(){return en(ee(e)?e.call(this,this):e,ee(t)?t.call(this,this):t)}:t:e}function uV(e,t){return io(Rl(e),Rl(t))}function Rl(e){if(Yt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function yn(e,t){return e?[...new Set([].concat(e,t))]:t}function io(e,t){return e?en(Object.create(null),e,t):t}function Ep(e,t){return e?Yt(e)&&Yt(t)?[...new Set([...e,...t])]:en(Object.create(null),lu(e),lu(t??{})):t}function cV(e,t){if(!e)return t;if(!t)return e;const n=en(Object.create(null),e);for(const s in t)n[s]=yn(e[s],t[s]);return n}function C0(){return{app:null,config:{isNativeTag:Hb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let lV=0;function fV(e,t){return function(s,r=null){ee(s)||(s=en({},s)),r!=null&&!Ee(r)&&(r=null);const a=C0(),o=new WeakSet,i=[];let u=!1;const c=a.app={_uid:lV++,_component:s,_props:r,_container:null,_context:a,_instance:null,version:qV,get config(){return a.config},set config(l){},use(l,...f){return o.has(l)||(l&&ee(l.install)?(o.add(l),l.install(c,...f)):ee(l)&&(o.add(l),l(c,...f))),c},mixin(l){return a.mixins.includes(l)||a.mixins.push(l),c},component(l,f){return f?(a.components[l]=f,c):a.components[l]},directive(l,f){return f?(a.directives[l]=f,c):a.directives[l]},mount(l,f,d){if(!u){const m=c._ceVNode||Kn(s,r);return m.appContext=a,d===!0?d="svg":d===!1&&(d=void 0),e(m,l,d),u=!0,c._container=l,l.__vue_app__=c,qu(m.component)}},onUnmount(l){i.push(l)},unmount(){u&&(ws(i,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(l,f){return a.provides[l]=f,c},runWithContext(l){const f=Sa;Sa=c;try{return l()}finally{Sa=f}}};return c}}let Sa=null;function hV(e,t){if(kn){let n=kn.provides;const s=kn.parent&&kn.parent.provides;s===n&&(n=kn.provides=Object.create(s)),n[e]=t}}function Li(e,t,n=!1){const s=Hu();if(s||Sa){let r=Sa?Sa._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return n&&ee(t)?t.call(s&&s.proxy):t}}const A0={},D0=()=>Object.create(A0),O0=e=>Object.getPrototypeOf(e)===A0;function dV(e,t,n,s=!1){const r={},a=D0();e.propsDefaults=Object.create(null),F0(e,t,r,a);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);n?e.props=s?r:EM(r):e.type.props?e.props=r:e.props=a,e.attrs=a}function pV(e,t,n,s){const{props:r,attrs:a,vnode:{patchFlag:o}}=e,i=me(r),[u]=e.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const l=e.vnode.dynamicProps;for(let f=0;f<l.length;f++){let d=l[f];if(Wu(e.emitsOptions,d))continue;const m=t[d];if(u)if(ge(a,d))m!==a[d]&&(a[d]=m,c=!0);else{const g=Vs(d);r[g]=Pl(u,i,g,m,e,!1)}else m!==a[d]&&(a[d]=m,c=!0)}}}else{F0(e,t,r,a)&&(c=!0);let l;for(const f in i)(!t||!ge(t,f)&&((l=wr(f))===f||!ge(t,l)))&&(u?n&&(n[f]!==void 0||n[l]!==void 0)&&(r[f]=Pl(u,i,f,void 0,e,!0)):delete r[f]);if(a!==i)for(const f in a)(!t||!ge(t,f))&&(delete a[f],c=!0)}c&&As(e.attrs,"set","")}function F0(e,t,n,s){const[r,a]=e.propsOptions;let o=!1,i;if(t)for(let u in t){if(fo(u))continue;const c=t[u];let l;r&&ge(r,l=Vs(u))?!a||!a.includes(l)?n[l]=c:(i||(i={}))[l]=c:Wu(e.emitsOptions,u)||(!(u in s)||c!==s[u])&&(s[u]=c,o=!0)}if(a){const u=me(n),c=i||pe;for(let l=0;l<a.length;l++){const f=a[l];n[f]=Pl(r,u,f,c[f],e,!ge(c,f))}}return o}function Pl(e,t,n,s,r,a){const o=e[n];if(o!=null){const i=ge(o,"default");if(i&&s===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&ee(u)){const{propsDefaults:c}=r;if(n in c)s=c[n];else{const l=Uo(r);s=c[n]=u.call(null,t),l()}}else s=u;r.ce&&r.ce._setProp(n,s)}o[0]&&(a&&!i?s=!1:o[1]&&(s===""||s===wr(n))&&(s=!0))}return s}const mV=new WeakMap;function R0(e,t,n=!1){const s=n?mV:t.propsCache,r=s.get(e);if(r)return r;const a=e.props,o={},i=[];let u=!1;if(!ee(e)){const l=f=>{u=!0;const[d,m]=R0(f,t,!0);en(o,d),m&&i.push(...m)};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}if(!a&&!u)return Ee(e)&&s.set(e,wa),wa;if(Yt(a))for(let l=0;l<a.length;l++){const f=Vs(a[l]);$p(f)&&(o[f]=pe)}else if(a)for(const l in a){const f=Vs(l);if($p(f)){const d=a[l],m=o[f]=Yt(d)||ee(d)?{type:d}:en({},d),g=m.type;let w=!1,b=!0;if(Yt(g))for(let k=0;k<g.length;++k){const I=g[k],T=ee(I)&&I.name;if(T==="Boolean"){w=!0;break}else T==="String"&&(b=!1)}else w=ee(g)&&g.name==="Boolean";m[0]=w,m[1]=b,(w||ge(m,"default"))&&i.push(f)}}const c=[o,i];return Ee(e)&&s.set(e,c),c}function $p(e){return e[0]!=="$"&&!fo(e)}const Vh=e=>e==="_"||e==="_ctx"||e==="$stable",Lh=e=>Yt(e)?e.map(cs):[cs(e)],gV=(e,t,n)=>{if(t._n)return t;const s=BM((...r)=>Lh(t(...r)),n);return s._c=!1,s},P0=(e,t,n)=>{const s=e._ctx;for(const r in e){if(Vh(r))continue;const a=e[r];if(ee(a))t[r]=gV(r,a,s);else if(a!=null){const o=Lh(a);t[r]=()=>o}}},M0=(e,t)=>{const n=Lh(t);e.slots.default=()=>n},V0=(e,t,n)=>{for(const s in t)(n||!Vh(s))&&(e[s]=t[s])},yV=(e,t,n)=>{const s=e.slots=D0();if(e.vnode.shapeFlag&32){const r=t._;r?(V0(s,t,n),n&&Yb(s,"_",r,!0)):P0(t,s)}else t&&M0(e,t)},bV=(e,t,n)=>{const{vnode:s,slots:r}=e;let a=!0,o=pe;if(s.shapeFlag&32){const i=t._;i?n&&i===1?a=!1:V0(r,t,n):(a=!t.$stable,P0(t,r)),o=t}else t&&(M0(e,t),o={default:1});if(a)for(const i in r)!Vh(i)&&o[i]==null&&delete r[i]},bn=OV;function wV(e){return vV(e)}function vV(e,t){const n=Fu();n.__VUE__=!0;const{insert:s,remove:r,patchProp:a,createElement:o,createText:i,createComment:u,setText:c,setElementText:l,parentNode:f,nextSibling:d,setScopeId:m=ps,insertStaticContent:g}=e,w=(F,W,at,lt=null,ct=null,dt=null,xt=void 0,_t=null,kt=!!W.dynamicChildren)=>{if(F===W)return;F&&!eo(F,W)&&(lt=Lt(F),vt(F,ct,dt,!0),F=null),W.patchFlag===-2&&(kt=!1,W.dynamicChildren=null);const{type:yt,ref:zt,shapeFlag:Ct}=W;switch(yt){case ju:b(F,W,at,lt);break;case pr:k(F,W,at,lt);break;case Bc:F==null&&I(W,at,lt,xt);break;case De:K(F,W,at,lt,ct,dt,xt,_t,kt);break;default:Ct&1?$(F,W,at,lt,ct,dt,xt,_t,kt):Ct&6?X(F,W,at,lt,ct,dt,xt,_t,kt):(Ct&64||Ct&128)&&yt.process(F,W,at,lt,ct,dt,xt,_t,kt,Ut)}zt!=null&&ct?go(zt,F&&F.ref,dt,W||F,!W):zt==null&&F&&F.ref!=null&&go(F.ref,null,dt,F,!0)},b=(F,W,at,lt)=>{if(F==null)s(W.el=i(W.children),at,lt);else{const ct=W.el=F.el;W.children!==F.children&&c(ct,W.children)}},k=(F,W,at,lt)=>{F==null?s(W.el=u(W.children||""),at,lt):W.el=F.el},I=(F,W,at,lt)=>{[F.el,F.anchor]=g(F.children,W,at,lt,F.el,F.anchor)},T=({el:F,anchor:W},at,lt)=>{let ct;for(;F&&F!==W;)ct=d(F),s(F,at,lt),F=ct;s(W,at,lt)},N=({el:F,anchor:W})=>{let at;for(;F&&F!==W;)at=d(F),r(F),F=at;r(W)},$=(F,W,at,lt,ct,dt,xt,_t,kt)=>{W.type==="svg"?xt="svg":W.type==="math"&&(xt="mathml"),F==null?D(W,at,lt,ct,dt,xt,_t,kt):R(F,W,ct,dt,xt,_t,kt)},D=(F,W,at,lt,ct,dt,xt,_t)=>{let kt,yt;const{props:zt,shapeFlag:Ct,transition:Bt,dirs:Ht}=F;if(kt=F.el=o(F.type,dt,zt&&zt.is,zt),Ct&8?l(kt,F.children):Ct&16&&L(F.children,kt,null,lt,ct,zc(F,dt),xt,_t),Ht&&Tr(F,null,lt,"created"),P(kt,F,F.scopeId,xt,lt),zt){for(const Qt in zt)Qt!=="value"&&!fo(Qt)&&a(kt,Qt,null,zt[Qt],dt,lt);"value"in zt&&a(kt,"value",null,zt.value,dt),(yt=zt.onVnodeBeforeMount)&&as(yt,lt,F)}Ht&&Tr(F,null,lt,"beforeMount");const Gt=kV(ct,Bt);Gt&&Bt.beforeEnter(kt),s(kt,W,at),((yt=zt&&zt.onVnodeMounted)||Gt||Ht)&&bn(()=>{yt&&as(yt,lt,F),Gt&&Bt.enter(kt),Ht&&Tr(F,null,lt,"mounted")},ct)},P=(F,W,at,lt,ct)=>{if(at&&m(F,at),lt)for(let dt=0;dt<lt.length;dt++)m(F,lt[dt]);if(ct){let dt=ct.subTree;if(W===dt||H0(dt.type)&&(dt.ssContent===W||dt.ssFallback===W)){const xt=ct.vnode;P(F,xt,xt.scopeId,xt.slotScopeIds,ct.parent)}}},L=(F,W,at,lt,ct,dt,xt,_t,kt=0)=>{for(let yt=kt;yt<F.length;yt++){const zt=F[yt]=_t?er(F[yt]):cs(F[yt]);w(null,zt,W,at,lt,ct,dt,xt,_t)}},R=(F,W,at,lt,ct,dt,xt)=>{const _t=W.el=F.el;let{patchFlag:kt,dynamicChildren:yt,dirs:zt}=W;kt|=F.patchFlag&16;const Ct=F.props||pe,Bt=W.props||pe;let Ht;if(at&&Er(at,!1),(Ht=Bt.onVnodeBeforeUpdate)&&as(Ht,at,W,F),zt&&Tr(W,F,at,"beforeUpdate"),at&&Er(at,!0),(Ct.innerHTML&&Bt.innerHTML==null||Ct.textContent&&Bt.textContent==null)&&l(_t,""),yt?M(F.dynamicChildren,yt,_t,at,lt,zc(W,ct),dt):xt||tt(F,W,_t,null,at,lt,zc(W,ct),dt,!1),kt>0){if(kt&16)E(_t,Ct,Bt,at,ct);else if(kt&2&&Ct.class!==Bt.class&&a(_t,"class",null,Bt.class,ct),kt&4&&a(_t,"style",Ct.style,Bt.style,ct),kt&8){const Gt=W.dynamicProps;for(let Qt=0;Qt<Gt.length;Qt++){const ne=Gt[Qt],Ne=Ct[ne],Re=Bt[ne];(Re!==Ne||ne==="value")&&a(_t,ne,Ne,Re,ct,at)}}kt&1&&F.children!==W.children&&l(_t,W.children)}else!xt&&yt==null&&E(_t,Ct,Bt,at,ct);((Ht=Bt.onVnodeUpdated)||zt)&&bn(()=>{Ht&&as(Ht,at,W,F),zt&&Tr(W,F,at,"updated")},lt)},M=(F,W,at,lt,ct,dt,xt)=>{for(let _t=0;_t<W.length;_t++){const kt=F[_t],yt=W[_t],zt=kt.el&&(kt.type===De||!eo(kt,yt)||kt.shapeFlag&198)?f(kt.el):at;w(kt,yt,zt,null,lt,ct,dt,xt,!0)}},E=(F,W,at,lt,ct)=>{if(W!==at){if(W!==pe)for(const dt in W)!fo(dt)&&!(dt in at)&&a(F,dt,W[dt],null,ct,lt);for(const dt in at){if(fo(dt))continue;const xt=at[dt],_t=W[dt];xt!==_t&&dt!=="value"&&a(F,dt,_t,xt,ct,lt)}"value"in at&&a(F,"value",W.value,at.value,ct)}},K=(F,W,at,lt,ct,dt,xt,_t,kt)=>{const yt=W.el=F?F.el:i(""),zt=W.anchor=F?F.anchor:i("");let{patchFlag:Ct,dynamicChildren:Bt,slotScopeIds:Ht}=W;Ht&&(_t=_t?_t.concat(Ht):Ht),F==null?(s(yt,at,lt),s(zt,at,lt),L(W.children||[],at,zt,ct,dt,xt,_t,kt)):Ct>0&&Ct&64&&Bt&&F.dynamicChildren?(M(F.dynamicChildren,Bt,at,ct,dt,xt,_t),(W.key!=null||ct&&W===ct.subTree)&&zh(F,W,!0)):tt(F,W,at,zt,ct,dt,xt,_t,kt)},X=(F,W,at,lt,ct,dt,xt,_t,kt)=>{W.slotScopeIds=_t,F==null?W.shapeFlag&512?ct.ctx.activate(W,at,lt,xt,kt):rt(W,at,lt,ct,dt,xt,kt):nt(F,W,kt)},rt=(F,W,at,lt,ct,dt,xt)=>{const _t=F.component=LV(F,lt,ct);if(_0(F)&&(_t.ctx.renderer=Ut),zV(_t,!1,xt),_t.asyncDep){if(ct&&ct.registerDep(_t,st,xt),!F.el){const kt=_t.subTree=Kn(pr);k(null,kt,W,at),F.placeholder=kt.el}}else st(_t,F,W,at,ct,dt,xt)},nt=(F,W,at)=>{const lt=W.component=F.component;if(AV(F,W,at))if(lt.asyncDep&&!lt.asyncResolved){it(lt,W,at);return}else lt.next=W,lt.update();else W.el=F.el,lt.vnode=W},st=(F,W,at,lt,ct,dt,xt)=>{const _t=()=>{if(F.isMounted){let{next:Ct,bu:Bt,u:Ht,parent:Gt,vnode:Qt}=F;{const We=L0(F);if(We){Ct&&(Ct.el=Qt.el,it(F,Ct,xt)),We.asyncDep.then(()=>{F.isUnmounted||_t()});return}}let ne=Ct,Ne;Er(F,!1),Ct?(Ct.el=Qt.el,it(F,Ct,xt)):Ct=Qt,Bt&&Mi(Bt),(Ne=Ct.props&&Ct.props.onVnodeBeforeUpdate)&&as(Ne,Gt,Ct,Qt),Er(F,!0);const Re=Ap(F),qe=F.subTree;F.subTree=Re,w(qe,Re,f(qe.el),Lt(qe),F,ct,dt),Ct.el=Re.el,ne===null&&DV(F,Re.el),Ht&&bn(Ht,ct),(Ne=Ct.props&&Ct.props.onVnodeUpdated)&&bn(()=>as(Ne,Gt,Ct,Qt),ct)}else{let Ct;const{el:Bt,props:Ht}=W,{bm:Gt,m:Qt,parent:ne,root:Ne,type:Re}=F,qe=yo(W);Er(F,!1),Gt&&Mi(Gt),!qe&&(Ct=Ht&&Ht.onVnodeBeforeMount)&&as(Ct,ne,W),Er(F,!0);{Ne.ce&&Ne.ce._def.shadowRoot!==!1&&Ne.ce._injectChildStyle(Re);const We=F.subTree=Ap(F);w(null,We,at,lt,F,ct,dt),W.el=We.el}if(Qt&&bn(Qt,ct),!qe&&(Ct=Ht&&Ht.onVnodeMounted)){const We=W;bn(()=>as(Ct,ne,We),ct)}(W.shapeFlag&256||ne&&yo(ne.vnode)&&ne.vnode.shapeFlag&256)&&F.a&&bn(F.a,ct),F.isMounted=!0,W=at=lt=null}};F.scope.on();const kt=F.effect=new e0(_t);F.scope.off();const yt=F.update=kt.run.bind(kt),zt=F.job=kt.runIfDirty.bind(kt);zt.i=F,zt.id=F.uid,kt.scheduler=()=>Ph(zt),Er(F,!0),yt()},it=(F,W,at)=>{W.component=F;const lt=F.vnode.props;F.vnode=W,F.next=null,pV(F,W.props,lt,at),bV(F,W.children,at),Ls(),kp(F),zs()},tt=(F,W,at,lt,ct,dt,xt,_t,kt=!1)=>{const yt=F&&F.children,zt=F?F.shapeFlag:0,Ct=W.children,{patchFlag:Bt,shapeFlag:Ht}=W;if(Bt>0){if(Bt&128){ht(yt,Ct,at,lt,ct,dt,xt,_t,kt);return}else if(Bt&256){ut(yt,Ct,at,lt,ct,dt,xt,_t,kt);return}}Ht&8?(zt&16&&Ot(yt,ct,dt),Ct!==yt&&l(at,Ct)):zt&16?Ht&16?ht(yt,Ct,at,lt,ct,dt,xt,_t,kt):Ot(yt,ct,dt,!0):(zt&8&&l(at,""),Ht&16&&L(Ct,at,lt,ct,dt,xt,_t,kt))},ut=(F,W,at,lt,ct,dt,xt,_t,kt)=>{F=F||wa,W=W||wa;const yt=F.length,zt=W.length,Ct=Math.min(yt,zt);let Bt;for(Bt=0;Bt<Ct;Bt++){const Ht=W[Bt]=kt?er(W[Bt]):cs(W[Bt]);w(F[Bt],Ht,at,null,ct,dt,xt,_t,kt)}yt>zt?Ot(F,ct,dt,!0,!1,Ct):L(W,at,lt,ct,dt,xt,_t,kt,Ct)},ht=(F,W,at,lt,ct,dt,xt,_t,kt)=>{let yt=0;const zt=W.length;let Ct=F.length-1,Bt=zt-1;for(;yt<=Ct&&yt<=Bt;){const Ht=F[yt],Gt=W[yt]=kt?er(W[yt]):cs(W[yt]);if(eo(Ht,Gt))w(Ht,Gt,at,null,ct,dt,xt,_t,kt);else break;yt++}for(;yt<=Ct&&yt<=Bt;){const Ht=F[Ct],Gt=W[Bt]=kt?er(W[Bt]):cs(W[Bt]);if(eo(Ht,Gt))w(Ht,Gt,at,null,ct,dt,xt,_t,kt);else break;Ct--,Bt--}if(yt>Ct){if(yt<=Bt){const Ht=Bt+1,Gt=Ht<zt?W[Ht].el:lt;for(;yt<=Bt;)w(null,W[yt]=kt?er(W[yt]):cs(W[yt]),at,Gt,ct,dt,xt,_t,kt),yt++}}else if(yt>Bt)for(;yt<=Ct;)vt(F[yt],ct,dt,!0),yt++;else{const Ht=yt,Gt=yt,Qt=new Map;for(yt=Gt;yt<=Bt;yt++){const $e=W[yt]=kt?er(W[yt]):cs(W[yt]);$e.key!=null&&Qt.set($e.key,yt)}let ne,Ne=0;const Re=Bt-Gt+1;let qe=!1,We=0;const mn=new Array(Re);for(yt=0;yt<Re;yt++)mn[yt]=0;for(yt=Ht;yt<=Ct;yt++){const $e=F[yt];if(Ne>=Re){vt($e,ct,dt,!0);continue}let Vt;if($e.key!=null)Vt=Qt.get($e.key);else for(ne=Gt;ne<=Bt;ne++)if(mn[ne-Gt]===0&&eo($e,W[ne])){Vt=ne;break}Vt===void 0?vt($e,ct,dt,!0):(mn[Vt-Gt]=yt+1,Vt>=We?We=Vt:qe=!0,w($e,W[Vt],at,null,ct,dt,xt,_t,kt),Ne++)}const qs=qe?xV(mn):wa;for(ne=qs.length-1,yt=Re-1;yt>=0;yt--){const $e=Gt+yt,Vt=W[$e],Ks=W[$e+1],ns=$e+1<zt?Ks.el||Ks.placeholder:lt;mn[yt]===0?w(null,Vt,at,ns,ct,dt,xt,_t,kt):qe&&(ne<0||yt!==qs[ne]?mt(Vt,at,ns,2):ne--)}}},mt=(F,W,at,lt,ct=null)=>{const{el:dt,type:xt,transition:_t,children:kt,shapeFlag:yt}=F;if(yt&6){mt(F.component.subTree,W,at,lt);return}if(yt&128){F.suspense.move(W,at,lt);return}if(yt&64){xt.move(F,W,at,Ut);return}if(xt===De){s(dt,W,at);for(let Ct=0;Ct<kt.length;Ct++)mt(kt[Ct],W,at,lt);s(F.anchor,W,at);return}if(xt===Bc){T(F,W,at);return}if(lt!==2&&yt&1&&_t)if(lt===0)_t.beforeEnter(dt),s(dt,W,at),bn(()=>_t.enter(dt),ct);else{const{leave:Ct,delayLeave:Bt,afterLeave:Ht}=_t,Gt=()=>{F.ctx.isUnmounted?r(dt):s(dt,W,at)},Qt=()=>{dt._isLeaving&&dt[qM](!0),Ct(dt,()=>{Gt(),Ht&&Ht()})};Bt?Bt(dt,Gt,Qt):Qt()}else s(dt,W,at)},vt=(F,W,at,lt=!1,ct=!1)=>{const{type:dt,props:xt,ref:_t,children:kt,dynamicChildren:yt,shapeFlag:zt,patchFlag:Ct,dirs:Bt,cacheIndex:Ht}=F;if(Ct===-2&&(ct=!1),_t!=null&&(Ls(),go(_t,null,at,F,!0),zs()),Ht!=null&&(W.renderCache[Ht]=void 0),zt&256){W.ctx.deactivate(F);return}const Gt=zt&1&&Bt,Qt=!yo(F);let ne;if(Qt&&(ne=xt&&xt.onVnodeBeforeUnmount)&&as(ne,W,F),zt&6)Tt(F.component,at,lt);else{if(zt&128){F.suspense.unmount(at,lt);return}Gt&&Tr(F,null,W,"beforeUnmount"),zt&64?F.type.remove(F,W,at,Ut,lt):yt&&!yt.hasOnce&&(dt!==De||Ct>0&&Ct&64)?Ot(yt,W,at,!1,!0):(dt===De&&Ct&384||!ct&&zt&16)&&Ot(kt,W,at),lt&&bt(F)}(Qt&&(ne=xt&&xt.onVnodeUnmounted)||Gt)&&bn(()=>{ne&&as(ne,W,F),Gt&&Tr(F,null,W,"unmounted")},at)},bt=F=>{const{type:W,el:at,anchor:lt,transition:ct}=F;if(W===De){$t(at,lt);return}if(W===Bc){N(F);return}const dt=()=>{r(at),ct&&!ct.persisted&&ct.afterLeave&&ct.afterLeave()};if(F.shapeFlag&1&&ct&&!ct.persisted){const{leave:xt,delayLeave:_t}=ct,kt=()=>xt(at,dt);_t?_t(F.el,dt,kt):kt()}else dt()},$t=(F,W)=>{let at;for(;F!==W;)at=d(F),r(F),F=at;r(W)},Tt=(F,W,at)=>{const{bum:lt,scope:ct,job:dt,subTree:xt,um:_t,m:kt,a:yt}=F;Cp(kt),Cp(yt),lt&&Mi(lt),ct.stop(),dt&&(dt.flags|=8,vt(xt,F,W,at)),_t&&bn(_t,W),bn(()=>{F.isUnmounted=!0},W)},Ot=(F,W,at,lt=!1,ct=!1,dt=0)=>{for(let xt=dt;xt<F.length;xt++)vt(F[xt],W,at,lt,ct)},Lt=F=>{if(F.shapeFlag&6)return Lt(F.component.subTree);if(F.shapeFlag&128)return F.suspense.next();const W=d(F.anchor||F.el),at=W&&W[x0];return at?d(at):W};let qt=!1;const wt=(F,W,at)=>{F==null?W._vnode&&vt(W._vnode,null,null,!0):w(W._vnode||null,F,W,null,null,null,at),W._vnode=F,qt||(qt=!0,kp(),w0(),qt=!1)},Ut={p:w,um:vt,m:mt,r:bt,mt:rt,mc:L,pc:tt,pbc:M,n:Lt,o:e};return{render:wt,hydrate:void 0,createApp:fV(wt)}}function zc({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Er({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function kV(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function zh(e,t,n=!1){const s=e.children,r=t.children;if(Yt(s)&&Yt(r))for(let a=0;a<s.length;a++){const o=s[a];let i=r[a];i.shapeFlag&1&&!i.dynamicChildren&&((i.patchFlag<=0||i.patchFlag===32)&&(i=r[a]=er(r[a]),i.el=o.el),!n&&i.patchFlag!==-2&&zh(o,i)),i.type===ju&&i.patchFlag!==-1&&(i.el=o.el),i.type===pr&&!i.el&&(i.el=o.el)}}function xV(e){const t=e.slice(),n=[0];let s,r,a,o,i;const u=e.length;for(s=0;s<u;s++){const c=e[s];if(c!==0){if(r=n[n.length-1],e[r]<c){t[s]=r,n.push(s);continue}for(a=0,o=n.length-1;a<o;)i=a+o>>1,e[n[i]]<c?a=i+1:o=i;c<e[n[a]]&&(a>0&&(t[s]=n[a-1]),n[a]=s)}}for(a=n.length,o=n[a-1];a-- >0;)n[a]=o,o=t[o];return n}function L0(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:L0(t)}function Cp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const SV=Symbol.for("v-scx"),NV=()=>Li(SV);function zu(e,t){return Bu(e,null,t)}function IV(e,t){return Bu(e,null,{flush:"sync"})}function gs(e,t,n){return Bu(e,t,n)}function Bu(e,t,n=pe){const{immediate:s,deep:r,flush:a,once:o}=n,i=en({},n),u=t&&s||!t&&a!=="post";let c;if(Vo){if(a==="sync"){const m=NV();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!u){const m=()=>{};return m.stop=ps,m.resume=ps,m.pause=ps,m}}const l=kn;i.call=(m,g,w)=>ws(m,l,g,w);let f=!1;a==="post"?i.scheduler=m=>{bn(m,l&&l.suspense)}:a!=="sync"&&(f=!0,i.scheduler=(m,g)=>{g?m():Ph(m)}),i.augmentJob=m=>{t&&(m.flags|=4),f&&(m.flags|=2,l&&(m.id=l.uid,m.i=l))};const d=MM(e,t,i);return Vo&&(c?c.push(d):u&&d()),d}function _V(e,t,n){const s=this.proxy,r=Be(e)?e.includes(".")?z0(s,e):()=>s[e]:e.bind(s,s);let a;ee(t)?a=t:(a=t.handler,n=t);const o=Uo(this),i=Bu(r,a.bind(s),n);return o(),i}function z0(e,t){const n=t.split(".");return()=>{let s=e;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}function B0(e,t,n=pe){const s=Hu(),r=Vs(t),a=wr(t),o=W0(e,r),i=OM((u,c)=>{let l,f=pe,d;return IV(()=>{const m=e[r];$n(l,m)&&(l=m,c())}),{get(){return u(),n.get?n.get(l):l},set(m){const g=n.set?n.set(m):m;if(!$n(g,l)&&!(f!==pe&&$n(m,f)))return;const w=s.vnode.props;w&&(t in w||r in w||a in w)&&(`onUpdate:${t}`in w||`onUpdate:${r}`in w||`onUpdate:${a}`in w)||(l=m,c()),s.emit(`update:${t}`,g),$n(m,g)&&$n(m,f)&&!$n(g,d)&&c(),f=m,d=g}}});return i[Symbol.iterator]=()=>{let u=0;return{next(){return u<2?{value:u++?o||pe:i,done:!1}:{done:!0}}}},i}const W0=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Vs(t)}Modifiers`]||e[`${wr(t)}Modifiers`];function TV(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||pe;let r=n;const a=t.startsWith("update:"),o=a&&W0(s,t.slice(7));o&&(o.trim&&(r=n.map(l=>Be(l)?l.trim():l)),o.number&&(r=n.map(Il)));let i,u=s[i=Fc(t)]||s[i=Fc(Vs(t))];!u&&a&&(u=s[i=Fc(wr(t))]),u&&ws(u,e,6,r);const c=s[i+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[i])return;e.emitted[i]=!0,ws(c,e,6,r)}}const EV=new WeakMap;function j0(e,t,n=!1){const s=n?EV:t.emitsCache,r=s.get(e);if(r!==void 0)return r;const a=e.emits;let o={},i=!1;if(!ee(e)){const u=c=>{const l=j0(c,t,!0);l&&(i=!0,en(o,l))};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!a&&!i?(Ee(e)&&s.set(e,null),null):(Yt(a)?a.forEach(u=>o[u]=null):en(o,a),Ee(e)&&s.set(e,o),o)}function Wu(e,t){return!e||!Au(t)?!1:(t=t.slice(2).replace(/Once$/,""),ge(e,t[0].toLowerCase()+t.slice(1))||ge(e,wr(t))||ge(e,t))}function Ap(e){const{type:t,vnode:n,proxy:s,withProxy:r,propsOptions:[a],slots:o,attrs:i,emit:u,render:c,renderCache:l,props:f,data:d,setupState:m,ctx:g,inheritAttrs:w}=e,b=uu(e);let k,I;try{if(n.shapeFlag&4){const N=r||s,$=N;k=cs(c.call($,N,l,f,m,d,g)),I=i}else{const N=t;k=cs(N.length>1?N(f,{attrs:i,slots:o,emit:u}):N(f,null)),I=t.props?i:$V(i)}}catch(N){wo.length=0,Mu(N,e,1),k=Kn(pr)}let T=k;if(I&&w!==!1){const N=Object.keys(I),{shapeFlag:$}=T;N.length&&$&7&&(a&&N.some(_h)&&(I=CV(I,a)),T=Fa(T,I,!1,!0))}return n.dirs&&(T=Fa(T,null,!1,!0),T.dirs=T.dirs?T.dirs.concat(n.dirs):n.dirs),n.transition&&Mh(T,n.transition),k=T,uu(b),k}const $V=e=>{let t;for(const n in e)(n==="class"||n==="style"||Au(n))&&((t||(t={}))[n]=e[n]);return t},CV=(e,t)=>{const n={};for(const s in e)(!_h(s)||!(s.slice(9)in t))&&(n[s]=e[s]);return n};function AV(e,t,n){const{props:s,children:r,component:a}=e,{props:o,children:i,patchFlag:u}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return s?Dp(s,o,c):!!o;if(u&8){const l=t.dynamicProps;for(let f=0;f<l.length;f++){const d=l[f];if(o[d]!==s[d]&&!Wu(c,d))return!0}}}else return(r||i)&&(!i||!i.$stable)?!0:s===o?!1:s?o?Dp(s,o,c):!0:!!o;return!1}function Dp(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let r=0;r<s.length;r++){const a=s[r];if(t[a]!==e[a]&&!Wu(n,a))return!0}return!1}function DV({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=n,t=t.parent;else break}}const H0=e=>e.__isSuspense;function OV(e,t){t&&t.pendingBranch?Yt(e)?t.effects.push(...e):t.effects.push(e):zM(e)}const De=Symbol.for("v-fgt"),ju=Symbol.for("v-txt"),pr=Symbol.for("v-cmt"),Bc=Symbol.for("v-stc"),wo=[];let Rn=null;function Xt(e=!1){wo.push(Rn=e?null:[])}function FV(){wo.pop(),Rn=wo[wo.length-1]||null}let Po=1;function Op(e,t=!1){Po+=e,e<0&&Rn&&t&&(Rn.hasOnce=!0)}function q0(e){return e.dynamicChildren=Po>0?Rn||wa:null,FV(),Po>0&&Rn&&Rn.push(e),e}function re(e,t,n,s,r,a){return q0(St(e,t,n,s,r,a,!0))}function nr(e,t,n,s,r){return q0(Kn(e,t,n,s,r,!0))}function K0(e){return e?e.__v_isVNode===!0:!1}function eo(e,t){return e.type===t.type&&e.key===t.key}const U0=({key:e})=>e??null,zi=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Be(e)||dn(e)||ee(e)?{i:jn,r:e,k:t,f:!!n}:e:null);function St(e,t=null,n=null,s=0,r=null,a=e===De?0:1,o=!1,i=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&U0(t),ref:t&&zi(t),scopeId:k0,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:jn};return i?(Bh(u,n),a&128&&e.normalize(u)):n&&(u.shapeFlag|=Be(n)?8:16),Po>0&&!o&&Rn&&(u.patchFlag>0||a&6)&&u.patchFlag!==32&&Rn.push(u),u}const Kn=RV;function RV(e,t=null,n=null,s=0,r=null,a=!1){if((!e||e===sV)&&(e=pr),K0(e)){const i=Fa(e,t,!0);return n&&Bh(i,n),Po>0&&!a&&Rn&&(i.shapeFlag&6?Rn[Rn.indexOf(e)]=i:Rn.push(i)),i.patchFlag=-2,i}if(HV(e)&&(e=e.__vccOpts),t){t=PV(t);let{class:i,style:u}=t;i&&!Be(i)&&(t.class=ur(i)),Ee(u)&&(Rh(u)&&!Yt(u)&&(u=en({},u)),t.style=Da(u))}const o=Be(e)?1:H0(e)?128:WM(e)?64:Ee(e)?4:ee(e)?2:0;return St(e,t,n,s,r,o,a,!0)}function PV(e){return e?Rh(e)||O0(e)?en({},e):e:null}function Fa(e,t,n=!1,s=!1){const{props:r,ref:a,patchFlag:o,children:i,transition:u}=e,c=t?G0(r||{},t):r,l={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&U0(c),ref:t&&t.ref?n&&a?Yt(a)?a.concat(zi(t)):[a,zi(t)]:zi(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==De?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Fa(e.ssContent),ssFallback:e.ssFallback&&Fa(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&s&&Mh(l,u.clone(l)),l}function Mo(e=" ",t=0){return Kn(ju,null,e,t)}function Lr(e="",t=!1){return t?(Xt(),nr(pr,null,e)):Kn(pr,null,e)}function cs(e){return e==null||typeof e=="boolean"?Kn(pr):Yt(e)?Kn(De,null,e.slice()):K0(e)?er(e):Kn(ju,null,String(e))}function er(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Fa(e)}function Bh(e,t){let n=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(Yt(t))n=16;else if(typeof t=="object")if(s&65){const r=t.default;r&&(r._c&&(r._d=!1),Bh(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!O0(t)?t._ctx=jn:r===3&&jn&&(jn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ee(t)?(t={default:t,_ctx:jn},n=32):(t=String(t),s&64?(n=16,t=[Mo(t)]):n=8);e.children=t,e.shapeFlag|=n}function G0(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const r in s)if(r==="class")t.class!==s.class&&(t.class=ur([t.class,s.class]));else if(r==="style")t.style=Da([t.style,s.style]);else if(Au(r)){const a=t[r],o=s[r];o&&a!==o&&!(Yt(a)&&a.includes(o))&&(t[r]=a?[].concat(a,o):o)}else r!==""&&(t[r]=s[r])}return t}function as(e,t,n,s=null){ws(e,t,7,[n,s])}const MV=C0();let VV=0;function LV(e,t,n){const s=e.type,r=(t?t.appContext:e.appContext)||MV,a={uid:VV++,vnode:e,type:s,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new uM(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:R0(s,r),emitsOptions:j0(s,r),emit:null,emitted:null,propsDefaults:pe,inheritAttrs:s.inheritAttrs,ctx:pe,data:pe,props:pe,attrs:pe,slots:pe,refs:pe,setupState:pe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=TV.bind(null,a),e.ce&&e.ce(a),a}let kn=null;const Hu=()=>kn||jn;let hu,Ml;{const e=Fu(),t=(n,s)=>{let r;return(r=e[n])||(r=e[n]=[]),r.push(s),a=>{r.length>1?r.forEach(o=>o(a)):r[0](a)}};hu=t("__VUE_INSTANCE_SETTERS__",n=>kn=n),Ml=t("__VUE_SSR_SETTERS__",n=>Vo=n)}const Uo=e=>{const t=kn;return hu(e),e.scope.on(),()=>{e.scope.off(),hu(t)}},Fp=()=>{kn&&kn.scope.off(),hu(null)};function Y0(e){return e.vnode.shapeFlag&4}let Vo=!1;function zV(e,t=!1,n=!1){t&&Ml(t);const{props:s,children:r}=e.vnode,a=Y0(e);dV(e,s,a,t),yV(e,r,n||t);const o=a?BV(e,t):void 0;return t&&Ml(!1),o}function BV(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,rV);const{setup:s}=n;if(s){Ls();const r=e.setupContext=s.length>1?jV(e):null,a=Uo(e),o=qo(s,e,0,[e.props,r]),i=qb(o);if(zs(),a(),(i||e.sp)&&!yo(e)&&I0(e),i){if(o.then(Fp,Fp),t)return o.then(u=>{Rp(e,u)}).catch(u=>{Mu(u,e,0)});e.asyncDep=o}else Rp(e,o)}else X0(e)}function Rp(e,t,n){ee(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ee(t)&&(e.setupState=g0(t)),X0(e)}function X0(e,t,n){const s=e.type;e.render||(e.render=s.render||ps);{const r=Uo(e);Ls();try{aV(e)}finally{zs(),r()}}}const WV={get(e,t){return ln(e,"get",""),e[t]}};function jV(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,WV),slots:e.slots,emit:e.emit,expose:t}}function qu(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(g0($M(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in bo)return bo[n](e)},has(t,n){return n in t||n in bo}})):e.proxy}function HV(e){return ee(e)&&"__vccOpts"in e}const xn=(e,t)=>RM(e,t,Vo),qV="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Vl;const Pp=typeof window<"u"&&window.trustedTypes;if(Pp)try{Vl=Pp.createPolicy("vue",{createHTML:e=>e})}catch{}const Z0=Vl?e=>Vl.createHTML(e):e=>e,KV="http://www.w3.org/2000/svg",UV="http://www.w3.org/1998/Math/MathML",_s=typeof document<"u"?document:null,Mp=_s&&_s.createElement("template"),GV={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const r=t==="svg"?_s.createElementNS(KV,e):t==="mathml"?_s.createElementNS(UV,e):n?_s.createElement(e,{is:n}):_s.createElement(e);return e==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:e=>_s.createTextNode(e),createComment:e=>_s.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>_s.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,r,a){const o=n?n.previousSibling:t.lastChild;if(r&&(r===a||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===a||!(r=r.nextSibling)););else{Mp.innerHTML=Z0(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const i=Mp.content;if(s==="svg"||s==="mathml"){const u=i.firstChild;for(;u.firstChild;)i.appendChild(u.firstChild);i.removeChild(u)}t.insertBefore(i,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},YV=Symbol("_vtc");function XV(e,t,n){const s=e[YV];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const du=Symbol("_vod"),J0=Symbol("_vsh"),Q0={name:"show",beforeMount(e,{value:t},{transition:n}){e[du]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):no(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),no(e,!0),s.enter(e)):s.leave(e,()=>{no(e,!1)}):no(e,t))},beforeUnmount(e,{value:t}){no(e,t)}};function no(e,t){e.style.display=t?e[du]:"none",e[J0]=!t}const ZV=Symbol(""),JV=/(?:^|;)\s*display\s*:/;function QV(e,t,n){const s=e.style,r=Be(n);let a=!1;if(n&&!r){if(t)if(Be(t))for(const o of t.split(";")){const i=o.slice(0,o.indexOf(":")).trim();n[i]==null&&Bi(s,i,"")}else for(const o in t)n[o]==null&&Bi(s,o,"");for(const o in n)o==="display"&&(a=!0),Bi(s,o,n[o])}else if(r){if(t!==n){const o=s[ZV];o&&(n+=";"+o),s.cssText=n,a=JV.test(n)}}else t&&e.removeAttribute("style");du in e&&(e[du]=a?s.display:"",e[J0]&&(s.display="none"))}const Vp=/\s*!important$/;function Bi(e,t,n){if(Yt(n))n.forEach(s=>Bi(e,t,s));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=tL(e,t);Vp.test(n)?e.setProperty(wr(s),n.replace(Vp,""),"important"):e[s]=n}}const Lp=["Webkit","Moz","ms"],Wc={};function tL(e,t){const n=Wc[t];if(n)return n;let s=Vs(t);if(s!=="filter"&&s in e)return Wc[t]=s;s=Gb(s);for(let r=0;r<Lp.length;r++){const a=Lp[r]+s;if(a in e)return Wc[t]=a}return t}const zp="http://www.w3.org/1999/xlink";function Bp(e,t,n,s,r,a=oM(t)){s&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(zp,t.slice(6,t.length)):e.setAttributeNS(zp,t,n):n==null||a&&!Xb(n)?e.removeAttribute(t):e.setAttribute(t,a?"":bs(n)?String(n):n)}function Wp(e,t,n,s,r){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Z0(n):n);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const i=a==="OPTION"?e.getAttribute("value")||"":e.value,u=n==null?e.type==="checkbox"?"on":"":String(n);(i!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let o=!1;if(n===""||n==null){const i=typeof e[t];i==="boolean"?n=Xb(n):n==null&&i==="string"?(n="",o=!0):i==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(r||t)}function sr(e,t,n,s){e.addEventListener(t,n,s)}function eL(e,t,n,s){e.removeEventListener(t,n,s)}const jp=Symbol("_vei");function nL(e,t,n,s,r=null){const a=e[jp]||(e[jp]={}),o=a[t];if(s&&o)o.value=s;else{const[i,u]=sL(t);if(s){const c=a[t]=oL(s,r);sr(e,i,c,u)}else o&&(eL(e,i,o,u),a[t]=void 0)}}const Hp=/(?:Once|Passive|Capture)$/;function sL(e){let t;if(Hp.test(e)){t={};let s;for(;s=e.match(Hp);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):wr(e.slice(2)),t]}let jc=0;const rL=Promise.resolve(),aL=()=>jc||(rL.then(()=>jc=0),jc=Date.now());function oL(e,t){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;ws(iL(s,n.value),t,5,[s])};return n.value=e,n.attached=aL(),n}function iL(e,t){if(Yt(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(s=>r=>!r._stopped&&s&&s(r))}else return t}const qp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,uL=(e,t,n,s,r,a)=>{const o=r==="svg";t==="class"?XV(e,s,o):t==="style"?QV(e,n,s):Au(t)?_h(t)||nL(e,t,n,s,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):cL(e,t,s,o))?(Wp(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Bp(e,t,s,o,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Be(s))?Wp(e,Vs(t),s,a,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),Bp(e,t,s,o))};function cL(e,t,n,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&qp(t)&&ee(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return qp(t)&&Be(n)?!1:t in e}const Ra=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Yt(t)?n=>Mi(t,n):t};function lL(e){e.target.composing=!0}function Kp(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Fs=Symbol("_assign"),ca={created(e,{modifiers:{lazy:t,trim:n,number:s}},r){e[Fs]=Ra(r);const a=s||r.props&&r.props.type==="number";sr(e,t?"change":"input",o=>{if(o.target.composing)return;let i=e.value;n&&(i=i.trim()),a&&(i=Il(i)),e[Fs](i)}),n&&sr(e,"change",()=>{e.value=e.value.trim()}),t||(sr(e,"compositionstart",lL),sr(e,"compositionend",Kp),sr(e,"change",Kp))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:r,number:a}},o){if(e[Fs]=Ra(o),e.composing)return;const i=(a||e.type==="number")&&!/^0\d/.test(e.value)?Il(e.value):e.value,u=t??"";i!==u&&(document.activeElement===e&&e.type!=="range"&&(s&&t===n||r&&e.value.trim()===u)||(e.value=u))}},fL={deep:!0,created(e,t,n){e[Fs]=Ra(n),sr(e,"change",()=>{const s=e._modelValue,r=tw(e),a=e.checked,o=e[Fs];if(Yt(s)){const i=Zb(s,r),u=i!==-1;if(a&&!u)o(s.concat(r));else if(!a&&u){const c=[...s];c.splice(i,1),o(c)}}else if(Du(s)){const i=new Set(s);a?i.add(r):i.delete(r),o(i)}else o(ew(e,a))})},mounted:Up,beforeUpdate(e,t,n){e[Fs]=Ra(n),Up(e,t,n)}};function Up(e,{value:t,oldValue:n},s){e._modelValue=t;let r;if(Yt(t))r=Zb(t,s.props.value)>-1;else if(Du(t))r=t.has(s.props.value);else{if(t===n)return;r=Oa(t,ew(e,!0))}e.checked!==r&&(e.checked=r)}const hL={created(e,{value:t},n){e.checked=Oa(t,n.props.value),e[Fs]=Ra(n),sr(e,"change",()=>{e[Fs](tw(e))})},beforeUpdate(e,{value:t,oldValue:n},s){e[Fs]=Ra(s),t!==n&&(e.checked=Oa(t,s.props.value))}};function tw(e){return"_value"in e?e._value:e.value}function ew(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const dL=["ctrl","shift","alt","meta"],pL={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>dL.some(n=>e[`${n}Key`]&&!t.includes(n))},mL=(e,t)=>{const n=e._withMods||(e._withMods={}),s=t.join(".");return n[s]||(n[s]=((r,...a)=>{for(let o=0;o<t.length;o++){const i=pL[t[o]];if(i&&i(r,t))return}return e(r,...a)}))},gL=en({patchProp:uL},GV);let Gp;function yL(){return Gp||(Gp=wV(gL))}const bL=((...e)=>{const t=yL().createApp(...e),{mount:n}=t;return t.mount=s=>{const r=vL(s);if(!r)return;const a=t._component;!ee(a)&&!a.render&&!a.template&&(a.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,wL(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t});function wL(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function vL(e){return Be(e)?document.querySelector(e):e}var kL=Object.defineProperty,xL=(e,t,n)=>t in e?kL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Je=(e,t,n)=>xL(e,typeof t!="symbol"?t+"":t,n);function Ku(e){return t0()?(cM(e),!0):!1}const SL=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const NL=e=>e!=null,IL=Object.prototype.toString,_L=e=>IL.call(e)==="[object Object]",Ll=()=>{};function TL(e,t){function n(...s){return new Promise((r,a)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(r).catch(a)})}return n}function EL(e,t={}){let n,s,r=Ll;const a=i=>{clearTimeout(i),r(),r=Ll};let o;return i=>{const u=cr(e),c=cr(t.maxWait);return n&&a(n),u<=0||c!==void 0&&c<=0?(s&&(a(s),s=void 0),Promise.resolve(i())):new Promise((l,f)=>{r=t.rejectOnCancel?f:l,o=i,c&&!s&&(s=setTimeout(()=>{n&&a(n),s=void 0,l(o())},c)),n=setTimeout(()=>{s&&a(s),s=void 0,l(i())},u)})}}function vo(e){return Array.isArray(e)?e:[e]}function $L(e){return Hu()}function CL(e,t=200,n={}){return TL(EL(t,n),e)}function AL(e,t=!0,n){$L()?Ko(e,n):t?e():Fo(e)}function DL(e,t,n){return gs(e,t,{...n,immediate:!0})}const Ba=SL?window:void 0;function Os(e){var t;const n=cr(e);return(t=n==null?void 0:n.$el)!=null?t:n}function pu(...e){const t=[],n=()=>{t.forEach(i=>i()),t.length=0},s=(i,u,c,l)=>(i.addEventListener(u,c,l),()=>i.removeEventListener(u,c,l)),r=xn(()=>{const i=vo(cr(e[0])).filter(u=>u!=null);return i.every(u=>typeof u!="string")?i:void 0}),a=DL(()=>{var i,u;return[(u=(i=r.value)==null?void 0:i.map(c=>Os(c)))!=null?u:[Ba].filter(c=>c!=null),vo(cr(r.value?e[1]:e[0])),vo(An(r.value?e[2]:e[1])),cr(r.value?e[3]:e[2])]},([i,u,c,l])=>{if(n(),!(i!=null&&i.length)||!(u!=null&&u.length)||!(c!=null&&c.length))return;const f=_L(l)?{...l}:l;t.push(...i.flatMap(d=>u.flatMap(m=>c.map(g=>s(d,m,g,f)))))},{flush:"post"}),o=()=>{a(),n()};return Ku(n),o}function OL(){const e=au(!1),t=Hu();return t&&Ko(()=>{e.value=!0},t),e}function nw(e){const t=OL();return xn(()=>(t.value,!!e()))}function FL(e,t,n={}){const{window:s=Ba,...r}=n;let a;const o=nw(()=>s&&"MutationObserver"in s),i=()=>{a&&(a.disconnect(),a=void 0)},u=xn(()=>{const d=cr(e),m=vo(d).map(Os).filter(NL);return new Set(m)}),c=gs(u,d=>{i(),o.value&&d.size&&(a=new MutationObserver(t),d.forEach(m=>a.observe(m,r)))},{immediate:!0,flush:"post"}),l=()=>a==null?void 0:a.takeRecords(),f=()=>{c(),i()};return Ku(f),{isSupported:o,stop:f,takeRecords:l}}function RL(e,t,n={}){const{window:s=Ba,document:r=s==null?void 0:s.document,flush:a="sync"}=n;if(!s||!r)return Ll;let o;const i=l=>{o==null||o(),o=l},u=zu(()=>{const l=Os(e);if(l){const{stop:f}=FL(r,d=>{d.map(m=>[...m.removedNodes]).flat().some(m=>m===l||m.contains(l))&&t(d)},{window:s,childList:!0,subtree:!0});i(f)}},{flush:a}),c=()=>{u(),i()};return Ku(c),c}function PL(e={}){var t;const{window:n=Ba,deep:s=!0,triggerOnRemoval:r=!1}=e,a=(t=e.document)!=null?t:n==null?void 0:n.document,o=()=>{var c;let l=a==null?void 0:a.activeElement;if(s)for(;l!=null&&l.shadowRoot;)l=(c=l==null?void 0:l.shadowRoot)==null?void 0:c.activeElement;return l},i=au(),u=()=>{i.value=o()};if(n){const c={capture:!0,passive:!0};pu(n,"blur",l=>{l.relatedTarget===null&&u()},c),pu(n,"focus",u,c)}return r&&RL(i,u,{document:a}),u(),i}function ML(e,t,n={}){const{window:s=Ba,...r}=n;let a;const o=nw(()=>s&&"ResizeObserver"in s),i=()=>{a&&(a.disconnect(),a=void 0)},u=xn(()=>{const f=cr(e);return Array.isArray(f)?f.map(d=>Os(d)):[Os(f)]}),c=gs(u,f=>{if(i(),o.value&&s){a=new ResizeObserver(t);for(const d of f)d&&a.observe(d,r)}},{immediate:!0,flush:"post"}),l=()=>{i(),c()};return Ku(l),{isSupported:o,stop:l}}function sw(e,t={width:0,height:0},n={}){const{window:s=Ba,box:r="content-box"}=n,a=xn(()=>{var f,d;return(d=(f=Os(e))==null?void 0:f.namespaceURI)==null?void 0:d.includes("svg")}),o=au(t.width),i=au(t.height),{stop:u}=ML(e,([f])=>{const d=r==="border-box"?f.borderBoxSize:r==="content-box"?f.contentBoxSize:f.devicePixelContentBoxSize;if(s&&a.value){const m=Os(e);if(m){const g=m.getBoundingClientRect();o.value=g.width,i.value=g.height}}else if(d){const m=vo(d);o.value=m.reduce((g,{inlineSize:w})=>g+w,0),i.value=m.reduce((g,{blockSize:w})=>g+w,0)}else o.value=f.contentRect.width,i.value=f.contentRect.height},n);AL(()=>{const f=Os(e);f&&(o.value="offsetWidth"in f?f.offsetWidth:t.width,i.value="offsetHeight"in f?f.offsetHeight:t.height)});const c=gs(()=>Os(e),f=>{o.value=f?t.width:0,i.value=f?t.height:0});function l(){u(),c()}return{width:o,height:i,stop:l}}var VL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function LL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zl={exports:{}},zL=zl.exports,Yp;function BL(){return Yp||(Yp=1,(function(e,t){(function(n,s){e.exports=s()})(zL,function(){var n=function(h,p){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,x){y.__proto__=x}||function(y,x){for(var S in x)Object.prototype.hasOwnProperty.call(x,S)&&(y[S]=x[S])})(h,p)},s=function(){return(s=Object.assign||function(h){for(var p,y=1,x=arguments.length;y<x;y++)for(var S in p=arguments[y])Object.prototype.hasOwnProperty.call(p,S)&&(h[S]=p[S]);return h}).apply(this,arguments)};function r(h,p,y){for(var x,S=0,_=p.length;S<_;S++)!x&&S in p||((x=x||Array.prototype.slice.call(p,0,S))[S]=p[S]);return h.concat(x||Array.prototype.slice.call(p))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:VL,o=Object.keys,i=Array.isArray;function u(h,p){return typeof p!="object"||o(p).forEach(function(y){h[y]=p[y]}),h}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var c=Object.getPrototypeOf,l={}.hasOwnProperty;function f(h,p){return l.call(h,p)}function d(h,p){typeof p=="function"&&(p=p(c(h))),(typeof Reflect>"u"?o:Reflect.ownKeys)(p).forEach(function(y){g(h,y,p[y])})}var m=Object.defineProperty;function g(h,p,y,x){m(h,p,u(y&&f(y,"get")&&typeof y.get=="function"?{get:y.get,set:y.set,configurable:!0}:{value:y,configurable:!0,writable:!0},x))}function w(h){return{from:function(p){return h.prototype=Object.create(p.prototype),g(h.prototype,"constructor",h),{extend:d.bind(null,h.prototype)}}}}var b=Object.getOwnPropertyDescriptor,k=[].slice;function I(h,p,y){return k.call(h,p,y)}function T(h,p){return p(h)}function N(h){if(!h)throw new Error("Assertion Failed")}function $(h){a.setImmediate?setImmediate(h):setTimeout(h,0)}function D(h,p){if(typeof p=="string"&&f(h,p))return h[p];if(!p)return h;if(typeof p!="string"){for(var y=[],x=0,S=p.length;x<S;++x){var _=D(h,p[x]);y.push(_)}return y}var O=p.indexOf(".");if(O!==-1){var V=h[p.substr(0,O)];return V==null?void 0:D(V,p.substr(O+1))}}function P(h,p,y){if(h&&p!==void 0&&!("isFrozen"in Object&&Object.isFrozen(h)))if(typeof p!="string"&&"length"in p){N(typeof y!="string"&&"length"in y);for(var x=0,S=p.length;x<S;++x)P(h,p[x],y[x])}else{var _,O,V=p.indexOf(".");V!==-1?(_=p.substr(0,V),(O=p.substr(V+1))===""?y===void 0?i(h)&&!isNaN(parseInt(_))?h.splice(_,1):delete h[_]:h[_]=y:P(V=!(V=h[_])||!f(h,_)?h[_]={}:V,O,y)):y===void 0?i(h)&&!isNaN(parseInt(p))?h.splice(p,1):delete h[p]:h[p]=y}}function L(h){var p,y={};for(p in h)f(h,p)&&(y[p]=h[p]);return y}var R=[].concat;function M(h){return R.apply([],h)}var Gt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(M([8,16,32,64].map(function(h){return["Int","Uint","Float"].map(function(p){return p+h+"Array"})}))).filter(function(h){return a[h]}),E=new Set(Gt.map(function(h){return a[h]})),K=null;function X(h){return K=new WeakMap,h=(function p(y){if(!y||typeof y!="object")return y;var x=K.get(y);if(x)return x;if(i(y)){x=[],K.set(y,x);for(var S=0,_=y.length;S<_;++S)x.push(p(y[S]))}else if(E.has(y.constructor))x=y;else{var O,V=c(y);for(O in x=V===Object.prototype?{}:Object.create(V),K.set(y,x),y)f(y,O)&&(x[O]=p(y[O]))}return x})(h),K=null,h}var rt={}.toString;function nt(h){return rt.call(h).slice(8,-1)}var st=typeof Symbol<"u"?Symbol.iterator:"@@iterator",it=typeof st=="symbol"?function(h){var p;return h!=null&&(p=h[st])&&p.apply(h)}:function(){return null};function tt(h,p){return p=h.indexOf(p),0<=p&&h.splice(p,1),0<=p}var ut={};function ht(h){var p,y,x,S;if(arguments.length===1){if(i(h))return h.slice();if(this===ut&&typeof h=="string")return[h];if(S=it(h)){for(y=[];!(x=S.next()).done;)y.push(x.value);return y}if(h==null)return[h];if(typeof(p=h.length)!="number")return[h];for(y=new Array(p);p--;)y[p]=h[p];return y}for(p=arguments.length,y=new Array(p);p--;)y[p]=arguments[p];return y}var mt=typeof Symbol<"u"?function(h){return h[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ht=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ln=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ht),vt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function bt(h,p){this.name=h,this.message=p}function $t(h,p){return h+". Errors: "+Object.keys(p).map(function(y){return p[y].toString()}).filter(function(y,x,S){return S.indexOf(y)===x}).join(`
`)}function Tt(h,p,y,x){this.failures=p,this.failedKeys=x,this.successCount=y,this.message=$t(h,p)}function Ot(h,p){this.name="BulkError",this.failures=Object.keys(p).map(function(y){return p[y]}),this.failuresByPos=p,this.message=$t(h,this.failures)}w(bt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),w(Tt).from(bt),w(Ot).from(bt);var Lt=Ln.reduce(function(h,p){return h[p]=p+"Error",h},{}),qt=bt,wt=Ln.reduce(function(h,p){var y=p+"Error";function x(S,_){this.name=y,S?typeof S=="string"?(this.message="".concat(S).concat(_?`
 `+_:""),this.inner=_||null):typeof S=="object"&&(this.message="".concat(S.name," ").concat(S.message),this.inner=S):(this.message=vt[p]||y,this.inner=null)}return w(x).from(qt),h[p]=x,h},{});wt.Syntax=SyntaxError,wt.Type=TypeError,wt.Range=RangeError;var Ut=Ht.reduce(function(h,p){return h[p+"Error"]=wt[p],h},{}),Jt=Ln.reduce(function(h,p){return["Syntax","Type","Range"].indexOf(p)===-1&&(h[p+"Error"]=wt[p]),h},{});function F(){}function W(h){return h}function at(h,p){return h==null||h===W?p:function(y){return p(h(y))}}function lt(h,p){return function(){h.apply(this,arguments),p.apply(this,arguments)}}function ct(h,p){return h===F?p:function(){var y=h.apply(this,arguments);y!==void 0&&(arguments[0]=y);var x=this.onsuccess,S=this.onerror;this.onsuccess=null,this.onerror=null;var _=p.apply(this,arguments);return x&&(this.onsuccess=this.onsuccess?lt(x,this.onsuccess):x),S&&(this.onerror=this.onerror?lt(S,this.onerror):S),_!==void 0?_:y}}function dt(h,p){return h===F?p:function(){h.apply(this,arguments);var y=this.onsuccess,x=this.onerror;this.onsuccess=this.onerror=null,p.apply(this,arguments),y&&(this.onsuccess=this.onsuccess?lt(y,this.onsuccess):y),x&&(this.onerror=this.onerror?lt(x,this.onerror):x)}}function xt(h,p){return h===F?p:function(y){var x=h.apply(this,arguments);u(y,x);var S=this.onsuccess,_=this.onerror;return this.onsuccess=null,this.onerror=null,y=p.apply(this,arguments),S&&(this.onsuccess=this.onsuccess?lt(S,this.onsuccess):S),_&&(this.onerror=this.onerror?lt(_,this.onerror):_),x===void 0?y===void 0?void 0:y:u(x,y)}}function _t(h,p){return h===F?p:function(){return p.apply(this,arguments)!==!1&&h.apply(this,arguments)}}function kt(h,p){return h===F?p:function(){var y=h.apply(this,arguments);if(y&&typeof y.then=="function"){for(var x=this,S=arguments.length,_=new Array(S);S--;)_[S]=arguments[S];return y.then(function(){return p.apply(x,_)})}return p.apply(this,arguments)}}Jt.ModifyError=Tt,Jt.DexieError=bt,Jt.BulkError=Ot;var yt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function zt(h){yt=h}var Ct={},Bt=100,Gt=typeof Promise>"u"?[]:(function(){var h=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[h,c(h),h];var p=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[p,c(p),h]})(),Ht=Gt[0],Ln=Gt[1],Gt=Gt[2],Ln=Ln&&Ln.then,Qt=Ht&&Ht.constructor,ne=!!Gt,Ne=function(h,p){Ks.push([h,p]),qe&&(queueMicrotask(cw),qe=!1)},Re=!0,qe=!0,We=[],mn=[],qs=W,$e={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:F,pgp:!1,env:{},finalize:F},Vt=$e,Ks=[],ns=0,Go=[];function Mt(h){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var p=this._PSD=Vt;if(typeof h!="function"){if(h!==Ct)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Gu(this,this._value))}this._state=null,this._value=null,++p.ref,(function y(x,S){try{S(function(_){if(x._state===null){if(_===x)throw new TypeError("A promise cannot be resolved with itself.");var O=x._lib&&ta();_&&typeof _.then=="function"?y(x,function(V,H){_ instanceof Mt?_._then(V,H):_.then(V,H)}):(x._state=!0,x._value=_,qh(x)),O&&ea()}},Gu.bind(null,x))}catch(_){Gu(x,_)}})(this,h)}var Uu={get:function(){var h=Vt,p=Jo;function y(x,S){var _=this,O=!h.global&&(h!==Vt||p!==Jo),V=O&&!Gs(),H=new Mt(function(q,Z){Yu(_,new Hh(Uh(x,h,O,V),Uh(S,h,O,V),q,Z,h))});return this._consoleTask&&(H._consoleTask=this._consoleTask),H}return y.prototype=Ct,y},set:function(h){g(this,"then",h&&h.prototype===Ct?Uu:{get:function(){return h},set:Uu.set})}};function Hh(h,p,y,x,S){this.onFulfilled=typeof h=="function"?h:null,this.onRejected=typeof p=="function"?p:null,this.resolve=y,this.reject=x,this.psd=S}function Gu(h,p){var y,x;mn.push(p),h._state===null&&(y=h._lib&&ta(),p=qs(p),h._state=!1,h._value=p,x=h,We.some(function(S){return S._value===x._value})||We.push(x),qh(h),y&&ea())}function qh(h){var p=h._listeners;h._listeners=[];for(var y=0,x=p.length;y<x;++y)Yu(h,p[y]);var S=h._PSD;--S.ref||S.finalize(),ns===0&&(++ns,Ne(function(){--ns==0&&Xu()},[]))}function Yu(h,p){if(h._state!==null){var y=h._state?p.onFulfilled:p.onRejected;if(y===null)return(h._state?p.resolve:p.reject)(h._value);++p.psd.ref,++ns,Ne(uw,[y,h,p])}else h._listeners.push(p)}function uw(h,p,y){try{var x,S=p._value;!p._state&&mn.length&&(mn=[]),x=yt&&p._consoleTask?p._consoleTask.run(function(){return h(S)}):h(S),p._state||mn.indexOf(S)!==-1||(function(_){for(var O=We.length;O;)if(We[--O]._value===_._value)return We.splice(O,1)})(p),y.resolve(x)}catch(_){y.reject(_)}finally{--ns==0&&Xu(),--y.psd.ref||y.psd.finalize()}}function cw(){vr($e,function(){ta()&&ea()})}function ta(){var h=Re;return qe=Re=!1,h}function ea(){var h,p,y;do for(;0<Ks.length;)for(h=Ks,Ks=[],y=h.length,p=0;p<y;++p){var x=h[p];x[0].apply(null,x[1])}while(0<Ks.length);qe=Re=!0}function Xu(){var h=We;We=[],h.forEach(function(x){x._PSD.onunhandled.call(null,x._value,x)});for(var p=Go.slice(0),y=p.length;y;)p[--y]()}function Yo(h){return new Mt(Ct,!1,h)}function Ce(h,p){var y=Vt;return function(){var x=ta(),S=Vt;try{return Ys(y,!0),h.apply(this,arguments)}catch(_){p&&p(_)}finally{Ys(S,!1),x&&ea()}}}d(Mt.prototype,{then:Uu,_then:function(h,p){Yu(this,new Hh(null,null,h,p,Vt))},catch:function(h){if(arguments.length===1)return this.then(null,h);var p=h,y=arguments[1];return typeof p=="function"?this.then(null,function(x){return(x instanceof p?y:Yo)(x)}):this.then(null,function(x){return(x&&x.name===p?y:Yo)(x)})},finally:function(h){return this.then(function(p){return Mt.resolve(h()).then(function(){return p})},function(p){return Mt.resolve(h()).then(function(){return Yo(p)})})},timeout:function(h,p){var y=this;return h<1/0?new Mt(function(x,S){var _=setTimeout(function(){return S(new wt.Timeout(p))},h);y.then(x,S).finally(clearTimeout.bind(null,_))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&g(Mt.prototype,Symbol.toStringTag,"Dexie.Promise"),$e.env=Kh(),d(Mt,{all:function(){var h=ht.apply(null,arguments).map(Qo);return new Mt(function(p,y){h.length===0&&p([]);var x=h.length;h.forEach(function(S,_){return Mt.resolve(S).then(function(O){h[_]=O,--x||p(h)},y)})})},resolve:function(h){return h instanceof Mt?h:h&&typeof h.then=="function"?new Mt(function(p,y){h.then(p,y)}):new Mt(Ct,!0,h)},reject:Yo,race:function(){var h=ht.apply(null,arguments).map(Qo);return new Mt(function(p,y){h.map(function(x){return Mt.resolve(x).then(p,y)})})},PSD:{get:function(){return Vt},set:function(h){return Vt=h}},totalEchoes:{get:function(){return Jo}},newPSD:Us,usePSD:vr,scheduler:{get:function(){return Ne},set:function(h){Ne=h}},rejectionMapper:{get:function(){return qs},set:function(h){qs=h}},follow:function(h,p){return new Mt(function(y,x){return Us(function(S,_){var O=Vt;O.unhandleds=[],O.onunhandled=_,O.finalize=lt(function(){var V,H=this;V=function(){H.unhandleds.length===0?S():_(H.unhandleds[0])},Go.push(function q(){V(),Go.splice(Go.indexOf(q),1)}),++ns,Ne(function(){--ns==0&&Xu()},[])},O.finalize),h()},p,y,x)})}}),Qt&&(Qt.allSettled&&g(Mt,"allSettled",function(){var h=ht.apply(null,arguments).map(Qo);return new Mt(function(p){h.length===0&&p([]);var y=h.length,x=new Array(y);h.forEach(function(S,_){return Mt.resolve(S).then(function(O){return x[_]={status:"fulfilled",value:O}},function(O){return x[_]={status:"rejected",reason:O}}).then(function(){return--y||p(x)})})})}),Qt.any&&typeof AggregateError<"u"&&g(Mt,"any",function(){var h=ht.apply(null,arguments).map(Qo);return new Mt(function(p,y){h.length===0&&y(new AggregateError([]));var x=h.length,S=new Array(x);h.forEach(function(_,O){return Mt.resolve(_).then(function(V){return p(V)},function(V){S[O]=V,--x||y(new AggregateError(S))})})})}),Qt.withResolvers&&(Mt.withResolvers=Qt.withResolvers));var Ge={awaits:0,echoes:0,id:0},lw=0,Xo=[],Zo=0,Jo=0,fw=0;function Us(h,p,y,x){var S=Vt,_=Object.create(S);return _.parent=S,_.ref=0,_.global=!1,_.id=++fw,$e.env,_.env=ne?{Promise:Mt,PromiseProp:{value:Mt,configurable:!0,writable:!0},all:Mt.all,race:Mt.race,allSettled:Mt.allSettled,any:Mt.any,resolve:Mt.resolve,reject:Mt.reject}:{},p&&u(_,p),++S.ref,_.finalize=function(){--this.parent.ref||this.parent.finalize()},x=vr(_,h,y,x),_.ref===0&&_.finalize(),x}function na(){return Ge.id||(Ge.id=++lw),++Ge.awaits,Ge.echoes+=Bt,Ge.id}function Gs(){return!!Ge.awaits&&(--Ge.awaits==0&&(Ge.id=0),Ge.echoes=Ge.awaits*Bt,!0)}function Qo(h){return Ge.echoes&&h&&h.constructor===Qt?(na(),h.then(function(p){return Gs(),p},function(p){return Gs(),Ve(p)})):h}function hw(){var h=Xo[Xo.length-1];Xo.pop(),Ys(h,!1)}function Ys(h,p){var y,x=Vt;(p?!Ge.echoes||Zo++&&h===Vt:!Zo||--Zo&&h===Vt)||queueMicrotask(p?(function(S){++Jo,Ge.echoes&&--Ge.echoes!=0||(Ge.echoes=Ge.awaits=Ge.id=0),Xo.push(Vt),Ys(S,!0)}).bind(null,h):hw),h!==Vt&&(Vt=h,x===$e&&($e.env=Kh()),ne&&(y=$e.env.Promise,p=h.env,(x.global||h.global)&&(Object.defineProperty(a,"Promise",p.PromiseProp),y.all=p.all,y.race=p.race,y.resolve=p.resolve,y.reject=p.reject,p.allSettled&&(y.allSettled=p.allSettled),p.any&&(y.any=p.any))))}function Kh(){var h=a.Promise;return ne?{Promise:h,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:h.all,race:h.race,allSettled:h.allSettled,any:h.any,resolve:h.resolve,reject:h.reject}:{}}function vr(h,p,y,x,S){var _=Vt;try{return Ys(h,!0),p(y,x,S)}finally{Ys(_,!1)}}function Uh(h,p,y,x){return typeof h!="function"?h:function(){var S=Vt;y&&na(),Ys(p,!0);try{return h.apply(this,arguments)}finally{Ys(S,!1),x&&queueMicrotask(Gs)}}}function Zu(h){Promise===Qt&&Ge.echoes===0?Zo===0?h():enqueueNativeMicroTask(h):setTimeout(h,0)}(""+Ln).indexOf("[native code]")===-1&&(na=Gs=F);var Ve=Mt.reject,kr="",Ss="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Gh="String expected.",sa=[],ti="__dbnames",Ju="readonly",Qu="readwrite";function xr(h,p){return h?p?function(){return h.apply(this,arguments)&&p.apply(this,arguments)}:h:p}var Yh={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ei(h){return typeof h!="string"||/\./.test(h)?function(p){return p}:function(p){return p[h]===void 0&&h in p&&delete(p=X(p))[h],p}}function Xh(){throw wt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function le(h,p){try{var y=Zh(h),x=Zh(p);if(y!==x)return y==="Array"?1:x==="Array"?-1:y==="binary"?1:x==="binary"?-1:y==="string"?1:x==="string"?-1:y==="Date"?1:x!=="Date"?NaN:-1;switch(y){case"number":case"Date":case"string":return p<h?1:h<p?-1:0;case"binary":return(function(S,_){for(var O=S.length,V=_.length,H=O<V?O:V,q=0;q<H;++q)if(S[q]!==_[q])return S[q]<_[q]?-1:1;return O===V?0:O<V?-1:1})(Jh(h),Jh(p));case"Array":return(function(S,_){for(var O=S.length,V=_.length,H=O<V?O:V,q=0;q<H;++q){var Z=le(S[q],_[q]);if(Z!==0)return Z}return O===V?0:O<V?-1:1})(h,p)}}catch{}return NaN}function Zh(h){var p=typeof h;return p!="object"?p:ArrayBuffer.isView(h)?"binary":(h=nt(h),h==="ArrayBuffer"?"binary":h)}function Jh(h){return h instanceof Uint8Array?h:ArrayBuffer.isView(h)?new Uint8Array(h.buffer,h.byteOffset,h.byteLength):new Uint8Array(h)}function ni(h,p,y){var x=h.schema.yProps;return x?(p&&0<y.numFailures&&(p=p.filter(function(S,_){return!y.failures[_]})),Promise.all(x.map(function(S){return S=S.updatesTable,p?h.db.table(S).where("k").anyOf(p).delete():h.db.table(S).clear()})).then(function(){return y})):y}var Wa=(Qh.prototype.execute=function(h){var p=this["@@propmod"];if(p.add!==void 0){var y=p.add;if(i(y))return r(r([],i(h)?h:[],!0),y).sort();if(typeof y=="number")return(Number(h)||0)+y;if(typeof y=="bigint")try{return BigInt(h)+y}catch{return BigInt(0)+y}throw new TypeError("Invalid term ".concat(y))}if(p.remove!==void 0){var x=p.remove;if(i(x))return i(h)?h.filter(function(S){return!x.includes(S)}).sort():[];if(typeof x=="number")return Number(h)-x;if(typeof x=="bigint")try{return BigInt(h)-x}catch{return BigInt(0)-x}throw new TypeError("Invalid subtrahend ".concat(x))}return y=(y=p.replacePrefix)===null||y===void 0?void 0:y[0],y&&typeof h=="string"&&h.startsWith(y)?p.replacePrefix[1]+h.substring(y.length):h},Qh);function Qh(h){this["@@propmod"]=h}function td(h,p){for(var y=o(p),x=y.length,S=!1,_=0;_<x;++_){var O=y[_],V=p[O],H=D(h,O);V instanceof Wa?(P(h,O,V.execute(H)),S=!0):H!==V&&(P(h,O,V),S=!0)}return S}var ed=(Ie.prototype._trans=function(h,p,y){var x=this._tx||Vt.trans,S=this.name,_=yt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(h==="readonly"?"read":"write"," ").concat(this.name));function O(q,Z,B){if(!B.schema[S])throw new wt.NotFound("Table "+S+" not part of transaction");return p(B.idbtrans,B)}var V=ta();try{var H=x&&x.db._novip===this.db._novip?x===Vt.trans?x._promise(h,O,y):Us(function(){return x._promise(h,O,y)},{trans:x,transless:Vt.transless||Vt}):(function q(Z,B,Q,U){if(Z.idbdb&&(Z._state.openComplete||Vt.letThrough||Z._vip)){var G=Z._createTransaction(B,Q,Z._dbSchema);try{G.create(),Z._state.PR1398_maxLoop=3}catch(Y){return Y.name===Lt.InvalidState&&Z.isOpen()&&0<--Z._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Z.close({disableAutoOpen:!1}),Z.open().then(function(){return q(Z,B,Q,U)})):Ve(Y)}return G._promise(B,function(Y,J){return Us(function(){return Vt.trans=G,U(Y,J,G)})}).then(function(Y){if(B==="readwrite")try{G.idbtrans.commit()}catch{}return B==="readonly"?Y:G._completion.then(function(){return Y})})}if(Z._state.openComplete)return Ve(new wt.DatabaseClosed(Z._state.dbOpenError));if(!Z._state.isBeingOpened){if(!Z._state.autoOpen)return Ve(new wt.DatabaseClosed);Z.open().catch(F)}return Z._state.dbReadyPromise.then(function(){return q(Z,B,Q,U)})})(this.db,h,[this.name],O);return _&&(H._consoleTask=_,H=H.catch(function(q){return console.trace(q),Ve(q)})),H}finally{V&&ea()}},Ie.prototype.get=function(h,p){var y=this;return h&&h.constructor===Object?this.where(h).first(p):h==null?Ve(new wt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(x){return y.core.get({trans:x,key:h}).then(function(S){return y.hook.reading.fire(S)})}).then(p)},Ie.prototype.where=function(h){if(typeof h=="string")return new this.db.WhereClause(this,h);if(i(h))return new this.db.WhereClause(this,"[".concat(h.join("+"),"]"));var p=o(h);if(p.length===1)return this.where(p[0]).equals(h[p[0]]);var y=this.schema.indexes.concat(this.schema.primKey).filter(function(V){if(V.compound&&p.every(function(q){return 0<=V.keyPath.indexOf(q)})){for(var H=0;H<p.length;++H)if(p.indexOf(V.keyPath[H])===-1)return!1;return!0}return!1}).sort(function(V,H){return V.keyPath.length-H.keyPath.length})[0];if(y&&this.db._maxKey!==kr){var _=y.keyPath.slice(0,p.length);return this.where(_).equals(_.map(function(H){return h[H]}))}!y&&yt&&console.warn("The query ".concat(JSON.stringify(h)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(p.join("+"),"]"));var x=this.schema.idxByName;function S(V,H){return le(V,H)===0}var O=p.reduce(function(B,H){var q=B[0],Z=B[1],B=x[H],Q=h[H];return[q||B,q||!B?xr(Z,B&&B.multi?function(U){return U=D(U,H),i(U)&&U.some(function(G){return S(Q,G)})}:function(U){return S(Q,D(U,H))}):Z]},[null,null]),_=O[0],O=O[1];return _?this.where(_.name).equals(h[_.keyPath]).filter(O):y?this.filter(O):this.where(p).equals("")},Ie.prototype.filter=function(h){return this.toCollection().and(h)},Ie.prototype.count=function(h){return this.toCollection().count(h)},Ie.prototype.offset=function(h){return this.toCollection().offset(h)},Ie.prototype.limit=function(h){return this.toCollection().limit(h)},Ie.prototype.each=function(h){return this.toCollection().each(h)},Ie.prototype.toArray=function(h){return this.toCollection().toArray(h)},Ie.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ie.prototype.orderBy=function(h){return new this.db.Collection(new this.db.WhereClause(this,i(h)?"[".concat(h.join("+"),"]"):h))},Ie.prototype.reverse=function(){return this.toCollection().reverse()},Ie.prototype.mapToClass=function(h){var p,y=this.db,x=this.name;function S(){return p!==null&&p.apply(this,arguments)||this}(this.schema.mappedClass=h).prototype instanceof Xh&&((function(H,q){if(typeof q!="function"&&q!==null)throw new TypeError("Class extends value "+String(q)+" is not a constructor or null");function Z(){this.constructor=H}n(H,q),H.prototype=q===null?Object.create(q):(Z.prototype=q.prototype,new Z)})(S,p=h),Object.defineProperty(S.prototype,"db",{get:function(){return y},enumerable:!1,configurable:!0}),S.prototype.table=function(){return x},h=S);for(var _=new Set,O=h.prototype;O;O=c(O))Object.getOwnPropertyNames(O).forEach(function(H){return _.add(H)});function V(H){if(!H)return H;var q,Z=Object.create(h.prototype);for(q in H)if(!_.has(q))try{Z[q]=H[q]}catch{}return Z}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=V,this.hook("reading",V),h},Ie.prototype.defineClass=function(){return this.mapToClass(function(h){u(this,h)})},Ie.prototype.add=function(h,p){var y=this,x=this.schema.primKey,S=x.auto,_=x.keyPath,O=h;return _&&S&&(O=ei(_)(h)),this._trans("readwrite",function(V){return y.core.mutate({trans:V,type:"add",keys:p!=null?[p]:null,values:[O]})}).then(function(V){return V.numFailures?Mt.reject(V.failures[0]):V.lastResult}).then(function(V){if(_)try{P(h,_,V)}catch{}return V})},Ie.prototype.upsert=function(h,p){var y=this,x=this.schema.primKey.keyPath;return this._trans("readwrite",function(S){return y.core.get({trans:S,key:h}).then(function(_){var O=_??{};return td(O,p),x&&P(O,x,h),y.core.mutate({trans:S,type:"put",values:[O],keys:[h],upsert:!0,updates:{keys:[h],changeSpecs:[p]}}).then(function(V){return V.numFailures?Mt.reject(V.failures[0]):!!_})})})},Ie.prototype.update=function(h,p){return typeof h!="object"||i(h)?this.where(":id").equals(h).modify(p):(h=D(h,this.schema.primKey.keyPath),h===void 0?Ve(new wt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(h).modify(p))},Ie.prototype.put=function(h,p){var y=this,x=this.schema.primKey,S=x.auto,_=x.keyPath,O=h;return _&&S&&(O=ei(_)(h)),this._trans("readwrite",function(V){return y.core.mutate({trans:V,type:"put",values:[O],keys:p!=null?[p]:null})}).then(function(V){return V.numFailures?Mt.reject(V.failures[0]):V.lastResult}).then(function(V){if(_)try{P(h,_,V)}catch{}return V})},Ie.prototype.delete=function(h){var p=this;return this._trans("readwrite",function(y){return p.core.mutate({trans:y,type:"delete",keys:[h]}).then(function(x){return ni(p,[h],x)}).then(function(x){return x.numFailures?Mt.reject(x.failures[0]):void 0})})},Ie.prototype.clear=function(){var h=this;return this._trans("readwrite",function(p){return h.core.mutate({trans:p,type:"deleteRange",range:Yh}).then(function(y){return ni(h,null,y)})}).then(function(p){return p.numFailures?Mt.reject(p.failures[0]):void 0})},Ie.prototype.bulkGet=function(h){var p=this;return this._trans("readonly",function(y){return p.core.getMany({keys:h,trans:y}).then(function(x){return x.map(function(S){return p.hook.reading.fire(S)})})})},Ie.prototype.bulkAdd=function(h,p,y){var x=this,S=Array.isArray(p)?p:void 0,_=(y=y||(S?void 0:p))?y.allKeys:void 0;return this._trans("readwrite",function(O){var q=x.schema.primKey,V=q.auto,q=q.keyPath;if(q&&S)throw new wt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(S&&S.length!==h.length)throw new wt.InvalidArgument("Arguments objects and keys must have the same length");var H=h.length,q=q&&V?h.map(ei(q)):h;return x.core.mutate({trans:O,type:"add",keys:S,values:q,wantResults:_}).then(function(G){var B=G.numFailures,Q=G.results,U=G.lastResult,G=G.failures;if(B===0)return _?Q:U;throw new Ot("".concat(x.name,".bulkAdd(): ").concat(B," of ").concat(H," operations failed"),G)})})},Ie.prototype.bulkPut=function(h,p,y){var x=this,S=Array.isArray(p)?p:void 0,_=(y=y||(S?void 0:p))?y.allKeys:void 0;return this._trans("readwrite",function(O){var q=x.schema.primKey,V=q.auto,q=q.keyPath;if(q&&S)throw new wt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(S&&S.length!==h.length)throw new wt.InvalidArgument("Arguments objects and keys must have the same length");var H=h.length,q=q&&V?h.map(ei(q)):h;return x.core.mutate({trans:O,type:"put",keys:S,values:q,wantResults:_}).then(function(G){var B=G.numFailures,Q=G.results,U=G.lastResult,G=G.failures;if(B===0)return _?Q:U;throw new Ot("".concat(x.name,".bulkPut(): ").concat(B," of ").concat(H," operations failed"),G)})})},Ie.prototype.bulkUpdate=function(h){var p=this,y=this.core,x=h.map(function(O){return O.key}),S=h.map(function(O){return O.changes}),_=[];return this._trans("readwrite",function(O){return y.getMany({trans:O,keys:x,cache:"clone"}).then(function(V){var H=[],q=[];h.forEach(function(B,Q){var U=B.key,G=B.changes,Y=V[Q];if(Y){for(var J=0,et=Object.keys(G);J<et.length;J++){var ot=et[J],ft=G[ot];if(ot===p.schema.primKey.keyPath){if(le(ft,U)!==0)throw new wt.Constraint("Cannot update primary key in bulkUpdate()")}else P(Y,ot,ft)}_.push(Q),H.push(U),q.push(Y)}});var Z=H.length;return y.mutate({trans:O,type:"put",keys:H,values:q,updates:{keys:x,changeSpecs:S}}).then(function(B){var Q=B.numFailures,U=B.failures;if(Q===0)return Z;for(var G=0,Y=Object.keys(U);G<Y.length;G++){var J,et=Y[G],ot=_[Number(et)];ot!=null&&(J=U[et],delete U[et],U[ot]=J)}throw new Ot("".concat(p.name,".bulkUpdate(): ").concat(Q," of ").concat(Z," operations failed"),U)})})})},Ie.prototype.bulkDelete=function(h){var p=this,y=h.length;return this._trans("readwrite",function(x){return p.core.mutate({trans:x,type:"delete",keys:h}).then(function(S){return ni(p,h,S)})}).then(function(O){var S=O.numFailures,_=O.lastResult,O=O.failures;if(S===0)return _;throw new Ot("".concat(p.name,".bulkDelete(): ").concat(S," of ").concat(y," operations failed"),O)})},Ie);function Ie(){}function ja(h){function p(O,V){if(V){for(var H=arguments.length,q=new Array(H-1);--H;)q[H-1]=arguments[H];return y[O].subscribe.apply(null,q),h}if(typeof O=="string")return y[O]}var y={};p.addEventType=_;for(var x=1,S=arguments.length;x<S;++x)_(arguments[x]);return p;function _(O,V,H){if(typeof O!="object"){var q;V=V||_t;var Z={subscribers:[],fire:H=H||F,subscribe:function(B){Z.subscribers.indexOf(B)===-1&&(Z.subscribers.push(B),Z.fire=V(Z.fire,B))},unsubscribe:function(B){Z.subscribers=Z.subscribers.filter(function(Q){return Q!==B}),Z.fire=Z.subscribers.reduce(V,H)}};return y[O]=p[O]=Z}o(q=O).forEach(function(B){var Q=q[B];if(i(Q))_(B,q[B][0],q[B][1]);else{if(Q!=="asap")throw new wt.InvalidArgument("Invalid event config");var U=_(B,W,function(){for(var G=arguments.length,Y=new Array(G);G--;)Y[G]=arguments[G];U.subscribers.forEach(function(J){$(function(){J.apply(null,Y)})})})}})}}function Ha(h,p){return w(p).from({prototype:h}),p}function ra(h,p){return!(h.filter||h.algorithm||h.or)&&(p?h.justLimit:!h.replayFilter)}function tc(h,p){h.filter=xr(h.filter,p)}function ec(h,p,y){var x=h.replayFilter;h.replayFilter=x?function(){return xr(x(),p())}:p,h.justLimit=y&&!x}function si(h,p){if(h.isPrimKey)return p.primaryKey;var y=p.getIndexByKeyPath(h.index);if(!y)throw new wt.Schema("KeyPath "+h.index+" on object store "+p.name+" is not indexed");return y}function nd(h,p,y){var x=si(h,p.schema);return p.openCursor({trans:y,values:!h.keysOnly,reverse:h.dir==="prev",unique:!!h.unique,query:{index:x,range:h.range}})}function ri(h,p,y,x){var S=h.replayFilter?xr(h.filter,h.replayFilter()):h.filter;if(h.or){var _={},O=function(V,H,q){var Z,B;S&&!S(H,q,function(Q){return H.stop(Q)},function(Q){return H.fail(Q)})||((B=""+(Z=H.primaryKey))=="[object ArrayBuffer]"&&(B=""+new Uint8Array(Z)),f(_,B)||(_[B]=!0,p(V,H,q)))};return Promise.all([h.or._iterate(O,y),sd(nd(h,x,y),h.algorithm,O,!h.keysOnly&&h.valueMapper)])}return sd(nd(h,x,y),xr(h.algorithm,S),p,!h.keysOnly&&h.valueMapper)}function sd(h,p,y,x){var S=Ce(x?function(_,O,V){return y(x(_),O,V)}:y);return h.then(function(_){if(_)return _.start(function(){var O=function(){return _.continue()};p&&!p(_,function(V){return O=V},function(V){_.stop(V),O=F},function(V){_.fail(V),O=F})||S(_.value,_,function(V){return O=V}),O()})})}var dw=(he.prototype._read=function(h,p){var y=this._ctx;return y.error?y.table._trans(null,Ve.bind(null,y.error)):y.table._trans("readonly",h).then(p)},he.prototype._write=function(h){var p=this._ctx;return p.error?p.table._trans(null,Ve.bind(null,p.error)):p.table._trans("readwrite",h,"locked")},he.prototype._addAlgorithm=function(h){var p=this._ctx;p.algorithm=xr(p.algorithm,h)},he.prototype._iterate=function(h,p){return ri(this._ctx,h,p,this._ctx.table.core)},he.prototype.clone=function(h){var p=Object.create(this.constructor.prototype),y=Object.create(this._ctx);return h&&u(y,h),p._ctx=y,p},he.prototype.raw=function(){return this._ctx.valueMapper=null,this},he.prototype.each=function(h){var p=this._ctx;return this._read(function(y){return ri(p,h,y,p.table.core)})},he.prototype.count=function(h){var p=this;return this._read(function(y){var x=p._ctx,S=x.table.core;if(ra(x,!0))return S.count({trans:y,query:{index:si(x,S.schema),range:x.range}}).then(function(O){return Math.min(O,x.limit)});var _=0;return ri(x,function(){return++_,!1},y,S).then(function(){return _})}).then(h)},he.prototype.sortBy=function(h,p){var y=h.split(".").reverse(),x=y[0],S=y.length-1;function _(H,q){return q?_(H[y[q]],q-1):H[x]}var O=this._ctx.dir==="next"?1:-1;function V(H,q){return le(_(H,S),_(q,S))*O}return this.toArray(function(H){return H.sort(V)}).then(p)},he.prototype.toArray=function(h){var p=this;return this._read(function(y){var x=p._ctx;if(x.dir==="next"&&ra(x,!0)&&0<x.limit){var S=x.valueMapper,_=si(x,x.table.core.schema);return x.table.core.query({trans:y,limit:x.limit,values:!0,query:{index:_,range:x.range}}).then(function(V){return V=V.result,S?V.map(S):V})}var O=[];return ri(x,function(V){return O.push(V)},y,x.table.core).then(function(){return O})},h)},he.prototype.offset=function(h){var p=this._ctx;return h<=0||(p.offset+=h,ra(p)?ec(p,function(){var y=h;return function(x,S){return y===0||(y===1?--y:S(function(){x.advance(y),y=0}),!1)}}):ec(p,function(){var y=h;return function(){return--y<0}})),this},he.prototype.limit=function(h){return this._ctx.limit=Math.min(this._ctx.limit,h),ec(this._ctx,function(){var p=h;return function(y,x,S){return--p<=0&&x(S),0<=p}},!0),this},he.prototype.until=function(h,p){return tc(this._ctx,function(y,x,S){return!h(y.value)||(x(S),p)}),this},he.prototype.first=function(h){return this.limit(1).toArray(function(p){return p[0]}).then(h)},he.prototype.last=function(h){return this.reverse().first(h)},he.prototype.filter=function(h){var p;return tc(this._ctx,function(y){return h(y.value)}),(p=this._ctx).isMatch=xr(p.isMatch,h),this},he.prototype.and=function(h){return this.filter(h)},he.prototype.or=function(h){return new this.db.WhereClause(this._ctx.table,h,this)},he.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},he.prototype.desc=function(){return this.reverse()},he.prototype.eachKey=function(h){var p=this._ctx;return p.keysOnly=!p.isMatch,this.each(function(y,x){h(x.key,x)})},he.prototype.eachUniqueKey=function(h){return this._ctx.unique="unique",this.eachKey(h)},he.prototype.eachPrimaryKey=function(h){var p=this._ctx;return p.keysOnly=!p.isMatch,this.each(function(y,x){h(x.primaryKey,x)})},he.prototype.keys=function(h){var p=this._ctx;p.keysOnly=!p.isMatch;var y=[];return this.each(function(x,S){y.push(S.key)}).then(function(){return y}).then(h)},he.prototype.primaryKeys=function(h){var p=this._ctx;if(p.dir==="next"&&ra(p,!0)&&0<p.limit)return this._read(function(x){var S=si(p,p.table.core.schema);return p.table.core.query({trans:x,values:!1,limit:p.limit,query:{index:S,range:p.range}})}).then(function(x){return x.result}).then(h);p.keysOnly=!p.isMatch;var y=[];return this.each(function(x,S){y.push(S.primaryKey)}).then(function(){return y}).then(h)},he.prototype.uniqueKeys=function(h){return this._ctx.unique="unique",this.keys(h)},he.prototype.firstKey=function(h){return this.limit(1).keys(function(p){return p[0]}).then(h)},he.prototype.lastKey=function(h){return this.reverse().firstKey(h)},he.prototype.distinct=function(){var h=this._ctx,h=h.index&&h.table.schema.idxByName[h.index];if(!h||!h.multi)return this;var p={};return tc(this._ctx,function(S){var x=S.primaryKey.toString(),S=f(p,x);return p[x]=!0,!S}),this},he.prototype.modify=function(h){var p=this,y=this._ctx;return this._write(function(x){var S=typeof h=="function"?h:function(Y){return td(Y,h)},_=y.table.core,q=_.schema.primaryKey,O=q.outbound,V=q.extractKey,H=200,q=p.db._options.modifyChunkSize;q&&(H=typeof q=="object"?q[_.name]||q["*"]||200:q);function Z(Y,ot){var et=ot.failures,ot=ot.numFailures;Q+=Y-ot;for(var ft=0,gt=o(et);ft<gt.length;ft++){var Et=gt[ft];B.push(et[Et])}}var B=[],Q=0,U=[],G=h===rd;return p.clone().primaryKeys().then(function(Y){function J(ot){var ft=Math.min(H,Y.length-ot),gt=Y.slice(ot,ot+ft);return(G?Promise.resolve([]):_.getMany({trans:x,keys:gt,cache:"immutable"})).then(function(Et){var Ft=[],It=[],At=O?[]:null,Rt=G?gt:[];if(!G)for(var Dt=0;Dt<ft;++Dt){var Wt=Et[Dt],se={value:X(Wt),primKey:Y[ot+Dt]};S.call(se,se.value,se)!==!1&&(se.value==null?Rt.push(Y[ot+Dt]):O||le(V(Wt),V(se.value))===0?(It.push(se.value),O&&At.push(Y[ot+Dt])):(Rt.push(Y[ot+Dt]),Ft.push(se.value)))}return Promise.resolve(0<Ft.length&&_.mutate({trans:x,type:"add",values:Ft}).then(function(ae){for(var ue in ae.failures)Rt.splice(parseInt(ue),1);Z(Ft.length,ae)})).then(function(){return(0<It.length||et&&typeof h=="object")&&_.mutate({trans:x,type:"put",keys:At,values:It,criteria:et,changeSpec:typeof h!="function"&&h,isAdditionalChunk:0<ot}).then(function(ae){return Z(It.length,ae)})}).then(function(){return(0<Rt.length||et&&G)&&_.mutate({trans:x,type:"delete",keys:Rt,criteria:et,isAdditionalChunk:0<ot}).then(function(ae){return ni(y.table,Rt,ae)}).then(function(ae){return Z(Rt.length,ae)})}).then(function(){return Y.length>ot+ft&&J(ot+H)})})}var et=ra(y)&&y.limit===1/0&&(typeof h!="function"||G)&&{index:y.index,range:y.range};return J(0).then(function(){if(0<B.length)throw new Tt("Error modifying one or more objects",B,Q,U);return Y.length})})})},he.prototype.delete=function(){var h=this._ctx,p=h.range;return!ra(h)||h.table.schema.yProps||!h.isPrimKey&&p.type!==3?this.modify(rd):this._write(function(y){var x=h.table.core.schema.primaryKey,S=p;return h.table.core.count({trans:y,query:{index:x,range:S}}).then(function(_){return h.table.core.mutate({trans:y,type:"deleteRange",range:S}).then(function(H){var V=H.failures,H=H.numFailures;if(H)throw new Tt("Could not delete some values",Object.keys(V).map(function(q){return V[q]}),_-H);return _-H})})})},he);function he(){}var rd=function(h,p){return p.value=null};function pw(h,p){return h<p?-1:h===p?0:1}function mw(h,p){return p<h?-1:h===p?0:1}function Dn(h,p,y){return h=h instanceof od?new h.Collection(h):h,h._ctx.error=new(y||TypeError)(p),h}function aa(h){return new h.Collection(h,function(){return ad("")}).limit(0)}function ai(h,p,y,x){var S,_,O,V,H,q,Z,B=y.length;if(!y.every(function(G){return typeof G=="string"}))return Dn(h,Gh);function Q(G){S=G==="next"?function(J){return J.toUpperCase()}:function(J){return J.toLowerCase()},_=G==="next"?function(J){return J.toLowerCase()}:function(J){return J.toUpperCase()},O=G==="next"?pw:mw;var Y=y.map(function(J){return{lower:_(J),upper:S(J)}}).sort(function(J,et){return O(J.lower,et.lower)});V=Y.map(function(J){return J.upper}),H=Y.map(function(J){return J.lower}),Z=(q=G)==="next"?"":x}Q("next"),h=new h.Collection(h,function(){return Xs(V[0],H[B-1]+x)}),h._ondirectionchange=function(G){Q(G)};var U=0;return h._addAlgorithm(function(G,Y,J){var et=G.key;if(typeof et!="string")return!1;var ot=_(et);if(p(ot,H,U))return!0;for(var ft=null,gt=U;gt<B;++gt){var Et=(function(Ft,It,At,Rt,Dt,Wt){for(var se=Math.min(Ft.length,Rt.length),ae=-1,ue=0;ue<se;++ue){var On=It[ue];if(On!==Rt[ue])return Dt(Ft[ue],At[ue])<0?Ft.substr(0,ue)+At[ue]+At.substr(ue+1):Dt(Ft[ue],Rt[ue])<0?Ft.substr(0,ue)+Rt[ue]+At.substr(ue+1):0<=ae?Ft.substr(0,ae)+It[ae]+At.substr(ae+1):null;Dt(Ft[ue],On)<0&&(ae=ue)}return se<Rt.length&&Wt==="next"?Ft+At.substr(Ft.length):se<Ft.length&&Wt==="prev"?Ft.substr(0,At.length):ae<0?null:Ft.substr(0,ae)+Rt[ae]+At.substr(ae+1)})(et,ot,V[gt],H[gt],O,q);Et===null&&ft===null?U=gt+1:(ft===null||0<O(ft,Et))&&(ft=Et)}return Y(ft!==null?function(){G.continue(ft+Z)}:J),!1}),h}function Xs(h,p,y,x){return{type:2,lower:h,upper:p,lowerOpen:y,upperOpen:x}}function ad(h){return{type:1,lower:h,upper:h}}var od=(Object.defineProperty(Ye.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ye.prototype.between=function(h,p,y,x){y=y!==!1,x=x===!0;try{return 0<this._cmp(h,p)||this._cmp(h,p)===0&&(y||x)&&(!y||!x)?aa(this):new this.Collection(this,function(){return Xs(h,p,!y,!x)})}catch{return Dn(this,Ss)}},Ye.prototype.equals=function(h){return h==null?Dn(this,Ss):new this.Collection(this,function(){return ad(h)})},Ye.prototype.above=function(h){return h==null?Dn(this,Ss):new this.Collection(this,function(){return Xs(h,void 0,!0)})},Ye.prototype.aboveOrEqual=function(h){return h==null?Dn(this,Ss):new this.Collection(this,function(){return Xs(h,void 0,!1)})},Ye.prototype.below=function(h){return h==null?Dn(this,Ss):new this.Collection(this,function(){return Xs(void 0,h,!1,!0)})},Ye.prototype.belowOrEqual=function(h){return h==null?Dn(this,Ss):new this.Collection(this,function(){return Xs(void 0,h)})},Ye.prototype.startsWith=function(h){return typeof h!="string"?Dn(this,Gh):this.between(h,h+kr,!0,!0)},Ye.prototype.startsWithIgnoreCase=function(h){return h===""?this.startsWith(h):ai(this,function(p,y){return p.indexOf(y[0])===0},[h],kr)},Ye.prototype.equalsIgnoreCase=function(h){return ai(this,function(p,y){return p===y[0]},[h],"")},Ye.prototype.anyOfIgnoreCase=function(){var h=ht.apply(ut,arguments);return h.length===0?aa(this):ai(this,function(p,y){return y.indexOf(p)!==-1},h,"")},Ye.prototype.startsWithAnyOfIgnoreCase=function(){var h=ht.apply(ut,arguments);return h.length===0?aa(this):ai(this,function(p,y){return y.some(function(x){return p.indexOf(x)===0})},h,kr)},Ye.prototype.anyOf=function(){var h=this,p=ht.apply(ut,arguments),y=this._cmp;try{p.sort(y)}catch{return Dn(this,Ss)}if(p.length===0)return aa(this);var x=new this.Collection(this,function(){return Xs(p[0],p[p.length-1])});x._ondirectionchange=function(_){y=_==="next"?h._ascending:h._descending,p.sort(y)};var S=0;return x._addAlgorithm(function(_,O,V){for(var H=_.key;0<y(H,p[S]);)if(++S===p.length)return O(V),!1;return y(H,p[S])===0||(O(function(){_.continue(p[S])}),!1)}),x},Ye.prototype.notEqual=function(h){return this.inAnyRange([[-1/0,h],[h,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ye.prototype.noneOf=function(){var h=ht.apply(ut,arguments);if(h.length===0)return new this.Collection(this);try{h.sort(this._ascending)}catch{return Dn(this,Ss)}var p=h.reduce(function(y,x){return y?y.concat([[y[y.length-1][1],x]]):[[-1/0,x]]},null);return p.push([h[h.length-1],this.db._maxKey]),this.inAnyRange(p,{includeLowers:!1,includeUppers:!1})},Ye.prototype.inAnyRange=function(et,p){var y=this,x=this._cmp,S=this._ascending,_=this._descending,O=this._min,V=this._max;if(et.length===0)return aa(this);if(!et.every(function(ot){return ot[0]!==void 0&&ot[1]!==void 0&&S(ot[0],ot[1])<=0}))return Dn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",wt.InvalidArgument);var H=!p||p.includeLowers!==!1,q=p&&p.includeUppers===!0,Z,B=S;function Q(ot,ft){return B(ot[0],ft[0])}try{(Z=et.reduce(function(ot,ft){for(var gt=0,Et=ot.length;gt<Et;++gt){var Ft=ot[gt];if(x(ft[0],Ft[1])<0&&0<x(ft[1],Ft[0])){Ft[0]=O(Ft[0],ft[0]),Ft[1]=V(Ft[1],ft[1]);break}}return gt===Et&&ot.push(ft),ot},[])).sort(Q)}catch{return Dn(this,Ss)}var U=0,G=q?function(ot){return 0<S(ot,Z[U][1])}:function(ot){return 0<=S(ot,Z[U][1])},Y=H?function(ot){return 0<_(ot,Z[U][0])}:function(ot){return 0<=_(ot,Z[U][0])},J=G,et=new this.Collection(this,function(){return Xs(Z[0][0],Z[Z.length-1][1],!H,!q)});return et._ondirectionchange=function(ot){B=ot==="next"?(J=G,S):(J=Y,_),Z.sort(Q)},et._addAlgorithm(function(ot,ft,gt){for(var Et,Ft=ot.key;J(Ft);)if(++U===Z.length)return ft(gt),!1;return!G(Et=Ft)&&!Y(Et)||(y._cmp(Ft,Z[U][1])===0||y._cmp(Ft,Z[U][0])===0||ft(function(){B===S?ot.continue(Z[U][0]):ot.continue(Z[U][1])}),!1)}),et},Ye.prototype.startsWithAnyOf=function(){var h=ht.apply(ut,arguments);return h.every(function(p){return typeof p=="string"})?h.length===0?aa(this):this.inAnyRange(h.map(function(p){return[p,p+kr]})):Dn(this,"startsWithAnyOf() only works with strings")},Ye);function Ye(){}function ss(h){return Ce(function(p){return qa(p),h(p.target.error),!1})}function qa(h){h.stopPropagation&&h.stopPropagation(),h.preventDefault&&h.preventDefault()}var Ka="storagemutated",nc="x-storagemutated-1",Zs=ja(null,Ka),gw=(rs.prototype._lock=function(){return N(!Vt.global),++this._reculock,this._reculock!==1||Vt.global||(Vt.lockOwnerFor=this),this},rs.prototype._unlock=function(){if(N(!Vt.global),--this._reculock==0)for(Vt.global||(Vt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var h=this._blockedFuncs.shift();try{vr(h[1],h[0])}catch{}}return this},rs.prototype._locked=function(){return this._reculock&&Vt.lockOwnerFor!==this},rs.prototype.create=function(h){var p=this;if(!this.mode)return this;var y=this.db.idbdb,x=this.db._state.dbOpenError;if(N(!this.idbtrans),!h&&!y)switch(x&&x.name){case"DatabaseClosedError":throw new wt.DatabaseClosed(x);case"MissingAPIError":throw new wt.MissingAPI(x.message,x);default:throw new wt.OpenFailed(x)}if(!this.active)throw new wt.TransactionInactive;return N(this._completion._state===null),(h=this.idbtrans=h||(this.db.core||y).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ce(function(S){qa(S),p._reject(h.error)}),h.onabort=Ce(function(S){qa(S),p.active&&p._reject(new wt.Abort(h.error)),p.active=!1,p.on("abort").fire(S)}),h.oncomplete=Ce(function(){p.active=!1,p._resolve(),"mutatedParts"in h&&Zs.storagemutated.fire(h.mutatedParts)}),this},rs.prototype._promise=function(h,p,y){var x=this;if(h==="readwrite"&&this.mode!=="readwrite")return Ve(new wt.ReadOnly("Transaction is readonly"));if(!this.active)return Ve(new wt.TransactionInactive);if(this._locked())return new Mt(function(_,O){x._blockedFuncs.push([function(){x._promise(h,p,y).then(_,O)},Vt])});if(y)return Us(function(){var _=new Mt(function(O,V){x._lock();var H=p(O,V,x);H&&H.then&&H.then(O,V)});return _.finally(function(){return x._unlock()}),_._lib=!0,_});var S=new Mt(function(_,O){var V=p(_,O,x);V&&V.then&&V.then(_,O)});return S._lib=!0,S},rs.prototype._root=function(){return this.parent?this.parent._root():this},rs.prototype.waitFor=function(h){var p,y=this._root(),x=Mt.resolve(h);y._waitingFor?y._waitingFor=y._waitingFor.then(function(){return x}):(y._waitingFor=x,y._waitingQueue=[],p=y.idbtrans.objectStore(y.storeNames[0]),(function _(){for(++y._spinCount;y._waitingQueue.length;)y._waitingQueue.shift()();y._waitingFor&&(p.get(-1/0).onsuccess=_)})());var S=y._waitingFor;return new Mt(function(_,O){x.then(function(V){return y._waitingQueue.push(Ce(_.bind(null,V)))},function(V){return y._waitingQueue.push(Ce(O.bind(null,V)))}).finally(function(){y._waitingFor===S&&(y._waitingFor=null)})})},rs.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new wt.Abort))},rs.prototype.table=function(h){var p=this._memoizedTables||(this._memoizedTables={});if(f(p,h))return p[h];var y=this.schema[h];if(!y)throw new wt.NotFound("Table "+h+" not part of transaction");return y=new this.db.Table(h,y,this),y.core=this.db.core.table(h),p[h]=y},rs);function rs(){}function sc(h,p,y,x,S,_,O,V){return{name:h,keyPath:p,unique:y,multi:x,auto:S,compound:_,src:(y&&!O?"&":"")+(x?"*":"")+(S?"++":"")+id(p),type:V}}function id(h){return typeof h=="string"?h:h?"["+[].join.call(h,"+")+"]":""}function rc(h,p,y){return{name:h,primKey:p,indexes:y,mappedClass:null,idxByName:(x=function(S){return[S.name,S]},y.reduce(function(S,_,O){return O=x(_,O),O&&(S[O[0]]=O[1]),S},{}))};var x}var Ua=function(h){try{return h.only([[]]),Ua=function(){return[[]]},[[]]}catch{return Ua=function(){return kr},kr}};function ac(h){return h==null?function(){}:typeof h=="string"?(p=h).split(".").length===1?function(y){return y[p]}:function(y){return D(y,p)}:function(y){return D(y,h)};var p}function ud(h){return[].slice.call(h)}var yw=0;function Ga(h){return h==null?":id":typeof h=="string"?h:"[".concat(h.join("+"),"]")}function bw(h,p,H){function x(J){if(J.type===3)return null;if(J.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var U=J.lower,G=J.upper,Y=J.lowerOpen,J=J.upperOpen;return U===void 0?G===void 0?null:p.upperBound(G,!!J):G===void 0?p.lowerBound(U,!!Y):p.bound(U,G,!!Y,!!J)}function S(Q){var U,G=Q.name;return{name:G,schema:Q,mutate:function(Y){var J=Y.trans,et=Y.type,ot=Y.keys,ft=Y.values,gt=Y.range;return new Promise(function(Et,Ft){Et=Ce(Et);var It=J.objectStore(G),At=It.keyPath==null,Rt=et==="put"||et==="add";if(!Rt&&et!=="delete"&&et!=="deleteRange")throw new Error("Invalid operation type: "+et);var Dt,Wt=(ot||ft||{length:1}).length;if(ot&&ft&&ot.length!==ft.length)throw new Error("Given keys array must have same length as given values array.");if(Wt===0)return Et({numFailures:0,failures:{},results:[],lastResult:void 0});function se(gn){++On,qa(gn)}var ae=[],ue=[],On=0;if(et==="deleteRange"){if(gt.type===4)return Et({numFailures:On,failures:ue,results:[],lastResult:void 0});gt.type===3?ae.push(Dt=It.clear()):ae.push(Dt=It.delete(x(gt)))}else{var At=Rt?At?[ft,ot]:[ft,null]:[ot,null],te=At[0],sn=At[1];if(Rt)for(var rn=0;rn<Wt;++rn)ae.push(Dt=sn&&sn[rn]!==void 0?It[et](te[rn],sn[rn]):It[et](te[rn])),Dt.onerror=se;else for(rn=0;rn<Wt;++rn)ae.push(Dt=It[et](te[rn])),Dt.onerror=se}function yi(gn){gn=gn.target.result,ae.forEach(function(Ir,Sc){return Ir.error!=null&&(ue[Sc]=Ir.error)}),Et({numFailures:On,failures:ue,results:et==="delete"?ot:ae.map(function(Ir){return Ir.result}),lastResult:gn})}Dt.onerror=function(gn){se(gn),yi(gn)},Dt.onsuccess=yi})},getMany:function(Y){var J=Y.trans,et=Y.keys;return new Promise(function(ot,ft){ot=Ce(ot);for(var gt,Et=J.objectStore(G),Ft=et.length,It=new Array(Ft),At=0,Rt=0,Dt=function(ae){ae=ae.target,It[ae._pos]=ae.result,++Rt===At&&ot(It)},Wt=ss(ft),se=0;se<Ft;++se)et[se]!=null&&((gt=Et.get(et[se]))._pos=se,gt.onsuccess=Dt,gt.onerror=Wt,++At);At===0&&ot(It)})},get:function(Y){var J=Y.trans,et=Y.key;return new Promise(function(ot,ft){ot=Ce(ot);var gt=J.objectStore(G).get(et);gt.onsuccess=function(Et){return ot(Et.target.result)},gt.onerror=ss(ft)})},query:(U=q,function(Y){return new Promise(function(J,et){J=Ce(J);var ot,ft,gt,At=Y.trans,Et=Y.values,Ft=Y.limit,Dt=Y.query,It=Ft===1/0?void 0:Ft,Rt=Dt.index,Dt=Dt.range,At=At.objectStore(G),Rt=Rt.isPrimaryKey?At:At.index(Rt.name),Dt=x(Dt);if(Ft===0)return J({result:[]});U?((It=Et?Rt.getAll(Dt,It):Rt.getAllKeys(Dt,It)).onsuccess=function(Wt){return J({result:Wt.target.result})},It.onerror=ss(et)):(ot=0,ft=!Et&&"openKeyCursor"in Rt?Rt.openKeyCursor(Dt):Rt.openCursor(Dt),gt=[],ft.onsuccess=function(Wt){var se=ft.result;return se?(gt.push(Et?se.value:se.primaryKey),++ot===Ft?J({result:gt}):void se.continue()):J({result:gt})},ft.onerror=ss(et))})}),openCursor:function(Y){var J=Y.trans,et=Y.values,ot=Y.query,ft=Y.reverse,gt=Y.unique;return new Promise(function(Et,Ft){Et=Ce(Et);var Rt=ot.index,It=ot.range,At=J.objectStore(G),At=Rt.isPrimaryKey?At:At.index(Rt.name),Rt=ft?gt?"prevunique":"prev":gt?"nextunique":"next",Dt=!et&&"openKeyCursor"in At?At.openKeyCursor(x(It),Rt):At.openCursor(x(It),Rt);Dt.onerror=ss(Ft),Dt.onsuccess=Ce(function(Wt){var se,ae,ue,On,te=Dt.result;te?(te.___id=++yw,te.done=!1,se=te.continue.bind(te),ae=(ae=te.continuePrimaryKey)&&ae.bind(te),ue=te.advance.bind(te),On=function(){throw new Error("Cursor not stopped")},te.trans=J,te.stop=te.continue=te.continuePrimaryKey=te.advance=function(){throw new Error("Cursor not started")},te.fail=Ce(Ft),te.next=function(){var sn=this,rn=1;return this.start(function(){return rn--?sn.continue():sn.stop()}).then(function(){return sn})},te.start=function(sn){function rn(){if(Dt.result)try{sn()}catch(gn){te.fail(gn)}else te.done=!0,te.start=function(){throw new Error("Cursor behind last entry")},te.stop()}var yi=new Promise(function(gn,Ir){gn=Ce(gn),Dt.onerror=ss(Ir),te.fail=Ir,te.stop=function(Sc){te.stop=te.continue=te.continuePrimaryKey=te.advance=On,gn(Sc)}});return Dt.onsuccess=Ce(function(gn){Dt.onsuccess=rn,rn()}),te.continue=se,te.continuePrimaryKey=ae,te.advance=ue,rn(),yi},Et(te)):Et(null)},Ft)})},count:function(Y){var J=Y.query,et=Y.trans,ot=J.index,ft=J.range;return new Promise(function(gt,Et){var Ft=et.objectStore(G),It=ot.isPrimaryKey?Ft:Ft.index(ot.name),Ft=x(ft),It=Ft?It.count(Ft):It.count();It.onsuccess=Ce(function(At){return gt(At.target.result)}),It.onerror=ss(Et)})}}}var _,O,V,Z=(O=H,V=ud((_=h).objectStoreNames),{schema:{name:_.name,tables:V.map(function(Q){return O.objectStore(Q)}).map(function(Q){var U=Q.keyPath,J=Q.autoIncrement,G=i(U),Y={},J={name:Q.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:U==null,compound:G,keyPath:U,autoIncrement:J,unique:!0,extractKey:ac(U)},indexes:ud(Q.indexNames).map(function(et){return Q.index(et)}).map(function(gt){var ot=gt.name,ft=gt.unique,Et=gt.multiEntry,gt=gt.keyPath,Et={name:ot,compound:i(gt),keyPath:gt,unique:ft,multiEntry:Et,extractKey:ac(gt)};return Y[Ga(gt)]=Et}),getIndexByKeyPath:function(et){return Y[Ga(et)]}};return Y[":id"]=J.primaryKey,U!=null&&(Y[Ga(U)]=J.primaryKey),J})},hasGetAll:0<V.length&&"getAll"in O.objectStore(V[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),H=Z.schema,q=Z.hasGetAll,Z=H.tables.map(S),B={};return Z.forEach(function(Q){return B[Q.name]=Q}),{stack:"dbcore",transaction:h.transaction.bind(h),table:function(Q){if(!B[Q])throw new Error("Table '".concat(Q,"' not found"));return B[Q]},MIN_KEY:-1/0,MAX_KEY:Ua(p),schema:H}}function ww(h,p,y,x){var S=y.IDBKeyRange;return y.indexedDB,{dbcore:(x=bw(p,S,x),h.dbcore.reduce(function(_,O){return O=O.create,s(s({},_),O(_))},x))}}function oi(h,x){var y=x.db,x=ww(h._middlewares,y,h._deps,x);h.core=x.dbcore,h.tables.forEach(function(S){var _=S.name;h.core.schema.tables.some(function(O){return O.name===_})&&(S.core=h.core.table(_),h[_]instanceof h.Table&&(h[_].core=S.core))})}function ii(h,p,y,x){y.forEach(function(S){var _=x[S];p.forEach(function(O){var V=(function H(q,Z){return b(q,Z)||(q=c(q))&&H(q,Z)})(O,S);(!V||"value"in V&&V.value===void 0)&&(O===h.Transaction.prototype||O instanceof h.Transaction?g(O,S,{get:function(){return this.table(S)},set:function(H){m(this,S,{value:H,writable:!0,configurable:!0,enumerable:!0})}}):O[S]=new h.Table(S,_))})})}function oc(h,p){p.forEach(function(y){for(var x in y)y[x]instanceof h.Table&&delete y[x]})}function vw(h,p){return h._cfg.version-p._cfg.version}function kw(h,p,y,x){var S=h._dbSchema;y.objectStoreNames.contains("$meta")&&!S.$meta&&(S.$meta=rc("$meta",ld("")[0],[]),h._storeNames.push("$meta"));var _=h._createTransaction("readwrite",h._storeNames,S);_.create(y),_._completion.catch(x);var O=_._reject.bind(_),V=Vt.transless||Vt;Us(function(){return Vt.trans=_,Vt.transless=V,p!==0?(oi(h,y),q=p,((H=_).storeNames.includes("$meta")?H.table("$meta").get("version").then(function(Z){return Z??q}):Mt.resolve(q)).then(function(Z){return Q=Z,U=_,G=y,Y=[],Z=(B=h)._versions,J=B._dbSchema=ci(0,B.idbdb,G),(Z=Z.filter(function(et){return et._cfg.version>=Q})).length!==0?(Z.forEach(function(et){Y.push(function(){var ot=J,ft=et._cfg.dbschema;li(B,ot,G),li(B,ft,G),J=B._dbSchema=ft;var gt=ic(ot,ft);gt.add.forEach(function(Rt){uc(G,Rt[0],Rt[1].primKey,Rt[1].indexes)}),gt.change.forEach(function(Rt){if(Rt.recreate)throw new wt.Upgrade("Not yet support for changing primary key");var Dt=G.objectStore(Rt.name);Rt.add.forEach(function(Wt){return ui(Dt,Wt)}),Rt.change.forEach(function(Wt){Dt.deleteIndex(Wt.name),ui(Dt,Wt)}),Rt.del.forEach(function(Wt){return Dt.deleteIndex(Wt)})});var Et=et._cfg.contentUpgrade;if(Et&&et._cfg.version>Q){oi(B,G),U._memoizedTables={};var Ft=L(ft);gt.del.forEach(function(Rt){Ft[Rt]=ot[Rt]}),oc(B,[B.Transaction.prototype]),ii(B,[B.Transaction.prototype],o(Ft),Ft),U.schema=Ft;var It,At=mt(Et);return At&&na(),gt=Mt.follow(function(){var Rt;(It=Et(U))&&At&&(Rt=Gs.bind(null,null),It.then(Rt,Rt))}),It&&typeof It.then=="function"?Mt.resolve(It):gt.then(function(){return It})}}),Y.push(function(ot){var ft,gt,Et=et._cfg.dbschema;ft=Et,gt=ot,[].slice.call(gt.db.objectStoreNames).forEach(function(Ft){return ft[Ft]==null&&gt.db.deleteObjectStore(Ft)}),oc(B,[B.Transaction.prototype]),ii(B,[B.Transaction.prototype],B._storeNames,B._dbSchema),U.schema=B._dbSchema}),Y.push(function(ot){B.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(B.idbdb.version/10)===et._cfg.version?(B.idbdb.deleteObjectStore("$meta"),delete B._dbSchema.$meta,B._storeNames=B._storeNames.filter(function(ft){return ft!=="$meta"})):ot.objectStore("$meta").put(et._cfg.version,"version"))})}),(function et(){return Y.length?Mt.resolve(Y.shift()(U.idbtrans)).then(et):Mt.resolve()})().then(function(){cd(J,G)})):Mt.resolve();var B,Q,U,G,Y,J}).catch(O)):(o(S).forEach(function(Z){uc(y,Z,S[Z].primKey,S[Z].indexes)}),oi(h,y),void Mt.follow(function(){return h.on.populate.fire(_)}).catch(O));var H,q})}function xw(h,p){cd(h._dbSchema,p),p.db.version%10!=0||p.objectStoreNames.contains("$meta")||p.db.createObjectStore("$meta").add(Math.ceil(p.db.version/10-1),"version");var y=ci(0,h.idbdb,p);li(h,h._dbSchema,p);for(var x=0,S=ic(y,h._dbSchema).change;x<S.length;x++){var _=(function(O){if(O.change.length||O.recreate)return console.warn("Unable to patch indexes of table ".concat(O.name," because it has changes on the type of index or primary key.")),{value:void 0};var V=p.objectStore(O.name);O.add.forEach(function(H){yt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(O.name,".").concat(H.src)),ui(V,H)})})(S[x]);if(typeof _=="object")return _.value}}function ic(h,p){var y,x={del:[],add:[],change:[]};for(y in h)p[y]||x.del.push(y);for(y in p){var S=h[y],_=p[y];if(S){var O={name:y,def:_,recreate:!1,del:[],add:[],change:[]};if(""+(S.primKey.keyPath||"")!=""+(_.primKey.keyPath||"")||S.primKey.auto!==_.primKey.auto)O.recreate=!0,x.change.push(O);else{var V=S.idxByName,H=_.idxByName,q=void 0;for(q in V)H[q]||O.del.push(q);for(q in H){var Z=V[q],B=H[q];Z?Z.src!==B.src&&O.change.push(B):O.add.push(B)}(0<O.del.length||0<O.add.length||0<O.change.length)&&x.change.push(O)}}else x.add.push([y,_])}return x}function uc(h,p,y,x){var S=h.db.createObjectStore(p,y.keyPath?{keyPath:y.keyPath,autoIncrement:y.auto}:{autoIncrement:y.auto});return x.forEach(function(_){return ui(S,_)}),S}function cd(h,p){o(h).forEach(function(y){p.db.objectStoreNames.contains(y)||(yt&&console.debug("Dexie: Creating missing table",y),uc(p,y,h[y].primKey,h[y].indexes))})}function ui(h,p){h.createIndex(p.name,p.keyPath,{unique:p.unique,multiEntry:p.multi})}function ci(h,p,y){var x={};return I(p.objectStoreNames,0).forEach(function(S){for(var _=y.objectStore(S),O=sc(id(q=_.keyPath),q||"",!0,!1,!!_.autoIncrement,q&&typeof q!="string",!0),V=[],H=0;H<_.indexNames.length;++H){var Z=_.index(_.indexNames[H]),q=Z.keyPath,Z=sc(Z.name,q,!!Z.unique,!!Z.multiEntry,!1,q&&typeof q!="string",!1);V.push(Z)}x[S]=rc(S,O,V)}),x}function li(h,p,y){for(var x=y.db.objectStoreNames,S=0;S<x.length;++S){var _=x[S],O=y.objectStore(_);h._hasGetAll="getAll"in O;for(var V=0;V<O.indexNames.length;++V){var H=O.indexNames[V],q=O.index(H).keyPath,Z=typeof q=="string"?q:"["+I(q).join("+")+"]";!p[_]||(q=p[_].idxByName[Z])&&(q.name=H,delete p[_].idxByName[Z],p[_].idxByName[H]=q)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(h._hasGetAll=!1)}function ld(h){return h.split(",").map(function(p,y){var _=p.split(":"),x=(S=_[1])===null||S===void 0?void 0:S.trim(),S=(p=_[0].trim()).replace(/([&*]|\+\+)/g,""),_=/^\[/.test(S)?S.match(/^\[(.*)\]$/)[1].split("+"):S;return sc(S,_||null,/\&/.test(p),/\*/.test(p),/\+\+/.test(p),i(_),y===0,x)})}var Sw=(oa.prototype._createTableSchema=rc,oa.prototype._parseIndexSyntax=ld,oa.prototype._parseStoresSpec=function(h,p){var y=this;o(h).forEach(function(x){if(h[x]!==null){var S=y._parseIndexSyntax(h[x]),_=S.shift();if(!_)throw new wt.Schema("Invalid schema for table "+x+": "+h[x]);if(_.unique=!0,_.multi)throw new wt.Schema("Primary key cannot be multiEntry*");S.forEach(function(O){if(O.auto)throw new wt.Schema("Only primary key can be marked as autoIncrement (++)");if(!O.keyPath)throw new wt.Schema("Index must have a name and cannot be an empty string")}),S=y._createTableSchema(x,_,S),p[x]=S}})},oa.prototype.stores=function(y){var p=this.db;this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,y):y;var y=p._versions,x={},S={};return y.forEach(function(_){u(x,_._cfg.storesSource),S=_._cfg.dbschema={},_._parseStoresSpec(x,S)}),p._dbSchema=S,oc(p,[p._allTables,p,p.Transaction.prototype]),ii(p,[p._allTables,p,p.Transaction.prototype,this._cfg.tables],o(S),S),p._storeNames=o(S),this},oa.prototype.upgrade=function(h){return this._cfg.contentUpgrade=kt(this._cfg.contentUpgrade||F,h),this},oa);function oa(){}function cc(h,p){var y=h._dbNamesDB;return y||(y=h._dbNamesDB=new Ns(ti,{addons:[],indexedDB:h,IDBKeyRange:p})).version(1).stores({dbnames:"name"}),y.table("dbnames")}function lc(h){return h&&typeof h.databases=="function"}function fc(h){return Us(function(){return Vt.letThrough=!0,h()})}function hc(h){return!("from"in h)}var nn=function(h,p){if(!this){var y=new nn;return h&&"d"in h&&u(y,h),y}u(this,arguments.length?{d:1,from:h,to:1<arguments.length?p:h}:{d:0})};function Ya(h,p,y){var x=le(p,y);if(!isNaN(x)){if(0<x)throw RangeError();if(hc(h))return u(h,{from:p,to:y,d:1});var S=h.l,x=h.r;if(le(y,h.from)<0)return S?Ya(S,p,y):h.l={from:p,to:y,d:1,l:null,r:null},hd(h);if(0<le(p,h.to))return x?Ya(x,p,y):h.r={from:p,to:y,d:1,l:null,r:null},hd(h);le(p,h.from)<0&&(h.from=p,h.l=null,h.d=x?x.d+1:1),0<le(y,h.to)&&(h.to=y,h.r=null,h.d=h.l?h.l.d+1:1),y=!h.r,S&&!h.l&&Xa(h,S),x&&y&&Xa(h,x)}}function Xa(h,p){hc(p)||(function y(x,H){var _=H.from,O=H.to,V=H.l,H=H.r;Ya(x,_,O),V&&y(x,V),H&&y(x,H)})(h,p)}function fd(h,p){var y=fi(p),x=y.next();if(x.done)return!1;for(var S=x.value,_=fi(h),O=_.next(S.from),V=O.value;!x.done&&!O.done;){if(le(V.from,S.to)<=0&&0<=le(V.to,S.from))return!0;le(S.from,V.from)<0?S=(x=y.next(V.from)).value:V=(O=_.next(S.from)).value}return!1}function fi(h){var p=hc(h)?null:{s:0,n:h};return{next:function(y){for(var x=0<arguments.length;p;)switch(p.s){case 0:if(p.s=1,x)for(;p.n.l&&le(y,p.n.from)<0;)p={up:p,n:p.n.l,s:1};else for(;p.n.l;)p={up:p,n:p.n.l,s:1};case 1:if(p.s=2,!x||le(y,p.n.to)<=0)return{value:p.n,done:!1};case 2:if(p.n.r){p.s=3,p={up:p,n:p.n.r,s:0};continue}case 3:p=p.up}return{done:!0}}}}function hd(h){var p,y,x=(((p=h.r)===null||p===void 0?void 0:p.d)||0)-(((y=h.l)===null||y===void 0?void 0:y.d)||0),S=1<x?"r":x<-1?"l":"";S&&(p=S=="r"?"l":"r",y=s({},h),x=h[S],h.from=x.from,h.to=x.to,h[S]=x[S],y[S]=x[p],(h[p]=y).d=dd(y)),h.d=dd(h)}function dd(y){var p=y.r,y=y.l;return(p?y?Math.max(p.d,y.d):p.d:y?y.d:0)+1}function hi(h,p){return o(p).forEach(function(y){h[y]?Xa(h[y],p[y]):h[y]=(function x(S){var _,O,V={};for(_ in S)f(S,_)&&(O=S[_],V[_]=!O||typeof O!="object"||E.has(O.constructor)?O:x(O));return V})(p[y])}),h}function dc(h,p){return h.all||p.all||Object.keys(h).some(function(y){return p[y]&&fd(p[y],h[y])})}d(nn.prototype,((Ln={add:function(h){return Xa(this,h),this},addKey:function(h){return Ya(this,h,h),this},addKeys:function(h){var p=this;return h.forEach(function(y){return Ya(p,y,y)}),this},hasKey:function(h){var p=fi(this).next(h).value;return p&&le(p.from,h)<=0&&0<=le(p.to,h)}})[st]=function(){return fi(this)},Ln));var Sr={},pc={},mc=!1;function di(h){hi(pc,h),mc||(mc=!0,setTimeout(function(){mc=!1,gc(pc,!(pc={}))},0))}function gc(h,p){p===void 0&&(p=!1);var y=new Set;if(h.all)for(var x=0,S=Object.values(Sr);x<S.length;x++)pd(O=S[x],h,y,p);else for(var _ in h){var O,V=/^idb\:\/\/(.*)\/(.*)\//.exec(_);V&&(_=V[1],V=V[2],(O=Sr["idb://".concat(_,"/").concat(V)])&&pd(O,h,y,p))}y.forEach(function(H){return H()})}function pd(h,p,y,x){for(var S=[],_=0,O=Object.entries(h.queries.query);_<O.length;_++){for(var V=O[_],H=V[0],q=[],Z=0,B=V[1];Z<B.length;Z++){var Q=B[Z];dc(p,Q.obsSet)?Q.subscribers.forEach(function(J){return y.add(J)}):x&&q.push(Q)}x&&S.push([H,q])}if(x)for(var U=0,G=S;U<G.length;U++){var Y=G[U],H=Y[0],q=Y[1];h.queries.query[H]=q}}function Nw(h){var p=h._state,y=h._deps.indexedDB;if(p.isBeingOpened||h.idbdb)return p.dbReadyPromise.then(function(){return p.dbOpenError?Ve(p.dbOpenError):h});p.isBeingOpened=!0,p.dbOpenError=null,p.openComplete=!1;var x=p.openCanceller,S=Math.round(10*h.verno),_=!1;function O(){if(p.openCanceller!==x)throw new wt.DatabaseClosed("db.open() was cancelled")}function V(){return new Mt(function(Q,U){if(O(),!y)throw new wt.MissingAPI;var G=h.name,Y=p.autoSchema||!S?y.open(G):y.open(G,S);if(!Y)throw new wt.MissingAPI;Y.onerror=ss(U),Y.onblocked=Ce(h._fireOnBlocked),Y.onupgradeneeded=Ce(function(J){var et;Z=Y.transaction,p.autoSchema&&!h._options.allowEmptyDB?(Y.onerror=qa,Z.abort(),Y.result.close(),(et=y.deleteDatabase(G)).onsuccess=et.onerror=Ce(function(){U(new wt.NoSuchDatabase("Database ".concat(G," doesnt exist")))})):(Z.onerror=ss(U),J=J.oldVersion>Math.pow(2,62)?0:J.oldVersion,B=J<1,h.idbdb=Y.result,_&&xw(h,Z),kw(h,J/10,Z,U))},U),Y.onsuccess=Ce(function(){Z=null;var J,et,ot,ft,gt,Et=h.idbdb=Y.result,Ft=I(Et.objectStoreNames);if(0<Ft.length)try{var It=Et.transaction((ft=Ft).length===1?ft[0]:ft,"readonly");if(p.autoSchema)et=Et,ot=It,(J=h).verno=et.version/10,ot=J._dbSchema=ci(0,et,ot),J._storeNames=I(et.objectStoreNames,0),ii(J,[J._allTables],o(ot),ot);else if(li(h,h._dbSchema,It),((gt=ic(ci(0,(gt=h).idbdb,It),gt._dbSchema)).add.length||gt.change.some(function(At){return At.add.length||At.change.length}))&&!_)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Et.close(),S=Et.version+1,_=!0,Q(V());oi(h,It)}catch{}sa.push(h),Et.onversionchange=Ce(function(At){p.vcFired=!0,h.on("versionchange").fire(At)}),Et.onclose=Ce(function(){h.close({disableAutoOpen:!1})}),B&&(gt=h._deps,It=G,Et=gt.indexedDB,gt=gt.IDBKeyRange,lc(Et)||It===ti||cc(Et,gt).put({name:It}).catch(F)),Q()},U)}).catch(function(Q){switch(Q==null?void 0:Q.name){case"UnknownError":if(0<p.PR1398_maxLoop)return p.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),V();break;case"VersionError":if(0<S)return S=0,V()}return Mt.reject(Q)})}var H,q=p.dbReadyResolve,Z=null,B=!1;return Mt.race([x,(typeof navigator>"u"?Mt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function U(){return indexedDB.databases().finally(Q)}H=setInterval(U,100),U()}).finally(function(){return clearInterval(H)}):Promise.resolve()).then(V)]).then(function(){return O(),p.onReadyBeingFired=[],Mt.resolve(fc(function(){return h.on.ready.fire(h.vip)})).then(function Q(){if(0<p.onReadyBeingFired.length){var U=p.onReadyBeingFired.reduce(kt,F);return p.onReadyBeingFired=[],Mt.resolve(fc(function(){return U(h.vip)})).then(Q)}})}).finally(function(){p.openCanceller===x&&(p.onReadyBeingFired=null,p.isBeingOpened=!1)}).catch(function(Q){p.dbOpenError=Q;try{Z&&Z.abort()}catch{}return x===p.openCanceller&&h._close(),Ve(Q)}).finally(function(){p.openComplete=!0,q()}).then(function(){var Q;return B&&(Q={},h.tables.forEach(function(U){U.schema.indexes.forEach(function(G){G.name&&(Q["idb://".concat(h.name,"/").concat(U.name,"/").concat(G.name)]=new nn(-1/0,[[[]]]))}),Q["idb://".concat(h.name,"/").concat(U.name,"/")]=Q["idb://".concat(h.name,"/").concat(U.name,"/:dels")]=new nn(-1/0,[[[]]])}),Zs(Ka).fire(Q),gc(Q,!0)),h})}function yc(h){function p(_){return h.next(_)}var y=S(p),x=S(function(_){return h.throw(_)});function S(_){return function(H){var V=_(H),H=V.value;return V.done?H:H&&typeof H.then=="function"?H.then(y,x):i(H)?Promise.all(H).then(y,x):y(H)}}return S(p)()}function pi(h,p,y){for(var x=i(h)?h.slice():[h],S=0;S<y;++S)x.push(p);return x}var Iw={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(h){return s(s({},h),{table:function(p){var y=h.table(p),x=y.schema,S={},_=[];function O(B,Q,U){var G=Ga(B),Y=S[G]=S[G]||[],J=B==null?0:typeof B=="string"?1:B.length,et=0<Q,et=s(s({},U),{name:et?"".concat(G,"(virtual-from:").concat(U.name,")"):U.name,lowLevelIndex:U,isVirtual:et,keyTail:Q,keyLength:J,extractKey:ac(B),unique:!et&&U.unique});return Y.push(et),et.isPrimaryKey||_.push(et),1<J&&O(J===2?B[0]:B.slice(0,J-1),Q+1,U),Y.sort(function(ot,ft){return ot.keyTail-ft.keyTail}),et}p=O(x.primaryKey.keyPath,0,x.primaryKey),S[":id"]=[p];for(var V=0,H=x.indexes;V<H.length;V++){var q=H[V];O(q.keyPath,0,q)}function Z(B){var Q,U=B.query.index;return U.isVirtual?s(s({},B),{query:{index:U.lowLevelIndex,range:(Q=B.query.range,U=U.keyTail,{type:Q.type===1?2:Q.type,lower:pi(Q.lower,Q.lowerOpen?h.MAX_KEY:h.MIN_KEY,U),lowerOpen:!0,upper:pi(Q.upper,Q.upperOpen?h.MIN_KEY:h.MAX_KEY,U),upperOpen:!0})}}):B}return s(s({},y),{schema:s(s({},x),{primaryKey:p,indexes:_,getIndexByKeyPath:function(B){return(B=S[Ga(B)])&&B[0]}}),count:function(B){return y.count(Z(B))},query:function(B){return y.query(Z(B))},openCursor:function(B){var Q=B.query.index,U=Q.keyTail,G=Q.isVirtual,Y=Q.keyLength;return G?y.openCursor(Z(B)).then(function(et){return et&&J(et)}):y.openCursor(B);function J(et){return Object.create(et,{continue:{value:function(ot){ot!=null?et.continue(pi(ot,B.reverse?h.MAX_KEY:h.MIN_KEY,U)):B.unique?et.continue(et.key.slice(0,Y).concat(B.reverse?h.MIN_KEY:h.MAX_KEY,U)):et.continue()}},continuePrimaryKey:{value:function(ot,ft){et.continuePrimaryKey(pi(ot,h.MAX_KEY,U),ft)}},primaryKey:{get:function(){return et.primaryKey}},key:{get:function(){var ot=et.key;return Y===1?ot[0]:ot.slice(0,Y)}},value:{get:function(){return et.value}}})}}})}})}};function bc(h,p,y,x){return y=y||{},x=x||"",o(h).forEach(function(S){var _,O,V;f(p,S)?(_=h[S],O=p[S],typeof _=="object"&&typeof O=="object"&&_&&O?(V=nt(_))!==nt(O)?y[x+S]=p[S]:V==="Object"?bc(_,O,y,x+S+"."):_!==O&&(y[x+S]=p[S]):_!==O&&(y[x+S]=p[S])):y[x+S]=void 0}),o(p).forEach(function(S){f(h,S)||(y[x+S]=p[S])}),y}function wc(h,p){return p.type==="delete"?p.keys:p.keys||p.values.map(h.extractKey)}var _w={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(h){return s(s({},h),{table:function(p){var y=h.table(p),x=y.schema.primaryKey;return s(s({},y),{mutate:function(S){var _=Vt.trans,O=_.table(p).hook,V=O.deleting,H=O.creating,q=O.updating;switch(S.type){case"add":if(H.fire===F)break;return _._promise("readwrite",function(){return Z(S)},!0);case"put":if(H.fire===F&&q.fire===F)break;return _._promise("readwrite",function(){return Z(S)},!0);case"delete":if(V.fire===F)break;return _._promise("readwrite",function(){return Z(S)},!0);case"deleteRange":if(V.fire===F)break;return _._promise("readwrite",function(){return(function B(Q,U,G){return y.query({trans:Q,values:!1,query:{index:x,range:U},limit:G}).then(function(Y){var J=Y.result;return Z({type:"delete",keys:J,trans:Q}).then(function(et){return 0<et.numFailures?Promise.reject(et.failures[0]):J.length<G?{failures:[],numFailures:0,lastResult:void 0}:B(Q,s(s({},U),{lower:J[J.length-1],lowerOpen:!0}),G)})})})(S.trans,S.range,1e4)},!0)}return y.mutate(S);function Z(B){var Q,U,G,Y=Vt.trans,J=B.keys||wc(x,B);if(!J)throw new Error("Keys missing");return(B=B.type==="add"||B.type==="put"?s(s({},B),{keys:J}):s({},B)).type!=="delete"&&(B.values=r([],B.values)),B.keys&&(B.keys=r([],B.keys)),Q=y,G=J,((U=B).type==="add"?Promise.resolve([]):Q.getMany({trans:U.trans,keys:G,cache:"immutable"})).then(function(et){var ot=J.map(function(ft,gt){var Et,Ft,It,At=et[gt],Rt={onerror:null,onsuccess:null};return B.type==="delete"?V.fire.call(Rt,ft,At,Y):B.type==="add"||At===void 0?(Et=H.fire.call(Rt,ft,B.values[gt],Y),ft==null&&Et!=null&&(B.keys[gt]=ft=Et,x.outbound||P(B.values[gt],x.keyPath,ft))):(Et=bc(At,B.values[gt]),(Ft=q.fire.call(Rt,Et,ft,At,Y))&&(It=B.values[gt],Object.keys(Ft).forEach(function(Dt){f(It,Dt)?It[Dt]=Ft[Dt]:P(It,Dt,Ft[Dt])}))),Rt});return y.mutate(B).then(function(ft){for(var gt=ft.failures,Et=ft.results,Ft=ft.numFailures,ft=ft.lastResult,It=0;It<J.length;++It){var At=(Et||J)[It],Rt=ot[It];At==null?Rt.onerror&&Rt.onerror(gt[It]):Rt.onsuccess&&Rt.onsuccess(B.type==="put"&&et[It]?B.values[It]:At)}return{failures:gt,results:Et,numFailures:Ft,lastResult:ft}}).catch(function(ft){return ot.forEach(function(gt){return gt.onerror&&gt.onerror(ft)}),Promise.reject(ft)})})}}})}})}};function md(h,p,y){try{if(!p||p.keys.length<h.length)return null;for(var x=[],S=0,_=0;S<p.keys.length&&_<h.length;++S)le(p.keys[S],h[_])===0&&(x.push(y?X(p.values[S]):p.values[S]),++_);return x.length===h.length?x:null}catch{return null}}var Tw={stack:"dbcore",level:-1,create:function(h){return{table:function(p){var y=h.table(p);return s(s({},y),{getMany:function(x){if(!x.cache)return y.getMany(x);var S=md(x.keys,x.trans._cache,x.cache==="clone");return S?Mt.resolve(S):y.getMany(x).then(function(_){return x.trans._cache={keys:x.keys,values:x.cache==="clone"?X(_):_},_})},mutate:function(x){return x.type!=="add"&&(x.trans._cache=null),y.mutate(x)}})}}}};function gd(h,p){return h.trans.mode==="readonly"&&!!h.subscr&&!h.trans.explicit&&h.trans.db._options.cache!=="disabled"&&!p.schema.primaryKey.outbound}function yd(h,p){switch(h){case"query":return p.values&&!p.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ew={stack:"dbcore",level:0,name:"Observability",create:function(h){var p=h.schema.name,y=new nn(h.MIN_KEY,h.MAX_KEY);return s(s({},h),{transaction:function(x,S,_){if(Vt.subscr&&S!=="readonly")throw new wt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Vt.querier));return h.transaction(x,S,_)},table:function(x){var S=h.table(x),_=S.schema,O=_.primaryKey,B=_.indexes,V=O.extractKey,H=O.outbound,q=O.autoIncrement&&B.filter(function(U){return U.compound&&U.keyPath.includes(O.keyPath)}),Z=s(s({},S),{mutate:function(U){function G(Dt){return Dt="idb://".concat(p,"/").concat(x,"/").concat(Dt),ft[Dt]||(ft[Dt]=new nn)}var Y,J,et,ot=U.trans,ft=U.mutatedParts||(U.mutatedParts={}),gt=G(""),Et=G(":dels"),Ft=U.type,Rt=U.type==="deleteRange"?[U.range]:U.type==="delete"?[U.keys]:U.values.length<50?[wc(O,U).filter(function(Dt){return Dt}),U.values]:[],It=Rt[0],At=Rt[1],Rt=U.trans._cache;return i(It)?(gt.addKeys(It),(Rt=Ft==="delete"||It.length===At.length?md(It,Rt):null)||Et.addKeys(It),(Rt||At)&&(Y=G,J=Rt,et=At,_.indexes.forEach(function(Dt){var Wt=Y(Dt.name||"");function se(ue){return ue!=null?Dt.extractKey(ue):null}function ae(ue){return Dt.multiEntry&&i(ue)?ue.forEach(function(On){return Wt.addKey(On)}):Wt.addKey(ue)}(J||et).forEach(function(ue,sn){var te=J&&se(J[sn]),sn=et&&se(et[sn]);le(te,sn)!==0&&(te!=null&&ae(te),sn!=null&&ae(sn))})}))):It?(At={from:(At=It.lower)!==null&&At!==void 0?At:h.MIN_KEY,to:(At=It.upper)!==null&&At!==void 0?At:h.MAX_KEY},Et.add(At),gt.add(At)):(gt.add(y),Et.add(y),_.indexes.forEach(function(Dt){return G(Dt.name).add(y)})),S.mutate(U).then(function(Dt){return!It||U.type!=="add"&&U.type!=="put"||(gt.addKeys(Dt.results),q&&q.forEach(function(Wt){for(var se=U.values.map(function(te){return Wt.extractKey(te)}),ae=Wt.keyPath.findIndex(function(te){return te===O.keyPath}),ue=0,On=Dt.results.length;ue<On;++ue)se[ue][ae]=Dt.results[ue];G(Wt.name).addKeys(se)})),ot.mutatedParts=hi(ot.mutatedParts||{},ft),Dt})}}),B=function(G){var Y=G.query,G=Y.index,Y=Y.range;return[G,new nn((G=Y.lower)!==null&&G!==void 0?G:h.MIN_KEY,(Y=Y.upper)!==null&&Y!==void 0?Y:h.MAX_KEY)]},Q={get:function(U){return[O,new nn(U.key)]},getMany:function(U){return[O,new nn().addKeys(U.keys)]},count:B,query:B,openCursor:B};return o(Q).forEach(function(U){Z[U]=function(G){var Y=Vt.subscr,J=!!Y,et=gd(Vt,S)&&yd(U,G)?G.obsSet={}:Y;if(J){var ot=function(At){return At="idb://".concat(p,"/").concat(x,"/").concat(At),et[At]||(et[At]=new nn)},ft=ot(""),gt=ot(":dels"),Y=Q[U](G),J=Y[0],Y=Y[1];if((U==="query"&&J.isPrimaryKey&&!G.values?gt:ot(J.name||"")).add(Y),!J.isPrimaryKey){if(U!=="count"){var Et=U==="query"&&H&&G.values&&S.query(s(s({},G),{values:!1}));return S[U].apply(this,arguments).then(function(At){if(U==="query"){if(H&&G.values)return Et.then(function(se){return se=se.result,ft.addKeys(se),At});var Rt=G.values?At.result.map(V):At.result;(G.values?ft:gt).addKeys(Rt)}else if(U==="openCursor"){var Dt=At,Wt=G.values;return Dt&&Object.create(Dt,{key:{get:function(){return gt.addKey(Dt.primaryKey),Dt.key}},primaryKey:{get:function(){var se=Dt.primaryKey;return gt.addKey(se),se}},value:{get:function(){return Wt&&ft.addKey(Dt.primaryKey),Dt.value}}})}return At})}gt.add(y)}}return S[U].apply(this,arguments)}}),Z}})}};function bd(h,p,y){if(y.numFailures===0)return p;if(p.type==="deleteRange")return null;var x=p.keys?p.keys.length:"values"in p&&p.values?p.values.length:1;return y.numFailures===x?null:(p=s({},p),i(p.keys)&&(p.keys=p.keys.filter(function(S,_){return!(_ in y.failures)})),"values"in p&&i(p.values)&&(p.values=p.values.filter(function(S,_){return!(_ in y.failures)})),p)}function vc(h,p){return y=h,((x=p).lower===void 0||(x.lowerOpen?0<le(y,x.lower):0<=le(y,x.lower)))&&(h=h,(p=p).upper===void 0||(p.upperOpen?le(h,p.upper)<0:le(h,p.upper)<=0));var y,x}function wd(h,p,Q,x,S,_){if(!Q||Q.length===0)return h;var O=p.query.index,V=O.multiEntry,H=p.query.range,q=x.schema.primaryKey.extractKey,Z=O.extractKey,B=(O.lowLevelIndex||O).extractKey,Q=Q.reduce(function(U,G){var Y=U,J=[];if(G.type==="add"||G.type==="put")for(var et=new nn,ot=G.values.length-1;0<=ot;--ot){var ft,gt=G.values[ot],Et=q(gt);et.hasKey(Et)||(ft=Z(gt),(V&&i(ft)?ft.some(function(Dt){return vc(Dt,H)}):vc(ft,H))&&(et.addKey(Et),J.push(gt)))}switch(G.type){case"add":var Ft=new nn().addKeys(p.values?U.map(function(Wt){return q(Wt)}):U),Y=U.concat(p.values?J.filter(function(Wt){return Wt=q(Wt),!Ft.hasKey(Wt)&&(Ft.addKey(Wt),!0)}):J.map(function(Wt){return q(Wt)}).filter(function(Wt){return!Ft.hasKey(Wt)&&(Ft.addKey(Wt),!0)}));break;case"put":var It=new nn().addKeys(G.values.map(function(Wt){return q(Wt)}));Y=U.filter(function(Wt){return!It.hasKey(p.values?q(Wt):Wt)}).concat(p.values?J:J.map(function(Wt){return q(Wt)}));break;case"delete":var At=new nn().addKeys(G.keys);Y=U.filter(function(Wt){return!At.hasKey(p.values?q(Wt):Wt)});break;case"deleteRange":var Rt=G.range;Y=U.filter(function(Wt){return!vc(q(Wt),Rt)})}return Y},h);return Q===h?h:(Q.sort(function(U,G){return le(B(U),B(G))||le(q(U),q(G))}),p.limit&&p.limit<1/0&&(Q.length>p.limit?Q.length=p.limit:h.length===p.limit&&Q.length<p.limit&&(S.dirty=!0)),_?Object.freeze(Q):Q)}function vd(h,p){return le(h.lower,p.lower)===0&&le(h.upper,p.upper)===0&&!!h.lowerOpen==!!p.lowerOpen&&!!h.upperOpen==!!p.upperOpen}function $w(h,p){return(function(y,x,S,_){if(y===void 0)return x!==void 0?-1:0;if(x===void 0)return 1;if((x=le(y,x))===0){if(S&&_)return 0;if(S)return 1;if(_)return-1}return x})(h.lower,p.lower,h.lowerOpen,p.lowerOpen)<=0&&0<=(function(y,x,S,_){if(y===void 0)return x!==void 0?1:0;if(x===void 0)return-1;if((x=le(y,x))===0){if(S&&_)return 0;if(S)return-1;if(_)return 1}return x})(h.upper,p.upper,h.upperOpen,p.upperOpen)}function Cw(h,p,y,x){h.subscribers.add(y),x.addEventListener("abort",function(){var S,_;h.subscribers.delete(y),h.subscribers.size===0&&(S=h,_=p,setTimeout(function(){S.subscribers.size===0&&tt(_,S)},3e3))})}var Aw={stack:"dbcore",level:0,name:"Cache",create:function(h){var p=h.schema.name;return s(s({},h),{transaction:function(y,x,S){var _,O,V=h.transaction(y,x,S);return x==="readwrite"&&(O=(_=new AbortController).signal,S=function(H){return function(){if(_.abort(),x==="readwrite"){for(var q=new Set,Z=0,B=y;Z<B.length;Z++){var Q=B[Z],U=Sr["idb://".concat(p,"/").concat(Q)];if(U){var G=h.table(Q),Y=U.optimisticOps.filter(function(Wt){return Wt.trans===V});if(V._explicit&&H&&V.mutatedParts)for(var J=0,et=Object.values(U.queries.query);J<et.length;J++)for(var ot=0,ft=(Ft=et[J]).slice();ot<ft.length;ot++)dc((It=ft[ot]).obsSet,V.mutatedParts)&&(tt(Ft,It),It.subscribers.forEach(function(Wt){return q.add(Wt)}));else if(0<Y.length){U.optimisticOps=U.optimisticOps.filter(function(Wt){return Wt.trans!==V});for(var gt=0,Et=Object.values(U.queries.query);gt<Et.length;gt++)for(var Ft,It,At,Rt=0,Dt=(Ft=Et[gt]).slice();Rt<Dt.length;Rt++)(It=Dt[Rt]).res!=null&&V.mutatedParts&&(H&&!It.dirty?(At=Object.isFrozen(It.res),At=wd(It.res,It.req,Y,G,It,At),It.dirty?(tt(Ft,It),It.subscribers.forEach(function(Wt){return q.add(Wt)})):At!==It.res&&(It.res=At,It.promise=Mt.resolve({result:At}))):(It.dirty&&tt(Ft,It),It.subscribers.forEach(function(Wt){return q.add(Wt)})))}}}q.forEach(function(Wt){return Wt()})}}},V.addEventListener("abort",S(!1),{signal:O}),V.addEventListener("error",S(!1),{signal:O}),V.addEventListener("complete",S(!0),{signal:O})),V},table:function(y){var x=h.table(y),S=x.schema.primaryKey;return s(s({},x),{mutate:function(_){var O=Vt.trans;if(S.outbound||O.db._options.cache==="disabled"||O.explicit||O.idbtrans.mode!=="readwrite")return x.mutate(_);var V=Sr["idb://".concat(p,"/").concat(y)];return V?(O=x.mutate(_),_.type!=="add"&&_.type!=="put"||!(50<=_.values.length||wc(S,_).some(function(H){return H==null}))?(V.optimisticOps.push(_),_.mutatedParts&&di(_.mutatedParts),O.then(function(H){0<H.numFailures&&(tt(V.optimisticOps,_),(H=bd(0,_,H))&&V.optimisticOps.push(H),_.mutatedParts&&di(_.mutatedParts))}),O.catch(function(){tt(V.optimisticOps,_),_.mutatedParts&&di(_.mutatedParts)})):O.then(function(H){var q=bd(0,s(s({},_),{values:_.values.map(function(Z,B){var Q;return H.failures[B]||(Z=(Q=S.keyPath)!==null&&Q!==void 0&&Q.includes(".")?X(Z):s({},Z),P(Z,S.keyPath,H.results[B])),Z})}),H);V.optimisticOps.push(q),queueMicrotask(function(){return _.mutatedParts&&di(_.mutatedParts)})}),O):x.mutate(_)},query:function(_){if(!gd(Vt,x)||!yd("query",_))return x.query(_);var O=((q=Vt.trans)===null||q===void 0?void 0:q.db._options.cache)==="immutable",B=Vt,V=B.requery,H=B.signal,q=(function(G,Y,J,et){var ot=Sr["idb://".concat(G,"/").concat(Y)];if(!ot)return[];if(!(Y=ot.queries[J]))return[null,!1,ot,null];var ft=Y[(et.query?et.query.index.name:null)||""];if(!ft)return[null,!1,ot,null];switch(J){case"query":var gt=ft.find(function(Et){return Et.req.limit===et.limit&&Et.req.values===et.values&&vd(Et.req.query.range,et.query.range)});return gt?[gt,!0,ot,ft]:[ft.find(function(Et){return("limit"in Et.req?Et.req.limit:1/0)>=et.limit&&(!et.values||Et.req.values)&&$w(Et.req.query.range,et.query.range)}),!1,ot,ft];case"count":return gt=ft.find(function(Et){return vd(Et.req.query.range,et.query.range)}),[gt,!!gt,ot,ft]}})(p,y,"query",_),Z=q[0],B=q[1],Q=q[2],U=q[3];return Z&&B?Z.obsSet=_.obsSet:(B=x.query(_).then(function(G){var Y=G.result;if(Z&&(Z.res=Y),O){for(var J=0,et=Y.length;J<et;++J)Object.freeze(Y[J]);Object.freeze(Y)}else G.result=X(Y);return G}).catch(function(G){return U&&Z&&tt(U,Z),Promise.reject(G)}),Z={obsSet:_.obsSet,promise:B,subscribers:new Set,type:"query",req:_,dirty:!1},U?U.push(Z):(U=[Z],(Q=Q||(Sr["idb://".concat(p,"/").concat(y)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[_.query.index.name||""]=U)),Cw(Z,U,V,H),Z.promise.then(function(G){return{result:wd(G.result,_,Q==null?void 0:Q.optimisticOps,x,Z,O)}})}})}})}};function mi(h,p){return new Proxy(h,{get:function(y,x,S){return x==="db"?p:Reflect.get(y,x,S)}})}var Ns=(Le.prototype.version=function(h){if(isNaN(h)||h<.1)throw new wt.Type("Given version is not a positive number");if(h=Math.round(10*h)/10,this.idbdb||this._state.isBeingOpened)throw new wt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,h);var p=this._versions,y=p.filter(function(x){return x._cfg.version===h})[0];return y||(y=new this.Version(h),p.push(y),p.sort(vw),y.stores({}),this._state.autoSchema=!1,y)},Le.prototype._whenReady=function(h){var p=this;return this.idbdb&&(this._state.openComplete||Vt.letThrough||this._vip)?h():new Mt(function(y,x){if(p._state.openComplete)return x(new wt.DatabaseClosed(p._state.dbOpenError));if(!p._state.isBeingOpened){if(!p._state.autoOpen)return void x(new wt.DatabaseClosed);p.open().catch(F)}p._state.dbReadyPromise.then(y,x)}).then(h)},Le.prototype.use=function(h){var p=h.stack,y=h.create,x=h.level,S=h.name;return S&&this.unuse({stack:p,name:S}),h=this._middlewares[p]||(this._middlewares[p]=[]),h.push({stack:p,create:y,level:x??10,name:S}),h.sort(function(_,O){return _.level-O.level}),this},Le.prototype.unuse=function(h){var p=h.stack,y=h.name,x=h.create;return p&&this._middlewares[p]&&(this._middlewares[p]=this._middlewares[p].filter(function(S){return x?S.create!==x:!!y&&S.name!==y})),this},Le.prototype.open=function(){var h=this;return vr($e,function(){return Nw(h)})},Le.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var h=this._state,p=sa.indexOf(this);if(0<=p&&sa.splice(p,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}h.isBeingOpened||(h.dbReadyPromise=new Mt(function(y){h.dbReadyResolve=y}),h.openCanceller=new Mt(function(y,x){h.cancelOpen=x}))},Le.prototype.close=function(y){var p=(y===void 0?{disableAutoOpen:!0}:y).disableAutoOpen,y=this._state;p?(y.isBeingOpened&&y.cancelOpen(new wt.DatabaseClosed),this._close(),y.autoOpen=!1,y.dbOpenError=new wt.DatabaseClosed):(this._close(),y.autoOpen=this._options.autoOpen||y.isBeingOpened,y.openComplete=!1,y.dbOpenError=null)},Le.prototype.delete=function(h){var p=this;h===void 0&&(h={disableAutoOpen:!0});var y=0<arguments.length&&typeof arguments[0]!="object",x=this._state;return new Mt(function(S,_){function O(){p.close(h);var V=p._deps.indexedDB.deleteDatabase(p.name);V.onsuccess=Ce(function(){var H,q,Z;H=p._deps,q=p.name,Z=H.indexedDB,H=H.IDBKeyRange,lc(Z)||q===ti||cc(Z,H).delete(q).catch(F),S()}),V.onerror=ss(_),V.onblocked=p._fireOnBlocked}if(y)throw new wt.InvalidArgument("Invalid closeOptions argument to db.delete()");x.isBeingOpened?x.dbReadyPromise.then(O):O()})},Le.prototype.backendDB=function(){return this.idbdb},Le.prototype.isOpen=function(){return this.idbdb!==null},Le.prototype.hasBeenClosed=function(){var h=this._state.dbOpenError;return h&&h.name==="DatabaseClosed"},Le.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Le.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Le.prototype,"tables",{get:function(){var h=this;return o(this._allTables).map(function(p){return h._allTables[p]})},enumerable:!1,configurable:!0}),Le.prototype.transaction=function(){var h=(function(p,y,x){var S=arguments.length;if(S<2)throw new wt.InvalidArgument("Too few arguments");for(var _=new Array(S-1);--S;)_[S-1]=arguments[S];return x=_.pop(),[p,M(_),x]}).apply(this,arguments);return this._transaction.apply(this,h)},Le.prototype._transaction=function(h,p,y){var x=this,S=Vt.trans;S&&S.db===this&&h.indexOf("!")===-1||(S=null);var _,O,V=h.indexOf("?")!==-1;h=h.replace("!","").replace("?","");try{if(O=p.map(function(q){if(q=q instanceof x.Table?q.name:q,typeof q!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return q}),h=="r"||h===Ju)_=Ju;else{if(h!="rw"&&h!=Qu)throw new wt.InvalidArgument("Invalid transaction mode: "+h);_=Qu}if(S){if(S.mode===Ju&&_===Qu){if(!V)throw new wt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");S=null}S&&O.forEach(function(q){if(S&&S.storeNames.indexOf(q)===-1){if(!V)throw new wt.SubTransaction("Table "+q+" not included in parent transaction.");S=null}}),V&&S&&!S.active&&(S=null)}}catch(q){return S?S._promise(null,function(Z,B){B(q)}):Ve(q)}var H=(function q(Z,B,Q,U,G){return Mt.resolve().then(function(){var Y=Vt.transless||Vt,J=Z._createTransaction(B,Q,Z._dbSchema,U);if(J.explicit=!0,Y={trans:J,transless:Y},U)J.idbtrans=U.idbtrans;else try{J.create(),J.idbtrans._explicit=!0,Z._state.PR1398_maxLoop=3}catch(ft){return ft.name===Lt.InvalidState&&Z.isOpen()&&0<--Z._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Z.close({disableAutoOpen:!1}),Z.open().then(function(){return q(Z,B,Q,null,G)})):Ve(ft)}var et,ot=mt(G);return ot&&na(),Y=Mt.follow(function(){var ft;(et=G.call(J,J))&&(ot?(ft=Gs.bind(null,null),et.then(ft,ft)):typeof et.next=="function"&&typeof et.throw=="function"&&(et=yc(et)))},Y),(et&&typeof et.then=="function"?Mt.resolve(et).then(function(ft){return J.active?ft:Ve(new wt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Y.then(function(){return et})).then(function(ft){return U&&J._resolve(),J._completion.then(function(){return ft})}).catch(function(ft){return J._reject(ft),Ve(ft)})})}).bind(null,this,_,O,S,y);return S?S._promise(_,H,"lock"):Vt.trans?vr(Vt.transless,function(){return x._whenReady(H)}):this._whenReady(H)},Le.prototype.table=function(h){if(!f(this._allTables,h))throw new wt.InvalidTable("Table ".concat(h," does not exist"));return this._allTables[h]},Le);function Le(h,p){var y=this;this._middlewares={},this.verno=0;var x=Le.dependencies;this._options=p=s({addons:Le.addons,autoOpen:!0,indexedDB:x.indexedDB,IDBKeyRange:x.IDBKeyRange,cache:"cloned"},p),this._deps={indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange},x=p.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var S,_,O,V,H,q={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:F,dbReadyPromise:null,cancelOpen:F,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:p.autoOpen};q.dbReadyPromise=new Mt(function(B){q.dbReadyResolve=B}),q.openCanceller=new Mt(function(B,Q){q.cancelOpen=Q}),this._state=q,this.name=h,this.on=ja(this,"populate","blocked","versionchange","close",{ready:[kt,F]}),this.once=function(B,Q){var U=function(){for(var G=[],Y=0;Y<arguments.length;Y++)G[Y]=arguments[Y];y.on(B).unsubscribe(U),Q.apply(y,G)};return y.on(B,U)},this.on.ready.subscribe=T(this.on.ready.subscribe,function(B){return function(Q,U){Le.vip(function(){var G,Y=y._state;Y.openComplete?(Y.dbOpenError||Mt.resolve().then(Q),U&&B(Q)):Y.onReadyBeingFired?(Y.onReadyBeingFired.push(Q),U&&B(Q)):(B(Q),G=y,U||B(function J(){G.on.ready.unsubscribe(Q),G.on.ready.unsubscribe(J)}))})}}),this.Collection=(S=this,Ha(dw.prototype,function(et,J){this.db=S;var U=Yh,G=null;if(J)try{U=J()}catch(ot){G=ot}var Y=et._ctx,J=Y.table,et=J.hook.reading.fire;this._ctx={table:J,index:Y.index,isPrimKey:!Y.index||J.schema.primKey.keyPath&&Y.index===J.schema.primKey.name,range:U,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:G,or:Y.or,valueMapper:et!==W?et:null}})),this.Table=(_=this,Ha(ed.prototype,function(B,Q,U){this.db=_,this._tx=U,this.name=B,this.schema=Q,this.hook=_._allTables[B]?_._allTables[B].hook:ja(null,{creating:[ct,F],reading:[at,W],updating:[xt,F],deleting:[dt,F]})})),this.Transaction=(O=this,Ha(gw.prototype,function(B,Q,U,G,Y){var J=this;B!=="readonly"&&Q.forEach(function(et){et=(et=U[et])===null||et===void 0?void 0:et.yProps,et&&(Q=Q.concat(et.map(function(ot){return ot.updatesTable})))}),this.db=O,this.mode=B,this.storeNames=Q,this.schema=U,this.chromeTransactionDurability=G,this.idbtrans=null,this.on=ja(this,"complete","error","abort"),this.parent=Y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Mt(function(et,ot){J._resolve=et,J._reject=ot}),this._completion.then(function(){J.active=!1,J.on.complete.fire()},function(et){var ot=J.active;return J.active=!1,J.on.error.fire(et),J.parent?J.parent._reject(et):ot&&J.idbtrans&&J.idbtrans.abort(),Ve(et)})})),this.Version=(V=this,Ha(Sw.prototype,function(B){this.db=V,this._cfg={version:B,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(H=this,Ha(od.prototype,function(B,Q,U){if(this.db=H,this._ctx={table:B,index:Q===":id"?null:Q,or:U},this._cmp=this._ascending=le,this._descending=function(G,Y){return le(Y,G)},this._max=function(G,Y){return 0<le(G,Y)?G:Y},this._min=function(G,Y){return le(G,Y)<0?G:Y},this._IDBKeyRange=H._deps.IDBKeyRange,!this._IDBKeyRange)throw new wt.MissingAPI})),this.on("versionchange",function(B){0<B.newVersion?console.warn("Another connection wants to upgrade database '".concat(y.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(y.name,"'. Closing db now to resume the delete request.")),y.close({disableAutoOpen:!1})}),this.on("blocked",function(B){!B.newVersion||B.newVersion<B.oldVersion?console.warn("Dexie.delete('".concat(y.name,"') was blocked")):console.warn("Upgrade '".concat(y.name,"' blocked by other connection holding version ").concat(B.oldVersion/10))}),this._maxKey=Ua(p.IDBKeyRange),this._createTransaction=function(B,Q,U,G){return new y.Transaction(B,Q,U,y._options.chromeTransactionDurability,G)},this._fireOnBlocked=function(B){y.on("blocked").fire(B),sa.filter(function(Q){return Q.name===y.name&&Q!==y&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire(B)})},this.use(Tw),this.use(Aw),this.use(Ew),this.use(Iw),this.use(_w);var Z=new Proxy(this,{get:function(B,Q,U){if(Q==="_vip")return!0;if(Q==="table")return function(Y){return mi(y.table(Y),Z)};var G=Reflect.get(B,Q,U);return G instanceof ed?mi(G,Z):Q==="tables"?G.map(function(Y){return mi(Y,Z)}):Q==="_createTransaction"?function(){return mi(G.apply(this,arguments),Z)}:G}});this.vip=Z,x.forEach(function(B){return B(y)})}var gi,Ln=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Dw=(kc.prototype.subscribe=function(h,p,y){return this._subscribe(h&&typeof h!="function"?h:{next:h,error:p,complete:y})},kc.prototype[Ln]=function(){return this},kc);function kc(h){this._subscribe=h}try{gi={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{gi={indexedDB:null,IDBKeyRange:null}}function kd(h){var p,y=!1,x=new Dw(function(S){var _=mt(h),O,V=!1,H={},q={},Z={get closed(){return V},unsubscribe:function(){V||(V=!0,O&&O.abort(),B&&Zs.storagemutated.unsubscribe(U))}};S.start&&S.start(Z);var B=!1,Q=function(){return Zu(G)},U=function(Y){hi(H,Y),dc(q,H)&&Q()},G=function(){var Y,J,et;!V&&gi.indexedDB&&(H={},Y={},O&&O.abort(),O=new AbortController,et=(function(ot){var ft=ta();try{_&&na();var gt=Us(h,ot);return gt=_?gt.finally(Gs):gt}finally{ft&&ea()}})(J={subscr:Y,signal:O.signal,requery:Q,querier:h,trans:null}),Promise.resolve(et).then(function(ot){y=!0,p=ot,V||J.signal.aborted||(H={},(function(ft){for(var gt in ft)if(f(ft,gt))return;return 1})(q=Y)||B||(Zs(Ka,U),B=!0),Zu(function(){return!V&&S.next&&S.next(ot)}))},function(ot){y=!1,["DatabaseClosedError","AbortError"].includes(ot==null?void 0:ot.name)||V||Zu(function(){V||S.error&&S.error(ot)})}))};return setTimeout(Q,0),Z});return x.hasValue=function(){return y},x.getValue=function(){return p},x}var Nr=Ns;function xc(h){var p=Js;try{Js=!0,Zs.storagemutated.fire(h),gc(h,!0)}finally{Js=p}}d(Nr,s(s({},Jt),{delete:function(h){return new Nr(h,{addons:[]}).delete()},exists:function(h){return new Nr(h,{addons:[]}).open().then(function(p){return p.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(h){try{return p=Nr.dependencies,y=p.indexedDB,p=p.IDBKeyRange,(lc(y)?Promise.resolve(y.databases()).then(function(x){return x.map(function(S){return S.name}).filter(function(S){return S!==ti})}):cc(y,p).toCollection().primaryKeys()).then(h)}catch{return Ve(new wt.MissingAPI)}var p,y},defineClass:function(){return function(h){u(this,h)}},ignoreTransaction:function(h){return Vt.trans?vr(Vt.transless,h):h()},vip:fc,async:function(h){return function(){try{var p=yc(h.apply(this,arguments));return p&&typeof p.then=="function"?p:Mt.resolve(p)}catch(y){return Ve(y)}}},spawn:function(h,p,y){try{var x=yc(h.apply(y,p||[]));return x&&typeof x.then=="function"?x:Mt.resolve(x)}catch(S){return Ve(S)}},currentTransaction:{get:function(){return Vt.trans||null}},waitFor:function(h,p){return p=Mt.resolve(typeof h=="function"?Nr.ignoreTransaction(h):h).timeout(p||6e4),Vt.trans?Vt.trans.waitFor(p):p},Promise:Mt,debug:{get:function(){return yt},set:function(h){zt(h)}},derive:w,extend:u,props:d,override:T,Events:ja,on:Zs,liveQuery:kd,extendObservabilitySet:hi,getByKeyPath:D,setByKeyPath:P,delByKeyPath:function(h,p){typeof p=="string"?P(h,p,void 0):"length"in p&&[].map.call(p,function(y){P(h,y,void 0)})},shallowClone:L,deepClone:X,getObjectDiff:bc,cmp:le,asap:$,minKey:-1/0,addons:[],connections:sa,errnames:Lt,dependencies:gi,cache:Sr,semVer:"4.2.1",version:"4.2.1".split(".").map(function(h){return parseInt(h)}).reduce(function(h,p,y){return h+p/Math.pow(10,2*y)})})),Nr.maxKey=Ua(Nr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Zs(Ka,function(h){Js||(h=new CustomEvent(nc,{detail:h}),Js=!0,dispatchEvent(h),Js=!1)}),addEventListener(nc,function(h){h=h.detail,Js||xc(h)}));var ia,Js=!1,xd=function(){};return typeof BroadcastChannel<"u"&&((xd=function(){(ia=new BroadcastChannel(nc)).onmessage=function(h){return h.data&&xc(h.data)}})(),typeof ia.unref=="function"&&ia.unref(),Zs(Ka,function(h){Js||ia.postMessage(h)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(h){if(!Ns.disableBfCache&&h.persisted){yt&&console.debug("Dexie: handling persisted pagehide"),ia!=null&&ia.close();for(var p=0,y=sa;p<y.length;p++)y[p].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(h){!Ns.disableBfCache&&h.persisted&&(yt&&console.debug("Dexie: handling persisted pageshow"),xd(),xc({all:new nn(-1/0,[[]])}))})),Mt.rejectionMapper=function(h,p){return!h||h instanceof bt||h instanceof TypeError||h instanceof SyntaxError||!h.name||!Ut[h.name]?h:(p=new Ut[h.name](p||h.message,h),"stack"in h&&g(p,"stack",{get:function(){return this.inner.stack}}),p)},zt(yt),s(Ns,Object.freeze({__proto__:null,Dexie:Ns,liveQuery:kd,Entity:Xh,cmp:le,PropModification:Wa,replacePrefix:function(h,p){return new Wa({replacePrefix:[h,p]})},add:function(h){return new Wa({add:h})},remove:function(h){return new Wa({remove:h})},default:Ns,RangeSet:nn,mergeRanges:Xa,rangesOverlap:fd}),{default:Ns}),Ns})})(zl)),zl.exports}var WL=BL();const Bl=LL(WL),Xp=Symbol.for("Dexie"),mu=globalThis[Xp]||(globalThis[Xp]=Bl);if(Bl.semVer!==mu.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Bl.semVer} and ${mu.semVer}`);const{liveQuery:Y6,mergeRanges:X6,rangesOverlap:Z6,RangeSet:J6,cmp:Q6,Entity:tU,PropModification:eU,replacePrefix:nU,add:sU,remove:rU,DexieYProvider:aU}=mu;var jL="",HL="",qL="",KL="",UL="",GL="",YL="",XL="",ZL="",JL="",QL="",tz="",ez="",nz="",sz="",rz="",az="",oz="",iz="",uz="",cz="",lz="",fz="",hz="",dz="",pz="",mz="",gz="",yz="",bz="",wz="",vz="",kz="",xz="",Sz="",Nz="",Iz="",_z="",Tz="",Ez="",$z="",Cz="",Az="",Dz="",Oz="",Fz="",Rz="",Pz="",Mz="",Vz="",Lz="",zz="",Bz="",Wz="",jz="",Hz="",qz="",Kz="",Uz="",Gz="",Yz="",Xz="",Zz="",Jz="",Qz="",tB="",eB="",nB="",sB="",rB="",aB="",oB="",iB="",uB="",cB="",lB="",fB="",hB="",dB="",pB="",mB="",gB="",yB="",bB="",wB="",vB="",kB="",xB="",SB="",NB="",IB="",_B="",TB="",EB="",$B="",CB="",AB="",DB="",OB="",FB="",RB="",PB="",MB="",VB="",LB="",zB="",BB="",WB="",jB="",HB="",qB="",KB="",UB="",GB="",YB="",XB="",ZB="",JB="",QB="",tW="",eW="",nW="",sW="",rW="",aW="",oW="",iW="",uW="",cW="",lW="",fW="",hW="",dW="",pW="",mW="",gW="",yW="",bW="",wW="",vW="",kW="",xW="",SW="",NW="",IW="",_W="",TW="",EW="",$W="",CW="",AW="",DW="",OW="",FW="",RW="",PW="",MW="",VW="",LW="",zW="",BW="",WW="",jW="",HW="",qW="",KW="",UW="",GW="",YW="",XW="",ZW="",JW="",QW="",t4="",e4="",n4="",s4="",r4="",a4="",o4="",i4="",u4="",c4="",l4="",f4="",h4="",d4="",p4="",m4="",g4="",y4="",b4="",w4="",v4="",k4="",x4="",S4="",N4="",I4="",_4="",T4="",E4="",$4="",C4="",A4="",D4="",O4="",F4="",R4="",P4="",M4="",V4="",L4="",z4="",B4="",W4="",j4="",H4="",q4="",K4="",U4="",G4="",Y4="",X4="",Z4="",J4="",Q4="",tj="",ej="",nj="",sj="",rj="",aj="",oj="",ij="",uj="",cj="",lj="",fj="",hj="",dj="",pj="",mj="",gj="",yj="",bj="",wj="",vj="",kj="",xj="",Sj="",Nj="",Ij="",_j="",Tj="",Ej="",$j="",Cj="",Aj="",Dj="",Oj="",Fj="",Rj="",Pj="",Mj="",Vj="",Lj="",zj="",Bj="",Wj="",jj="",Hj="",qj="",Kj="",Uj="",Gj="",Yj="",Xj="",Zj="",Jj="",Qj="",tH="",eH="",nH="",sH="",rH="",aH="",oH="",iH="",uH="",cH="",lH="",fH="",hH="",dH="",pH="",mH="",gH="",yH="",bH="",wH="",vH="",kH="",xH="",SH="",NH="",IH="",_H="",TH="",EH="",$H="",CH="",AH="",DH="",OH="",FH="",RH="",PH="",MH="",VH="",LH="",zH="",BH="",WH="",jH="",HH="",qH="",KH="",UH="",GH="",YH="",XH="",ZH="",JH="",QH="",tq="",eq="",nq="",sq="",rq="",aq="",oq="",iq="",uq="",cq="",lq="",fq="",hq="",dq="",pq="",mq="",gq="",yq="",bq="",wq="",vq="",kq="",xq="",Sq="",Nq="",Iq="",_q="",Tq="",Eq="",$q="",Cq="",Aq="",Dq="",Oq="",Fq="",Rq="",Pq="",Mq="",Vq="",Lq="",zq="",Bq="",Wq="",jq="",Hq="",qq="",Kq="",Uq="",Gq="",Yq="",Xq="",Zq="",Jq="",Qq="",tK="",eK="",nK="",sK="",rK="",aK="",oK="",iK="",uK="",cK="",lK="",fK="",hK="",dK="",pK="",mK={a:jL,e:HL,ai:qL,ei:KL,xi:UL,yi:GL,an:YL,han:XL,ang:ZL,ao:JL,wa:QL,yu:tz,niu:ez,o:nz,ba:sz,pa:rz,pi:az,bi:oz,bai:iz,bo:uz,bei:cz,ban:lz,pan:fz,bin:hz,bang:dz,pang:pz,beng:mz,bao:gz,bu:yz,pu:bz,mian:wz,po:vz,fan:kz,fu:xz,ben:Sz,feng:Nz,bian:Iz,pian:_z,zhen:Tz,biao:Ez,piao:$z,huo:Cz,bie:Az,min:Dz,fen:Oz,bing:Fz,geng:Rz,fang:Pz,xian:Mz,fou:Vz,ca:Lz,cha:zz,cai:Bz,can:Wz,shen:jz,cen:Hz,san:qz,cang:Kz,zang:Uz,chen:Gz,cao:Yz,ce:Xz,ze:Zz,zhai:Jz,dao:Qz,ceng:tB,zha:eB,chai:nB,ci:sB,zi:rB,cuo:aB,chan:oB,shan:iB,zhan:uB,xin:cB,lian:lB,chang:fB,zhang:hB,chao:dB,zhao:pB,zhou:mB,che:gB,ju:yB,cheng:bB,rong:wB,sheng:vB,deng:kB,zhi:xB,zheng:SB,tang:NB,chi:IB,shi:_B,qi:TB,chuai:EB,tuo:$B,duo:CB,xue:AB,chong:DB,chou:OB,qiu:FB,xiu:RB,chu:PB,tuan:MB,zhui:VB,chuan:LB,zhuan:zB,yuan:BB,cuan:WB,chuang:jB,zhuang:HB,chui:qB,chun:KB,zhun:UB,cu:GB,dun:YB,qu:XB,xu:ZB,chuo:JB,zu:QB,ji:tW,cong:eW,zong:nW,cou:sW,cui:rW,wei:aW,cun:oW,zuo:iW,zuan:uW,da:cW,dai:lW,tai:fW,ta:hW,dan:dW,lu:pW,tan:mW,ren:gW,jie:yW,yan:bW,dang:wW,tao:vW,tiao:kW,te:xW,de:SW,dei:NW,di:IW,ti:_W,tui:TW,you:EW,dian:$W,tian:CW,zhu:AW,nian:DW,diao:OW,yao:FW,die:RW,she:PW,ye:MW,xie:VW,zhe:LW,ding:zW,diu:BW,ting:WW,dong:jW,tong:HW,zhong:qW,dou:KW,du:UW,duan:GW,dui:YW,rui:XW,yue:ZW,tun:JW,hui:QW,wu:t4,ya:e4,he:n4,wo:s4,en:r4,n:a4,er:o4,fa:i4,quan:u4,fei:c4,pei:l4,ping:f4,fo:h4,hu:d4,ga:p4,ge:m4,ha:g4,xia:y4,gai:b4,hai:w4,gan:v4,gang:k4,jiang:x4,hang:S4,gong:N4,hong:I4,guang:_4,qiong:T4,gao:E4,hao:$4,li:C4,jia:A4,luo:D4,ke:O4,qia:F4,gei:R4,gen:P4,hen:M4,gou:V4,kou:L4,gu:z4,pai:B4,gua:W4,tou:j4,guai:H4,kuai:q4,guan:K4,wan:U4,ne:G4,gui:Y4,jun:X4,jiong:Z4,jue:J4,gun:Q4,hun:tj,guo:ej,hei:nj,kan:sj,heng:rj,mo:aj,peng:oj,hou:ij,hua:uj,huai:cj,huan:lj,xun:fj,huang:hj,nai:dj,luan:pj,qie:mj,jian:gj,nan:yj,qian:bj,qiang:wj,xiang:vj,jiao:kj,zhuo:xj,qiao:Sj,xiao:Nj,si:Ij,kai:_j,jin:Tj,qin:Ej,jing:$j,ying:Cj,jiu:Aj,zui:Dj,juan:Oj,suan:Fj,yun:Rj,qun:Pj,ka:Mj,kang:Vj,keng:Lj,kao:zj,ken:Bj,yin:Wj,kong:jj,ku:Hj,kua:qj,kui:Kj,kuan:Uj,kuang:Gj,que:Yj,kun:Xj,kuo:Zj,la:Jj,lai:Qj,lan:tH,lin:eH,lang:nH,liang:sH,lao:rH,mu:aH,le:oH,lei:iH,sui:uH,lie:cH,leng:lH,ling:fH,lia:hH,liao:dH,liu:pH,lun:mH,lv:gH,lou:yH,mao:bH,long:wH,nong:vH,shuang:kH,shu:xH,shuai:SH,lve:NH,ma:IH,me:_H,mai:TH,man:EH,mi:$H,men:CH,mang:AH,meng:DH,miao:OH,mou:FH,miu:RH,mei:PH,wen:MH,mie:VH,ming:LH,na:zH,nei:BH,nuo:WH,ruo:jH,nang:HH,nao:qH,ni:KH,nen:UH,neng:GH,nin:YH,niao:XH,nie:ZH,niang:JH,ning:QH,nu:tq,nv:eq,ru:nq,nuan:sq,nve:rq,re:aq,ou:oq,pao:iq,pou:uq,pen:cq,pie:lq,pin:fq,se:hq,qing:dq,zan:pq,shao:mq,sao:gq,sha:yq,xuan:bq,ran:wq,rang:vq,rao:kq,reng:xq,ri:Sq,rou:Nq,ruan:Iq,run:_q,sa:Tq,suo:Eq,sai:$q,shui:Cq,sang:Aq,sen:Dq,seng:Oq,shai:Fq,shang:Rq,xing:Pq,shou:Mq,shuo:Vq,su:Lq,shua:zq,shuan:Bq,shun:Wq,song:jq,sou:Hq,sun:qq,teng:Kq,tie:Uq,tu:Gq,wai:Yq,wang:Xq,weng:Zq,zhua:Jq,yang:Qq,xiong:tK,yo:eK,yong:nK,za:sK,zai:rK,zao:aK,zei:oK,zen:iK,zeng:uK,zhei:cK,zou:lK,zhuai:fK,zun:hK,dia:dK,nou:pK};const gK=5;var yK=class{constructor(){Je(this,"currentInput",""),Je(this,"candidates",[]),Je(this,"db"),Je(this,"pinyinDict",mK),Je(this,"pinyinCharTable"),Je(this,"initializationPromise"),this.db=new mu("PinyinCharDB"),this.db.version(1).stores({pinyinCharEntries:"++id, &[pinyin+char], pinyin, char, weight"}),this.pinyinCharTable=this.db.table("pinyinCharEntries"),this.initializationPromise=this.initializeDatabase()}async initializeDatabase(){try{if(await this.pinyinCharTable.count()===0){const e=[];for(const[t,n]of Object.entries(this.pinyinDict))for(const s of n.split(""))e.push({pinyin:t,char:s,weight:1});await this.pinyinCharTable.bulkAdd(e)}}catch(e){throw console.error(" PinyinCharDB :",e),e}}async processInput(e){if(await this.initializationPromise,this.currentInput=e.toLowerCase(),this.candidates=[],!this.currentInput)return[];const t=await this.pinyinCharTable.where("pinyin").startsWith(this.currentInput).toArray(),n=(s,r)=>{const a=s.pinyin===r,o=s.weight>1;return a&&o?1:!a&&o?2:a&&!o?3:!a&&!o?4:5};return t.sort((s,r)=>{const a=n(s,this.currentInput),o=n(r,this.currentInput);return a!==o?a-o:r.weight!==s.weight?r.weight-s.weight:s.id-r.id}),this.candidates=t.map(s=>s.char),this.candidates=[...new Set(this.candidates)],this.candidates}async selectCandidate(e){var t,n,s;if(await this.initializationPromise,!this.currentInput)return;let r=this.currentInput;for(const o of Object.keys(this.pinyinDict))if(o.startsWith(this.currentInput)&&this.pinyinDict[o].includes(e))if(o.length>r.length||o===this.currentInput){if(r=o,(t=this.pinyinDict[this.currentInput])!=null&&t.includes(e)&&this.currentInput===o)break}else r===this.currentInput&&(n=this.pinyinDict[o])!=null&&n.includes(e)&&(r=o);if(!((s=this.pinyinDict[r])!=null&&s.includes(e))){for(const o of Object.keys(this.pinyinDict))if(this.pinyinDict[o].includes(e)){if(o.startsWith(this.currentInput)){r=o;break}r===this.currentInput&&(r=o)}}const a=await this.pinyinCharTable.where({pinyin:r,char:e}).first();if(a&&a.id!==void 0){const o=Math.min((a.weight||0)+1,gK);await this.pinyinCharTable.update(a.id,{weight:o})}else this.pinyinDict[r]?await this.pinyinCharTable.add({pinyin:r,char:e,weight:1}):console.warn(` ${e}  ${r} `);this.clear()}clear(){this.currentInput="",this.candidates=[]}getCurrentInput(){return this.currentInput}getCandidates(){return this.candidates}},bK=class{constructor(e,t={}){Je(this,"canvas"),Je(this,"ctx"),Je(this,"lastX",0),Je(this,"lastY",0),Je(this,"strokeData",[]),Je(this,"clearTimerId",null),Je(this,"isDrawing",!1),Je(this,"options"),Je(this,"handleStart",s=>{s.preventDefault(),this.isDrawing=!0;const{offsetX:r,offsetY:a}=this.getEventCoordinates(s);this.startDrawing(r,a),this.resetClearTimer()}),Je(this,"handleMove",s=>{if(!this.isDrawing)return;s.preventDefault();const{offsetX:r,offsetY:a}=this.getEventCoordinates(s);this.draw(r,a),this.resetClearTimer()}),Je(this,"handleEnd",s=>{this.isDrawing&&(s.preventDefault(),this.isDrawing=!1,this.endStroke(),this.startClearTimer(),this.options.onDrawEnd&&this.options.onDrawEnd())}),this.canvas=e,this.options={clearDelay:1e3,...t};const n=this.canvas.getContext("2d");if(!n)throw new Error("Failed to get 2D rendering context");this.ctx=n,this.setupCanvas(),this.attachEvents()}setupCanvas(){this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth=3,this.ctx.strokeStyle="#000",this.clearCanvas(),this.drawGrid()}drawGrid(){const e=this.canvas.width,t=this.canvas.height;this.ctx.save(),this.ctx.strokeStyle="#ddd",this.ctx.lineWidth=1,this.ctx.setLineDash([3,3]),this.ctx.beginPath(),this.ctx.moveTo(0,t/2),this.ctx.lineTo(e,t/2),this.ctx.moveTo(e/2,0),this.ctx.lineTo(e/2,t),this.ctx.stroke(),this.ctx.setLineDash([]),this.ctx.beginPath(),this.ctx.rect(0,0,e,t),this.ctx.stroke(),this.ctx.restore()}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawGrid(),this.strokeData=[],this.resetClearTimer()}startDrawing(e,t){this.lastX=e,this.lastY=t,this.ctx.strokeStyle="#000",this.ctx.lineWidth=3,this.ctx.setLineDash([]),this.strokeData.push(e,t,0)}draw(e,t){this.ctx.beginPath(),this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(e,t),this.ctx.stroke(),this.lastX=e,this.lastY=t,this.strokeData.push(e,t,0)}endStroke(){this.strokeData.length>=3&&(this.strokeData[this.strokeData.length-1]=1)}getStrokeData(){return this.strokeData}resetClearTimer(){this.clearTimerId&&(window.clearTimeout(this.clearTimerId),this.clearTimerId=null)}startClearTimer(){this.resetClearTimer(),this.clearTimerId=window.setTimeout(()=>{this.clearCanvas(),this.clearTimerId=null},this.options.clearDelay)}getEventCoordinates(e){if(e instanceof MouseEvent)return{offsetX:e.offsetX,offsetY:e.offsetY};{const t=e.touches[0]||e.changedTouches[0],n=e.target.getBoundingClientRect();return{offsetX:t.clientX-n.left,offsetY:t.clientY-n.top}}}attachEvents(){this.canvas.addEventListener("mousedown",this.handleStart),this.canvas.addEventListener("mousemove",this.handleMove),this.canvas.addEventListener("mouseup",this.handleEnd),this.canvas.addEventListener("mouseleave",this.handleEnd),this.canvas.addEventListener("touchstart",this.handleStart,{passive:!1}),this.canvas.addEventListener("touchmove",this.handleMove,{passive:!1}),this.canvas.addEventListener("touchend",this.handleEnd),this.canvas.addEventListener("touchcancel",this.handleEnd)}detachEvents(){this.canvas.removeEventListener("mousedown",this.handleStart),this.canvas.removeEventListener("mousemove",this.handleMove),this.canvas.removeEventListener("mouseup",this.handleEnd),this.canvas.removeEventListener("mouseleave",this.handleEnd),this.canvas.removeEventListener("touchstart",this.handleStart),this.canvas.removeEventListener("touchmove",this.handleMove),this.canvas.removeEventListener("touchend",this.handleEnd),this.canvas.removeEventListener("touchcancel",this.handleEnd)}destroy(){this.detachEvents(),this.resetClearTimer()}getCanvas(){return this.canvas}getContext(){return this.ctx}};function wK(e,t,n){if(!e||!t||n==="static")return null;let s,r;if(n==="bottom")s=window.innerHeight-t.offsetHeight,r=0;else{const a=e.getBoundingClientRect(),o=t.offsetWidth;s=a.bottom+window.scrollY,r=a.left+window.scrollX+a.width/2-o/2;const i=window.innerWidth;r+o>i&&(r=i-o-10),r<10&&(r=10)}return{top:`${s}px`,left:`${r}px`}}function Zp(e){if(!e)return!1;if(e.tagName==="TEXTAREA")return!0;if(e.tagName==="INPUT"){const t=(e.type||"text").toLowerCase();return!["checkbox","radio","button","submit","reset","file","image","range","color","hidden","date","datetime-local","month","week","time"].includes(t)}return!1}function vK(e,t,n){e.value=t,NK(e,n),e.dispatchEvent(new Event("input",{bubbles:!0}))}function kK(e,t,n,s=""){return e.slice(0,t)+s+e.slice(t+n)}function rw(e,t=""){const n=Number(e.getAttribute("maxlength"));let s=e.selectionStart??0;const r=e.selectionEnd??s;let a;if(t.length>0)a=r-s;else{const u=r-s;if(u>0)a=u;else if(s>0)a=1,s--;else return}if(t.length>0&&n&&e.value.length-a+t.length>n)return;const o=kK(e.value,s,a,t),i=s+t.length;vK(e,o,i)}function xK(e,t){rw(e,t)}function SK(e){rw(e)}function NK(e,t){e.selectionStart=t,e.selectionEnd=t}let aw=null;function IK(e){aw=e}function Wl(){return aw}function _K(e=!1){const t=ke(!1),n=ke(0);async function s(){const a=Wl();if(a)try{t.value=await a.initialize({onProgress:o=>{n.value=o}})}catch(o){console.error(":",o),t.value=!1}else console.warn(""),t.value=!1}async function r(){const a=Wl();if(a&&t.value)try{await a.close(),t.value=!1}catch(o){console.error(":",o)}}return Ko(()=>{e&&s()}),Lu(()=>{r()}),{recognizerInitialized:t,recognizerProgress:n}}const Wh="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M21,11H6.83L10.41,7.41L9,6L3,12L9,18L10.41,16.58L6.83,13H21V11Z'%20/%3e%3c/svg%3e",jh="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M19,7V11H5.83L9.41,7.41L8,6L2,12L8,18L9.41,16.58L5.83,13H21V7H19Z'%20/%3e%3c/svg%3e",TK={class:"zhk-candidate-list"},EK=["onClick"],ow=js({__name:"CandidateList",props:{candidates:{}},emits:["select"],setup(e,{emit:t}){const n=t;function s(r){n("select",r)}return(r,a)=>(Xt(),re("div",TK,[(Xt(!0),re(De,null,ms(e.candidates,(o,i)=>(Xt(),re("button",{key:`candidate-${i}`,class:"zhk-candidate-list__item",onClick:u=>s(o)},fn(o),9,EK))),128))]))}}),$K={class:"handwriting-input"},CK={class:"handwriting-buttons"},AK={class:"handwriting-canvas-container"},DK={class:"progress-bar"},OK={class:"progress-text"},FK=["width","height"],RK={class:"handwriting-buttons"},PK=js({__name:"HandwritingInput",props:{recognizerInitialized:{type:Boolean},recognizerProgress:{}},emits:["key","exit"],setup(e,{emit:t}){const n=e,s=t,r=ke(null),a=ke(null);let o=null;const i=ke(!1),{height:u}=sw(a);function c(){o&&o.clearCanvas()}function l(){r.value&&(o&&o.destroy(),o=new bK(r.value,{onDrawEnd:d}))}const f=ke([]);async function d(){if(!o||o.getStrokeData().length===0||i.value)return;const g=Wl();if(g){i.value=!0;try{const w=[...o.getStrokeData()],b=await g.recognize(w);f.value=b}catch(w){console.error(":",w)}finally{i.value=!1}}else console.warn("")}Lu(()=>{o&&o.destroy()}),zu(()=>{r.value&&u.value&&n.recognizerInitialized&&Fo(()=>{l()})});function m(g){s("key",{key:g}),f.value=[],c()}return(g,w)=>(Xt(),re("div",$K,[Kn(ow,{candidates:f.value,onSelect:m},null,8,["candidates"]),St("div",{ref_key:"containerRef",ref:a,class:"handwriting-content"},[St("div",CK,[St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[0]||(w[0]=b=>s("key",{key:""}))},"  "),St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[1]||(w[1]=b=>s("key",{key:""}))},"  "),St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[2]||(w[2]=b=>s("key",{key:""}))},"  "),w[8]||(w[8]=Mo()),St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[3]||(w[3]=b=>s("key",{key:""}))},"  ")]),St("div",AK,[e.recognizerInitialized?(Xt(),re("canvas",{key:1,ref_key:"canvasRef",ref:r,class:"handwriting-canvas",width:An(u),height:An(u)},null,8,FK)):(Xt(),re("div",{key:0,class:"handwriting-loading",style:Da({width:`${An(u)}px`,height:`${An(u)}px`})},[w[9]||(w[9]=St("div",{class:"loading-text"}," ... ",-1)),St("div",DK,[St("div",{class:"progress-fill",style:Da({width:`${e.recognizerProgress*100}%`})},null,4)]),St("div",OK,fn(Math.round(e.recognizerProgress*100))+"% ",1)],4))]),St("div",RK,[St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[4]||(w[4]=b=>s("key",{key:"delete",isControl:!0}))},[...w[10]||(w[10]=[St("img",{src:Wh,alt:""},null,-1)])]),St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[5]||(w[5]=b=>s("exit"))},"  "),St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[6]||(w[6]=b=>s("key",{key:""}))},"  "),St("button",{class:"handwriting-btn handwriting-btn--function",onClick:w[7]||(w[7]=b=>s("key",{key:"enter",isControl:!0}))},[...w[11]||(w[11]=[St("img",{src:jh,alt:""},null,-1)])])])],512)]))}}),MK="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M6,18H18V16H6M12,8.41L16.59,13L18,11.58L12,5.58L6,11.58L7.41,13L12,8.41Z'%20/%3e%3c/svg%3e",iw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M3%2015H5V19H19V15H21V19C21%2020.1%2020.1%2021%2019%2021H5C3.9%2021%203%2020.1%203%2019V15Z'%20/%3e%3c/svg%3e",VK="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z'%20/%3e%3c/svg%3e",LK={class:"zhk-selection"},zK={class:"zhk-selection__list"},BK=["onClick"],WK=js({__name:"CandidateSelection",props:{candidates:{}},emits:["select","close"],setup(e,{emit:t}){const n=t;function s(a){n("select",a)}function r(){n("close")}return(a,o)=>(Xt(),re("div",LK,[St("div",zK,[(Xt(!0),re(De,null,ms(e.candidates,(i,u)=>(Xt(),re("div",{key:u,class:"zhk-selection__text",onClick:c=>s(i)},fn(i),9,BK))),128))]),St("div",{class:"zhk-selection__func"},[St("button",{class:"zhk-selection__func-btn",onClick:r},"  ")])]))}}),jK={class:"zhk-candidate"},HK={class:"zhk-candidate__container"},qK={key:0,class:"zhk-candidate__pinyin"},KK={class:"zhk-candidate__bottom-container"},UK=js({__name:"CandidateBar",props:{modelValue:{required:!0},modelModifiers:{}},emits:Ol(["key","input"],["update:modelValue"]),setup(e,{emit:t}){const n=t,s=B0(e,"modelValue"),r=new yK,a=ke([]);zu(async()=>{a.value=await r.processInput(s.value)});const o=xn(()=>a.value.slice(0,30)),i=ke(!1);function u(c){r.selectCandidate(c),n("input",c),s.value="",i.value=!1}return(c,l)=>(Xt(),re("div",jK,[St("div",HK,[s.value?(Xt(),re("div",qK,fn(s.value),1)):Lr("",!0),St("div",KK,[a.value.length>0?(Xt(),nr(ow,{key:0,candidates:o.value,onSelect:u},null,8,["candidates"])):Lr("",!0),a.value.length>0?(Xt(),re("button",{key:1,class:"zhk-candidate__more",onClick:l[0]||(l[0]=f=>i.value=!0)},[...l[2]||(l[2]=[St("img",{src:VK,alt:""},null,-1)])])):Lr("",!0)])]),is(Kn(WK,{candidates:a.value,onSelect:u,onClose:l[1]||(l[1]=f=>i.value=!1)},null,8,["candidates"]),[[Q0,i.value]])]))}}),GK={class:"zhk-base"},YK={class:"zhk-base__row"},XK=["onClick"],ZK=["disabled"],JK={key:1,src:MK,class:"zhk-base__key-icon",alt:"Shift"},QK=["onClick"],t6={class:"zhk-base__row"},e6={class:"zhk-base__toggle-main"},n6={class:"zhk-base__toggle-sub"},s6=js({__name:"KeyboardBase",props:Ol({enableHandwriting:{type:Boolean}},{modelValue:{default:"en"},modelModifiers:{}}),emits:Ol(["key"],["update:modelValue"]),setup(e,{emit:t}){const n=e,s=t,r=B0(e,"modelValue"),a=ke(!1),o=xn(()=>r.value==="zh"),i=xn(()=>o.value?!0:a.value);function u(N,$=!1){s("key",{key:N,isControl:$})}function c(){o.value?r.value="hand":a.value=!a.value}function l(){r.value="num"}function f(){r.value="symbol"}const d=["1","2","3","4","5","6","7","8","9","0"],m=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],g=ke("");function w(){if(r.value==="zh"&&g.value){g.value=g.value.slice(0,-1);return}u("delete",!0)}function b(N){if(r.value==="zh"){g.value+=N;return}const $=a.value?N.toUpperCase():N;u($)}function k(){r.value=r.value==="zh"?"en":"zh"}const I=xn(()=>n.enableHandwriting?"":"-"),T=xn(()=>!n.enableHandwriting);return(N,$)=>(Xt(),re("div",GK,[St("div",YK,[r.value==="zh"?(Xt(),nr(UK,{key:0,modelValue:g.value,"onUpdate:modelValue":$[0]||($[0]=D=>g.value=D),onInput:$[1]||($[1]=D=>u(D,!1))},null,8,["modelValue"])):(Xt(),re(De,{key:1},ms(d,(D,P)=>St("button",{key:`number-${P}`,class:"zhk-base__key zhk-base__key--letter",onClick:L=>b(D)},fn(D),9,XK)),64))]),(Xt(),re(De,null,ms(m,(D,P)=>St("div",{key:`row-${P}`,class:"zhk-base__row"},[P===2?(Xt(),re("button",{key:0,class:ur(["zhk-base__key zhk-base__key--function zhk-base__key--shift",{"zhk-base__key--active":!o.value&&a.value,"zhk-base__key--disabled":o.value&&T.value}]),disabled:o.value&&T.value,onClick:c},[o.value?(Xt(),re(De,{key:0},[Mo(fn(I.value),1)],64)):(Xt(),re("img",JK))],10,ZK)):Lr("",!0),(Xt(!0),re(De,null,ms(D,(L,R)=>(Xt(),re("button",{key:`key-${P}-${R}`,class:"zhk-base__key zhk-base__key--letter",onClick:M=>b(L)},fn(i.value?L.toUpperCase():L),9,QK))),128)),P===2?(Xt(),re("button",{key:1,class:"zhk-base__key zhk-base__key--function zhk-base__key--delete",onClick:$[2]||($[2]=()=>w())},[...$[7]||($[7]=[St("img",{src:Wh,class:"zhk-base__key-icon",alt:"Delete"},null,-1)])])):Lr("",!0)])),64)),St("div",t6,[St("button",{class:"zhk-base__key zhk-base__key--function",onClick:f},"  "),St("button",{class:"zhk-base__key zhk-base__key--function",onClick:l}," 123 "),St("button",{class:"zhk-base__key",onClick:$[3]||($[3]=()=>u(","))},"  "),St("button",{class:"zhk-base__key zhk-base__key--space",onClick:$[4]||($[4]=()=>u(" "))},[...$[8]||($[8]=[St("img",{src:iw,class:"zhk-base__key-icon",alt:"Space"},null,-1)])]),St("button",{class:"zhk-base__key",onClick:$[5]||($[5]=()=>u(""))},"  "),St("button",{class:"zhk-base__key zhk-base__key--function",onClick:k},[St("span",e6,fn(r.value==="zh"?"":""),1),St("span",n6,"/"+fn(r.value==="zh"?"":""),1)]),St("button",{class:"zhk-base__key zhk-base__key--function",onClick:$[6]||($[6]=()=>u("enter",!0))},[...$[9]||($[9]=[St("img",{src:jh,class:"zhk-base__key-icon",alt:"Enter"},null,-1)])])])]))}}),r6={class:"num-keyboard"},a6={class:"num-keyboard__container"},o6={class:"num-keyboard__left"},i6={class:"num-keyboard__rows"},u6=["onClick"],c6={key:1,src:iw,class:"zhk-base__key-icon",alt:"Space"},l6={class:"num-keyboard__right"},f6=["onClick"],h6=["src","alt"],d6={key:1},p6=js({__name:"NumericKeyboard",emits:["key","exit"],setup(e,{emit:t}){const n=t,s=[["1","2","3"],["4","5","6"],["7","8","9"],["back","0","space"]],r=[{key:"delete",icon:Wh,text:"",alt:"Delete"},{key:".",icon:"",text:".",alt:"."},{key:"@",icon:"",text:"@",alt:"@"},{key:"enter",icon:jh,text:"",alt:"Enter"}];function a(u){n("key",{key:u})}function o(u,c=!0){n("key",{key:u,isControl:c})}function i(){n("exit")}return(u,c)=>(Xt(),re("div",r6,[St("div",a6,[St("div",o6,[St("div",i6,[(Xt(),re(De,null,ms(s,(l,f)=>St("div",{key:`row-${f}`,class:"num-keyboard__row"},[(Xt(!0),re(De,null,ms(l,(d,m)=>(Xt(),re("button",{key:`key-${f}-${m}`,class:ur(["num-keyboard__key",{"num-keyboard__key--back":d==="back","num-keyboard__key--space":d==="space"}]),onClick:g=>d==="back"?i():a(d==="space"?" ":d)},[d==="back"?(Xt(),re(De,{key:0},[Mo("  ")],64)):d==="space"?(Xt(),re("img",c6)):(Xt(),re(De,{key:2},[Mo(fn(d),1)],64))],10,u6))),128))])),64))])]),St("div",l6,[(Xt(),re(De,null,ms(r,(l,f)=>St("button",{key:`func-${f}`,class:"num-keyboard__key num-keyboard__key--function",onClick:d=>l.key==="."||l.key==="@"?a(l.key):o(l.key)},[l.icon?(Xt(),re("img",{key:0,src:l.icon,class:"num-keyboard__key-icon",alt:l.alt},null,8,h6)):(Xt(),re("span",d6,fn(l.text),1))],8,f6)),64))])])]))}}),m6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M18,20V10H6V20H18M18,8A2,2%200%200,1%2020,10V20A2,2%200%200,1%2018,22H6C4.89,22%204,21.1%204,20V10A2,2%200%200,1%206,8H15V6A3,3%200%200,0%2012,3A3,3%200%200,0%209,6H7A5,5%200%200,1%2012,1A5,5%200%200,1%2017,6V8H18M12,17A2,2%200%200,1%2010,15A2,2%200%200,1%2012,13A2,2%200%200,1%2014,15A2,2%200%200,1%2012,17Z'%20/%3e%3c/svg%3e",g6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M12,17C10.89,17%2010,16.1%2010,15C10,13.89%2010.89,13%2012,13A2,2%200%200,1%2014,15A2,2%200%200,1%2012,17M18,20V10H6V20H18M18,8A2,2%200%200,1%2020,10V20A2,2%200%200,1%2018,22H6C4.89,22%204,21.1%204,20V10C4,8.89%204.89,8%206,8H7V6A5,5%200%200,1%2012,1A5,5%200%200,1%2017,6V8H18M12,3A3,3%200%200,0%209,6V8H15V6A3,3%200%200,0%2012,3Z'%20/%3e%3c/svg%3e",y6={class:"symbol-keyboard"},b6={class:"symbol-keyboard__content"},w6={class:"symbol-keyboard__functions"},v6={class:"symbol-keyboard__lang-selector"},k6={class:"symbol-keyboard__control-group"},x6=["src"],S6=["src"],N6={class:"symbol-keyboard__symbols-container"},I6={class:"symbol-keyboard__symbols-grid"},_6=["onClick"],T6="!@#$%^&*(){}[]<>/\\|:;\"',.?+-=_~`",E6="",$6=js({__name:"SymbolKeyboard",emits:["key","exit"],setup(e,{emit:t}){const n=t,s=ke("en"),r=xn(()=>s.value==="zh"?E6:T6),a=ke(!1);function o(l){n("key",{key:l}),a.value||n("exit")}function i(){n("exit")}function u(l){s.value=l}function c(){a.value=!a.value}return(l,f)=>(Xt(),re("div",y6,[St("div",b6,[St("div",w6,[St("div",v6,[St("button",{class:ur(["symbol-keyboard__lang-btn",{"symbol-keyboard__lang-btn--active":s.value==="zh"}]),onClick:f[0]||(f[0]=d=>u("zh"))},"  ",2),St("button",{class:ur(["symbol-keyboard__lang-btn",{"symbol-keyboard__lang-btn--active":s.value==="en"}]),onClick:f[1]||(f[1]=d=>u("en"))},"  ",2)]),St("div",k6,[St("button",{class:ur(["symbol-keyboard__key symbol-keyboard__key--function symbol-keyboard__key--lock",{"symbol-keyboard__key--locked":a.value}]),onClick:c},[a.value?(Xt(),re("img",{key:1,src:An(g6),alt:"Lock closed"},null,8,S6)):(Xt(),re("img",{key:0,src:An(m6),alt:"Lock open"},null,8,x6))],2),St("button",{class:"symbol-keyboard__key symbol-keyboard__key--function symbol-keyboard__key--back",onClick:i},"  ")])]),St("div",N6,[St("div",I6,[(Xt(!0),re(De,null,ms(r.value,(d,m)=>(Xt(),re("button",{key:`key-${m}`,class:"symbol-keyboard__key",onClick:g=>o(d)},fn(d),9,_6))),128))])])])]))}}),C6={key:0,class:"zhk__disabled-overlay"},A6=js({__name:"ZhKeyboard",props:{defaultMode:{default:"en"},enableHandwriting:{type:Boolean,default:!1},position:{default:"static"},disableWhenNoFocus:{type:Boolean,default:!0}},emits:["key"],setup(e,{emit:t}){const n=e,s=t,r=ke(n.defaultMode||"en"),a=ke(n.defaultMode||"en"),o=ke([]),i=ke(!1),u=ke(null),c=ke(null),{recognizerInitialized:l,recognizerProgress:f}=_K(n.enableHandwriting);gs(r,(L,R)=>{L!==R&&(a.value=R)});const d=PL(),m=xn(()=>d.value&&Zp(d.value)?d.value:null),g=xn(()=>n.position==="static"||!!(d.value&&Zp(d.value))),{height:w}=sw(c),b=ke(!1);zu(()=>{if(m.value){const L=m.value.dataset.inputmode;L&&(r.value=L)}}),gs([g,m],()=>{g.value&&w.value&&Fo(()=>{I(),b.value=!0})}),gs(w,(L,R)=>{!b.value&&L&&L!==R&&Fo(()=>{I()})},{once:!0});const k=xn(()=>n.disableWhenNoFocus===!1?!1:!m.value);function I(){if(!w.value)return;const L=wK(m.value,c.value,n.position);u.value=L}const T=CL(I,100);pu(window,"scroll",T,{passive:!0}),pu(window,"resize",T,{passive:!0});function N(L){if(L.isControl){switch(L.key){case"delete":SK(m.value);break;case"more":i.value=!0;break}return}else $(L.key);s("key",L)}function $(L){xK(m.value,L)}function D(){r.value=a.value}function P(L){o.value=L}return(L,R)=>(Xt(),nr(HM,{to:"body",disabled:e.position==="static"},[is(St("div",G0(L.$attrs,{ref_key:"keyboardRef",ref:c,class:["zhk",{"zhk--floating":e.position==="float","zhk--bottom":e.position==="bottom","zhk--disabled":k.value}],style:{"--keyboard-height":`${An(w)}px`,...u.value},onMousedown:R[1]||(R[1]=mL(()=>{},["prevent"]))}),[k.value||!g.value||!An(w)?(Xt(),re("div",C6,[...R[2]||(R[2]=[St("span",null,"",-1)])])):(Xt(),re(De,{key:1},[r.value==="hand"?(Xt(),nr(PK,{key:0,"recognizer-initialized":An(l),"recognizer-progress":An(f),onKey:N,onExit:D,onRecognize:P},null,8,["recognizer-initialized","recognizer-progress"])):r.value==="num"?(Xt(),nr(p6,{key:1,onKey:N,onExit:D})):r.value==="symbol"?(Xt(),nr($6,{key:2,onKey:N,onExit:D})):r.value==="en"||r.value==="zh"?(Xt(),nr(s6,{key:3,modelValue:r.value,"onUpdate:modelValue":R[0]||(R[0]=M=>r.value=M),"enable-handwriting":e.enableHandwriting,onKey:N},null,8,["modelValue","enable-handwriting"])):Lr("",!0)],64))],16),[[Q0,g.value]])],8,["disabled"]))}}),D6={class:"root-container"},O6={class:"container"},F6={class:"input-grid"},R6={class:"input-container"},P6={class:"input-container"},M6={class:"input-container"},V6={class:"input-container"},L6={class:"controls"},z6={class:"checkbox-container"},B6={class:"checkbox-item"},W6={class:"position-container"},j6={class:"radio-group"},H6=["id","value"],q6=["for"],K6={class:"keyboard-wrapper"},U6=js({__name:"App",setup(e){const t=ke(""),n=ke(""),s=ke(""),r=ke(""),a=ke(400),o=ke(300),i=ke("float"),u=ke(!0),c={static:"",float:"",bottom:""};return Ko(()=>{window.innerWidth<960&&(i.value="bottom")}),(l,f)=>(Xt(),re("div",D6,[St("div",O6,[f[14]||(f[14]=St("div",{class:"header"},[St("h1",null,""),St("div",{class:"github-link"},[St("a",{href:"https://github.com/dusionlike/zh-keyboard",target:"_blank",rel:"noopener noreferrer"},[St("img",{src:"https://img.shields.io/github/stars/dusionlike/zh-keyboard?style=social",alt:"GitHub stars"})])])],-1)),St("div",F6,[St("div",R6,[f[8]||(f[8]=St("label",null,":",-1)),is(St("input",{"onUpdate:modelValue":f[0]||(f[0]=d=>t.value=d),type:"text","data-inputmode":"en",inputmode:"none",placeholder:""},null,512),[[ca,t.value]])]),St("div",P6,[f[9]||(f[9]=St("label",null,":",-1)),is(St("input",{"onUpdate:modelValue":f[1]||(f[1]=d=>n.value=d),type:"text","data-inputmode":"zh",inputmode:"none",placeholder:""},null,512),[[ca,n.value]])]),St("div",M6,[f[10]||(f[10]=St("label",null,":",-1)),is(St("input",{"onUpdate:modelValue":f[2]||(f[2]=d=>s.value=d),type:"text","data-inputmode":"hand",inputmode:"none",placeholder:""},null,512),[[ca,s.value]])]),St("div",V6,[f[11]||(f[11]=St("label",null,":",-1)),is(St("input",{"onUpdate:modelValue":f[3]||(f[3]=d=>r.value=d),type:"text","data-inputmode":"num",inputmode:"none",placeholder:""},null,512),[[ca,r.value]])])]),St("div",L6,[i.value!=="bottom"?(Xt(),re(De,{key:0},[St("label",null,": "+fn(a.value)+"px",1),is(St("input",{"onUpdate:modelValue":f[4]||(f[4]=d=>a.value=d),type:"range",min:"400",max:"1080",step:"10",class:"width-slider"},null,512),[[ca,a.value]]),St("label",null,": "+fn(o.value)+"px",1),is(St("input",{"onUpdate:modelValue":f[5]||(f[5]=d=>o.value=d),type:"range",min:"300",max:"1000",step:"10",class:"width-slider"},null,512),[[ca,o.value]])],64)):Lr("",!0),St("div",z6,[St("div",B6,[is(St("input",{id:"disable-when-no-focus","onUpdate:modelValue":f[6]||(f[6]=d=>u.value=d),type:"checkbox"},null,512),[[fL,u.value]]),f[12]||(f[12]=St("label",{for:"disable-when-no-focus"},"",-1))])]),St("div",W6,[f[13]||(f[13]=St("label",null,":",-1)),St("div",j6,[(Xt(),re(De,null,ms(c,(d,m)=>St("div",{key:m,class:"radio-item"},[is(St("input",{id:`pos-${m}`,"onUpdate:modelValue":f[7]||(f[7]=g=>i.value=g),type:"radio",value:m,name:"position"},null,8,H6),[[hL,i.value]]),St("label",{for:`pos-${m}`},fn(d),9,q6)])),64))])])])]),St("div",K6,[Kn(An(A6),{position:i.value,style:Da(i.value==="bottom"?{width:"100%",height:"auto"}:{width:`${a.value}px`,height:`${o.value}px`}),"enable-handwriting":"","disable-when-no-focus":u.value},null,8,["position","style","disable-when-no-focus"])])]))}});IK(new XP({modelPath:new URL(""+new URL("../models/handwrite/model.json",import.meta.url).href,import.meta.url).href,dictPath:new URL(""+new URL("../models/dict.txt",import.meta.url).href,import.meta.url).href}));bL(U6).mount("#app");
